/*! For license information please see main.9161317f.js.LICENSE.txt */
(()=>{var e={43:(e,t,n)=>{"use strict";e.exports=n(202)},153:(e,t,n)=>{"use strict";var i=n(43),r=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var i,s={},c=null,u=null;for(i in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)o.call(t,i)&&!l.hasOwnProperty(i)&&(s[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===s[i]&&(s[i]=t[i]);return{$$typeof:r,type:e,key:c,ref:u,props:s,_owner:a.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},202:(e,t)=>{"use strict";var n=Symbol.for("react.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function _(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function v(){}function y(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}_.prototype.isReactComponent={},_.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},_.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=_.prototype;var w=y.prototype=new v;w.constructor=y,m(w,_.prototype),w.isPureReactComponent=!0;var b=Array.isArray,E=Object.prototype.hasOwnProperty,T={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function x(e,t,i){var r,s={},o=null,a=null;if(null!=t)for(r in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(o=""+t.key),t)E.call(t,r)&&!C.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(1===l)s.children=i;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===s[r]&&(s[r]=l[r]);return{$$typeof:n,type:e,key:o,ref:a,props:s,_owner:T.current}}function S(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var I=/\/+/g;function k(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function P(e,t,r,s,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case i:l=!0}}if(l)return o=o(l=e),e=""===s?"."+k(l,0):s,b(o)?(r="",null!=e&&(r=e.replace(I,"$&/")+"/"),P(o,t,r,"",function(e){return e})):null!=o&&(S(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,r+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(I,"$&/")+"/")+e)),t.push(o)),1;if(l=0,s=""===s?".":s+":",b(e))for(var c=0;c<e.length;c++){var u=s+k(a=e[c],c);l+=P(a,t,r,u,o)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(a=e.next()).done;)l+=P(a=a.value,t,r,u=s+k(a,c++),o);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function N(e,t,n){if(null==e)return e;var i=[],r=0;return P(e,i,"","",function(e){return t.call(n,e,r++)}),i}function A(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R={current:null},L={transition:null},O={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:L,ReactCurrentOwner:T};function D(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:N,forEach:function(e,t,n){N(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return N(e,function(){t++}),t},toArray:function(e){return N(e,function(e){return e})||[]},only:function(e){if(!S(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=_,t.Fragment=r,t.Profiler=o,t.PureComponent=y,t.StrictMode=s,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,t.act=D,t.cloneElement=function(e,t,i){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=m({},e.props),s=e.key,o=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,a=T.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)E.call(t,c)&&!C.hasOwnProperty(c)&&(r[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)r.children=i;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:n,type:e.type,key:s,ref:o,props:r,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=x,t.createFactory=function(e){var t=x.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=S,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:A}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=L.transition;L.transition={};try{e()}finally{L.transition=t}},t.unstable_act=D,t.useCallback=function(e,t){return R.current.useCallback(e,t)},t.useContext=function(e){return R.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return R.current.useDeferredValue(e)},t.useEffect=function(e,t){return R.current.useEffect(e,t)},t.useId=function(){return R.current.useId()},t.useImperativeHandle=function(e,t,n){return R.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return R.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.current.useMemo(e,t)},t.useReducer=function(e,t,n){return R.current.useReducer(e,t,n)},t.useRef=function(e){return R.current.useRef(e)},t.useState=function(e){return R.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return R.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return R.current.useTransition()},t.version="18.3.1"},228:function(e,t){!function(e){"use strict";var t="1.9.4";function n(e){var t,n,i,r;for(n=1,i=arguments.length;n<i;n++)for(t in r=arguments[n])e[t]=r[t];return e}var i=Object.create||function(){function e(){}return function(t){return e.prototype=t,new e}}();function r(e,t){var n=Array.prototype.slice;if(e.bind)return e.bind.apply(e,n.call(arguments,1));var i=n.call(arguments,2);return function(){return e.apply(t,i.length?i.concat(n.call(arguments)):arguments)}}var s=0;function o(e){return"_leaflet_id"in e||(e._leaflet_id=++s),e._leaflet_id}function a(e,t,n){var i,r,s,o;return o=function(){i=!1,r&&(s.apply(n,r),r=!1)},s=function(){i?r=arguments:(e.apply(n,arguments),setTimeout(o,t),i=!0)},s}function l(e,t,n){var i=t[1],r=t[0],s=i-r;return e===i&&n?e:((e-r)%s+s)%s+r}function c(){return!1}function u(e,t){if(!1===t)return e;var n=Math.pow(10,void 0===t?6:t);return Math.round(e*n)/n}function h(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function d(e){return h(e).split(/\s+/)}function f(e,t){for(var n in Object.prototype.hasOwnProperty.call(e,"options")||(e.options=e.options?i(e.options):{}),t)e.options[n]=t[n];return e.options}function p(e,t,n){var i=[];for(var r in e)i.push(encodeURIComponent(n?r.toUpperCase():r)+"="+encodeURIComponent(e[r]));return(t&&-1!==t.indexOf("?")?"&":"?")+i.join("&")}var m=/\{ *([\w_ -]+) *\}/g;function g(e,t){return e.replace(m,function(e,n){var i=t[n];if(void 0===i)throw new Error("No value provided for variable "+e);return"function"===typeof i&&(i=i(t)),i})}var _=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function v(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1}var y="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function w(e){return window["webkit"+e]||window["moz"+e]||window["ms"+e]}var b=0;function E(e){var t=+new Date,n=Math.max(0,16-(t-b));return b=t+n,window.setTimeout(e,n)}var T=window.requestAnimationFrame||w("RequestAnimationFrame")||E,C=window.cancelAnimationFrame||w("CancelAnimationFrame")||w("CancelRequestAnimationFrame")||function(e){window.clearTimeout(e)};function x(e,t,n){if(!n||T!==E)return T.call(window,r(e,t));e.call(t)}function S(e){e&&C.call(window,e)}var I={__proto__:null,extend:n,create:i,bind:r,get lastId(){return s},stamp:o,throttle:a,wrapNum:l,falseFn:c,formatNum:u,trim:h,splitWords:d,setOptions:f,getParamString:p,template:g,isArray:_,indexOf:v,emptyImageUrl:y,requestFn:T,cancelFn:C,requestAnimFrame:x,cancelAnimFrame:S};function k(){}function P(e){if("undefined"!==typeof L&&L&&L.Mixin){e=_(e)?e:[e];for(var t=0;t<e.length;t++)e[t]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}k.extend=function(e){var t=function(){f(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},r=t.__super__=this.prototype,s=i(r);for(var o in s.constructor=t,t.prototype=s,this)Object.prototype.hasOwnProperty.call(this,o)&&"prototype"!==o&&"__super__"!==o&&(t[o]=this[o]);return e.statics&&n(t,e.statics),e.includes&&(P(e.includes),n.apply(null,[s].concat(e.includes))),n(s,e),delete s.statics,delete s.includes,s.options&&(s.options=r.options?i(r.options):{},n(s.options,e.options)),s._initHooks=[],s.callInitHooks=function(){if(!this._initHooksCalled){r.callInitHooks&&r.callInitHooks.call(this),this._initHooksCalled=!0;for(var e=0,t=s._initHooks.length;e<t;e++)s._initHooks[e].call(this)}},t},k.include=function(e){var t=this.prototype.options;return n(this.prototype,e),e.options&&(this.prototype.options=t,this.mergeOptions(e.options)),this},k.mergeOptions=function(e){return n(this.prototype.options,e),this},k.addInitHook=function(e){var t=Array.prototype.slice.call(arguments,1),n="function"===typeof e?e:function(){this[e].apply(this,t)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(n),this};var N={on:function(e,t,n){if("object"===typeof e)for(var i in e)this._on(i,e[i],t);else for(var r=0,s=(e=d(e)).length;r<s;r++)this._on(e[r],t,n);return this},off:function(e,t,n){if(arguments.length)if("object"===typeof e)for(var i in e)this._off(i,e[i],t);else{e=d(e);for(var r=1===arguments.length,s=0,o=e.length;s<o;s++)r?this._off(e[s]):this._off(e[s],t,n)}else delete this._events;return this},_on:function(e,t,n,i){if("function"===typeof t){if(!1===this._listens(e,t,n)){n===this&&(n=void 0);var r={fn:t,ctx:n};i&&(r.once=!0),this._events=this._events||{},this._events[e]=this._events[e]||[],this._events[e].push(r)}}else console.warn("wrong listener type: "+typeof t)},_off:function(e,t,n){var i,r,s;if(this._events&&(i=this._events[e]))if(1!==arguments.length)if("function"===typeof t){var o=this._listens(e,t,n);if(!1!==o){var a=i[o];this._firingCount&&(a.fn=c,this._events[e]=i=i.slice()),i.splice(o,1)}}else console.warn("wrong listener type: "+typeof t);else{if(this._firingCount)for(r=0,s=i.length;r<s;r++)i[r].fn=c;delete this._events[e]}},fire:function(e,t,i){if(!this.listens(e,i))return this;var r=n({},t,{type:e,target:this,sourceTarget:t&&t.sourceTarget||this});if(this._events){var s=this._events[e];if(s){this._firingCount=this._firingCount+1||1;for(var o=0,a=s.length;o<a;o++){var l=s[o],c=l.fn;l.once&&this.off(e,c,l.ctx),c.call(l.ctx||this,r)}this._firingCount--}}return i&&this._propagateEvent(r),this},listens:function(e,t,n,i){"string"!==typeof e&&console.warn('"string" type argument expected');var r=t;"function"!==typeof t&&(i=!!t,r=void 0,n=void 0);var s=this._events&&this._events[e];if(s&&s.length&&!1!==this._listens(e,r,n))return!0;if(i)for(var o in this._eventParents)if(this._eventParents[o].listens(e,t,n,i))return!0;return!1},_listens:function(e,t,n){if(!this._events)return!1;var i=this._events[e]||[];if(!t)return!!i.length;n===this&&(n=void 0);for(var r=0,s=i.length;r<s;r++)if(i[r].fn===t&&i[r].ctx===n)return r;return!1},once:function(e,t,n){if("object"===typeof e)for(var i in e)this._on(i,e[i],t,!0);else for(var r=0,s=(e=d(e)).length;r<s;r++)this._on(e[r],t,n,!0);return this},addEventParent:function(e){return this._eventParents=this._eventParents||{},this._eventParents[o(e)]=e,this},removeEventParent:function(e){return this._eventParents&&delete this._eventParents[o(e)],this},_propagateEvent:function(e){for(var t in this._eventParents)this._eventParents[t].fire(e.type,n({layer:e.target,propagatedFrom:e.target},e),!0)}};N.addEventListener=N.on,N.removeEventListener=N.clearAllEventListeners=N.off,N.addOneTimeEventListener=N.once,N.fireEvent=N.fire,N.hasEventListeners=N.listens;var A=k.extend(N);function R(e,t,n){this.x=n?Math.round(e):e,this.y=n?Math.round(t):t}var O=Math.trunc||function(e){return e>0?Math.floor(e):Math.ceil(e)};function D(e,t,n){return e instanceof R?e:_(e)?new R(e[0],e[1]):void 0===e||null===e?e:"object"===typeof e&&"x"in e&&"y"in e?new R(e.x,e.y):new R(e,t,n)}function M(e,t){if(e)for(var n=t?[e,t]:e,i=0,r=n.length;i<r;i++)this.extend(n[i])}function j(e,t){return!e||e instanceof M?e:new M(e,t)}function F(e,t){if(e)for(var n=t?[e,t]:e,i=0,r=n.length;i<r;i++)this.extend(n[i])}function U(e,t){return e instanceof F?e:new F(e,t)}function z(e,t,n){if(isNaN(e)||isNaN(t))throw new Error("Invalid LatLng object: ("+e+", "+t+")");this.lat=+e,this.lng=+t,void 0!==n&&(this.alt=+n)}function B(e,t,n){return e instanceof z?e:_(e)&&"object"!==typeof e[0]?3===e.length?new z(e[0],e[1],e[2]):2===e.length?new z(e[0],e[1]):null:void 0===e||null===e?e:"object"===typeof e&&"lat"in e?new z(e.lat,"lng"in e?e.lng:e.lon,e.alt):void 0===t?null:new z(e,t,n)}R.prototype={clone:function(){return new R(this.x,this.y)},add:function(e){return this.clone()._add(D(e))},_add:function(e){return this.x+=e.x,this.y+=e.y,this},subtract:function(e){return this.clone()._subtract(D(e))},_subtract:function(e){return this.x-=e.x,this.y-=e.y,this},divideBy:function(e){return this.clone()._divideBy(e)},_divideBy:function(e){return this.x/=e,this.y/=e,this},multiplyBy:function(e){return this.clone()._multiplyBy(e)},_multiplyBy:function(e){return this.x*=e,this.y*=e,this},scaleBy:function(e){return new R(this.x*e.x,this.y*e.y)},unscaleBy:function(e){return new R(this.x/e.x,this.y/e.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=O(this.x),this.y=O(this.y),this},distanceTo:function(e){var t=(e=D(e)).x-this.x,n=e.y-this.y;return Math.sqrt(t*t+n*n)},equals:function(e){return(e=D(e)).x===this.x&&e.y===this.y},contains:function(e){return e=D(e),Math.abs(e.x)<=Math.abs(this.x)&&Math.abs(e.y)<=Math.abs(this.y)},toString:function(){return"Point("+u(this.x)+", "+u(this.y)+")"}},M.prototype={extend:function(e){var t,n;if(!e)return this;if(e instanceof R||"number"===typeof e[0]||"x"in e)t=n=D(e);else if(t=(e=j(e)).min,n=e.max,!t||!n)return this;return this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(n.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(n.y,this.max.y)):(this.min=t.clone(),this.max=n.clone()),this},getCenter:function(e){return D((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,e)},getBottomLeft:function(){return D(this.min.x,this.max.y)},getTopRight:function(){return D(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(e){var t,n;return(e="number"===typeof e[0]||e instanceof R?D(e):j(e))instanceof M?(t=e.min,n=e.max):t=n=e,t.x>=this.min.x&&n.x<=this.max.x&&t.y>=this.min.y&&n.y<=this.max.y},intersects:function(e){e=j(e);var t=this.min,n=this.max,i=e.min,r=e.max,s=r.x>=t.x&&i.x<=n.x,o=r.y>=t.y&&i.y<=n.y;return s&&o},overlaps:function(e){e=j(e);var t=this.min,n=this.max,i=e.min,r=e.max,s=r.x>t.x&&i.x<n.x,o=r.y>t.y&&i.y<n.y;return s&&o},isValid:function(){return!(!this.min||!this.max)},pad:function(e){var t=this.min,n=this.max,i=Math.abs(t.x-n.x)*e,r=Math.abs(t.y-n.y)*e;return j(D(t.x-i,t.y-r),D(n.x+i,n.y+r))},equals:function(e){return!!e&&(e=j(e),this.min.equals(e.getTopLeft())&&this.max.equals(e.getBottomRight()))}},F.prototype={extend:function(e){var t,n,i=this._southWest,r=this._northEast;if(e instanceof z)t=e,n=e;else{if(!(e instanceof F))return e?this.extend(B(e)||U(e)):this;if(t=e._southWest,n=e._northEast,!t||!n)return this}return i||r?(i.lat=Math.min(t.lat,i.lat),i.lng=Math.min(t.lng,i.lng),r.lat=Math.max(n.lat,r.lat),r.lng=Math.max(n.lng,r.lng)):(this._southWest=new z(t.lat,t.lng),this._northEast=new z(n.lat,n.lng)),this},pad:function(e){var t=this._southWest,n=this._northEast,i=Math.abs(t.lat-n.lat)*e,r=Math.abs(t.lng-n.lng)*e;return new F(new z(t.lat-i,t.lng-r),new z(n.lat+i,n.lng+r))},getCenter:function(){return new z((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new z(this.getNorth(),this.getWest())},getSouthEast:function(){return new z(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(e){e="number"===typeof e[0]||e instanceof z||"lat"in e?B(e):U(e);var t,n,i=this._southWest,r=this._northEast;return e instanceof F?(t=e.getSouthWest(),n=e.getNorthEast()):t=n=e,t.lat>=i.lat&&n.lat<=r.lat&&t.lng>=i.lng&&n.lng<=r.lng},intersects:function(e){e=U(e);var t=this._southWest,n=this._northEast,i=e.getSouthWest(),r=e.getNorthEast(),s=r.lat>=t.lat&&i.lat<=n.lat,o=r.lng>=t.lng&&i.lng<=n.lng;return s&&o},overlaps:function(e){e=U(e);var t=this._southWest,n=this._northEast,i=e.getSouthWest(),r=e.getNorthEast(),s=r.lat>t.lat&&i.lat<n.lat,o=r.lng>t.lng&&i.lng<n.lng;return s&&o},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(e,t){return!!e&&(e=U(e),this._southWest.equals(e.getSouthWest(),t)&&this._northEast.equals(e.getNorthEast(),t))},isValid:function(){return!(!this._southWest||!this._northEast)}},z.prototype={equals:function(e,t){return!!e&&(e=B(e),Math.max(Math.abs(this.lat-e.lat),Math.abs(this.lng-e.lng))<=(void 0===t?1e-9:t))},toString:function(e){return"LatLng("+u(this.lat,e)+", "+u(this.lng,e)+")"},distanceTo:function(e){return q.distance(this,B(e))},wrap:function(){return q.wrapLatLng(this)},toBounds:function(e){var t=180*e/40075017,n=t/Math.cos(Math.PI/180*this.lat);return U([this.lat-t,this.lng-n],[this.lat+t,this.lng+n])},clone:function(){return new z(this.lat,this.lng,this.alt)}};var V={latLngToPoint:function(e,t){var n=this.projection.project(e),i=this.scale(t);return this.transformation._transform(n,i)},pointToLatLng:function(e,t){var n=this.scale(t),i=this.transformation.untransform(e,n);return this.projection.unproject(i)},project:function(e){return this.projection.project(e)},unproject:function(e){return this.projection.unproject(e)},scale:function(e){return 256*Math.pow(2,e)},zoom:function(e){return Math.log(e/256)/Math.LN2},getProjectedBounds:function(e){if(this.infinite)return null;var t=this.projection.bounds,n=this.scale(e);return new M(this.transformation.transform(t.min,n),this.transformation.transform(t.max,n))},infinite:!1,wrapLatLng:function(e){var t=this.wrapLng?l(e.lng,this.wrapLng,!0):e.lng;return new z(this.wrapLat?l(e.lat,this.wrapLat,!0):e.lat,t,e.alt)},wrapLatLngBounds:function(e){var t=e.getCenter(),n=this.wrapLatLng(t),i=t.lat-n.lat,r=t.lng-n.lng;if(0===i&&0===r)return e;var s=e.getSouthWest(),o=e.getNorthEast();return new F(new z(s.lat-i,s.lng-r),new z(o.lat-i,o.lng-r))}},q=n({},V,{wrapLng:[-180,180],R:6371e3,distance:function(e,t){var n=Math.PI/180,i=e.lat*n,r=t.lat*n,s=Math.sin((t.lat-e.lat)*n/2),o=Math.sin((t.lng-e.lng)*n/2),a=s*s+Math.cos(i)*Math.cos(r)*o*o,l=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));return this.R*l}}),H=6378137,W={R:H,MAX_LATITUDE:85.0511287798,project:function(e){var t=Math.PI/180,n=this.MAX_LATITUDE,i=Math.max(Math.min(n,e.lat),-n),r=Math.sin(i*t);return new R(this.R*e.lng*t,this.R*Math.log((1+r)/(1-r))/2)},unproject:function(e){var t=180/Math.PI;return new z((2*Math.atan(Math.exp(e.y/this.R))-Math.PI/2)*t,e.x*t/this.R)},bounds:function(){var e=H*Math.PI;return new M([-e,-e],[e,e])}()};function K(e,t,n,i){if(_(e))return this._a=e[0],this._b=e[1],this._c=e[2],void(this._d=e[3]);this._a=e,this._b=t,this._c=n,this._d=i}function G(e,t,n,i){return new K(e,t,n,i)}K.prototype={transform:function(e,t){return this._transform(e.clone(),t)},_transform:function(e,t){return t=t||1,e.x=t*(this._a*e.x+this._b),e.y=t*(this._c*e.y+this._d),e},untransform:function(e,t){return t=t||1,new R((e.x/t-this._b)/this._a,(e.y/t-this._d)/this._c)}};var Z=n({},q,{code:"EPSG:3857",projection:W,transformation:function(){var e=.5/(Math.PI*W.R);return G(e,.5,-e,.5)}()}),Q=n({},Z,{code:"EPSG:900913"});function Y(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function J(e,t){var n,i,r,s,o,a,l="";for(n=0,r=e.length;n<r;n++){for(i=0,s=(o=e[n]).length;i<s;i++)l+=(i?"L":"M")+(a=o[i]).x+" "+a.y;l+=t?Me.svg?"z":"x":""}return l||"M0 0"}var X=document.documentElement.style,$="ActiveXObject"in window,ee=$&&!document.addEventListener,te="msLaunchUri"in navigator&&!("documentMode"in document),ne=De("webkit"),ie=De("android"),re=De("android 2")||De("android 3"),se=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),oe=ie&&De("Google")&&se<537&&!("AudioNode"in window),ae=!!window.opera,le=!te&&De("chrome"),ce=De("gecko")&&!ne&&!ae&&!$,ue=!le&&De("safari"),he=De("phantom"),de="OTransition"in X,fe=0===navigator.platform.indexOf("Win"),pe=$&&"transition"in X,me="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!re,ge="MozPerspective"in X,_e=!window.L_DISABLE_3D&&(pe||me||ge)&&!de&&!he,ve="undefined"!==typeof orientation||De("mobile"),ye=ve&&ne,we=ve&&me,be=!window.PointerEvent&&window.MSPointerEvent,Ee=!(!window.PointerEvent&&!be),Te="ontouchstart"in window||!!window.TouchEvent,Ce=!window.L_NO_TOUCH&&(Te||Ee),xe=ve&&ae,Se=ve&&ce,Ie=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,ke=function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("testPassiveEventSupport",c,t),window.removeEventListener("testPassiveEventSupport",c,t)}catch(n){}return e}(),Pe=!!document.createElement("canvas").getContext,Ne=!(!document.createElementNS||!Y("svg").createSVGRect),Ae=!!Ne&&function(){var e=document.createElement("div");return e.innerHTML="<svg/>","http://www.w3.org/2000/svg"===(e.firstChild&&e.firstChild.namespaceURI)}(),Re=!Ne&&function(){try{var e=document.createElement("div");e.innerHTML='<v:shape adj="1"/>';var t=e.firstChild;return t.style.behavior="url(#default#VML)",t&&"object"===typeof t.adj}catch(n){return!1}}(),Le=0===navigator.platform.indexOf("Mac"),Oe=0===navigator.platform.indexOf("Linux");function De(e){return navigator.userAgent.toLowerCase().indexOf(e)>=0}var Me={ie:$,ielt9:ee,edge:te,webkit:ne,android:ie,android23:re,androidStock:oe,opera:ae,chrome:le,gecko:ce,safari:ue,phantom:he,opera12:de,win:fe,ie3d:pe,webkit3d:me,gecko3d:ge,any3d:_e,mobile:ve,mobileWebkit:ye,mobileWebkit3d:we,msPointer:be,pointer:Ee,touch:Ce,touchNative:Te,mobileOpera:xe,mobileGecko:Se,retina:Ie,passiveEvents:ke,canvas:Pe,svg:Ne,vml:Re,inlineSvg:Ae,mac:Le,linux:Oe},je=Me.msPointer?"MSPointerDown":"pointerdown",Fe=Me.msPointer?"MSPointerMove":"pointermove",Ue=Me.msPointer?"MSPointerUp":"pointerup",ze=Me.msPointer?"MSPointerCancel":"pointercancel",Be={touchstart:je,touchmove:Fe,touchend:Ue,touchcancel:ze},Ve={touchstart:Xe,touchmove:Je,touchend:Je,touchcancel:Je},qe={},He=!1;function We(e,t,n){return"touchstart"===t&&Ye(),Ve[t]?(n=Ve[t].bind(this,n),e.addEventListener(Be[t],n,!1),n):(console.warn("wrong event specified:",t),c)}function Ke(e,t,n){Be[t]?e.removeEventListener(Be[t],n,!1):console.warn("wrong event specified:",t)}function Ge(e){qe[e.pointerId]=e}function Ze(e){qe[e.pointerId]&&(qe[e.pointerId]=e)}function Qe(e){delete qe[e.pointerId]}function Ye(){He||(document.addEventListener(je,Ge,!0),document.addEventListener(Fe,Ze,!0),document.addEventListener(Ue,Qe,!0),document.addEventListener(ze,Qe,!0),He=!0)}function Je(e,t){if(t.pointerType!==(t.MSPOINTER_TYPE_MOUSE||"mouse")){for(var n in t.touches=[],qe)t.touches.push(qe[n]);t.changedTouches=[t],e(t)}}function Xe(e,t){t.MSPOINTER_TYPE_TOUCH&&t.pointerType===t.MSPOINTER_TYPE_TOUCH&&Gt(t),Je(e,t)}function $e(e){var t,n,i={};for(n in e)t=e[n],i[n]=t&&t.bind?t.bind(e):t;return e=i,i.type="dblclick",i.detail=2,i.isTrusted=!1,i._simulated=!0,i}var et=200;function tt(e,t){e.addEventListener("dblclick",t);var n,i=0;function r(e){if(1===e.detail){if("mouse"!==e.pointerType&&(!e.sourceCapabilities||e.sourceCapabilities.firesTouchEvents)){var r=Qt(e);if(!r.some(function(e){return e instanceof HTMLLabelElement&&e.attributes.for})||r.some(function(e){return e instanceof HTMLInputElement||e instanceof HTMLSelectElement})){var s=Date.now();s-i<=et?2===++n&&t($e(e)):n=1,i=s}}}else n=e.detail}return e.addEventListener("click",r),{dblclick:t,simDblclick:r}}function nt(e,t){e.removeEventListener("dblclick",t.dblclick),e.removeEventListener("click",t.simDblclick)}var it,rt,st,ot,at,lt=xt(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),ct=xt(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ut="webkitTransition"===ct||"OTransition"===ct?ct+"End":"transitionend";function ht(e){return"string"===typeof e?document.getElementById(e):e}function dt(e,t){var n=e.style[t]||e.currentStyle&&e.currentStyle[t];if((!n||"auto"===n)&&document.defaultView){var i=document.defaultView.getComputedStyle(e,null);n=i?i[t]:null}return"auto"===n?null:n}function ft(e,t,n){var i=document.createElement(e);return i.className=t||"",n&&n.appendChild(i),i}function pt(e){var t=e.parentNode;t&&t.removeChild(e)}function mt(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function gt(e){var t=e.parentNode;t&&t.lastChild!==e&&t.appendChild(e)}function _t(e){var t=e.parentNode;t&&t.firstChild!==e&&t.insertBefore(e,t.firstChild)}function vt(e,t){if(void 0!==e.classList)return e.classList.contains(t);var n=Et(e);return n.length>0&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(n)}function yt(e,t){if(void 0!==e.classList)for(var n=d(t),i=0,r=n.length;i<r;i++)e.classList.add(n[i]);else if(!vt(e,t)){var s=Et(e);bt(e,(s?s+" ":"")+t)}}function wt(e,t){void 0!==e.classList?e.classList.remove(t):bt(e,h((" "+Et(e)+" ").replace(" "+t+" "," ")))}function bt(e,t){void 0===e.className.baseVal?e.className=t:e.className.baseVal=t}function Et(e){return e.correspondingElement&&(e=e.correspondingElement),void 0===e.className.baseVal?e.className:e.className.baseVal}function Tt(e,t){"opacity"in e.style?e.style.opacity=t:"filter"in e.style&&Ct(e,t)}function Ct(e,t){var n=!1,i="DXImageTransform.Microsoft.Alpha";try{n=e.filters.item(i)}catch(r){if(1===t)return}t=Math.round(100*t),n?(n.Enabled=100!==t,n.Opacity=t):e.style.filter+=" progid:"+i+"(opacity="+t+")"}function xt(e){for(var t=document.documentElement.style,n=0;n<e.length;n++)if(e[n]in t)return e[n];return!1}function St(e,t,n){var i=t||new R(0,0);e.style[lt]=(Me.ie3d?"translate("+i.x+"px,"+i.y+"px)":"translate3d("+i.x+"px,"+i.y+"px,0)")+(n?" scale("+n+")":"")}function It(e,t){e._leaflet_pos=t,Me.any3d?St(e,t):(e.style.left=t.x+"px",e.style.top=t.y+"px")}function kt(e){return e._leaflet_pos||new R(0,0)}if("onselectstart"in document)it=function(){jt(window,"selectstart",Gt)},rt=function(){Ut(window,"selectstart",Gt)};else{var Pt=xt(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);it=function(){if(Pt){var e=document.documentElement.style;st=e[Pt],e[Pt]="none"}},rt=function(){Pt&&(document.documentElement.style[Pt]=st,st=void 0)}}function Nt(){jt(window,"dragstart",Gt)}function At(){Ut(window,"dragstart",Gt)}function Rt(e){for(;-1===e.tabIndex;)e=e.parentNode;e.style&&(Lt(),ot=e,at=e.style.outlineStyle,e.style.outlineStyle="none",jt(window,"keydown",Lt))}function Lt(){ot&&(ot.style.outlineStyle=at,ot=void 0,at=void 0,Ut(window,"keydown",Lt))}function Ot(e){do{e=e.parentNode}while((!e.offsetWidth||!e.offsetHeight)&&e!==document.body);return e}function Dt(e){var t=e.getBoundingClientRect();return{x:t.width/e.offsetWidth||1,y:t.height/e.offsetHeight||1,boundingClientRect:t}}var Mt={__proto__:null,TRANSFORM:lt,TRANSITION:ct,TRANSITION_END:ut,get:ht,getStyle:dt,create:ft,remove:pt,empty:mt,toFront:gt,toBack:_t,hasClass:vt,addClass:yt,removeClass:wt,setClass:bt,getClass:Et,setOpacity:Tt,testProp:xt,setTransform:St,setPosition:It,getPosition:kt,get disableTextSelection(){return it},get enableTextSelection(){return rt},disableImageDrag:Nt,enableImageDrag:At,preventOutline:Rt,restoreOutline:Lt,getSizedParentNode:Ot,getScale:Dt};function jt(e,t,n,i){if(t&&"object"===typeof t)for(var r in t)Vt(e,r,t[r],n);else for(var s=0,o=(t=d(t)).length;s<o;s++)Vt(e,t[s],n,i);return this}var Ft="_leaflet_events";function Ut(e,t,n,i){if(1===arguments.length)zt(e),delete e[Ft];else if(t&&"object"===typeof t)for(var r in t)qt(e,r,t[r],n);else if(t=d(t),2===arguments.length)zt(e,function(e){return-1!==v(t,e)});else for(var s=0,o=t.length;s<o;s++)qt(e,t[s],n,i);return this}function zt(e,t){for(var n in e[Ft]){var i=n.split(/\d/)[0];t&&!t(i)||qt(e,i,null,null,n)}}var Bt={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Vt(e,t,n,i){var r=t+o(n)+(i?"_"+o(i):"");if(e[Ft]&&e[Ft][r])return this;var s=function(t){return n.call(i||e,t||window.event)},a=s;!Me.touchNative&&Me.pointer&&0===t.indexOf("touch")?s=We(e,t,s):Me.touch&&"dblclick"===t?s=tt(e,s):"addEventListener"in e?"touchstart"===t||"touchmove"===t||"wheel"===t||"mousewheel"===t?e.addEventListener(Bt[t]||t,s,!!Me.passiveEvents&&{passive:!1}):"mouseenter"===t||"mouseleave"===t?(s=function(t){t=t||window.event,$t(e,t)&&a(t)},e.addEventListener(Bt[t],s,!1)):e.addEventListener(t,a,!1):e.attachEvent("on"+t,s),e[Ft]=e[Ft]||{},e[Ft][r]=s}function qt(e,t,n,i,r){r=r||t+o(n)+(i?"_"+o(i):"");var s=e[Ft]&&e[Ft][r];if(!s)return this;!Me.touchNative&&Me.pointer&&0===t.indexOf("touch")?Ke(e,t,s):Me.touch&&"dblclick"===t?nt(e,s):"removeEventListener"in e?e.removeEventListener(Bt[t]||t,s,!1):e.detachEvent("on"+t,s),e[Ft][r]=null}function Ht(e){return e.stopPropagation?e.stopPropagation():e.originalEvent?e.originalEvent._stopped=!0:e.cancelBubble=!0,this}function Wt(e){return Vt(e,"wheel",Ht),this}function Kt(e){return jt(e,"mousedown touchstart dblclick contextmenu",Ht),e._leaflet_disable_click=!0,this}function Gt(e){return e.preventDefault?e.preventDefault():e.returnValue=!1,this}function Zt(e){return Gt(e),Ht(e),this}function Qt(e){if(e.composedPath)return e.composedPath();for(var t=[],n=e.target;n;)t.push(n),n=n.parentNode;return t}function Yt(e,t){if(!t)return new R(e.clientX,e.clientY);var n=Dt(t),i=n.boundingClientRect;return new R((e.clientX-i.left)/n.x-t.clientLeft,(e.clientY-i.top)/n.y-t.clientTop)}var Jt=Me.linux&&Me.chrome?window.devicePixelRatio:Me.mac?3*window.devicePixelRatio:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Xt(e){return Me.edge?e.wheelDeltaY/2:e.deltaY&&0===e.deltaMode?-e.deltaY/Jt:e.deltaY&&1===e.deltaMode?20*-e.deltaY:e.deltaY&&2===e.deltaMode?60*-e.deltaY:e.deltaX||e.deltaZ?0:e.wheelDelta?(e.wheelDeltaY||e.wheelDelta)/2:e.detail&&Math.abs(e.detail)<32765?20*-e.detail:e.detail?e.detail/-32765*60:0}function $t(e,t){var n=t.relatedTarget;if(!n)return!0;try{for(;n&&n!==e;)n=n.parentNode}catch(i){return!1}return n!==e}var en={__proto__:null,on:jt,off:Ut,stopPropagation:Ht,disableScrollPropagation:Wt,disableClickPropagation:Kt,preventDefault:Gt,stop:Zt,getPropagationPath:Qt,getMousePosition:Yt,getWheelDelta:Xt,isExternalTarget:$t,addListener:jt,removeListener:Ut},tn=A.extend({run:function(e,t,n,i){this.stop(),this._el=e,this._inProgress=!0,this._duration=n||.25,this._easeOutPower=1/Math.max(i||.5,.2),this._startPos=kt(e),this._offset=t.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=x(this._animate,this),this._step()},_step:function(e){var t=+new Date-this._startTime,n=1e3*this._duration;t<n?this._runFrame(this._easeOut(t/n),e):(this._runFrame(1),this._complete())},_runFrame:function(e,t){var n=this._startPos.add(this._offset.multiplyBy(e));t&&n._round(),It(this._el,n),this.fire("step")},_complete:function(){S(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(e){return 1-Math.pow(1-e,this._easeOutPower)}}),nn=A.extend({options:{crs:Z,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(e,t){t=f(this,t),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(e),this._initLayout(),this._onResize=r(this._onResize,this),this._initEvents(),t.maxBounds&&this.setMaxBounds(t.maxBounds),void 0!==t.zoom&&(this._zoom=this._limitZoom(t.zoom)),t.center&&void 0!==t.zoom&&this.setView(B(t.center),t.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=ct&&Me.any3d&&!Me.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),jt(this._proxy,ut,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(e,t,i){return t=void 0===t?this._zoom:this._limitZoom(t),e=this._limitCenter(B(e),t,this.options.maxBounds),i=i||{},this._stop(),this._loaded&&!i.reset&&!0!==i&&(void 0!==i.animate&&(i.zoom=n({animate:i.animate},i.zoom),i.pan=n({animate:i.animate,duration:i.duration},i.pan)),this._zoom!==t?this._tryAnimatedZoom&&this._tryAnimatedZoom(e,t,i.zoom):this._tryAnimatedPan(e,i.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(e,t,i.pan&&i.pan.noMoveStart),this)},setZoom:function(e,t){return this._loaded?this.setView(this.getCenter(),e,{zoom:t}):(this._zoom=e,this)},zoomIn:function(e,t){return e=e||(Me.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+e,t)},zoomOut:function(e,t){return e=e||(Me.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-e,t)},setZoomAround:function(e,t,n){var i=this.getZoomScale(t),r=this.getSize().divideBy(2),s=(e instanceof R?e:this.latLngToContainerPoint(e)).subtract(r).multiplyBy(1-1/i),o=this.containerPointToLatLng(r.add(s));return this.setView(o,t,{zoom:n})},_getBoundsCenterZoom:function(e,t){t=t||{},e=e.getBounds?e.getBounds():U(e);var n=D(t.paddingTopLeft||t.padding||[0,0]),i=D(t.paddingBottomRight||t.padding||[0,0]),r=this.getBoundsZoom(e,!1,n.add(i));if((r="number"===typeof t.maxZoom?Math.min(t.maxZoom,r):r)===1/0)return{center:e.getCenter(),zoom:r};var s=i.subtract(n).divideBy(2),o=this.project(e.getSouthWest(),r),a=this.project(e.getNorthEast(),r);return{center:this.unproject(o.add(a).divideBy(2).add(s),r),zoom:r}},fitBounds:function(e,t){if(!(e=U(e)).isValid())throw new Error("Bounds are not valid.");var n=this._getBoundsCenterZoom(e,t);return this.setView(n.center,n.zoom,t)},fitWorld:function(e){return this.fitBounds([[-90,-180],[90,180]],e)},panTo:function(e,t){return this.setView(e,this._zoom,{pan:t})},panBy:function(e,t){if(t=t||{},!(e=D(e).round()).x&&!e.y)return this.fire("moveend");if(!0!==t.animate&&!this.getSize().contains(e))return this._resetView(this.unproject(this.project(this.getCenter()).add(e)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new tn,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),t.noMoveStart||this.fire("movestart"),!1!==t.animate){yt(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(e).round();this._panAnim.run(this._mapPane,n,t.duration||.25,t.easeLinearity)}else this._rawPanBy(e),this.fire("move").fire("moveend");return this},flyTo:function(e,t,n){if(!1===(n=n||{}).animate||!Me.any3d)return this.setView(e,t,n);this._stop();var i=this.project(this.getCenter()),r=this.project(e),s=this.getSize(),o=this._zoom;e=B(e),t=void 0===t?o:t;var a=Math.max(s.x,s.y),l=a*this.getZoomScale(o,t),c=r.distanceTo(i)||1,u=1.42,h=u*u;function d(e){var t=(l*l-a*a+(e?-1:1)*h*h*c*c)/(2*(e?l:a)*h*c),n=Math.sqrt(t*t+1)-t;return n<1e-9?-18:Math.log(n)}function f(e){return(Math.exp(e)-Math.exp(-e))/2}function p(e){return(Math.exp(e)+Math.exp(-e))/2}function m(e){return f(e)/p(e)}var g=d(0);function _(e){return a*(p(g)/p(g+u*e))}function v(e){return a*(p(g)*m(g+u*e)-f(g))/h}function y(e){return 1-Math.pow(1-e,1.5)}var w=Date.now(),b=(d(1)-g)/u,E=n.duration?1e3*n.duration:1e3*b*.8;function T(){var n=(Date.now()-w)/E,s=y(n)*b;n<=1?(this._flyToFrame=x(T,this),this._move(this.unproject(i.add(r.subtract(i).multiplyBy(v(s)/c)),o),this.getScaleZoom(a/_(s),o),{flyTo:!0})):this._move(e,t)._moveEnd(!0)}return this._moveStart(!0,n.noMoveStart),T.call(this),this},flyToBounds:function(e,t){var n=this._getBoundsCenterZoom(e,t);return this.flyTo(n.center,n.zoom,t)},setMaxBounds:function(e){return e=U(e),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),e.isValid()?(this.options.maxBounds=e,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(e){var t=this.options.minZoom;return this.options.minZoom=e,this._loaded&&t!==e&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(e):this},setMaxZoom:function(e){var t=this.options.maxZoom;return this.options.maxZoom=e,this._loaded&&t!==e&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(e):this},panInsideBounds:function(e,t){this._enforcingBounds=!0;var n=this.getCenter(),i=this._limitCenter(n,this._zoom,U(e));return n.equals(i)||this.panTo(i,t),this._enforcingBounds=!1,this},panInside:function(e,t){var n=D((t=t||{}).paddingTopLeft||t.padding||[0,0]),i=D(t.paddingBottomRight||t.padding||[0,0]),r=this.project(this.getCenter()),s=this.project(e),o=this.getPixelBounds(),a=j([o.min.add(n),o.max.subtract(i)]),l=a.getSize();if(!a.contains(s)){this._enforcingBounds=!0;var c=s.subtract(a.getCenter()),u=a.extend(s).getSize().subtract(l);r.x+=c.x<0?-u.x:u.x,r.y+=c.y<0?-u.y:u.y,this.panTo(this.unproject(r),t),this._enforcingBounds=!1}return this},invalidateSize:function(e){if(!this._loaded)return this;e=n({animate:!1,pan:!0},!0===e?{animate:!0}:e);var t=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var i=this.getSize(),s=t.divideBy(2).round(),o=i.divideBy(2).round(),a=s.subtract(o);return a.x||a.y?(e.animate&&e.pan?this.panBy(a):(e.pan&&this._rawPanBy(a),this.fire("move"),e.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(r(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:t,newSize:i})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(e){if(e=this._locateOptions=n({timeout:1e4,watch:!1},e),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var t=r(this._handleGeolocationResponse,this),i=r(this._handleGeolocationError,this);return e.watch?this._locationWatchId=navigator.geolocation.watchPosition(t,i,e):navigator.geolocation.getCurrentPosition(t,i,e),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(e){if(this._container._leaflet_id){var t=e.code,n=e.message||(1===t?"permission denied":2===t?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:t,message:"Geolocation error: "+n+"."})}},_handleGeolocationResponse:function(e){if(this._container._leaflet_id){var t=new z(e.coords.latitude,e.coords.longitude),n=t.toBounds(2*e.coords.accuracy),i=this._locateOptions;if(i.setView){var r=this.getBoundsZoom(n);this.setView(t,i.maxZoom?Math.min(r,i.maxZoom):r)}var s={latlng:t,bounds:n,timestamp:e.timestamp};for(var o in e.coords)"number"===typeof e.coords[o]&&(s[o]=e.coords[o]);this.fire("locationfound",s)}},addHandler:function(e,t){if(!t)return this;var n=this[e]=new t(this);return this._handlers.push(n),this.options[e]&&n.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(t){this._container._leaflet_id=void 0,this._containerId=void 0}var e;for(e in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),pt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(S(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[e].remove();for(e in this._panes)pt(this._panes[e]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(e,t){var n=ft("div","leaflet-pane"+(e?" leaflet-"+e.replace("Pane","")+"-pane":""),t||this._mapPane);return e&&(this._panes[e]=n),n},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var e=this.getPixelBounds();return new F(this.unproject(e.getBottomLeft()),this.unproject(e.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(e,t,n){e=U(e),n=D(n||[0,0]);var i=this.getZoom()||0,r=this.getMinZoom(),s=this.getMaxZoom(),o=e.getNorthWest(),a=e.getSouthEast(),l=this.getSize().subtract(n),c=j(this.project(a,i),this.project(o,i)).getSize(),u=Me.any3d?this.options.zoomSnap:1,h=l.x/c.x,d=l.y/c.y,f=t?Math.max(h,d):Math.min(h,d);return i=this.getScaleZoom(f,i),u&&(i=Math.round(i/(u/100))*(u/100),i=t?Math.ceil(i/u)*u:Math.floor(i/u)*u),Math.max(r,Math.min(s,i))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new R(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(e,t){var n=this._getTopLeftPoint(e,t);return new M(n,n.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(e){return this.options.crs.getProjectedBounds(void 0===e?this.getZoom():e)},getPane:function(e){return"string"===typeof e?this._panes[e]:e},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(e,t){var n=this.options.crs;return t=void 0===t?this._zoom:t,n.scale(e)/n.scale(t)},getScaleZoom:function(e,t){var n=this.options.crs;t=void 0===t?this._zoom:t;var i=n.zoom(e*n.scale(t));return isNaN(i)?1/0:i},project:function(e,t){return t=void 0===t?this._zoom:t,this.options.crs.latLngToPoint(B(e),t)},unproject:function(e,t){return t=void 0===t?this._zoom:t,this.options.crs.pointToLatLng(D(e),t)},layerPointToLatLng:function(e){var t=D(e).add(this.getPixelOrigin());return this.unproject(t)},latLngToLayerPoint:function(e){return this.project(B(e))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(e){return this.options.crs.wrapLatLng(B(e))},wrapLatLngBounds:function(e){return this.options.crs.wrapLatLngBounds(U(e))},distance:function(e,t){return this.options.crs.distance(B(e),B(t))},containerPointToLayerPoint:function(e){return D(e).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(e){return D(e).add(this._getMapPanePos())},containerPointToLatLng:function(e){var t=this.containerPointToLayerPoint(D(e));return this.layerPointToLatLng(t)},latLngToContainerPoint:function(e){return this.layerPointToContainerPoint(this.latLngToLayerPoint(B(e)))},mouseEventToContainerPoint:function(e){return Yt(e,this._container)},mouseEventToLayerPoint:function(e){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(e))},mouseEventToLatLng:function(e){return this.layerPointToLatLng(this.mouseEventToLayerPoint(e))},_initContainer:function(e){var t=this._container=ht(e);if(!t)throw new Error("Map container not found.");if(t._leaflet_id)throw new Error("Map container is already initialized.");jt(t,"scroll",this._onScroll,this),this._containerId=o(t)},_initLayout:function(){var e=this._container;this._fadeAnimated=this.options.fadeAnimation&&Me.any3d,yt(e,"leaflet-container"+(Me.touch?" leaflet-touch":"")+(Me.retina?" leaflet-retina":"")+(Me.ielt9?" leaflet-oldie":"")+(Me.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var t=dt(e,"position");"absolute"!==t&&"relative"!==t&&"fixed"!==t&&"sticky"!==t&&(e.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var e=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),It(this._mapPane,new R(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(yt(e.markerPane,"leaflet-zoom-hide"),yt(e.shadowPane,"leaflet-zoom-hide"))},_resetView:function(e,t,n){It(this._mapPane,new R(0,0));var i=!this._loaded;this._loaded=!0,t=this._limitZoom(t),this.fire("viewprereset");var r=this._zoom!==t;this._moveStart(r,n)._move(e,t)._moveEnd(r),this.fire("viewreset"),i&&this.fire("load")},_moveStart:function(e,t){return e&&this.fire("zoomstart"),t||this.fire("movestart"),this},_move:function(e,t,n,i){void 0===t&&(t=this._zoom);var r=this._zoom!==t;return this._zoom=t,this._lastCenter=e,this._pixelOrigin=this._getNewPixelOrigin(e),i?n&&n.pinch&&this.fire("zoom",n):((r||n&&n.pinch)&&this.fire("zoom",n),this.fire("move",n)),this},_moveEnd:function(e){return e&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return S(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(e){It(this._mapPane,this._getMapPanePos().subtract(e))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(e){this._targets={},this._targets[o(this._container)]=this;var t=e?Ut:jt;t(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&t(window,"resize",this._onResize,this),Me.any3d&&this.options.transform3DLimit&&(e?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){S(this._resizeRequest),this._resizeRequest=x(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var e=this._getMapPanePos();Math.max(Math.abs(e.x),Math.abs(e.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(e,t){for(var n,i=[],r="mouseout"===t||"mouseover"===t,s=e.target||e.srcElement,a=!1;s;){if((n=this._targets[o(s)])&&("click"===t||"preclick"===t)&&this._draggableMoved(n)){a=!0;break}if(n&&n.listens(t,!0)){if(r&&!$t(s,e))break;if(i.push(n),r)break}if(s===this._container)break;s=s.parentNode}return i.length||a||r||!this.listens(t,!0)||(i=[this]),i},_isClickDisabled:function(e){for(;e&&e!==this._container;){if(e._leaflet_disable_click)return!0;e=e.parentNode}},_handleDOMEvent:function(e){var t=e.target||e.srcElement;if(!(!this._loaded||t._leaflet_disable_events||"click"===e.type&&this._isClickDisabled(t))){var n=e.type;"mousedown"===n&&Rt(t),this._fireDOMEvent(e,n)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(e,t,i){if("click"===e.type){var r=n({},e);r.type="preclick",this._fireDOMEvent(r,r.type,i)}var s=this._findEventTargets(e,t);if(i){for(var o=[],a=0;a<i.length;a++)i[a].listens(t,!0)&&o.push(i[a]);s=o.concat(s)}if(s.length){"contextmenu"===t&&Gt(e);var l=s[0],c={originalEvent:e};if("keypress"!==e.type&&"keydown"!==e.type&&"keyup"!==e.type){var u=l.getLatLng&&(!l._radius||l._radius<=10);c.containerPoint=u?this.latLngToContainerPoint(l.getLatLng()):this.mouseEventToContainerPoint(e),c.layerPoint=this.containerPointToLayerPoint(c.containerPoint),c.latlng=u?l.getLatLng():this.layerPointToLatLng(c.layerPoint)}for(a=0;a<s.length;a++)if(s[a].fire(t,c,!0),c.originalEvent._stopped||!1===s[a].options.bubblingMouseEvents&&-1!==v(this._mouseEvents,t))return}},_draggableMoved:function(e){return(e=e.dragging&&e.dragging.enabled()?e:this).dragging&&e.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var e=0,t=this._handlers.length;e<t;e++)this._handlers[e].disable()},whenReady:function(e,t){return this._loaded?e.call(t||this,{target:this}):this.on("load",e,t),this},_getMapPanePos:function(){return kt(this._mapPane)||new R(0,0)},_moved:function(){var e=this._getMapPanePos();return e&&!e.equals([0,0])},_getTopLeftPoint:function(e,t){return(e&&void 0!==t?this._getNewPixelOrigin(e,t):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(e,t){var n=this.getSize()._divideBy(2);return this.project(e,t)._subtract(n)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(e,t,n){var i=this._getNewPixelOrigin(n,t);return this.project(e,t)._subtract(i)},_latLngBoundsToNewLayerBounds:function(e,t,n){var i=this._getNewPixelOrigin(n,t);return j([this.project(e.getSouthWest(),t)._subtract(i),this.project(e.getNorthWest(),t)._subtract(i),this.project(e.getSouthEast(),t)._subtract(i),this.project(e.getNorthEast(),t)._subtract(i)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(e){return this.latLngToLayerPoint(e).subtract(this._getCenterLayerPoint())},_limitCenter:function(e,t,n){if(!n)return e;var i=this.project(e,t),r=this.getSize().divideBy(2),s=new M(i.subtract(r),i.add(r)),o=this._getBoundsOffset(s,n,t);return Math.abs(o.x)<=1&&Math.abs(o.y)<=1?e:this.unproject(i.add(o),t)},_limitOffset:function(e,t){if(!t)return e;var n=this.getPixelBounds(),i=new M(n.min.add(e),n.max.add(e));return e.add(this._getBoundsOffset(i,t))},_getBoundsOffset:function(e,t,n){var i=j(this.project(t.getNorthEast(),n),this.project(t.getSouthWest(),n)),r=i.min.subtract(e.min),s=i.max.subtract(e.max);return new R(this._rebound(r.x,-s.x),this._rebound(r.y,-s.y))},_rebound:function(e,t){return e+t>0?Math.round(e-t)/2:Math.max(0,Math.ceil(e))-Math.max(0,Math.floor(t))},_limitZoom:function(e){var t=this.getMinZoom(),n=this.getMaxZoom(),i=Me.any3d?this.options.zoomSnap:1;return i&&(e=Math.round(e/i)*i),Math.max(t,Math.min(n,e))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){wt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(e,t){var n=this._getCenterOffset(e)._trunc();return!(!0!==(t&&t.animate)&&!this.getSize().contains(n))&&(this.panBy(n,t),!0)},_createAnimProxy:function(){var e=this._proxy=ft("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(e),this.on("zoomanim",function(e){var t=lt,n=this._proxy.style[t];St(this._proxy,this.project(e.center,e.zoom),this.getZoomScale(e.zoom,1)),n===this._proxy.style[t]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){pt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var e=this.getCenter(),t=this.getZoom();St(this._proxy,this.project(e,t),this.getZoomScale(t,1))},_catchTransitionEnd:function(e){this._animatingZoom&&e.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(e,t,n){if(this._animatingZoom)return!0;if(n=n||{},!this._zoomAnimated||!1===n.animate||this._nothingToAnimate()||Math.abs(t-this._zoom)>this.options.zoomAnimationThreshold)return!1;var i=this.getZoomScale(t),r=this._getCenterOffset(e)._divideBy(1-1/i);return!(!0!==n.animate&&!this.getSize().contains(r))&&(x(function(){this._moveStart(!0,n.noMoveStart||!1)._animateZoom(e,t,!0)},this),!0)},_animateZoom:function(e,t,n,i){this._mapPane&&(n&&(this._animatingZoom=!0,this._animateToCenter=e,this._animateToZoom=t,yt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:e,zoom:t,noUpdate:i}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(r(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&wt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function rn(e,t){return new nn(e,t)}var sn=k.extend({options:{position:"topright"},initialize:function(e){f(this,e)},getPosition:function(){return this.options.position},setPosition:function(e){var t=this._map;return t&&t.removeControl(this),this.options.position=e,t&&t.addControl(this),this},getContainer:function(){return this._container},addTo:function(e){this.remove(),this._map=e;var t=this._container=this.onAdd(e),n=this.getPosition(),i=e._controlCorners[n];return yt(t,"leaflet-control"),-1!==n.indexOf("bottom")?i.insertBefore(t,i.firstChild):i.appendChild(t),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(pt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(e){this._map&&e&&e.screenX>0&&e.screenY>0&&this._map.getContainer().focus()}}),on=function(e){return new sn(e)};nn.include({addControl:function(e){return e.addTo(this),this},removeControl:function(e){return e.remove(),this},_initControlPos:function(){var e=this._controlCorners={},t="leaflet-",n=this._controlContainer=ft("div",t+"control-container",this._container);function i(i,r){var s=t+i+" "+t+r;e[i+r]=ft("div",s,n)}i("top","left"),i("top","right"),i("bottom","left"),i("bottom","right")},_clearControlPos:function(){for(var e in this._controlCorners)pt(this._controlCorners[e]);pt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var an=sn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(e,t,n,i){return n<i?-1:i<n?1:0}},initialize:function(e,t,n){for(var i in f(this,n),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1,e)this._addLayer(e[i],i);for(i in t)this._addLayer(t[i],i,!0)},onAdd:function(e){this._initLayout(),this._update(),this._map=e,e.on("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(e){return sn.prototype.addTo.call(this,e),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(e,t){return this._addLayer(e,t),this._map?this._update():this},addOverlay:function(e,t){return this._addLayer(e,t,!0),this._map?this._update():this},removeLayer:function(e){e.off("add remove",this._onLayerChange,this);var t=this._getLayer(o(e));return t&&this._layers.splice(this._layers.indexOf(t),1),this._map?this._update():this},expand:function(){yt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var e=this._map.getSize().y-(this._container.offsetTop+50);return e<this._section.clientHeight?(yt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=e+"px"):wt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return wt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var e="leaflet-control-layers",t=this._container=ft("div",e),n=this.options.collapsed;t.setAttribute("aria-haspopup",!0),Kt(t),Wt(t);var i=this._section=ft("section",e+"-list");n&&(this._map.on("click",this.collapse,this),jt(t,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var r=this._layersLink=ft("a",e+"-toggle",t);r.href="#",r.title="Layers",r.setAttribute("role","button"),jt(r,{keydown:function(e){13===e.keyCode&&this._expandSafely()},click:function(e){Gt(e),this._expandSafely()}},this),n||this.expand(),this._baseLayersList=ft("div",e+"-base",i),this._separator=ft("div",e+"-separator",i),this._overlaysList=ft("div",e+"-overlays",i),t.appendChild(i)},_getLayer:function(e){for(var t=0;t<this._layers.length;t++)if(this._layers[t]&&o(this._layers[t].layer)===e)return this._layers[t]},_addLayer:function(e,t,n){this._map&&e.on("add remove",this._onLayerChange,this),this._layers.push({layer:e,name:t,overlay:n}),this.options.sortLayers&&this._layers.sort(r(function(e,t){return this.options.sortFunction(e.layer,t.layer,e.name,t.name)},this)),this.options.autoZIndex&&e.setZIndex&&(this._lastZIndex++,e.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;mt(this._baseLayersList),mt(this._overlaysList),this._layerControlInputs=[];var e,t,n,i,r=0;for(n=0;n<this._layers.length;n++)i=this._layers[n],this._addItem(i),t=t||i.overlay,e=e||!i.overlay,r+=i.overlay?0:1;return this.options.hideSingleBase&&(e=e&&r>1,this._baseLayersList.style.display=e?"":"none"),this._separator.style.display=t&&e?"":"none",this},_onLayerChange:function(e){this._handlingClick||this._update();var t=this._getLayer(o(e.target)),n=t.overlay?"add"===e.type?"overlayadd":"overlayremove":"add"===e.type?"baselayerchange":null;n&&this._map.fire(n,t)},_createRadioElement:function(e,t){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+e+'"'+(t?' checked="checked"':"")+"/>",i=document.createElement("div");return i.innerHTML=n,i.firstChild},_addItem:function(e){var t,n=document.createElement("label"),i=this._map.hasLayer(e.layer);e.overlay?((t=document.createElement("input")).type="checkbox",t.className="leaflet-control-layers-selector",t.defaultChecked=i):t=this._createRadioElement("leaflet-base-layers_"+o(this),i),this._layerControlInputs.push(t),t.layerId=o(e.layer),jt(t,"click",this._onInputClick,this);var r=document.createElement("span");r.innerHTML=" "+e.name;var s=document.createElement("span");return n.appendChild(s),s.appendChild(t),s.appendChild(r),(e.overlay?this._overlaysList:this._baseLayersList).appendChild(n),this._checkDisabledLayers(),n},_onInputClick:function(){if(!this._preventClick){var e,t,n=this._layerControlInputs,i=[],r=[];this._handlingClick=!0;for(var s=n.length-1;s>=0;s--)e=n[s],t=this._getLayer(e.layerId).layer,e.checked?i.push(t):e.checked||r.push(t);for(s=0;s<r.length;s++)this._map.hasLayer(r[s])&&this._map.removeLayer(r[s]);for(s=0;s<i.length;s++)this._map.hasLayer(i[s])||this._map.addLayer(i[s]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var e,t,n=this._layerControlInputs,i=this._map.getZoom(),r=n.length-1;r>=0;r--)e=n[r],t=this._getLayer(e.layerId).layer,e.disabled=void 0!==t.options.minZoom&&i<t.options.minZoom||void 0!==t.options.maxZoom&&i>t.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var e=this._section;this._preventClick=!0,jt(e,"click",Gt),this.expand();var t=this;setTimeout(function(){Ut(e,"click",Gt),t._preventClick=!1})}}),ln=function(e,t,n){return new an(e,t,n)},cn=sn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(e){var t="leaflet-control-zoom",n=ft("div",t+" leaflet-bar"),i=this.options;return this._zoomInButton=this._createButton(i.zoomInText,i.zoomInTitle,t+"-in",n,this._zoomIn),this._zoomOutButton=this._createButton(i.zoomOutText,i.zoomOutTitle,t+"-out",n,this._zoomOut),this._updateDisabled(),e.on("zoomend zoomlevelschange",this._updateDisabled,this),n},onRemove:function(e){e.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(e){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(e.shiftKey?3:1))},_zoomOut:function(e){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(e.shiftKey?3:1))},_createButton:function(e,t,n,i,r){var s=ft("a",n,i);return s.innerHTML=e,s.href="#",s.title=t,s.setAttribute("role","button"),s.setAttribute("aria-label",t),Kt(s),jt(s,"click",Zt),jt(s,"click",r,this),jt(s,"click",this._refocusOnMap,this),s},_updateDisabled:function(){var e=this._map,t="leaflet-disabled";wt(this._zoomInButton,t),wt(this._zoomOutButton,t),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||e._zoom===e.getMinZoom())&&(yt(this._zoomOutButton,t),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||e._zoom===e.getMaxZoom())&&(yt(this._zoomInButton,t),this._zoomInButton.setAttribute("aria-disabled","true"))}});nn.mergeOptions({zoomControl:!0}),nn.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new cn,this.addControl(this.zoomControl))});var un=function(e){return new cn(e)},hn=sn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(e){var t="leaflet-control-scale",n=ft("div",t),i=this.options;return this._addScales(i,t+"-line",n),e.on(i.updateWhenIdle?"moveend":"move",this._update,this),e.whenReady(this._update,this),n},onRemove:function(e){e.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(e,t,n){e.metric&&(this._mScale=ft("div",t,n)),e.imperial&&(this._iScale=ft("div",t,n))},_update:function(){var e=this._map,t=e.getSize().y/2,n=e.distance(e.containerPointToLatLng([0,t]),e.containerPointToLatLng([this.options.maxWidth,t]));this._updateScales(n)},_updateScales:function(e){this.options.metric&&e&&this._updateMetric(e),this.options.imperial&&e&&this._updateImperial(e)},_updateMetric:function(e){var t=this._getRoundNum(e),n=t<1e3?t+" m":t/1e3+" km";this._updateScale(this._mScale,n,t/e)},_updateImperial:function(e){var t,n,i,r=3.2808399*e;r>5280?(t=r/5280,n=this._getRoundNum(t),this._updateScale(this._iScale,n+" mi",n/t)):(i=this._getRoundNum(r),this._updateScale(this._iScale,i+" ft",i/r))},_updateScale:function(e,t,n){e.style.width=Math.round(this.options.maxWidth*n)+"px",e.innerHTML=t},_getRoundNum:function(e){var t=Math.pow(10,(Math.floor(e)+"").length-1),n=e/t;return t*(n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1)}}),dn=function(e){return new hn(e)},fn='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',pn=sn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Me.inlineSvg?fn+" ":"")+"Leaflet</a>"},initialize:function(e){f(this,e),this._attributions={}},onAdd:function(e){for(var t in e.attributionControl=this,this._container=ft("div","leaflet-control-attribution"),Kt(this._container),e._layers)e._layers[t].getAttribution&&this.addAttribution(e._layers[t].getAttribution());return this._update(),e.on("layeradd",this._addAttribution,this),this._container},onRemove:function(e){e.off("layeradd",this._addAttribution,this)},_addAttribution:function(e){e.layer.getAttribution&&(this.addAttribution(e.layer.getAttribution()),e.layer.once("remove",function(){this.removeAttribution(e.layer.getAttribution())},this))},setPrefix:function(e){return this.options.prefix=e,this._update(),this},addAttribution:function(e){return e?(this._attributions[e]||(this._attributions[e]=0),this._attributions[e]++,this._update(),this):this},removeAttribution:function(e){return e?(this._attributions[e]&&(this._attributions[e]--,this._update()),this):this},_update:function(){if(this._map){var e=[];for(var t in this._attributions)this._attributions[t]&&e.push(t);var n=[];this.options.prefix&&n.push(this.options.prefix),e.length&&n.push(e.join(", ")),this._container.innerHTML=n.join(' <span aria-hidden="true">|</span> ')}}});nn.mergeOptions({attributionControl:!0}),nn.addInitHook(function(){this.options.attributionControl&&(new pn).addTo(this)});var mn=function(e){return new pn(e)};sn.Layers=an,sn.Zoom=cn,sn.Scale=hn,sn.Attribution=pn,on.layers=ln,on.zoom=un,on.scale=dn,on.attribution=mn;var gn=k.extend({initialize:function(e){this._map=e},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});gn.addTo=function(e,t){return e.addHandler(t,this),this};var _n={Events:N},vn=Me.touch?"touchstart mousedown":"mousedown",yn=A.extend({options:{clickTolerance:3},initialize:function(e,t,n,i){f(this,i),this._element=e,this._dragStartTarget=t||e,this._preventOutline=n},enable:function(){this._enabled||(jt(this._dragStartTarget,vn,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(yn._dragging===this&&this.finishDrag(!0),Ut(this._dragStartTarget,vn,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(e){if(this._enabled&&(this._moved=!1,!vt(this._element,"leaflet-zoom-anim")))if(e.touches&&1!==e.touches.length)yn._dragging===this&&this.finishDrag();else if(!(yn._dragging||e.shiftKey||1!==e.which&&1!==e.button&&!e.touches)&&(yn._dragging=this,this._preventOutline&&Rt(this._element),Nt(),it(),!this._moving)){this.fire("down");var t=e.touches?e.touches[0]:e,n=Ot(this._element);this._startPoint=new R(t.clientX,t.clientY),this._startPos=kt(this._element),this._parentScale=Dt(n);var i="mousedown"===e.type;jt(document,i?"mousemove":"touchmove",this._onMove,this),jt(document,i?"mouseup":"touchend touchcancel",this._onUp,this)}},_onMove:function(e){if(this._enabled)if(e.touches&&e.touches.length>1)this._moved=!0;else{var t=e.touches&&1===e.touches.length?e.touches[0]:e,n=new R(t.clientX,t.clientY)._subtract(this._startPoint);(n.x||n.y)&&(Math.abs(n.x)+Math.abs(n.y)<this.options.clickTolerance||(n.x/=this._parentScale.x,n.y/=this._parentScale.y,Gt(e),this._moved||(this.fire("dragstart"),this._moved=!0,yt(document.body,"leaflet-dragging"),this._lastTarget=e.target||e.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),yt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(n),this._moving=!0,this._lastEvent=e,this._updatePosition()))}},_updatePosition:function(){var e={originalEvent:this._lastEvent};this.fire("predrag",e),It(this._element,this._newPos),this.fire("drag",e)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(e){wt(document.body,"leaflet-dragging"),this._lastTarget&&(wt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Ut(document,"mousemove touchmove",this._onMove,this),Ut(document,"mouseup touchend touchcancel",this._onUp,this),At(),rt();var t=this._moved&&this._moving;this._moving=!1,yn._dragging=!1,t&&this.fire("dragend",{noInertia:e,distance:this._newPos.distanceTo(this._startPos)})}});function wn(e,t,n){var i,r,s,o,a,l,c,u,h,d=[1,4,2,8];for(r=0,c=e.length;r<c;r++)e[r]._code=Ln(e[r],t);for(o=0;o<4;o++){for(u=d[o],i=[],r=0,s=(c=e.length)-1;r<c;s=r++)a=e[r],l=e[s],a._code&u?l._code&u||((h=Rn(l,a,u,t,n))._code=Ln(h,t),i.push(h)):(l._code&u&&((h=Rn(l,a,u,t,n))._code=Ln(h,t),i.push(h)),i.push(a));e=i}return e}function bn(e,t){var n,i,r,s,o,a,l,c,u;if(!e||0===e.length)throw new Error("latlngs not passed");Mn(e)||(console.warn("latlngs are not flat! Only the first ring will be used"),e=e[0]);var h=B([0,0]),d=U(e);d.getNorthWest().distanceTo(d.getSouthWest())*d.getNorthEast().distanceTo(d.getNorthWest())<1700&&(h=En(e));var f=e.length,p=[];for(n=0;n<f;n++){var m=B(e[n]);p.push(t.project(B([m.lat-h.lat,m.lng-h.lng])))}for(a=l=c=0,n=0,i=f-1;n<f;i=n++)r=p[n],s=p[i],o=r.y*s.x-s.y*r.x,l+=(r.x+s.x)*o,c+=(r.y+s.y)*o,a+=3*o;u=0===a?p[0]:[l/a,c/a];var g=t.unproject(D(u));return B([g.lat+h.lat,g.lng+h.lng])}function En(e){for(var t=0,n=0,i=0,r=0;r<e.length;r++){var s=B(e[r]);t+=s.lat,n+=s.lng,i++}return B([t/i,n/i])}var Tn,Cn={__proto__:null,clipPolygon:wn,polygonCenter:bn,centroid:En};function xn(e,t){if(!t||!e.length)return e.slice();var n=t*t;return e=kn(e=Nn(e,n),n)}function Sn(e,t,n){return Math.sqrt(Dn(e,t,n,!0))}function In(e,t,n){return Dn(e,t,n)}function kn(e,t){var n=e.length,i=new(typeof Uint8Array!==void 0+""?Uint8Array:Array)(n);i[0]=i[n-1]=1,Pn(e,i,t,0,n-1);var r,s=[];for(r=0;r<n;r++)i[r]&&s.push(e[r]);return s}function Pn(e,t,n,i,r){var s,o,a,l=0;for(o=i+1;o<=r-1;o++)(a=Dn(e[o],e[i],e[r],!0))>l&&(s=o,l=a);l>n&&(t[s]=1,Pn(e,t,n,i,s),Pn(e,t,n,s,r))}function Nn(e,t){for(var n=[e[0]],i=1,r=0,s=e.length;i<s;i++)On(e[i],e[r])>t&&(n.push(e[i]),r=i);return r<s-1&&n.push(e[s-1]),n}function An(e,t,n,i,r){var s,o,a,l=i?Tn:Ln(e,n),c=Ln(t,n);for(Tn=c;;){if(!(l|c))return[e,t];if(l&c)return!1;a=Ln(o=Rn(e,t,s=l||c,n,r),n),s===l?(e=o,l=a):(t=o,c=a)}}function Rn(e,t,n,i,r){var s,o,a=t.x-e.x,l=t.y-e.y,c=i.min,u=i.max;return 8&n?(s=e.x+a*(u.y-e.y)/l,o=u.y):4&n?(s=e.x+a*(c.y-e.y)/l,o=c.y):2&n?(s=u.x,o=e.y+l*(u.x-e.x)/a):1&n&&(s=c.x,o=e.y+l*(c.x-e.x)/a),new R(s,o,r)}function Ln(e,t){var n=0;return e.x<t.min.x?n|=1:e.x>t.max.x&&(n|=2),e.y<t.min.y?n|=4:e.y>t.max.y&&(n|=8),n}function On(e,t){var n=t.x-e.x,i=t.y-e.y;return n*n+i*i}function Dn(e,t,n,i){var r,s=t.x,o=t.y,a=n.x-s,l=n.y-o,c=a*a+l*l;return c>0&&((r=((e.x-s)*a+(e.y-o)*l)/c)>1?(s=n.x,o=n.y):r>0&&(s+=a*r,o+=l*r)),a=e.x-s,l=e.y-o,i?a*a+l*l:new R(s,o)}function Mn(e){return!_(e[0])||"object"!==typeof e[0][0]&&"undefined"!==typeof e[0][0]}function jn(e){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Mn(e)}function Fn(e,t){var n,i,r,s,o,a,l,c;if(!e||0===e.length)throw new Error("latlngs not passed");Mn(e)||(console.warn("latlngs are not flat! Only the first ring will be used"),e=e[0]);var u=B([0,0]),h=U(e);h.getNorthWest().distanceTo(h.getSouthWest())*h.getNorthEast().distanceTo(h.getNorthWest())<1700&&(u=En(e));var d=e.length,f=[];for(n=0;n<d;n++){var p=B(e[n]);f.push(t.project(B([p.lat-u.lat,p.lng-u.lng])))}for(n=0,i=0;n<d-1;n++)i+=f[n].distanceTo(f[n+1])/2;if(0===i)c=f[0];else for(n=0,s=0;n<d-1;n++)if(o=f[n],a=f[n+1],(s+=r=o.distanceTo(a))>i){l=(s-i)/r,c=[a.x-l*(a.x-o.x),a.y-l*(a.y-o.y)];break}var m=t.unproject(D(c));return B([m.lat+u.lat,m.lng+u.lng])}var Un={__proto__:null,simplify:xn,pointToSegmentDistance:Sn,closestPointOnSegment:In,clipSegment:An,_getEdgeIntersection:Rn,_getBitCode:Ln,_sqClosestPointOnSegment:Dn,isFlat:Mn,_flat:jn,polylineCenter:Fn},zn={project:function(e){return new R(e.lng,e.lat)},unproject:function(e){return new z(e.y,e.x)},bounds:new M([-180,-90],[180,90])},Bn={R:6378137,R_MINOR:6356752.314245179,bounds:new M([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(e){var t=Math.PI/180,n=this.R,i=e.lat*t,r=this.R_MINOR/n,s=Math.sqrt(1-r*r),o=s*Math.sin(i),a=Math.tan(Math.PI/4-i/2)/Math.pow((1-o)/(1+o),s/2);return i=-n*Math.log(Math.max(a,1e-10)),new R(e.lng*t*n,i)},unproject:function(e){for(var t,n=180/Math.PI,i=this.R,r=this.R_MINOR/i,s=Math.sqrt(1-r*r),o=Math.exp(-e.y/i),a=Math.PI/2-2*Math.atan(o),l=0,c=.1;l<15&&Math.abs(c)>1e-7;l++)t=s*Math.sin(a),t=Math.pow((1-t)/(1+t),s/2),a+=c=Math.PI/2-2*Math.atan(o*t)-a;return new z(a*n,e.x*n/i)}},Vn={__proto__:null,LonLat:zn,Mercator:Bn,SphericalMercator:W},qn=n({},q,{code:"EPSG:3395",projection:Bn,transformation:function(){var e=.5/(Math.PI*Bn.R);return G(e,.5,-e,.5)}()}),Hn=n({},q,{code:"EPSG:4326",projection:zn,transformation:G(1/180,1,-1/180,.5)}),Wn=n({},V,{projection:zn,transformation:G(1,0,-1,0),scale:function(e){return Math.pow(2,e)},zoom:function(e){return Math.log(e)/Math.LN2},distance:function(e,t){var n=t.lng-e.lng,i=t.lat-e.lat;return Math.sqrt(n*n+i*i)},infinite:!0});V.Earth=q,V.EPSG3395=qn,V.EPSG3857=Z,V.EPSG900913=Q,V.EPSG4326=Hn,V.Simple=Wn;var Kn=A.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(e){return e.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(e){return e&&e.removeLayer(this),this},getPane:function(e){return this._map.getPane(e?this.options[e]||e:this.options.pane)},addInteractiveTarget:function(e){return this._map._targets[o(e)]=this,this},removeInteractiveTarget:function(e){return delete this._map._targets[o(e)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(e){var t=e.target;if(t.hasLayer(this)){if(this._map=t,this._zoomAnimated=t._zoomAnimated,this.getEvents){var n=this.getEvents();t.on(n,this),this.once("remove",function(){t.off(n,this)},this)}this.onAdd(t),this.fire("add"),t.fire("layeradd",{layer:this})}}});nn.include({addLayer:function(e){if(!e._layerAdd)throw new Error("The provided object is not a Layer.");var t=o(e);return this._layers[t]||(this._layers[t]=e,e._mapToAdd=this,e.beforeAdd&&e.beforeAdd(this),this.whenReady(e._layerAdd,e)),this},removeLayer:function(e){var t=o(e);return this._layers[t]?(this._loaded&&e.onRemove(this),delete this._layers[t],this._loaded&&(this.fire("layerremove",{layer:e}),e.fire("remove")),e._map=e._mapToAdd=null,this):this},hasLayer:function(e){return o(e)in this._layers},eachLayer:function(e,t){for(var n in this._layers)e.call(t,this._layers[n]);return this},_addLayers:function(e){for(var t=0,n=(e=e?_(e)?e:[e]:[]).length;t<n;t++)this.addLayer(e[t])},_addZoomLimit:function(e){isNaN(e.options.maxZoom)&&isNaN(e.options.minZoom)||(this._zoomBoundLayers[o(e)]=e,this._updateZoomLevels())},_removeZoomLimit:function(e){var t=o(e);this._zoomBoundLayers[t]&&(delete this._zoomBoundLayers[t],this._updateZoomLevels())},_updateZoomLevels:function(){var e=1/0,t=-1/0,n=this._getZoomSpan();for(var i in this._zoomBoundLayers){var r=this._zoomBoundLayers[i].options;e=void 0===r.minZoom?e:Math.min(e,r.minZoom),t=void 0===r.maxZoom?t:Math.max(t,r.maxZoom)}this._layersMaxZoom=t===-1/0?void 0:t,this._layersMinZoom=e===1/0?void 0:e,n!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Gn=Kn.extend({initialize:function(e,t){var n,i;if(f(this,t),this._layers={},e)for(n=0,i=e.length;n<i;n++)this.addLayer(e[n])},addLayer:function(e){var t=this.getLayerId(e);return this._layers[t]=e,this._map&&this._map.addLayer(e),this},removeLayer:function(e){var t=e in this._layers?e:this.getLayerId(e);return this._map&&this._layers[t]&&this._map.removeLayer(this._layers[t]),delete this._layers[t],this},hasLayer:function(e){return("number"===typeof e?e:this.getLayerId(e))in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(e){var t,n,i=Array.prototype.slice.call(arguments,1);for(t in this._layers)(n=this._layers[t])[e]&&n[e].apply(n,i);return this},onAdd:function(e){this.eachLayer(e.addLayer,e)},onRemove:function(e){this.eachLayer(e.removeLayer,e)},eachLayer:function(e,t){for(var n in this._layers)e.call(t,this._layers[n]);return this},getLayer:function(e){return this._layers[e]},getLayers:function(){var e=[];return this.eachLayer(e.push,e),e},setZIndex:function(e){return this.invoke("setZIndex",e)},getLayerId:function(e){return o(e)}}),Zn=function(e,t){return new Gn(e,t)},Qn=Gn.extend({addLayer:function(e){return this.hasLayer(e)?this:(e.addEventParent(this),Gn.prototype.addLayer.call(this,e),this.fire("layeradd",{layer:e}))},removeLayer:function(e){return this.hasLayer(e)?(e in this._layers&&(e=this._layers[e]),e.removeEventParent(this),Gn.prototype.removeLayer.call(this,e),this.fire("layerremove",{layer:e})):this},setStyle:function(e){return this.invoke("setStyle",e)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var e=new F;for(var t in this._layers){var n=this._layers[t];e.extend(n.getBounds?n.getBounds():n.getLatLng())}return e}}),Yn=function(e,t){return new Qn(e,t)},Jn=k.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(e){f(this,e)},createIcon:function(e){return this._createIcon("icon",e)},createShadow:function(e){return this._createIcon("shadow",e)},_createIcon:function(e,t){var n=this._getIconUrl(e);if(!n){if("icon"===e)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var i=this._createImg(n,t&&"IMG"===t.tagName?t:null);return this._setIconStyles(i,e),(this.options.crossOrigin||""===this.options.crossOrigin)&&(i.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),i},_setIconStyles:function(e,t){var n=this.options,i=n[t+"Size"];"number"===typeof i&&(i=[i,i]);var r=D(i),s=D("shadow"===t&&n.shadowAnchor||n.iconAnchor||r&&r.divideBy(2,!0));e.className="leaflet-marker-"+t+" "+(n.className||""),s&&(e.style.marginLeft=-s.x+"px",e.style.marginTop=-s.y+"px"),r&&(e.style.width=r.x+"px",e.style.height=r.y+"px")},_createImg:function(e,t){return(t=t||document.createElement("img")).src=e,t},_getIconUrl:function(e){return Me.retina&&this.options[e+"RetinaUrl"]||this.options[e+"Url"]}});function Xn(e){return new Jn(e)}var $n=Jn.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(e){return"string"!==typeof $n.imagePath&&($n.imagePath=this._detectIconPath()),(this.options.imagePath||$n.imagePath)+Jn.prototype._getIconUrl.call(this,e)},_stripUrl:function(e){var t=function(e,t,n){var i=t.exec(e);return i&&i[n]};return(e=t(e,/^url\((['"])?(.+)\1\)$/,2))&&t(e,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var e=ft("div","leaflet-default-icon-path",document.body),t=dt(e,"background-image")||dt(e,"backgroundImage");if(document.body.removeChild(e),t=this._stripUrl(t))return t;var n=document.querySelector('link[href$="leaflet.css"]');return n?n.href.substring(0,n.href.length-11-1):""}}),ei=gn.extend({initialize:function(e){this._marker=e},addHooks:function(){var e=this._marker._icon;this._draggable||(this._draggable=new yn(e,e,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),yt(e,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&wt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(e){var t=this._marker,n=t._map,i=this._marker.options.autoPanSpeed,r=this._marker.options.autoPanPadding,s=kt(t._icon),o=n.getPixelBounds(),a=n.getPixelOrigin(),l=j(o.min._subtract(a).add(r),o.max._subtract(a).subtract(r));if(!l.contains(s)){var c=D((Math.max(l.max.x,s.x)-l.max.x)/(o.max.x-l.max.x)-(Math.min(l.min.x,s.x)-l.min.x)/(o.min.x-l.min.x),(Math.max(l.max.y,s.y)-l.max.y)/(o.max.y-l.max.y)-(Math.min(l.min.y,s.y)-l.min.y)/(o.min.y-l.min.y)).multiplyBy(i);n.panBy(c,{animate:!1}),this._draggable._newPos._add(c),this._draggable._startPos._add(c),It(t._icon,this._draggable._newPos),this._onDrag(e),this._panRequest=x(this._adjustPan.bind(this,e))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(e){this._marker.options.autoPan&&(S(this._panRequest),this._panRequest=x(this._adjustPan.bind(this,e)))},_onDrag:function(e){var t=this._marker,n=t._shadow,i=kt(t._icon),r=t._map.layerPointToLatLng(i);n&&It(n,i),t._latlng=r,e.latlng=r,e.oldLatLng=this._oldLatLng,t.fire("move",e).fire("drag",e)},_onDragEnd:function(e){S(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",e)}}),ti=Kn.extend({options:{icon:new $n,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(e,t){f(this,t),this._latlng=B(e)},onAdd:function(e){this._zoomAnimated=this._zoomAnimated&&e.options.markerZoomAnimation,this._zoomAnimated&&e.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(e){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&e.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(e){var t=this._latlng;return this._latlng=B(e),this.update(),this.fire("move",{oldLatLng:t,latlng:this._latlng})},setZIndexOffset:function(e){return this.options.zIndexOffset=e,this.update()},getIcon:function(){return this.options.icon},setIcon:function(e){return this.options.icon=e,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var e=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(e)}return this},_initIcon:function(){var e=this.options,t="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),n=e.icon.createIcon(this._icon),i=!1;n!==this._icon&&(this._icon&&this._removeIcon(),i=!0,e.title&&(n.title=e.title),"IMG"===n.tagName&&(n.alt=e.alt||"")),yt(n,t),e.keyboard&&(n.tabIndex="0",n.setAttribute("role","button")),this._icon=n,e.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&jt(n,"focus",this._panOnFocus,this);var r=e.icon.createShadow(this._shadow),s=!1;r!==this._shadow&&(this._removeShadow(),s=!0),r&&(yt(r,t),r.alt=""),this._shadow=r,e.opacity<1&&this._updateOpacity(),i&&this.getPane().appendChild(this._icon),this._initInteraction(),r&&s&&this.getPane(e.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ut(this._icon,"focus",this._panOnFocus,this),pt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&pt(this._shadow),this._shadow=null},_setPos:function(e){this._icon&&It(this._icon,e),this._shadow&&It(this._shadow,e),this._zIndex=e.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(e){this._icon&&(this._icon.style.zIndex=this._zIndex+e)},_animateZoom:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center).round();this._setPos(t)},_initInteraction:function(){if(this.options.interactive&&(yt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),ei)){var e=this.options.draggable;this.dragging&&(e=this.dragging.enabled(),this.dragging.disable()),this.dragging=new ei(this),e&&this.dragging.enable()}},setOpacity:function(e){return this.options.opacity=e,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var e=this.options.opacity;this._icon&&Tt(this._icon,e),this._shadow&&Tt(this._shadow,e)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var e=this._map;if(e){var t=this.options.icon.options,n=t.iconSize?D(t.iconSize):D(0,0),i=t.iconAnchor?D(t.iconAnchor):D(0,0);e.panInside(this._latlng,{paddingTopLeft:i,paddingBottomRight:n.subtract(i)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function ni(e,t){return new ti(e,t)}var ii=Kn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(e){this._renderer=e.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(e){return f(this,e),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&e&&Object.prototype.hasOwnProperty.call(e,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),ri=ii.extend({options:{fill:!0,radius:10},initialize:function(e,t){f(this,t),this._latlng=B(e),this._radius=this.options.radius},setLatLng:function(e){var t=this._latlng;return this._latlng=B(e),this.redraw(),this.fire("move",{oldLatLng:t,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(e){return this.options.radius=this._radius=e,this.redraw()},getRadius:function(){return this._radius},setStyle:function(e){var t=e&&e.radius||this._radius;return ii.prototype.setStyle.call(this,e),this.setRadius(t),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var e=this._radius,t=this._radiusY||e,n=this._clickTolerance(),i=[e+n,t+n];this._pxBounds=new M(this._point.subtract(i),this._point.add(i))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(e){return e.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function si(e,t){return new ri(e,t)}var oi=ri.extend({initialize:function(e,t,i){if("number"===typeof t&&(t=n({},i,{radius:t})),f(this,t),this._latlng=B(e),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(e){return this._mRadius=e,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var e=[this._radius,this._radiusY||this._radius];return new F(this._map.layerPointToLatLng(this._point.subtract(e)),this._map.layerPointToLatLng(this._point.add(e)))},setStyle:ii.prototype.setStyle,_project:function(){var e=this._latlng.lng,t=this._latlng.lat,n=this._map,i=n.options.crs;if(i.distance===q.distance){var r=Math.PI/180,s=this._mRadius/q.R/r,o=n.project([t+s,e]),a=n.project([t-s,e]),l=o.add(a).divideBy(2),c=n.unproject(l).lat,u=Math.acos((Math.cos(s*r)-Math.sin(t*r)*Math.sin(c*r))/(Math.cos(t*r)*Math.cos(c*r)))/r;(isNaN(u)||0===u)&&(u=s/Math.cos(Math.PI/180*t)),this._point=l.subtract(n.getPixelOrigin()),this._radius=isNaN(u)?0:l.x-n.project([c,e-u]).x,this._radiusY=l.y-o.y}else{var h=i.unproject(i.project(this._latlng).subtract([this._mRadius,0]));this._point=n.latLngToLayerPoint(this._latlng),this._radius=this._point.x-n.latLngToLayerPoint(h).x}this._updateBounds()}});function ai(e,t,n){return new oi(e,t,n)}var li=ii.extend({options:{smoothFactor:1,noClip:!1},initialize:function(e,t){f(this,t),this._setLatLngs(e)},getLatLngs:function(){return this._latlngs},setLatLngs:function(e){return this._setLatLngs(e),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(e){for(var t,n,i=1/0,r=null,s=Dn,o=0,a=this._parts.length;o<a;o++)for(var l=this._parts[o],c=1,u=l.length;c<u;c++){var h=s(e,t=l[c-1],n=l[c],!0);h<i&&(i=h,r=s(e,t,n))}return r&&(r.distance=Math.sqrt(i)),r},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Fn(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(e,t){return t=t||this._defaultShape(),e=B(e),t.push(e),this._bounds.extend(e),this.redraw()},_setLatLngs:function(e){this._bounds=new F,this._latlngs=this._convertLatLngs(e)},_defaultShape:function(){return Mn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(e){for(var t=[],n=Mn(e),i=0,r=e.length;i<r;i++)n?(t[i]=B(e[i]),this._bounds.extend(t[i])):t[i]=this._convertLatLngs(e[i]);return t},_project:function(){var e=new M;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,e),this._bounds.isValid()&&e.isValid()&&(this._rawPxBounds=e,this._updateBounds())},_updateBounds:function(){var e=this._clickTolerance(),t=new R(e,e);this._rawPxBounds&&(this._pxBounds=new M([this._rawPxBounds.min.subtract(t),this._rawPxBounds.max.add(t)]))},_projectLatlngs:function(e,t,n){var i,r,s=e[0]instanceof z,o=e.length;if(s){for(r=[],i=0;i<o;i++)r[i]=this._map.latLngToLayerPoint(e[i]),n.extend(r[i]);t.push(r)}else for(i=0;i<o;i++)this._projectLatlngs(e[i],t,n)},_clipPoints:function(){var e=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(e))if(this.options.noClip)this._parts=this._rings;else{var t,n,i,r,s,o,a,l=this._parts;for(t=0,i=0,r=this._rings.length;t<r;t++)for(n=0,s=(a=this._rings[t]).length;n<s-1;n++)(o=An(a[n],a[n+1],e,n,!0))&&(l[i]=l[i]||[],l[i].push(o[0]),o[1]===a[n+1]&&n!==s-2||(l[i].push(o[1]),i++))}},_simplifyPoints:function(){for(var e=this._parts,t=this.options.smoothFactor,n=0,i=e.length;n<i;n++)e[n]=xn(e[n],t)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(e,t){var n,i,r,s,o,a,l=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(e))return!1;for(n=0,s=this._parts.length;n<s;n++)for(i=0,r=(o=(a=this._parts[n]).length)-1;i<o;r=i++)if((t||0!==i)&&Sn(e,a[r],a[i])<=l)return!0;return!1}});function ci(e,t){return new li(e,t)}li._flat=jn;var ui=li.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return bn(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(e){var t=li.prototype._convertLatLngs.call(this,e),n=t.length;return n>=2&&t[0]instanceof z&&t[0].equals(t[n-1])&&t.pop(),t},_setLatLngs:function(e){li.prototype._setLatLngs.call(this,e),Mn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Mn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var e=this._renderer._bounds,t=this.options.weight,n=new R(t,t);if(e=new M(e.min.subtract(n),e.max.add(n)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(e))if(this.options.noClip)this._parts=this._rings;else for(var i,r=0,s=this._rings.length;r<s;r++)(i=wn(this._rings[r],e,!0)).length&&this._parts.push(i)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(e){var t,n,i,r,s,o,a,l,c=!1;if(!this._pxBounds||!this._pxBounds.contains(e))return!1;for(r=0,a=this._parts.length;r<a;r++)for(s=0,o=(l=(t=this._parts[r]).length)-1;s<l;o=s++)n=t[s],i=t[o],n.y>e.y!==i.y>e.y&&e.x<(i.x-n.x)*(e.y-n.y)/(i.y-n.y)+n.x&&(c=!c);return c||li.prototype._containsPoint.call(this,e,!0)}});function hi(e,t){return new ui(e,t)}var di=Qn.extend({initialize:function(e,t){f(this,t),this._layers={},e&&this.addData(e)},addData:function(e){var t,n,i,r=_(e)?e:e.features;if(r){for(t=0,n=r.length;t<n;t++)((i=r[t]).geometries||i.geometry||i.features||i.coordinates)&&this.addData(i);return this}var s=this.options;if(s.filter&&!s.filter(e))return this;var o=fi(e,s);return o?(o.feature=wi(e),o.defaultOptions=o.options,this.resetStyle(o),s.onEachFeature&&s.onEachFeature(e,o),this.addLayer(o)):this},resetStyle:function(e){return void 0===e?this.eachLayer(this.resetStyle,this):(e.options=n({},e.defaultOptions),this._setLayerStyle(e,this.options.style),this)},setStyle:function(e){return this.eachLayer(function(t){this._setLayerStyle(t,e)},this)},_setLayerStyle:function(e,t){e.setStyle&&("function"===typeof t&&(t=t(e.feature)),e.setStyle(t))}});function fi(e,t){var n,i,r,s,o="Feature"===e.type?e.geometry:e,a=o?o.coordinates:null,l=[],c=t&&t.pointToLayer,u=t&&t.coordsToLatLng||mi;if(!a&&!o)return null;switch(o.type){case"Point":return pi(c,e,n=u(a),t);case"MultiPoint":for(r=0,s=a.length;r<s;r++)n=u(a[r]),l.push(pi(c,e,n,t));return new Qn(l);case"LineString":case"MultiLineString":return i=gi(a,"LineString"===o.type?0:1,u),new li(i,t);case"Polygon":case"MultiPolygon":return i=gi(a,"Polygon"===o.type?1:2,u),new ui(i,t);case"GeometryCollection":for(r=0,s=o.geometries.length;r<s;r++){var h=fi({geometry:o.geometries[r],type:"Feature",properties:e.properties},t);h&&l.push(h)}return new Qn(l);case"FeatureCollection":for(r=0,s=o.features.length;r<s;r++){var d=fi(o.features[r],t);d&&l.push(d)}return new Qn(l);default:throw new Error("Invalid GeoJSON object.")}}function pi(e,t,n,i){return e?e(t,n):new ti(n,i&&i.markersInheritOptions&&i)}function mi(e){return new z(e[1],e[0],e[2])}function gi(e,t,n){for(var i,r=[],s=0,o=e.length;s<o;s++)i=t?gi(e[s],t-1,n):(n||mi)(e[s]),r.push(i);return r}function _i(e,t){return void 0!==(e=B(e)).alt?[u(e.lng,t),u(e.lat,t),u(e.alt,t)]:[u(e.lng,t),u(e.lat,t)]}function vi(e,t,n,i){for(var r=[],s=0,o=e.length;s<o;s++)r.push(t?vi(e[s],Mn(e[s])?0:t-1,n,i):_i(e[s],i));return!t&&n&&r.length>0&&r.push(r[0].slice()),r}function yi(e,t){return e.feature?n({},e.feature,{geometry:t}):wi(t)}function wi(e){return"Feature"===e.type||"FeatureCollection"===e.type?e:{type:"Feature",properties:{},geometry:e}}var bi={toGeoJSON:function(e){return yi(this,{type:"Point",coordinates:_i(this.getLatLng(),e)})}};function Ei(e,t){return new di(e,t)}ti.include(bi),oi.include(bi),ri.include(bi),li.include({toGeoJSON:function(e){var t=!Mn(this._latlngs);return yi(this,{type:(t?"Multi":"")+"LineString",coordinates:vi(this._latlngs,t?1:0,!1,e)})}}),ui.include({toGeoJSON:function(e){var t=!Mn(this._latlngs),n=t&&!Mn(this._latlngs[0]),i=vi(this._latlngs,n?2:t?1:0,!0,e);return t||(i=[i]),yi(this,{type:(n?"Multi":"")+"Polygon",coordinates:i})}}),Gn.include({toMultiPoint:function(e){var t=[];return this.eachLayer(function(n){t.push(n.toGeoJSON(e).geometry.coordinates)}),yi(this,{type:"MultiPoint",coordinates:t})},toGeoJSON:function(e){var t=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===t)return this.toMultiPoint(e);var n="GeometryCollection"===t,i=[];return this.eachLayer(function(t){if(t.toGeoJSON){var r=t.toGeoJSON(e);if(n)i.push(r.geometry);else{var s=wi(r);"FeatureCollection"===s.type?i.push.apply(i,s.features):i.push(s)}}}),n?yi(this,{geometries:i,type:"GeometryCollection"}):{type:"FeatureCollection",features:i}}});var Ti=Ei,Ci=Kn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(e,t,n){this._url=e,this._bounds=U(t),f(this,n)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(yt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){pt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(e){return this.options.opacity=e,this._image&&this._updateOpacity(),this},setStyle:function(e){return e.opacity&&this.setOpacity(e.opacity),this},bringToFront:function(){return this._map&&gt(this._image),this},bringToBack:function(){return this._map&&_t(this._image),this},setUrl:function(e){return this._url=e,this._image&&(this._image.src=e),this},setBounds:function(e){return this._bounds=U(e),this._map&&this._reset(),this},getEvents:function(){var e={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},setZIndex:function(e){return this.options.zIndex=e,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var e="IMG"===this._url.tagName,t=this._image=e?this._url:ft("img");yt(t,"leaflet-image-layer"),this._zoomAnimated&&yt(t,"leaflet-zoom-animated"),this.options.className&&yt(t,this.options.className),t.onselectstart=c,t.onmousemove=c,t.onload=r(this.fire,this,"load"),t.onerror=r(this._overlayOnError,this,"error"),(this.options.crossOrigin||""===this.options.crossOrigin)&&(t.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),e?this._url=t.src:(t.src=this._url,t.alt=this.options.alt)},_animateZoom:function(e){var t=this._map.getZoomScale(e.zoom),n=this._map._latLngBoundsToNewLayerBounds(this._bounds,e.zoom,e.center).min;St(this._image,n,t)},_reset:function(){var e=this._image,t=new M(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),n=t.getSize();It(e,t.min),e.style.width=n.x+"px",e.style.height=n.y+"px"},_updateOpacity:function(){Tt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var e=this.options.errorOverlayUrl;e&&this._url!==e&&(this._url=e,this._image.src=e)},getCenter:function(){return this._bounds.getCenter()}}),xi=function(e,t,n){return new Ci(e,t,n)},Si=Ci.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var e="VIDEO"===this._url.tagName,t=this._image=e?this._url:ft("video");if(yt(t,"leaflet-image-layer"),this._zoomAnimated&&yt(t,"leaflet-zoom-animated"),this.options.className&&yt(t,this.options.className),t.onselectstart=c,t.onmousemove=c,t.onloadeddata=r(this.fire,this,"load"),e){for(var n=t.getElementsByTagName("source"),i=[],s=0;s<n.length;s++)i.push(n[s].src);this._url=n.length>0?i:[t.src]}else{_(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(t.style,"objectFit")&&(t.style.objectFit="fill"),t.autoplay=!!this.options.autoplay,t.loop=!!this.options.loop,t.muted=!!this.options.muted,t.playsInline=!!this.options.playsInline;for(var o=0;o<this._url.length;o++){var a=ft("source");a.src=this._url[o],t.appendChild(a)}}}});function Ii(e,t,n){return new Si(e,t,n)}var ki=Ci.extend({_initImage:function(){var e=this._image=this._url;yt(e,"leaflet-image-layer"),this._zoomAnimated&&yt(e,"leaflet-zoom-animated"),this.options.className&&yt(e,this.options.className),e.onselectstart=c,e.onmousemove=c}});function Pi(e,t,n){return new ki(e,t,n)}var Ni=Kn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(e,t){e&&(e instanceof z||_(e))?(this._latlng=B(e),f(this,t)):(f(this,e),this._source=t),this.options.content&&(this._content=this.options.content)},openOn:function(e){return(e=arguments.length?e:this._source._map).hasLayer(this)||e.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(e){return this._map?this.close():(arguments.length?this._source=e:e=this._source,this._prepareOpen(),this.openOn(e._map)),this},onAdd:function(e){this._zoomAnimated=e._zoomAnimated,this._container||this._initLayout(),e._fadeAnimated&&Tt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),e._fadeAnimated&&Tt(this._container,1),this.bringToFront(),this.options.interactive&&(yt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(e){e._fadeAnimated?(Tt(this._container,0),this._removeTimeout=setTimeout(r(pt,void 0,this._container),200)):pt(this._container),this.options.interactive&&(wt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(e){return this._latlng=B(e),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(e){return this._content=e,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var e={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&gt(this._container),this},bringToBack:function(){return this._map&&_t(this._container),this},_prepareOpen:function(e){var t=this._source;if(!t._map)return!1;if(t instanceof Qn){t=null;var n=this._source._layers;for(var i in n)if(n[i]._map){t=n[i];break}if(!t)return!1;this._source=t}if(!e)if(t.getCenter)e=t.getCenter();else if(t.getLatLng)e=t.getLatLng();else{if(!t.getBounds)throw new Error("Unable to get source layer LatLng.");e=t.getBounds().getCenter()}return this.setLatLng(e),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var e=this._contentNode,t="function"===typeof this._content?this._content(this._source||this):this._content;if("string"===typeof t)e.innerHTML=t;else{for(;e.hasChildNodes();)e.removeChild(e.firstChild);e.appendChild(t)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var e=this._map.latLngToLayerPoint(this._latlng),t=D(this.options.offset),n=this._getAnchor();this._zoomAnimated?It(this._container,e.add(n)):t=t.add(e).add(n);var i=this._containerBottom=-t.y,r=this._containerLeft=-Math.round(this._containerWidth/2)+t.x;this._container.style.bottom=i+"px",this._container.style.left=r+"px"}},_getAnchor:function(){return[0,0]}});nn.include({_initOverlay:function(e,t,n,i){var r=t;return r instanceof e||(r=new e(i).setContent(t)),n&&r.setLatLng(n),r}}),Kn.include({_initOverlay:function(e,t,n,i){var r=n;return r instanceof e?(f(r,i),r._source=this):(r=t&&!i?t:new e(i,this)).setContent(n),r}});var Ai=Ni.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(e){return!(e=arguments.length?e:this._source._map).hasLayer(this)&&e._popup&&e._popup.options.autoClose&&e.removeLayer(e._popup),e._popup=this,Ni.prototype.openOn.call(this,e)},onAdd:function(e){Ni.prototype.onAdd.call(this,e),e.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof ii||this._source.on("preclick",Ht))},onRemove:function(e){Ni.prototype.onRemove.call(this,e),e.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof ii||this._source.off("preclick",Ht))},getEvents:function(){var e=Ni.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(e.preclick=this.close),this.options.keepInView&&(e.moveend=this._adjustPan),e},_initLayout:function(){var e="leaflet-popup",t=this._container=ft("div",e+" "+(this.options.className||"")+" leaflet-zoom-animated"),n=this._wrapper=ft("div",e+"-content-wrapper",t);if(this._contentNode=ft("div",e+"-content",n),Kt(t),Wt(this._contentNode),jt(t,"contextmenu",Ht),this._tipContainer=ft("div",e+"-tip-container",t),this._tip=ft("div",e+"-tip",this._tipContainer),this.options.closeButton){var i=this._closeButton=ft("a",e+"-close-button",t);i.setAttribute("role","button"),i.setAttribute("aria-label","Close popup"),i.href="#close",i.innerHTML='<span aria-hidden="true">&#215;</span>',jt(i,"click",function(e){Gt(e),this.close()},this)}},_updateLayout:function(){var e=this._contentNode,t=e.style;t.width="",t.whiteSpace="nowrap";var n=e.offsetWidth;n=Math.min(n,this.options.maxWidth),n=Math.max(n,this.options.minWidth),t.width=n+1+"px",t.whiteSpace="",t.height="";var i=e.offsetHeight,r=this.options.maxHeight,s="leaflet-popup-scrolled";r&&i>r?(t.height=r+"px",yt(e,s)):wt(e,s),this._containerWidth=this._container.offsetWidth},_animateZoom:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center),n=this._getAnchor();It(this._container,t.add(n))},_adjustPan:function(){if(this.options.autoPan)if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning)this._autopanning=!1;else{var e=this._map,t=parseInt(dt(this._container,"marginBottom"),10)||0,n=this._container.offsetHeight+t,i=this._containerWidth,r=new R(this._containerLeft,-n-this._containerBottom);r._add(kt(this._container));var s=e.layerPointToContainerPoint(r),o=D(this.options.autoPanPadding),a=D(this.options.autoPanPaddingTopLeft||o),l=D(this.options.autoPanPaddingBottomRight||o),c=e.getSize(),u=0,h=0;s.x+i+l.x>c.x&&(u=s.x+i-c.x+l.x),s.x-u-a.x<0&&(u=s.x-a.x),s.y+n+l.y>c.y&&(h=s.y+n-c.y+l.y),s.y-h-a.y<0&&(h=s.y-a.y),(u||h)&&(this.options.keepInView&&(this._autopanning=!0),e.fire("autopanstart").panBy([u,h]))}},_getAnchor:function(){return D(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Ri=function(e,t){return new Ai(e,t)};nn.mergeOptions({closePopupOnClick:!0}),nn.include({openPopup:function(e,t,n){return this._initOverlay(Ai,e,t,n).openOn(this),this},closePopup:function(e){return(e=arguments.length?e:this._popup)&&e.close(),this}}),Kn.include({bindPopup:function(e,t){return this._popup=this._initOverlay(Ai,this._popup,e,t),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(e){return this._popup&&(this instanceof Qn||(this._popup._source=this),this._popup._prepareOpen(e||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(e){return this._popup&&this._popup.setContent(e),this},getPopup:function(){return this._popup},_openPopup:function(e){if(this._popup&&this._map){Zt(e);var t=e.layer||e.target;this._popup._source!==t||t instanceof ii?(this._popup._source=t,this.openPopup(e.latlng)):this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(e.latlng)}},_movePopup:function(e){this._popup.setLatLng(e.latlng)},_onKeyPress:function(e){13===e.originalEvent.keyCode&&this._openPopup(e)}});var Li=Ni.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(e){Ni.prototype.onAdd.call(this,e),this.setOpacity(this.options.opacity),e.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(e){Ni.prototype.onRemove.call(this,e),e.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var e=Ni.prototype.getEvents.call(this);return this.options.permanent||(e.preclick=this.close),e},_initLayout:function(){var e="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=ft("div",e),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+o(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(e){var t,n,i=this._map,r=this._container,s=i.latLngToContainerPoint(i.getCenter()),o=i.layerPointToContainerPoint(e),a=this.options.direction,l=r.offsetWidth,c=r.offsetHeight,u=D(this.options.offset),h=this._getAnchor();"top"===a?(t=l/2,n=c):"bottom"===a?(t=l/2,n=0):"center"===a?(t=l/2,n=c/2):"right"===a?(t=0,n=c/2):"left"===a?(t=l,n=c/2):o.x<s.x?(a="right",t=0,n=c/2):(a="left",t=l+2*(u.x+h.x),n=c/2),e=e.subtract(D(t,n,!0)).add(u).add(h),wt(r,"leaflet-tooltip-right"),wt(r,"leaflet-tooltip-left"),wt(r,"leaflet-tooltip-top"),wt(r,"leaflet-tooltip-bottom"),yt(r,"leaflet-tooltip-"+a),It(r,e)},_updatePosition:function(){var e=this._map.latLngToLayerPoint(this._latlng);this._setPosition(e)},setOpacity:function(e){this.options.opacity=e,this._container&&Tt(this._container,e)},_animateZoom:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center);this._setPosition(t)},_getAnchor:function(){return D(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Oi=function(e,t){return new Li(e,t)};nn.include({openTooltip:function(e,t,n){return this._initOverlay(Li,e,t,n).openOn(this),this},closeTooltip:function(e){return e.close(),this}}),Kn.include({bindTooltip:function(e,t){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Li,this._tooltip,e,t),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(e){if(e||!this._tooltipHandlersAdded){var t=e?"off":"on",n={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?n.add=this._openTooltip:(n.mouseover=this._openTooltip,n.mouseout=this.closeTooltip,n.click=this._openTooltip,this._map?this._addFocusListeners():n.add=this._addFocusListeners),this._tooltip.options.sticky&&(n.mousemove=this._moveTooltip),this[t](n),this._tooltipHandlersAdded=!e}},openTooltip:function(e){return this._tooltip&&(this instanceof Qn||(this._tooltip._source=this),this._tooltip._prepareOpen(e)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(e){return this._tooltip&&this._tooltip.setContent(e),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(e){var t="function"===typeof e.getElement&&e.getElement();t&&(jt(t,"focus",function(){this._tooltip._source=e,this.openTooltip()},this),jt(t,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(e){var t="function"===typeof e.getElement&&e.getElement();t&&t.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(e){if(this._tooltip&&this._map)if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var t=this;this._map.once("moveend",function(){t._openOnceFlag=!1,t._openTooltip(e)})}else this._tooltip._source=e.layer||e.target,this.openTooltip(this._tooltip.options.sticky?e.latlng:void 0)},_moveTooltip:function(e){var t,n,i=e.latlng;this._tooltip.options.sticky&&e.originalEvent&&(t=this._map.mouseEventToContainerPoint(e.originalEvent),n=this._map.containerPointToLayerPoint(t),i=this._map.layerPointToLatLng(n)),this._tooltip.setLatLng(i)}});var Di=Jn.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(e){var t=e&&"DIV"===e.tagName?e:document.createElement("div"),n=this.options;if(n.html instanceof Element?(mt(t),t.appendChild(n.html)):t.innerHTML=!1!==n.html?n.html:"",n.bgPos){var i=D(n.bgPos);t.style.backgroundPosition=-i.x+"px "+-i.y+"px"}return this._setIconStyles(t,"icon"),t},createShadow:function(){return null}});function Mi(e){return new Di(e)}Jn.Default=$n;var ji=Kn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Me.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(e){f(this,e)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(e){e._addZoomLimit(this)},onRemove:function(e){this._removeAllTiles(),pt(this._container),e._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(gt(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(_t(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(e){return this.options.opacity=e,this._updateOpacity(),this},setZIndex:function(e){return this.options.zIndex=e,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var e=this._clampZoom(this._map.getZoom());e!==this._tileZoom&&(this._tileZoom=e,this._updateLevels()),this._update()}return this},getEvents:function(){var e={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=a(this._onMoveEnd,this.options.updateInterval,this)),e.move=this._onMove),this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},createTile:function(){return document.createElement("div")},getTileSize:function(){var e=this.options.tileSize;return e instanceof R?e:new R(e,e)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(e){for(var t,n=this.getPane().children,i=-e(-1/0,1/0),r=0,s=n.length;r<s;r++)t=n[r].style.zIndex,n[r]!==this._container&&t&&(i=e(i,+t));isFinite(i)&&(this.options.zIndex=i+e(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Me.ielt9){Tt(this._container,this.options.opacity);var e=+new Date,t=!1,n=!1;for(var i in this._tiles){var r=this._tiles[i];if(r.current&&r.loaded){var s=Math.min(1,(e-r.loaded)/200);Tt(r.el,s),s<1?t=!0:(r.active?n=!0:this._onOpaqueTile(r),r.active=!0)}}n&&!this._noPrune&&this._pruneTiles(),t&&(S(this._fadeFrame),this._fadeFrame=x(this._updateOpacity,this))}},_onOpaqueTile:c,_initContainer:function(){this._container||(this._container=ft("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var e=this._tileZoom,t=this.options.maxZoom;if(void 0!==e){for(var n in this._levels)n=Number(n),this._levels[n].el.children.length||n===e?(this._levels[n].el.style.zIndex=t-Math.abs(e-n),this._onUpdateLevel(n)):(pt(this._levels[n].el),this._removeTilesAtZoom(n),this._onRemoveLevel(n),delete this._levels[n]);var i=this._levels[e],r=this._map;return i||((i=this._levels[e]={}).el=ft("div","leaflet-tile-container leaflet-zoom-animated",this._container),i.el.style.zIndex=t,i.origin=r.project(r.unproject(r.getPixelOrigin()),e).round(),i.zoom=e,this._setZoomTransform(i,r.getCenter(),r.getZoom()),c(i.el.offsetWidth),this._onCreateLevel(i)),this._level=i,i}},_onUpdateLevel:c,_onRemoveLevel:c,_onCreateLevel:c,_pruneTiles:function(){if(this._map){var e,t,n=this._map.getZoom();if(n>this.options.maxZoom||n<this.options.minZoom)this._removeAllTiles();else{for(e in this._tiles)(t=this._tiles[e]).retain=t.current;for(e in this._tiles)if((t=this._tiles[e]).current&&!t.active){var i=t.coords;this._retainParent(i.x,i.y,i.z,i.z-5)||this._retainChildren(i.x,i.y,i.z,i.z+2)}for(e in this._tiles)this._tiles[e].retain||this._removeTile(e)}}},_removeTilesAtZoom:function(e){for(var t in this._tiles)this._tiles[t].coords.z===e&&this._removeTile(t)},_removeAllTiles:function(){for(var e in this._tiles)this._removeTile(e)},_invalidateAll:function(){for(var e in this._levels)pt(this._levels[e].el),this._onRemoveLevel(Number(e)),delete this._levels[e];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(e,t,n,i){var r=Math.floor(e/2),s=Math.floor(t/2),o=n-1,a=new R(+r,+s);a.z=+o;var l=this._tileCoordsToKey(a),c=this._tiles[l];return c&&c.active?(c.retain=!0,!0):(c&&c.loaded&&(c.retain=!0),o>i&&this._retainParent(r,s,o,i))},_retainChildren:function(e,t,n,i){for(var r=2*e;r<2*e+2;r++)for(var s=2*t;s<2*t+2;s++){var o=new R(r,s);o.z=n+1;var a=this._tileCoordsToKey(o),l=this._tiles[a];l&&l.active?l.retain=!0:(l&&l.loaded&&(l.retain=!0),n+1<i&&this._retainChildren(r,s,n+1,i))}},_resetView:function(e){var t=e&&(e.pinch||e.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),t,t)},_animateZoom:function(e){this._setView(e.center,e.zoom,!0,e.noUpdate)},_clampZoom:function(e){var t=this.options;return void 0!==t.minNativeZoom&&e<t.minNativeZoom?t.minNativeZoom:void 0!==t.maxNativeZoom&&t.maxNativeZoom<e?t.maxNativeZoom:e},_setView:function(e,t,n,i){var r=Math.round(t);r=void 0!==this.options.maxZoom&&r>this.options.maxZoom||void 0!==this.options.minZoom&&r<this.options.minZoom?void 0:this._clampZoom(r);var s=this.options.updateWhenZooming&&r!==this._tileZoom;i&&!s||(this._tileZoom=r,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==r&&this._update(e),n||this._pruneTiles(),this._noPrune=!!n),this._setZoomTransforms(e,t)},_setZoomTransforms:function(e,t){for(var n in this._levels)this._setZoomTransform(this._levels[n],e,t)},_setZoomTransform:function(e,t,n){var i=this._map.getZoomScale(n,e.zoom),r=e.origin.multiplyBy(i).subtract(this._map._getNewPixelOrigin(t,n)).round();Me.any3d?St(e.el,r,i):It(e.el,r)},_resetGrid:function(){var e=this._map,t=e.options.crs,n=this._tileSize=this.getTileSize(),i=this._tileZoom,r=this._map.getPixelWorldBounds(this._tileZoom);r&&(this._globalTileRange=this._pxBoundsToTileRange(r)),this._wrapX=t.wrapLng&&!this.options.noWrap&&[Math.floor(e.project([0,t.wrapLng[0]],i).x/n.x),Math.ceil(e.project([0,t.wrapLng[1]],i).x/n.y)],this._wrapY=t.wrapLat&&!this.options.noWrap&&[Math.floor(e.project([t.wrapLat[0],0],i).y/n.x),Math.ceil(e.project([t.wrapLat[1],0],i).y/n.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(e){var t=this._map,n=t._animatingZoom?Math.max(t._animateToZoom,t.getZoom()):t.getZoom(),i=t.getZoomScale(n,this._tileZoom),r=t.project(e,this._tileZoom).floor(),s=t.getSize().divideBy(2*i);return new M(r.subtract(s),r.add(s))},_update:function(e){var t=this._map;if(t){var n=this._clampZoom(t.getZoom());if(void 0===e&&(e=t.getCenter()),void 0!==this._tileZoom){var i=this._getTiledPixelBounds(e),r=this._pxBoundsToTileRange(i),s=r.getCenter(),o=[],a=this.options.keepBuffer,l=new M(r.getBottomLeft().subtract([a,-a]),r.getTopRight().add([a,-a]));if(!(isFinite(r.min.x)&&isFinite(r.min.y)&&isFinite(r.max.x)&&isFinite(r.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var c in this._tiles){var u=this._tiles[c].coords;u.z===this._tileZoom&&l.contains(new R(u.x,u.y))||(this._tiles[c].current=!1)}if(Math.abs(n-this._tileZoom)>1)this._setView(e,n);else{for(var h=r.min.y;h<=r.max.y;h++)for(var d=r.min.x;d<=r.max.x;d++){var f=new R(d,h);if(f.z=this._tileZoom,this._isValidTile(f)){var p=this._tiles[this._tileCoordsToKey(f)];p?p.current=!0:o.push(f)}}if(o.sort(function(e,t){return e.distanceTo(s)-t.distanceTo(s)}),0!==o.length){this._loading||(this._loading=!0,this.fire("loading"));var m=document.createDocumentFragment();for(d=0;d<o.length;d++)this._addTile(o[d],m);this._level.el.appendChild(m)}}}}},_isValidTile:function(e){var t=this._map.options.crs;if(!t.infinite){var n=this._globalTileRange;if(!t.wrapLng&&(e.x<n.min.x||e.x>n.max.x)||!t.wrapLat&&(e.y<n.min.y||e.y>n.max.y))return!1}if(!this.options.bounds)return!0;var i=this._tileCoordsToBounds(e);return U(this.options.bounds).overlaps(i)},_keyToBounds:function(e){return this._tileCoordsToBounds(this._keyToTileCoords(e))},_tileCoordsToNwSe:function(e){var t=this._map,n=this.getTileSize(),i=e.scaleBy(n),r=i.add(n);return[t.unproject(i,e.z),t.unproject(r,e.z)]},_tileCoordsToBounds:function(e){var t=this._tileCoordsToNwSe(e),n=new F(t[0],t[1]);return this.options.noWrap||(n=this._map.wrapLatLngBounds(n)),n},_tileCoordsToKey:function(e){return e.x+":"+e.y+":"+e.z},_keyToTileCoords:function(e){var t=e.split(":"),n=new R(+t[0],+t[1]);return n.z=+t[2],n},_removeTile:function(e){var t=this._tiles[e];t&&(pt(t.el),delete this._tiles[e],this.fire("tileunload",{tile:t.el,coords:this._keyToTileCoords(e)}))},_initTile:function(e){yt(e,"leaflet-tile");var t=this.getTileSize();e.style.width=t.x+"px",e.style.height=t.y+"px",e.onselectstart=c,e.onmousemove=c,Me.ielt9&&this.options.opacity<1&&Tt(e,this.options.opacity)},_addTile:function(e,t){var n=this._getTilePos(e),i=this._tileCoordsToKey(e),s=this.createTile(this._wrapCoords(e),r(this._tileReady,this,e));this._initTile(s),this.createTile.length<2&&x(r(this._tileReady,this,e,null,s)),It(s,n),this._tiles[i]={el:s,coords:e,current:!0},t.appendChild(s),this.fire("tileloadstart",{tile:s,coords:e})},_tileReady:function(e,t,n){t&&this.fire("tileerror",{error:t,tile:n,coords:e});var i=this._tileCoordsToKey(e);(n=this._tiles[i])&&(n.loaded=+new Date,this._map._fadeAnimated?(Tt(n.el,0),S(this._fadeFrame),this._fadeFrame=x(this._updateOpacity,this)):(n.active=!0,this._pruneTiles()),t||(yt(n.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:n.el,coords:e})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Me.ielt9||!this._map._fadeAnimated?x(this._pruneTiles,this):setTimeout(r(this._pruneTiles,this),250)))},_getTilePos:function(e){return e.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(e){var t=new R(this._wrapX?l(e.x,this._wrapX):e.x,this._wrapY?l(e.y,this._wrapY):e.y);return t.z=e.z,t},_pxBoundsToTileRange:function(e){var t=this.getTileSize();return new M(e.min.unscaleBy(t).floor(),e.max.unscaleBy(t).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var e in this._tiles)if(!this._tiles[e].loaded)return!1;return!0}});function Fi(e){return new ji(e)}var Ui=ji.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(e,t){this._url=e,(t=f(this,t)).detectRetina&&Me.retina&&t.maxZoom>0?(t.tileSize=Math.floor(t.tileSize/2),t.zoomReverse?(t.zoomOffset--,t.minZoom=Math.min(t.maxZoom,t.minZoom+1)):(t.zoomOffset++,t.maxZoom=Math.max(t.minZoom,t.maxZoom-1)),t.minZoom=Math.max(0,t.minZoom)):t.zoomReverse?t.minZoom=Math.min(t.maxZoom,t.minZoom):t.maxZoom=Math.max(t.minZoom,t.maxZoom),"string"===typeof t.subdomains&&(t.subdomains=t.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(e,t){return this._url===e&&void 0===t&&(t=!0),this._url=e,t||this.redraw(),this},createTile:function(e,t){var n=document.createElement("img");return jt(n,"load",r(this._tileOnLoad,this,t,n)),jt(n,"error",r(this._tileOnError,this,t,n)),(this.options.crossOrigin||""===this.options.crossOrigin)&&(n.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),"string"===typeof this.options.referrerPolicy&&(n.referrerPolicy=this.options.referrerPolicy),n.alt="",n.src=this.getTileUrl(e),n},getTileUrl:function(e){var t={r:Me.retina?"@2x":"",s:this._getSubdomain(e),x:e.x,y:e.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var i=this._globalTileRange.max.y-e.y;this.options.tms&&(t.y=i),t["-y"]=i}return g(this._url,n(t,this.options))},_tileOnLoad:function(e,t){Me.ielt9?setTimeout(r(e,this,null,t),0):e(null,t)},_tileOnError:function(e,t,n){var i=this.options.errorTileUrl;i&&t.getAttribute("src")!==i&&(t.src=i),e(n,t)},_onTileRemove:function(e){e.tile.onload=null},_getZoomForUrl:function(){var e=this._tileZoom,t=this.options.maxZoom;return this.options.zoomReverse&&(e=t-e),e+this.options.zoomOffset},_getSubdomain:function(e){var t=Math.abs(e.x+e.y)%this.options.subdomains.length;return this.options.subdomains[t]},_abortLoading:function(){var e,t;for(e in this._tiles)if(this._tiles[e].coords.z!==this._tileZoom&&((t=this._tiles[e].el).onload=c,t.onerror=c,!t.complete)){t.src=y;var n=this._tiles[e].coords;pt(t),delete this._tiles[e],this.fire("tileabort",{tile:t,coords:n})}},_removeTile:function(e){var t=this._tiles[e];if(t)return t.el.setAttribute("src",y),ji.prototype._removeTile.call(this,e)},_tileReady:function(e,t,n){if(this._map&&(!n||n.getAttribute("src")!==y))return ji.prototype._tileReady.call(this,e,t,n)}});function zi(e,t){return new Ui(e,t)}var Bi=Ui.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(e,t){this._url=e;var i=n({},this.defaultWmsParams);for(var r in t)r in this.options||(i[r]=t[r]);var s=(t=f(this,t)).detectRetina&&Me.retina?2:1,o=this.getTileSize();i.width=o.x*s,i.height=o.y*s,this.wmsParams=i},onAdd:function(e){this._crs=this.options.crs||e.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var t=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[t]=this._crs.code,Ui.prototype.onAdd.call(this,e)},getTileUrl:function(e){var t=this._tileCoordsToNwSe(e),n=this._crs,i=j(n.project(t[0]),n.project(t[1])),r=i.min,s=i.max,o=(this._wmsVersion>=1.3&&this._crs===Hn?[r.y,r.x,s.y,s.x]:[r.x,r.y,s.x,s.y]).join(","),a=Ui.prototype.getTileUrl.call(this,e);return a+p(this.wmsParams,a,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+o},setParams:function(e,t){return n(this.wmsParams,e),t||this.redraw(),this}});function Vi(e,t){return new Bi(e,t)}Ui.WMS=Bi,zi.wms=Vi;var qi=Kn.extend({options:{padding:.1},initialize:function(e){f(this,e),o(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),yt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var e={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(e.zoomanim=this._onAnimZoom),e},_onAnimZoom:function(e){this._updateTransform(e.center,e.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(e,t){var n=this._map.getZoomScale(t,this._zoom),i=this._map.getSize().multiplyBy(.5+this.options.padding),r=this._map.project(this._center,t),s=i.multiplyBy(-n).add(r).subtract(this._map._getNewPixelOrigin(e,t));Me.any3d?St(this._container,s,n):It(this._container,s)},_reset:function(){for(var e in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[e]._reset()},_onZoomEnd:function(){for(var e in this._layers)this._layers[e]._project()},_updatePaths:function(){for(var e in this._layers)this._layers[e]._update()},_update:function(){var e=this.options.padding,t=this._map.getSize(),n=this._map.containerPointToLayerPoint(t.multiplyBy(-e)).round();this._bounds=new M(n,n.add(t.multiplyBy(1+2*e)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Hi=qi.extend({options:{tolerance:0},getEvents:function(){var e=qi.prototype.getEvents.call(this);return e.viewprereset=this._onViewPreReset,e},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){qi.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var e=this._container=document.createElement("canvas");jt(e,"mousemove",this._onMouseMove,this),jt(e,"click dblclick mousedown mouseup contextmenu",this._onClick,this),jt(e,"mouseout",this._handleMouseOut,this),e._leaflet_disable_events=!0,this._ctx=e.getContext("2d")},_destroyContainer:function(){S(this._redrawRequest),delete this._ctx,pt(this._container),Ut(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var e in this._redrawBounds=null,this._layers)this._layers[e]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){qi.prototype._update.call(this);var e=this._bounds,t=this._container,n=e.getSize(),i=Me.retina?2:1;It(t,e.min),t.width=i*n.x,t.height=i*n.y,t.style.width=n.x+"px",t.style.height=n.y+"px",Me.retina&&this._ctx.scale(2,2),this._ctx.translate(-e.min.x,-e.min.y),this.fire("update")}},_reset:function(){qi.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(e){this._updateDashArray(e),this._layers[o(e)]=e;var t=e._order={layer:e,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=t),this._drawLast=t,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(e){this._requestRedraw(e)},_removePath:function(e){var t=e._order,n=t.next,i=t.prev;n?n.prev=i:this._drawLast=i,i?i.next=n:this._drawFirst=n,delete e._order,delete this._layers[o(e)],this._requestRedraw(e)},_updatePath:function(e){this._extendRedrawBounds(e),e._project(),e._update(),this._requestRedraw(e)},_updateStyle:function(e){this._updateDashArray(e),this._requestRedraw(e)},_updateDashArray:function(e){if("string"===typeof e.options.dashArray){var t,n,i=e.options.dashArray.split(/[, ]+/),r=[];for(n=0;n<i.length;n++){if(t=Number(i[n]),isNaN(t))return;r.push(t)}e.options._dashArray=r}else e.options._dashArray=e.options.dashArray},_requestRedraw:function(e){this._map&&(this._extendRedrawBounds(e),this._redrawRequest=this._redrawRequest||x(this._redraw,this))},_extendRedrawBounds:function(e){if(e._pxBounds){var t=(e.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new M,this._redrawBounds.extend(e._pxBounds.min.subtract([t,t])),this._redrawBounds.extend(e._pxBounds.max.add([t,t]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var e=this._redrawBounds;if(e){var t=e.getSize();this._ctx.clearRect(e.min.x,e.min.y,t.x,t.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var e,t=this._redrawBounds;if(this._ctx.save(),t){var n=t.getSize();this._ctx.beginPath(),this._ctx.rect(t.min.x,t.min.y,n.x,n.y),this._ctx.clip()}this._drawing=!0;for(var i=this._drawFirst;i;i=i.next)e=i.layer,(!t||e._pxBounds&&e._pxBounds.intersects(t))&&e._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(e,t){if(this._drawing){var n,i,r,s,o=e._parts,a=o.length,l=this._ctx;if(a){for(l.beginPath(),n=0;n<a;n++){for(i=0,r=o[n].length;i<r;i++)s=o[n][i],l[i?"lineTo":"moveTo"](s.x,s.y);t&&l.closePath()}this._fillStroke(l,e)}}},_updateCircle:function(e){if(this._drawing&&!e._empty()){var t=e._point,n=this._ctx,i=Math.max(Math.round(e._radius),1),r=(Math.max(Math.round(e._radiusY),1)||i)/i;1!==r&&(n.save(),n.scale(1,r)),n.beginPath(),n.arc(t.x,t.y/r,i,0,2*Math.PI,!1),1!==r&&n.restore(),this._fillStroke(n,e)}},_fillStroke:function(e,t){var n=t.options;n.fill&&(e.globalAlpha=n.fillOpacity,e.fillStyle=n.fillColor||n.color,e.fill(n.fillRule||"evenodd")),n.stroke&&0!==n.weight&&(e.setLineDash&&e.setLineDash(t.options&&t.options._dashArray||[]),e.globalAlpha=n.opacity,e.lineWidth=n.weight,e.strokeStyle=n.color,e.lineCap=n.lineCap,e.lineJoin=n.lineJoin,e.stroke())},_onClick:function(e){for(var t,n,i=this._map.mouseEventToLayerPoint(e),r=this._drawFirst;r;r=r.next)(t=r.layer).options.interactive&&t._containsPoint(i)&&("click"!==e.type&&"preclick"!==e.type||!this._map._draggableMoved(t))&&(n=t);this._fireEvent(!!n&&[n],e)},_onMouseMove:function(e){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var t=this._map.mouseEventToLayerPoint(e);this._handleMouseHover(e,t)}},_handleMouseOut:function(e){var t=this._hoveredLayer;t&&(wt(this._container,"leaflet-interactive"),this._fireEvent([t],e,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(e,t){if(!this._mouseHoverThrottled){for(var n,i,s=this._drawFirst;s;s=s.next)(n=s.layer).options.interactive&&n._containsPoint(t)&&(i=n);i!==this._hoveredLayer&&(this._handleMouseOut(e),i&&(yt(this._container,"leaflet-interactive"),this._fireEvent([i],e,"mouseover"),this._hoveredLayer=i)),this._fireEvent(!!this._hoveredLayer&&[this._hoveredLayer],e),this._mouseHoverThrottled=!0,setTimeout(r(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(e,t,n){this._map._fireDOMEvent(t,n||t.type,e)},_bringToFront:function(e){var t=e._order;if(t){var n=t.next,i=t.prev;n&&(n.prev=i,i?i.next=n:n&&(this._drawFirst=n),t.prev=this._drawLast,this._drawLast.next=t,t.next=null,this._drawLast=t,this._requestRedraw(e))}},_bringToBack:function(e){var t=e._order;if(t){var n=t.next,i=t.prev;i&&(i.next=n,n?n.prev=i:i&&(this._drawLast=i),t.prev=null,t.next=this._drawFirst,this._drawFirst.prev=t,this._drawFirst=t,this._requestRedraw(e))}}});function Wi(e){return Me.canvas?new Hi(e):null}var Ki=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(e){return document.createElement("<lvml:"+e+' class="lvml">')}}catch(e){}return function(e){return document.createElement("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Gi={_initContainer:function(){this._container=ft("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(qi.prototype._update.call(this),this.fire("update"))},_initPath:function(e){var t=e._container=Ki("shape");yt(t,"leaflet-vml-shape "+(this.options.className||"")),t.coordsize="1 1",e._path=Ki("path"),t.appendChild(e._path),this._updateStyle(e),this._layers[o(e)]=e},_addPath:function(e){var t=e._container;this._container.appendChild(t),e.options.interactive&&e.addInteractiveTarget(t)},_removePath:function(e){var t=e._container;pt(t),e.removeInteractiveTarget(t),delete this._layers[o(e)]},_updateStyle:function(e){var t=e._stroke,n=e._fill,i=e.options,r=e._container;r.stroked=!!i.stroke,r.filled=!!i.fill,i.stroke?(t||(t=e._stroke=Ki("stroke")),r.appendChild(t),t.weight=i.weight+"px",t.color=i.color,t.opacity=i.opacity,i.dashArray?t.dashStyle=_(i.dashArray)?i.dashArray.join(" "):i.dashArray.replace(/( *, *)/g," "):t.dashStyle="",t.endcap=i.lineCap.replace("butt","flat"),t.joinstyle=i.lineJoin):t&&(r.removeChild(t),e._stroke=null),i.fill?(n||(n=e._fill=Ki("fill")),r.appendChild(n),n.color=i.fillColor||i.color,n.opacity=i.fillOpacity):n&&(r.removeChild(n),e._fill=null)},_updateCircle:function(e){var t=e._point.round(),n=Math.round(e._radius),i=Math.round(e._radiusY||n);this._setPath(e,e._empty()?"M0 0":"AL "+t.x+","+t.y+" "+n+","+i+" 0,23592600")},_setPath:function(e,t){e._path.v=t},_bringToFront:function(e){gt(e._container)},_bringToBack:function(e){_t(e._container)}},Zi=Me.vml?Ki:Y,Qi=qi.extend({_initContainer:function(){this._container=Zi("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Zi("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){pt(this._container),Ut(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!this._map._animatingZoom||!this._bounds){qi.prototype._update.call(this);var e=this._bounds,t=e.getSize(),n=this._container;this._svgSize&&this._svgSize.equals(t)||(this._svgSize=t,n.setAttribute("width",t.x),n.setAttribute("height",t.y)),It(n,e.min),n.setAttribute("viewBox",[e.min.x,e.min.y,t.x,t.y].join(" ")),this.fire("update")}},_initPath:function(e){var t=e._path=Zi("path");e.options.className&&yt(t,e.options.className),e.options.interactive&&yt(t,"leaflet-interactive"),this._updateStyle(e),this._layers[o(e)]=e},_addPath:function(e){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(e._path),e.addInteractiveTarget(e._path)},_removePath:function(e){pt(e._path),e.removeInteractiveTarget(e._path),delete this._layers[o(e)]},_updatePath:function(e){e._project(),e._update()},_updateStyle:function(e){var t=e._path,n=e.options;t&&(n.stroke?(t.setAttribute("stroke",n.color),t.setAttribute("stroke-opacity",n.opacity),t.setAttribute("stroke-width",n.weight),t.setAttribute("stroke-linecap",n.lineCap),t.setAttribute("stroke-linejoin",n.lineJoin),n.dashArray?t.setAttribute("stroke-dasharray",n.dashArray):t.removeAttribute("stroke-dasharray"),n.dashOffset?t.setAttribute("stroke-dashoffset",n.dashOffset):t.removeAttribute("stroke-dashoffset")):t.setAttribute("stroke","none"),n.fill?(t.setAttribute("fill",n.fillColor||n.color),t.setAttribute("fill-opacity",n.fillOpacity),t.setAttribute("fill-rule",n.fillRule||"evenodd")):t.setAttribute("fill","none"))},_updatePoly:function(e,t){this._setPath(e,J(e._parts,t))},_updateCircle:function(e){var t=e._point,n=Math.max(Math.round(e._radius),1),i="a"+n+","+(Math.max(Math.round(e._radiusY),1)||n)+" 0 1,0 ",r=e._empty()?"M0 0":"M"+(t.x-n)+","+t.y+i+2*n+",0 "+i+2*-n+",0 ";this._setPath(e,r)},_setPath:function(e,t){e._path.setAttribute("d",t)},_bringToFront:function(e){gt(e._path)},_bringToBack:function(e){_t(e._path)}});function Yi(e){return Me.svg||Me.vml?new Qi(e):null}Me.vml&&Qi.include(Gi),nn.include({getRenderer:function(e){var t=e.options.renderer||this._getPaneRenderer(e.options.pane)||this.options.renderer||this._renderer;return t||(t=this._renderer=this._createRenderer()),this.hasLayer(t)||this.addLayer(t),t},_getPaneRenderer:function(e){if("overlayPane"===e||void 0===e)return!1;var t=this._paneRenderers[e];return void 0===t&&(t=this._createRenderer({pane:e}),this._paneRenderers[e]=t),t},_createRenderer:function(e){return this.options.preferCanvas&&Wi(e)||Yi(e)}});var Ji=ui.extend({initialize:function(e,t){ui.prototype.initialize.call(this,this._boundsToLatLngs(e),t)},setBounds:function(e){return this.setLatLngs(this._boundsToLatLngs(e))},_boundsToLatLngs:function(e){return[(e=U(e)).getSouthWest(),e.getNorthWest(),e.getNorthEast(),e.getSouthEast()]}});function Xi(e,t){return new Ji(e,t)}Qi.create=Zi,Qi.pointsToPath=J,di.geometryToLayer=fi,di.coordsToLatLng=mi,di.coordsToLatLngs=gi,di.latLngToCoords=_i,di.latLngsToCoords=vi,di.getFeature=yi,di.asFeature=wi,nn.mergeOptions({boxZoom:!0});var $i=gn.extend({initialize:function(e){this._map=e,this._container=e._container,this._pane=e._panes.overlayPane,this._resetStateTimeout=0,e.on("unload",this._destroy,this)},addHooks:function(){jt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Ut(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){pt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(e){if(!e.shiftKey||1!==e.which&&1!==e.button)return!1;this._clearDeferredResetState(),this._resetState(),it(),Nt(),this._startPoint=this._map.mouseEventToContainerPoint(e),jt(document,{contextmenu:Zt,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(e){this._moved||(this._moved=!0,this._box=ft("div","leaflet-zoom-box",this._container),yt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(e);var t=new M(this._point,this._startPoint),n=t.getSize();It(this._box,t.min),this._box.style.width=n.x+"px",this._box.style.height=n.y+"px"},_finish:function(){this._moved&&(pt(this._box),wt(this._container,"leaflet-crosshair")),rt(),At(),Ut(document,{contextmenu:Zt,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(e){if((1===e.which||1===e.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(r(this._resetState,this),0);var t=new F(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(t).fire("boxzoomend",{boxZoomBounds:t})}},_onKeyDown:function(e){27===e.keyCode&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});nn.addInitHook("addHandler","boxZoom",$i),nn.mergeOptions({doubleClickZoom:!0});var er=gn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(e){var t=this._map,n=t.getZoom(),i=t.options.zoomDelta,r=e.originalEvent.shiftKey?n-i:n+i;"center"===t.options.doubleClickZoom?t.setZoom(r):t.setZoomAround(e.containerPoint,r)}});nn.addInitHook("addHandler","doubleClickZoom",er),nn.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var tr=gn.extend({addHooks:function(){if(!this._draggable){var e=this._map;this._draggable=new yn(e._mapPane,e._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),e.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),e.on("zoomend",this._onZoomEnd,this),e.whenReady(this._onZoomEnd,this))}yt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){wt(this._map._container,"leaflet-grab"),wt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var e=this._map;if(e._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var t=U(this._map.options.maxBounds);this._offsetLimit=j(this._map.latLngToContainerPoint(t.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(t.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;e.fire("movestart").fire("dragstart"),e.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(e){if(this._map.options.inertia){var t=this._lastTime=+new Date,n=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(n),this._times.push(t),this._prunePositions(t)}this._map.fire("move",e).fire("drag",e)},_prunePositions:function(e){for(;this._positions.length>1&&e-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var e=this._map.getSize().divideBy(2),t=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=t.subtract(e).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(e,t){return e-(e-t)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var e=this._draggable._newPos.subtract(this._draggable._startPos),t=this._offsetLimit;e.x<t.min.x&&(e.x=this._viscousLimit(e.x,t.min.x)),e.y<t.min.y&&(e.y=this._viscousLimit(e.y,t.min.y)),e.x>t.max.x&&(e.x=this._viscousLimit(e.x,t.max.x)),e.y>t.max.y&&(e.y=this._viscousLimit(e.y,t.max.y)),this._draggable._newPos=this._draggable._startPos.add(e)}},_onPreDragWrap:function(){var e=this._worldWidth,t=Math.round(e/2),n=this._initialWorldOffset,i=this._draggable._newPos.x,r=(i-t+n)%e+t-n,s=(i+t+n)%e-t-n,o=Math.abs(r+n)<Math.abs(s+n)?r:s;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=o},_onDragEnd:function(e){var t=this._map,n=t.options,i=!n.inertia||e.noInertia||this._times.length<2;if(t.fire("dragend",e),i)t.fire("moveend");else{this._prunePositions(+new Date);var r=this._lastPos.subtract(this._positions[0]),s=(this._lastTime-this._times[0])/1e3,o=n.easeLinearity,a=r.multiplyBy(o/s),l=a.distanceTo([0,0]),c=Math.min(n.inertiaMaxSpeed,l),u=a.multiplyBy(c/l),h=c/(n.inertiaDeceleration*o),d=u.multiplyBy(-h/2).round();d.x||d.y?(d=t._limitOffset(d,t.options.maxBounds),x(function(){t.panBy(d,{duration:h,easeLinearity:o,noMoveStart:!0,animate:!0})})):t.fire("moveend")}}});nn.addInitHook("addHandler","dragging",tr),nn.mergeOptions({keyboard:!0,keyboardPanDelta:80});var nr=gn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(e){this._map=e,this._setPanDelta(e.options.keyboardPanDelta),this._setZoomDelta(e.options.zoomDelta)},addHooks:function(){var e=this._map._container;e.tabIndex<=0&&(e.tabIndex="0"),jt(e,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Ut(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var e=document.body,t=document.documentElement,n=e.scrollTop||t.scrollTop,i=e.scrollLeft||t.scrollLeft;this._map._container.focus(),window.scrollTo(i,n)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(e){var t,n,i=this._panKeys={},r=this.keyCodes;for(t=0,n=r.left.length;t<n;t++)i[r.left[t]]=[-1*e,0];for(t=0,n=r.right.length;t<n;t++)i[r.right[t]]=[e,0];for(t=0,n=r.down.length;t<n;t++)i[r.down[t]]=[0,e];for(t=0,n=r.up.length;t<n;t++)i[r.up[t]]=[0,-1*e]},_setZoomDelta:function(e){var t,n,i=this._zoomKeys={},r=this.keyCodes;for(t=0,n=r.zoomIn.length;t<n;t++)i[r.zoomIn[t]]=e;for(t=0,n=r.zoomOut.length;t<n;t++)i[r.zoomOut[t]]=-e},_addHooks:function(){jt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Ut(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(e){if(!(e.altKey||e.ctrlKey||e.metaKey)){var t,n=e.keyCode,i=this._map;if(n in this._panKeys){if(!i._panAnim||!i._panAnim._inProgress)if(t=this._panKeys[n],e.shiftKey&&(t=D(t).multiplyBy(3)),i.options.maxBounds&&(t=i._limitOffset(D(t),i.options.maxBounds)),i.options.worldCopyJump){var r=i.wrapLatLng(i.unproject(i.project(i.getCenter()).add(t)));i.panTo(r)}else i.panBy(t)}else if(n in this._zoomKeys)i.setZoom(i.getZoom()+(e.shiftKey?3:1)*this._zoomKeys[n]);else{if(27!==n||!i._popup||!i._popup.options.closeOnEscapeKey)return;i.closePopup()}Zt(e)}}});nn.addInitHook("addHandler","keyboard",nr),nn.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var ir=gn.extend({addHooks:function(){jt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Ut(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(e){var t=Xt(e),n=this._map.options.wheelDebounceTime;this._delta+=t,this._lastMousePos=this._map.mouseEventToContainerPoint(e),this._startTime||(this._startTime=+new Date);var i=Math.max(n-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(r(this._performZoom,this),i),Zt(e)},_performZoom:function(){var e=this._map,t=e.getZoom(),n=this._map.options.zoomSnap||0;e._stop();var i=this._delta/(4*this._map.options.wheelPxPerZoomLevel),r=4*Math.log(2/(1+Math.exp(-Math.abs(i))))/Math.LN2,s=n?Math.ceil(r/n)*n:r,o=e._limitZoom(t+(this._delta>0?s:-s))-t;this._delta=0,this._startTime=null,o&&("center"===e.options.scrollWheelZoom?e.setZoom(t+o):e.setZoomAround(this._lastMousePos,t+o))}});nn.addInitHook("addHandler","scrollWheelZoom",ir);var rr=600;nn.mergeOptions({tapHold:Me.touchNative&&Me.safari&&Me.mobile,tapTolerance:15});var sr=gn.extend({addHooks:function(){jt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Ut(this._map._container,"touchstart",this._onDown,this)},_onDown:function(e){if(clearTimeout(this._holdTimeout),1===e.touches.length){var t=e.touches[0];this._startPos=this._newPos=new R(t.clientX,t.clientY),this._holdTimeout=setTimeout(r(function(){this._cancel(),this._isTapValid()&&(jt(document,"touchend",Gt),jt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",t))},this),rr),jt(document,"touchend touchcancel contextmenu",this._cancel,this),jt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function e(){Ut(document,"touchend",Gt),Ut(document,"touchend touchcancel",e)},_cancel:function(){clearTimeout(this._holdTimeout),Ut(document,"touchend touchcancel contextmenu",this._cancel,this),Ut(document,"touchmove",this._onMove,this)},_onMove:function(e){var t=e.touches[0];this._newPos=new R(t.clientX,t.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(e,t){var n=new MouseEvent(e,{bubbles:!0,cancelable:!0,view:window,screenX:t.screenX,screenY:t.screenY,clientX:t.clientX,clientY:t.clientY});n._simulated=!0,t.target.dispatchEvent(n)}});nn.addInitHook("addHandler","tapHold",sr),nn.mergeOptions({touchZoom:Me.touch,bounceAtZoomLimits:!0});var or=gn.extend({addHooks:function(){yt(this._map._container,"leaflet-touch-zoom"),jt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){wt(this._map._container,"leaflet-touch-zoom"),Ut(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(e){var t=this._map;if(e.touches&&2===e.touches.length&&!t._animatingZoom&&!this._zooming){var n=t.mouseEventToContainerPoint(e.touches[0]),i=t.mouseEventToContainerPoint(e.touches[1]);this._centerPoint=t.getSize()._divideBy(2),this._startLatLng=t.containerPointToLatLng(this._centerPoint),"center"!==t.options.touchZoom&&(this._pinchStartLatLng=t.containerPointToLatLng(n.add(i)._divideBy(2))),this._startDist=n.distanceTo(i),this._startZoom=t.getZoom(),this._moved=!1,this._zooming=!0,t._stop(),jt(document,"touchmove",this._onTouchMove,this),jt(document,"touchend touchcancel",this._onTouchEnd,this),Gt(e)}},_onTouchMove:function(e){if(e.touches&&2===e.touches.length&&this._zooming){var t=this._map,n=t.mouseEventToContainerPoint(e.touches[0]),i=t.mouseEventToContainerPoint(e.touches[1]),s=n.distanceTo(i)/this._startDist;if(this._zoom=t.getScaleZoom(s,this._startZoom),!t.options.bounceAtZoomLimits&&(this._zoom<t.getMinZoom()&&s<1||this._zoom>t.getMaxZoom()&&s>1)&&(this._zoom=t._limitZoom(this._zoom)),"center"===t.options.touchZoom){if(this._center=this._startLatLng,1===s)return}else{var o=n._add(i)._divideBy(2)._subtract(this._centerPoint);if(1===s&&0===o.x&&0===o.y)return;this._center=t.unproject(t.project(this._pinchStartLatLng,this._zoom).subtract(o),this._zoom)}this._moved||(t._moveStart(!0,!1),this._moved=!0),S(this._animRequest);var a=r(t._move,t,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=x(a,this,!0),Gt(e)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,S(this._animRequest),Ut(document,"touchmove",this._onTouchMove,this),Ut(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});nn.addInitHook("addHandler","touchZoom",or),nn.BoxZoom=$i,nn.DoubleClickZoom=er,nn.Drag=tr,nn.Keyboard=nr,nn.ScrollWheelZoom=ir,nn.TapHold=sr,nn.TouchZoom=or,e.Bounds=M,e.Browser=Me,e.CRS=V,e.Canvas=Hi,e.Circle=oi,e.CircleMarker=ri,e.Class=k,e.Control=sn,e.DivIcon=Di,e.DivOverlay=Ni,e.DomEvent=en,e.DomUtil=Mt,e.Draggable=yn,e.Evented=A,e.FeatureGroup=Qn,e.GeoJSON=di,e.GridLayer=ji,e.Handler=gn,e.Icon=Jn,e.ImageOverlay=Ci,e.LatLng=z,e.LatLngBounds=F,e.Layer=Kn,e.LayerGroup=Gn,e.LineUtil=Un,e.Map=nn,e.Marker=ti,e.Mixin=_n,e.Path=ii,e.Point=R,e.PolyUtil=Cn,e.Polygon=ui,e.Polyline=li,e.Popup=Ai,e.PosAnimation=tn,e.Projection=Vn,e.Rectangle=Ji,e.Renderer=qi,e.SVG=Qi,e.SVGOverlay=ki,e.TileLayer=Ui,e.Tooltip=Li,e.Transformation=K,e.Util=I,e.VideoOverlay=Si,e.bind=r,e.bounds=j,e.canvas=Wi,e.circle=ai,e.circleMarker=si,e.control=on,e.divIcon=Mi,e.extend=n,e.featureGroup=Yn,e.geoJSON=Ei,e.geoJson=Ti,e.gridLayer=Fi,e.icon=Xn,e.imageOverlay=xi,e.latLng=B,e.latLngBounds=U,e.layerGroup=Zn,e.map=rn,e.marker=ni,e.point=D,e.polygon=hi,e.polyline=ci,e.popup=Ri,e.rectangle=Xi,e.setOptions=f,e.stamp=o,e.svg=Yi,e.svgOverlay=Pi,e.tileLayer=zi,e.tooltip=Oi,e.transformation=G,e.version=t,e.videoOverlay=Ii;var ar=window.L;e.noConflict=function(){return window.L=ar,this},window.L=e}(t)},234:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,r=e[i];if(!(0<s(r,t)))break e;e[i]=t,e[n]=r,n=i}}function i(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,r=e.length,o=r>>>1;i<o;){var a=2*(i+1)-1,l=e[a],c=a+1,u=e[c];if(0>s(l,n))c<r&&0>s(u,l)?(e[i]=u,e[c]=n,i=c):(e[i]=l,e[a]=n,i=a);else{if(!(c<r&&0>s(u,n)))break e;e[i]=u,e[c]=n,i=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],h=1,d=null,f=3,p=!1,m=!1,g=!1,_="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,y="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=i(u);null!==t;){if(null===t.callback)r(u);else{if(!(t.startTime<=e))break;r(u),t.sortIndex=t.expirationTime,n(c,t)}t=i(u)}}function b(e){if(g=!1,w(e),!m)if(null!==i(c))m=!0,L(E);else{var t=i(u);null!==t&&O(b,t.startTime-e)}}function E(e,n){m=!1,g&&(g=!1,v(S),S=-1),p=!0;var s=f;try{for(w(n),d=i(c);null!==d&&(!(d.expirationTime>n)||e&&!P());){var o=d.callback;if("function"===typeof o){d.callback=null,f=d.priorityLevel;var a=o(d.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?d.callback=a:d===i(c)&&r(c),w(n)}else r(c);d=i(c)}if(null!==d)var l=!0;else{var h=i(u);null!==h&&O(b,h.startTime-n),l=!1}return l}finally{d=null,f=s,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var T,C=!1,x=null,S=-1,I=5,k=-1;function P(){return!(t.unstable_now()-k<I)}function N(){if(null!==x){var e=t.unstable_now();k=e;var n=!0;try{n=x(!0,e)}finally{n?T():(C=!1,x=null)}}else C=!1}if("function"===typeof y)T=function(){y(N)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,R=A.port2;A.port1.onmessage=N,T=function(){R.postMessage(null)}}else T=function(){_(N,0)};function L(e){x=e,C||(C=!0,T())}function O(e,n){S=_(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,L(E))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return i(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,r,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:h++,callback:r,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(e.sortIndex=s,n(u,e),null===i(c)&&e===i(u)&&(g?(v(S),S=-1):g=!0,O(b,s-o))):(e.sortIndex=a,n(c,e),m||p||(m=!0,L(E))),e},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},391:(e,t,n)=>{"use strict";var i=n(950);t.createRoot=i.createRoot,t.hydrateRoot=i.hydrateRoot},403:(e,t,n)=>{"use strict";var i;n.d(t,{E_:()=>l,F3:()=>a,Ii:()=>o}),function(e){e.Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE"}(i||(i={}));class r extends Error{constructor(e,t,n){super(e),this.message=e,this.code=t,this.data=n}}const s=e=>{const t=e.CapacitorCustomPlatform||null,n=e.Capacitor||{},s=n.Plugins=n.Plugins||{},o=()=>null!==t?t.name:(e=>{var t,n;return(null===e||void 0===e?void 0:e.androidBridge)?"android":(null===(n=null===(t=null===e||void 0===e?void 0:e.webkit)||void 0===t?void 0:t.messageHandlers)||void 0===n?void 0:n.bridge)?"ios":"web"})(e),a=e=>{var t;return null===(t=n.PluginHeaders)||void 0===t?void 0:t.find(t=>t.name===e)},l=new Map;return n.convertFileSrc||(n.convertFileSrc=e=>e),n.getPlatform=o,n.handleError=t=>e.console.error(t),n.isNativePlatform=()=>"web"!==o(),n.isPluginAvailable=e=>{const t=l.get(e);return!!(null===t||void 0===t?void 0:t.platforms.has(o()))||!!a(e)},n.registerPlugin=function(e){let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const u=l.get(e);if(u)return console.warn('Capacitor plugin "'.concat(e,'" already registered. Cannot register plugins twice.')),u.proxy;const h=o(),d=a(e);let f;const p=s=>{let o;const a=function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];const p=(async()=>(!f&&h in c?f=f="function"===typeof c[h]?await c[h]():c[h]:null!==t&&!f&&"web"in c&&(f=f="function"===typeof c.web?await c.web():c.web),f))().then(t=>{const a=((t,s)=>{var o,a;if(!d){if(t)return null===(a=t[s])||void 0===a?void 0:a.bind(t);throw new r('"'.concat(e,'" plugin is not implemented on ').concat(h),i.Unimplemented)}{const i=null===d||void 0===d?void 0:d.methods.find(e=>s===e.name);if(i)return"promise"===i.rtype?t=>n.nativePromise(e,s.toString(),t):(t,i)=>n.nativeCallback(e,s.toString(),t,i);if(t)return null===(o=t[s])||void 0===o?void 0:o.bind(t)}})(t,s);if(a){const e=a(...l);return o=null===e||void 0===e?void 0:e.remove,e}throw new r('"'.concat(e,".").concat(s,'()" is not implemented on ').concat(h),i.Unimplemented)});return"addListener"===s&&(p.remove=async()=>o()),p};return a.toString=()=>"".concat(s.toString(),"() { [capacitor code] }"),Object.defineProperty(a,"name",{value:s,writable:!1,configurable:!1}),a},m=p("addListener"),g=p("removeListener"),_=(e,t)=>{const n=m({eventName:e},t),i=async()=>{const i=await n;g({eventName:e,callbackId:i},t)},r=new Promise(e=>n.then(()=>e({remove:i})));return r.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await i()},r},v=new Proxy({},{get(e,t){switch(t){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return d?_:m;case"removeListener":return g;default:return p(t)}}});return s[e]=v,l.set(e,{name:e,proxy:v,platforms:new Set([...Object.keys(c),...d?[h]:[]])}),v},n.Exception=r,n.DEBUG=!!n.DEBUG,n.isLoggingEnabled=!!n.isLoggingEnabled,n},o=(e=>e.Capacitor=s(e))("undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:{}),a=o.registerPlugin;class l{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let n=!1;this.listeners[e]||(this.listeners[e]=[],n=!0),this.listeners[e].push(t);const i=this.windowListeners[e];i&&!i.registered&&this.addWindowListener(i),n&&this.sendRetainedArgumentsForEvent(e);return Promise.resolve({remove:async()=>this.removeListener(e,t)})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,n){const i=this.listeners[e];if(i)i.forEach(e=>e(t));else if(n){let n=this.retainedEventArguments[e];n||(n=[]),n.push(t),this.retainedEventArguments[e]=n}}hasListeners(e){var t;return!!(null===(t=this.listeners[e])||void 0===t?void 0:t.length)}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:e=>{this.notifyListeners(t,e)}}}unimplemented(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"not implemented";return new o.Exception(e,i.Unimplemented)}unavailable(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"not available";return new o.Exception(e,i.Unavailable)}async removeListener(e,t){const n=this.listeners[e];if(!n)return;const i=n.indexOf(t);this.listeners[e].splice(i,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(t=>{this.notifyListeners(e,t)}))}}const c=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),u=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class h extends l{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach(e=>{if(e.length<=0)return;let[n,i]=e.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");n=u(n).trim(),i=u(i).trim(),t[n]=i}),t}async setCookie(e){try{const t=c(e.key),n=c(e.value),i="; expires=".concat((e.expires||"").replace("expires=","")),r=(e.path||"/").replace("path=",""),s=null!=e.url&&e.url.length>0?"domain=".concat(e.url):"";document.cookie="".concat(t,"=").concat(n||"").concat(i,"; path=").concat(r,"; ").concat(s,";")}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie="".concat(e.key,"=; Max-Age=0")}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,"=;expires=".concat((new Date).toUTCString(),";path=/"))}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}a("CapacitorCookies",{web:()=>new h});const d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Object.assign({method:e.method||"GET",headers:e.headers},t),i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=Object.keys(e);return Object.keys(e).map(e=>e.toLocaleLowerCase()).reduce((n,i,r)=>(n[i]=e[t[r]],n),{})}(e.headers),r=i["content-type"]||"";if("string"===typeof e.data)n.body=e.data;else if(r.includes("application/x-www-form-urlencoded")){const t=new URLSearchParams;for(const[n,i]of Object.entries(e.data||{}))t.set(n,i);n.body=t.toString()}else if(r.includes("multipart/form-data")||e.data instanceof FormData){const t=new FormData;if(e.data instanceof FormData)e.data.forEach((e,n)=>{t.append(n,e)});else for(const n of Object.keys(e.data))t.append(n,e.data[n]);n.body=t;const i=new Headers(n.headers);i.delete("content-type"),n.headers=i}else(r.includes("application/json")||"object"===typeof e.data)&&(n.body=JSON.stringify(e.data));return n};class f extends l{async request(e){const t=d(e,e.webFetchExtra),n=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e?Object.entries(e).reduce((e,n)=>{const[i,r]=n;let s,o;return Array.isArray(r)?(o="",r.forEach(e=>{s=t?encodeURIComponent(e):e,o+="".concat(i,"=").concat(s,"&")}),o.slice(0,-1)):(s=t?encodeURIComponent(r):r,o="".concat(i,"=").concat(s)),"".concat(e,"&").concat(o)},"").substr(1):null}(e.params,e.shouldEncodeUrlParams),i=n?"".concat(e.url,"?").concat(n):e.url,r=await fetch(i,t),s=r.headers.get("content-type")||"";let o,a,{responseType:l="text"}=r.ok?e:{};switch(s.includes("application/json")&&(l="json"),l){case"arraybuffer":case"blob":a=await r.blob(),o=await(async e=>new Promise((t,n)=>{const i=new FileReader;i.onload=()=>{const e=i.result;t(e.indexOf(",")>=0?e.split(",")[1]:e)},i.onerror=e=>n(e),i.readAsDataURL(e)}))(a);break;case"json":o=await r.json();break;default:o=await r.text()}const c={};return r.headers.forEach((e,t)=>{c[t]=e}),{data:o,headers:c,status:r.status,url:r.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}a("CapacitorHttp",{web:()=>new f})},579:(e,t,n)=>{"use strict";e.exports=n(153)},730:(e,t,n)=>{"use strict";var i=n(43),r=n(853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,a={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(a[e]=t,e=0;e<t.length;e++)o.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function m(e,t,n,i,r,s,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new m(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new m(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new m(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new m(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new m(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)});var _=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function y(e,t,n,i){var r=g.hasOwnProperty(t)?g[t]:null;(null!==r?0!==r.type:i||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,i){if(null===t||"undefined"===typeof t||function(e,t,n,i){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,r,i)&&(n=null),i||null===r?function(e){return!!h.call(p,e)||!h.call(f,e)&&(d.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=null===n?3!==r.type&&"":n:(t=r.attributeName,i=r.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(_,v);g[t]=new m(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(_,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(_,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)});var w=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,b=Symbol.for("react.element"),E=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),I=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),R=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var L=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var O=Symbol.iterator;function D(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=O&&e[O]||e["@@iterator"])?e:null}var M,j=Object.assign;function F(e){if(void 0===M)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);M=t&&t[1]||""}return"\n"+M+e}var U=!1;function z(e,t){if(!e||U)return"";U=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var i=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){i=c}e.call(t.prototype)}else{try{throw Error()}catch(c){i=c}e()}}catch(c){if(c&&i&&"string"===typeof c.stack){for(var r=c.stack.split("\n"),s=i.stack.split("\n"),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(1!==o||1!==a)do{if(o--,0>--a||r[o]!==s[a]){var l="\n"+r[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=a);break}}}finally{U=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?F(e):""}function B(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=z(e.type,!1);case 11:return e=z(e.type.render,!1);case 1:return e=z(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case T:return"Fragment";case E:return"Portal";case x:return"Profiler";case C:return"StrictMode";case P:return"Suspense";case N:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case I:return(e.displayName||"Context")+".Consumer";case S:return(e._context.displayName||"Context")+".Provider";case k:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case A:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case R:t=e._payload,e=e._init;try{return V(e(t))}catch(n){}}return null}function q(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function W(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function K(e){e._valueTracker||(e._valueTracker=function(e){var t=W(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){i=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(e){i=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function G(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=W(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function Z(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Q(e,t){var n=t.checked;return j({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Y(e,t){var n=null==t.defaultValue?"":t.defaultValue,i=null!=t.checked?t.checked:t.defaultChecked;n=H(null!=t.value?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&y(e,"checked",t,!1)}function X(e,t){J(e,t);var n=H(t.value),i=t.type;if(null!=n)"number"===i?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===i||"reset"===i)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function $(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!("submit"!==i&&"reset"!==i||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Z(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,i){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&i&&(e[n].defaultSelected=!0)}else{for(n=""+H(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(i&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function ie(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return j({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:H(n)}}function se(e,t){var n=H(t.value),i=H(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=i&&(e.defaultValue=""+i)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,he=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,i){MSApp.execUnsafeLocalFunction(function(){return ue(e,t)})}:ue);function de(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=me(n,t[n],i);"float"===n&&(n="cssFloat"),i?e.setProperty(n,r):e[n]=r}}Object.keys(fe).forEach(function(e){pe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]})});var _e=j({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(_e[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function ye(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function be(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ee=null,Te=null,Ce=null;function xe(e){if(e=yr(e)){if("function"!==typeof Ee)throw Error(s(280));var t=e.stateNode;t&&(t=br(t),Ee(e.stateNode,e.type,t))}}function Se(e){Te?Ce?Ce.push(e):Ce=[e]:Te=e}function Ie(){if(Te){var e=Te,t=Ce;if(Ce=Te=null,xe(e),t)for(e=0;e<t.length;e++)xe(t[e])}}function ke(e,t){return e(t)}function Pe(){}var Ne=!1;function Ae(e,t,n){if(Ne)return e(t,n);Ne=!0;try{return ke(e,t,n)}finally{Ne=!1,(null!==Te||null!==Ce)&&(Pe(),Ie())}}function Re(e,t){var n=e.stateNode;if(null===n)return null;var i=br(n);if(null===i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var Le=!1;if(u)try{var Oe={};Object.defineProperty(Oe,"passive",{get:function(){Le=!0}}),window.addEventListener("test",Oe,Oe),window.removeEventListener("test",Oe,Oe)}catch(ue){Le=!1}function De(e,t,n,i,r,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Me=!1,je=null,Fe=!1,Ue=null,ze={onError:function(e){Me=!0,je=e}};function Be(e,t,n,i,r,s,o,a,l){Me=!1,je=null,De.apply(ze,arguments)}function Ve(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function qe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(Ve(e)!==e)throw Error(s(188))}function We(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ve(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(null===r)break;var o=r.alternate;if(null===o){if(null!==(i=r.return)){n=i;continue}break}if(r.child===o.child){for(o=r.child;o;){if(o===n)return He(r),e;if(o===i)return He(r),t;o=o.sibling}throw Error(s(188))}if(n.return!==i.return)n=r,i=o;else{for(var a=!1,l=r.child;l;){if(l===n){a=!0,n=r,i=o;break}if(l===i){a=!0,i=r,n=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===n){a=!0,n=o,i=r;break}if(l===i){a=!0,i=o,n=r;break}l=l.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==i)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e))?Ke(e):null}function Ke(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ke(e);if(null!==t)return t;e=e.sibling}return null}var Ge=r.unstable_scheduleCallback,Ze=r.unstable_cancelCallback,Qe=r.unstable_shouldYield,Ye=r.unstable_requestPaint,Je=r.unstable_now,Xe=r.unstable_getCurrentPriorityLevel,$e=r.unstable_ImmediatePriority,et=r.unstable_UserBlockingPriority,tt=r.unstable_NormalPriority,nt=r.unstable_LowPriority,it=r.unstable_IdlePriority,rt=null,st=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(at(e)/lt|0)|0},at=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var n=e.pendingLanes;if(0===n)return 0;var i=0,r=e.suspendedLanes,s=e.pingedLanes,o=268435455&n;if(0!==o){var a=o&~r;0!==a?i=ht(a):0!==(s&=o)&&(i=ht(s))}else 0!==(o=n&~r)?i=ht(o):0!==s&&(i=ht(s));if(0===i)return 0;if(0!==t&&t!==i&&0===(t&r)&&((r=i&-i)>=(s=t&-t)||16===r&&0!==(4194240&s)))return t;if(0!==(4&i)&&(i|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)r=1<<(n=31-ot(t)),i|=e[n],t&=~r;return i}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function _t(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-ot(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}var yt=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var bt,Et,Tt,Ct,xt,St=!1,It=[],kt=null,Pt=null,Nt=null,At=new Map,Rt=new Map,Lt=[],Ot="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dt(e,t){switch(e){case"focusin":case"focusout":kt=null;break;case"dragenter":case"dragleave":Pt=null;break;case"mouseover":case"mouseout":Nt=null;break;case"pointerover":case"pointerout":At.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rt.delete(t.pointerId)}}function Mt(e,t,n,i,r,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},null!==t&&(null!==(t=yr(t))&&Et(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function jt(e){var t=vr(e.target);if(null!==t){var n=Ve(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=qe(n)))return e.blockedOn=t,void xt(e.priority,function(){Tt(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=yr(n))&&Et(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);we=i,n.target.dispatchEvent(i),we=null,t.shift()}return!0}function Ut(e,t,n){Ft(e)&&n.delete(t)}function zt(){St=!1,null!==kt&&Ft(kt)&&(kt=null),null!==Pt&&Ft(Pt)&&(Pt=null),null!==Nt&&Ft(Nt)&&(Nt=null),At.forEach(Ut),Rt.forEach(Ut)}function Bt(e,t){e.blockedOn===t&&(e.blockedOn=null,St||(St=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,zt)))}function Vt(e){function t(t){return Bt(t,e)}if(0<It.length){Bt(It[0],e);for(var n=1;n<It.length;n++){var i=It[n];i.blockedOn===e&&(i.blockedOn=null)}}for(null!==kt&&Bt(kt,e),null!==Pt&&Bt(Pt,e),null!==Nt&&Bt(Nt,e),At.forEach(t),Rt.forEach(t),n=0;n<Lt.length;n++)(i=Lt[n]).blockedOn===e&&(i.blockedOn=null);for(;0<Lt.length&&null===(n=Lt[0]).blockedOn;)jt(n),null===n.blockedOn&&Lt.shift()}var qt=w.ReactCurrentBatchConfig,Ht=!0;function Wt(e,t,n,i){var r=yt,s=qt.transition;qt.transition=null;try{yt=1,Gt(e,t,n,i)}finally{yt=r,qt.transition=s}}function Kt(e,t,n,i){var r=yt,s=qt.transition;qt.transition=null;try{yt=4,Gt(e,t,n,i)}finally{yt=r,qt.transition=s}}function Gt(e,t,n,i){if(Ht){var r=Qt(e,t,n,i);if(null===r)Hi(e,t,i,Zt,n),Dt(e,i);else if(function(e,t,n,i,r){switch(t){case"focusin":return kt=Mt(kt,e,t,n,i,r),!0;case"dragenter":return Pt=Mt(Pt,e,t,n,i,r),!0;case"mouseover":return Nt=Mt(Nt,e,t,n,i,r),!0;case"pointerover":var s=r.pointerId;return At.set(s,Mt(At.get(s)||null,e,t,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,Rt.set(s,Mt(Rt.get(s)||null,e,t,n,i,r)),!0}return!1}(r,e,t,n,i))i.stopPropagation();else if(Dt(e,i),4&t&&-1<Ot.indexOf(e)){for(;null!==r;){var s=yr(r);if(null!==s&&bt(s),null===(s=Qt(e,t,n,i))&&Hi(e,t,i,Zt,n),s===r)break;r=s}null!==r&&i.stopPropagation()}else Hi(e,t,i,null,n)}}var Zt=null;function Qt(e,t,n,i){if(Zt=null,null!==(e=vr(e=be(i))))if(null===(t=Ve(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=qe(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Zt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case $e:return 1;case et:return 4;case tt:case nt:return 16;case it:return 536870912;default:return 16}default:return 16}}var Jt=null,Xt=null,$t=null;function en(){if($t)return $t;var e,t,n=Xt,i=n.length,r="value"in Jt?Jt.value:Jt.textContent,s=r.length;for(e=0;e<i&&n[e]===r[e];e++);var o=i-e;for(t=1;t<=o&&n[i-t]===r[s-t];t++);return $t=r.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,i,r,s){for(var o in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(r):r[o]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return j(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,an,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=sn(cn),hn=j({},cn,{view:0,detail:0}),dn=sn(hn),fn=j({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(on=e.screenX-ln.screenX,an=e.screenY-ln.screenY):an=on=0,ln=e),on)},movementY:function(e){return"movementY"in e?e.movementY:an}}),pn=sn(fn),mn=sn(j({},fn,{dataTransfer:0})),gn=sn(j({},hn,{relatedTarget:0})),_n=sn(j({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=j({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),yn=sn(vn),wn=sn(j({},cn,{data:0})),bn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},En={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Tn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Tn[e])&&!!t[e]}function xn(){return Cn}var Sn=j({},hn,{key:function(e){if(e.key){var t=bn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?En[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),In=sn(Sn),kn=sn(j({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Pn=sn(j({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xn})),Nn=sn(j({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),An=j({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Rn=sn(An),Ln=[9,13,27,32],On=u&&"CompositionEvent"in window,Dn=null;u&&"documentMode"in document&&(Dn=document.documentMode);var Mn=u&&"TextEvent"in window&&!Dn,jn=u&&(!On||Dn&&8<Dn&&11>=Dn),Fn=String.fromCharCode(32),Un=!1;function zn(e,t){switch(e){case"keyup":return-1!==Ln.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Vn=!1;var qn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!qn[e.type]:"textarea"===t}function Wn(e,t,n,i){Se(i),0<(t=Ki(t,"onChange")).length&&(n=new un("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var Kn=null,Gn=null;function Zn(e){Fi(e,0)}function Qn(e){if(G(wr(e)))return e}function Yn(e,t){if("change"===e)return t}var Jn=!1;if(u){var Xn;if(u){var $n="oninput"in document;if(!$n){var ei=document.createElement("div");ei.setAttribute("oninput","return;"),$n="function"===typeof ei.oninput}Xn=$n}else Xn=!1;Jn=Xn&&(!document.documentMode||9<document.documentMode)}function ti(){Kn&&(Kn.detachEvent("onpropertychange",ni),Gn=Kn=null)}function ni(e){if("value"===e.propertyName&&Qn(Gn)){var t=[];Wn(t,Gn,e,be(e)),Ae(Zn,t)}}function ii(e,t,n){"focusin"===e?(ti(),Gn=n,(Kn=t).attachEvent("onpropertychange",ni)):"focusout"===e&&ti()}function ri(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qn(Gn)}function si(e,t){if("click"===e)return Qn(t)}function oi(e,t){if("input"===e||"change"===e)return Qn(t)}var ai="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function li(e,t){if(ai(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!h.call(t,r)||!ai(e[r],t[r]))return!1}return!0}function ci(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ui(e,t){var n,i=ci(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=ci(i)}}function hi(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hi(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function di(){for(var e=window,t=Z();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(i){n=!1}if(!n)break;t=Z((e=t.contentWindow).document)}return t}function fi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pi(e){var t=di(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hi(n.ownerDocument.documentElement,n)){if(null!==i&&fi(n))if(t=i.start,void 0===(e=i.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=void 0===i.end?s:Math.min(i.end,r),!e.extend&&s>i&&(r=i,i=s,s=r),r=ui(n,s);var o=ui(n,i);r&&o&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),s>i?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mi=u&&"documentMode"in document&&11>=document.documentMode,gi=null,_i=null,vi=null,yi=!1;function wi(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;yi||null==gi||gi!==Z(i)||("selectionStart"in(i=gi)&&fi(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},vi&&li(vi,i)||(vi=i,0<(i=Ki(_i,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=gi)))}function bi(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ei={animationend:bi("Animation","AnimationEnd"),animationiteration:bi("Animation","AnimationIteration"),animationstart:bi("Animation","AnimationStart"),transitionend:bi("Transition","TransitionEnd")},Ti={},Ci={};function xi(e){if(Ti[e])return Ti[e];if(!Ei[e])return e;var t,n=Ei[e];for(t in n)if(n.hasOwnProperty(t)&&t in Ci)return Ti[e]=n[t];return e}u&&(Ci=document.createElement("div").style,"AnimationEvent"in window||(delete Ei.animationend.animation,delete Ei.animationiteration.animation,delete Ei.animationstart.animation),"TransitionEvent"in window||delete Ei.transitionend.transition);var Si=xi("animationend"),Ii=xi("animationiteration"),ki=xi("animationstart"),Pi=xi("transitionend"),Ni=new Map,Ai="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ri(e,t){Ni.set(e,t),l(t,[e])}for(var Li=0;Li<Ai.length;Li++){var Oi=Ai[Li];Ri(Oi.toLowerCase(),"on"+(Oi[0].toUpperCase()+Oi.slice(1)))}Ri(Si,"onAnimationEnd"),Ri(Ii,"onAnimationIteration"),Ri(ki,"onAnimationStart"),Ri("dblclick","onDoubleClick"),Ri("focusin","onFocus"),Ri("focusout","onBlur"),Ri(Pi,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Di="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mi=new Set("cancel close invalid load scroll toggle".split(" ").concat(Di));function ji(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,i,r,o,a,l,c){if(Be.apply(this,arguments),Me){if(!Me)throw Error(s(198));var u=je;Me=!1,je=null,Fe||(Fe=!0,Ue=u)}}(i,t,void 0,e),e.currentTarget=null}function Fi(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var i=e[n],r=i.event;i=i.listeners;e:{var s=void 0;if(t)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;ji(r,a,c),s=l}else for(o=0;o<i.length;o++){if(l=(a=i[o]).instance,c=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;ji(r,a,c),s=l}}}if(Fe)throw e=Ue,Fe=!1,Ue=null,e}function Ui(e,t){var n=t[mr];void 0===n&&(n=t[mr]=new Set);var i=e+"__bubble";n.has(i)||(qi(t,e,2,!1),n.add(i))}function zi(e,t,n){var i=0;t&&(i|=4),qi(n,e,i,t)}var Bi="_reactListening"+Math.random().toString(36).slice(2);function Vi(e){if(!e[Bi]){e[Bi]=!0,o.forEach(function(t){"selectionchange"!==t&&(Mi.has(t)||zi(t,!1,e),zi(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Bi]||(t[Bi]=!0,zi("selectionchange",!1,t))}}function qi(e,t,n,i){switch(Yt(t)){case 1:var r=Wt;break;case 4:r=Kt;break;default:r=Gt}n=r.bind(null,t,n,e),r=void 0,!Le||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),i?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Hi(e,t,n,i,r){var s=i;if(0===(1&t)&&0===(2&t)&&null!==i)e:for(;;){if(null===i)return;var o=i.tag;if(3===o||4===o){var a=i.stateNode.containerInfo;if(a===r||8===a.nodeType&&a.parentNode===r)break;if(4===o)for(o=i.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;o=o.return}for(;null!==a;){if(null===(o=vr(a)))return;if(5===(l=o.tag)||6===l){i=s=o;continue e}a=a.parentNode}}i=i.return}Ae(function(){var i=s,r=be(n),o=[];e:{var a=Ni.get(e);if(void 0!==a){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=In;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Pn;break;case Si:case Ii:case ki:l=_n;break;case Pi:l=Nn;break;case"scroll":l=dn;break;case"wheel":l=Rn;break;case"copy":case"cut":case"paste":l=yn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=kn}var u=0!==(4&t),h=!u&&"scroll"===e,d=u?null!==a?a+"Capture":null:a;u=[];for(var f,p=i;null!==p;){var m=(f=p).stateNode;if(5===f.tag&&null!==m&&(f=m,null!==d&&(null!=(m=Re(p,d))&&u.push(Wi(p,m,f)))),h)break;p=p.return}0<u.length&&(a=new l(a,c,null,n,r),o.push({event:a,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===we||!(c=n.relatedTarget||n.fromElement)||!vr(c)&&!c[pr])&&(l||a)&&(a=r.window===r?r:(a=r.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=i,null!==(c=(c=n.relatedTarget||n.toElement)?vr(c):null)&&(c!==(h=Ve(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=i),l!==c)){if(u=pn,m="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=kn,m="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==l?a:wr(l),f=null==c?a:wr(c),(a=new u(m,p+"leave",l,n,r)).target=h,a.relatedTarget=f,m=null,vr(r)===i&&((u=new u(d,p+"enter",c,n,r)).target=f,u.relatedTarget=h,m=u),h=m,l&&c)e:{for(d=c,p=0,f=u=l;f;f=Gi(f))p++;for(f=0,m=d;m;m=Gi(m))f++;for(;0<p-f;)u=Gi(u),p--;for(;0<f-p;)d=Gi(d),f--;for(;p--;){if(u===d||null!==d&&u===d.alternate)break e;u=Gi(u),d=Gi(d)}u=null}else u=null;null!==l&&Zi(o,a,l,u,!1),null!==c&&null!==h&&Zi(o,h,c,u,!0)}if("select"===(l=(a=i?wr(i):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var g=Yn;else if(Hn(a))if(Jn)g=oi;else{g=ri;var _=ii}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(g=si);switch(g&&(g=g(e,i))?Wn(o,g,n,r):(_&&_(e,a,i),"focusout"===e&&(_=a._wrapperState)&&_.controlled&&"number"===a.type&&ee(a,"number",a.value)),_=i?wr(i):window,e){case"focusin":(Hn(_)||"true"===_.contentEditable)&&(gi=_,_i=i,vi=null);break;case"focusout":vi=_i=gi=null;break;case"mousedown":yi=!0;break;case"contextmenu":case"mouseup":case"dragend":yi=!1,wi(o,n,r);break;case"selectionchange":if(mi)break;case"keydown":case"keyup":wi(o,n,r)}var v;if(On)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else Vn?zn(e,n)&&(y="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(y="onCompositionStart");y&&(jn&&"ko"!==n.locale&&(Vn||"onCompositionStart"!==y?"onCompositionEnd"===y&&Vn&&(v=en()):(Xt="value"in(Jt=r)?Jt.value:Jt.textContent,Vn=!0)),0<(_=Ki(i,y)).length&&(y=new wn(y,e,null,n,r),o.push({event:y,listeners:_}),v?y.data=v:null!==(v=Bn(n))&&(y.data=v))),(v=Mn?function(e,t){switch(e){case"compositionend":return Bn(t);case"keypress":return 32!==t.which?null:(Un=!0,Fn);case"textInput":return(e=t.data)===Fn&&Un?null:e;default:return null}}(e,n):function(e,t){if(Vn)return"compositionend"===e||!On&&zn(e,t)?(e=en(),$t=Xt=Jt=null,Vn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return jn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(i=Ki(i,"onBeforeInput")).length&&(r=new wn("onBeforeInput","beforeinput",null,n,r),o.push({event:r,listeners:i}),r.data=v))}Fi(o,t)})}function Wi(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Ki(e,t){for(var n=t+"Capture",i=[];null!==e;){var r=e,s=r.stateNode;5===r.tag&&null!==s&&(r=s,null!=(s=Re(e,n))&&i.unshift(Wi(e,s,r)),null!=(s=Re(e,t))&&i.push(Wi(e,s,r))),e=e.return}return i}function Gi(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Zi(e,t,n,i,r){for(var s=t._reactName,o=[];null!==n&&n!==i;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===i)break;5===a.tag&&null!==c&&(a=c,r?null!=(l=Re(n,s))&&o.unshift(Wi(n,l,a)):r||null!=(l=Re(n,s))&&o.push(Wi(n,l,a))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Qi=/\r\n?/g,Yi=/\u0000|\uFFFD/g;function Ji(e){return("string"===typeof e?e:""+e).replace(Qi,"\n").replace(Yi,"")}function Xi(e,t,n){if(t=Ji(t),Ji(e)!==t&&n)throw Error(s(425))}function $i(){}var er=null,tr=null;function nr(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ir="function"===typeof setTimeout?setTimeout:void 0,rr="function"===typeof clearTimeout?clearTimeout:void 0,sr="function"===typeof Promise?Promise:void 0,or="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof sr?function(e){return sr.resolve(null).then(e).catch(ar)}:ir;function ar(e){setTimeout(function(){throw e})}function lr(e,t){var n=t,i=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===i)return e.removeChild(r),void Vt(t);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=r}while(n);Vt(t)}function cr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ur(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var hr=Math.random().toString(36).slice(2),dr="__reactFiber$"+hr,fr="__reactProps$"+hr,pr="__reactContainer$"+hr,mr="__reactEvents$"+hr,gr="__reactListeners$"+hr,_r="__reactHandles$"+hr;function vr(e){var t=e[dr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pr]||n[dr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ur(e);null!==e;){if(n=e[dr])return n;e=ur(e)}return t}n=(e=n).parentNode}return null}function yr(e){return!(e=e[dr]||e[pr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wr(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function br(e){return e[fr]||null}var Er=[],Tr=-1;function Cr(e){return{current:e}}function xr(e){0>Tr||(e.current=Er[Tr],Er[Tr]=null,Tr--)}function Sr(e,t){Tr++,Er[Tr]=e.current,e.current=t}var Ir={},kr=Cr(Ir),Pr=Cr(!1),Nr=Ir;function Ar(e,t){var n=e.type.contextTypes;if(!n)return Ir;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r,s={};for(r in n)s[r]=t[r];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Rr(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Lr(){xr(Pr),xr(kr)}function Or(e,t,n){if(kr.current!==Ir)throw Error(s(168));Sr(kr,t),Sr(Pr,n)}function Dr(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,"function"!==typeof i.getChildContext)return n;for(var r in i=i.getChildContext())if(!(r in t))throw Error(s(108,q(e)||"Unknown",r));return j({},n,i)}function Mr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ir,Nr=kr.current,Sr(kr,e),Sr(Pr,Pr.current),!0}function jr(e,t,n){var i=e.stateNode;if(!i)throw Error(s(169));n?(e=Dr(e,t,Nr),i.__reactInternalMemoizedMergedChildContext=e,xr(Pr),xr(kr),Sr(kr,e)):xr(Pr),Sr(Pr,n)}var Fr=null,Ur=!1,zr=!1;function Br(e){null===Fr?Fr=[e]:Fr.push(e)}function Vr(){if(!zr&&null!==Fr){zr=!0;var e=0,t=yt;try{var n=Fr;for(yt=1;e<n.length;e++){var i=n[e];do{i=i(!0)}while(null!==i)}Fr=null,Ur=!1}catch(r){throw null!==Fr&&(Fr=Fr.slice(e+1)),Ge($e,Vr),r}finally{yt=t,zr=!1}}return null}var qr=[],Hr=0,Wr=null,Kr=0,Gr=[],Zr=0,Qr=null,Yr=1,Jr="";function Xr(e,t){qr[Hr++]=Kr,qr[Hr++]=Wr,Wr=e,Kr=t}function $r(e,t,n){Gr[Zr++]=Yr,Gr[Zr++]=Jr,Gr[Zr++]=Qr,Qr=e;var i=Yr;e=Jr;var r=32-ot(i)-1;i&=~(1<<r),n+=1;var s=32-ot(t)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,Yr=1<<32-ot(t)+r|n<<r|i,Jr=s+e}else Yr=1<<s|n<<r|i,Jr=e}function es(e){null!==e.return&&(Xr(e,1),$r(e,1,0))}function ts(e){for(;e===Wr;)Wr=qr[--Hr],qr[Hr]=null,Kr=qr[--Hr],qr[Hr]=null;for(;e===Qr;)Qr=Gr[--Zr],Gr[Zr]=null,Jr=Gr[--Zr],Gr[Zr]=null,Yr=Gr[--Zr],Gr[Zr]=null}var ns=null,is=null,rs=!1,ss=null;function os(e,t){var n=Ac(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function as(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ns=e,is=cr(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ns=e,is=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Qr?{id:Yr,overflow:Jr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ac(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ns=e,is=null,!0);default:return!1}}function ls(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cs(e){if(rs){var t=is;if(t){var n=t;if(!as(e,t)){if(ls(e))throw Error(s(418));t=cr(n.nextSibling);var i=ns;t&&as(e,t)?os(i,n):(e.flags=-4097&e.flags|2,rs=!1,ns=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,rs=!1,ns=e}}}function us(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ns=e}function hs(e){if(e!==ns)return!1;if(!rs)return us(e),rs=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!nr(e.type,e.memoizedProps)),t&&(t=is)){if(ls(e))throw ds(),Error(s(418));for(;t;)os(e,t),t=cr(t.nextSibling)}if(us(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){is=cr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}is=null}}else is=ns?cr(e.stateNode.nextSibling):null;return!0}function ds(){for(var e=is;e;)e=cr(e.nextSibling)}function fs(){is=ns=null,rs=!1}function ps(e){null===ss?ss=[e]:ss.push(e)}var ms=w.ReactCurrentBatchConfig;function gs(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var i=n.stateNode}if(!i)throw Error(s(147,e));var r=i,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=r.refs;null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function _s(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function vs(e){return(0,e._init)(e._payload)}function ys(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Lc(e,t)).index=0,e.sibling=null,e}function o(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=2,n):i:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,i){return null===t||6!==t.tag?((t=jc(n,e.mode,i)).return=e,t):((t=r(t,n)).return=e,t)}function c(e,t,n,i){var s=n.type;return s===T?h(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===R&&vs(s)===t.type)?((i=r(t,n.props)).ref=gs(e,t,n),i.return=e,i):((i=Oc(n.type,n.key,n.props,null,e.mode,i)).ref=gs(e,t,n),i.return=e,i)}function u(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Fc(n,e.mode,i)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function h(e,t,n,i,s){return null===t||7!==t.tag?((t=Dc(n,e.mode,i,s)).return=e,t):((t=r(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=jc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case b:return(n=Oc(t.type,t.key,t.props,null,e.mode,n)).ref=gs(e,null,t),n.return=e,n;case E:return(t=Fc(t,e.mode,n)).return=e,t;case R:return d(e,(0,t._init)(t._payload),n)}if(te(t)||D(t))return(t=Dc(t,e.mode,n,null)).return=e,t;_s(e,t)}return null}function f(e,t,n,i){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==r?null:l(e,t,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case b:return n.key===r?c(e,t,n,i):null;case E:return n.key===r?u(e,t,n,i):null;case R:return f(e,t,(r=n._init)(n._payload),i)}if(te(n)||D(n))return null!==r?null:h(e,t,n,i,null);_s(e,n)}return null}function p(e,t,n,i,r){if("string"===typeof i&&""!==i||"number"===typeof i)return l(t,e=e.get(n)||null,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case b:return c(t,e=e.get(null===i.key?n:i.key)||null,i,r);case E:return u(t,e=e.get(null===i.key?n:i.key)||null,i,r);case R:return p(e,t,n,(0,i._init)(i._payload),r)}if(te(i)||D(i))return h(t,e=e.get(n)||null,i,r,null);_s(t,i)}return null}function m(r,s,a,l){for(var c=null,u=null,h=s,m=s=0,g=null;null!==h&&m<a.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var _=f(r,h,a[m],l);if(null===_){null===h&&(h=g);break}e&&h&&null===_.alternate&&t(r,h),s=o(_,s,m),null===u?c=_:u.sibling=_,u=_,h=g}if(m===a.length)return n(r,h),rs&&Xr(r,m),c;if(null===h){for(;m<a.length;m++)null!==(h=d(r,a[m],l))&&(s=o(h,s,m),null===u?c=h:u.sibling=h,u=h);return rs&&Xr(r,m),c}for(h=i(r,h);m<a.length;m++)null!==(g=p(h,r,m,a[m],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),s=o(g,s,m),null===u?c=g:u.sibling=g,u=g);return e&&h.forEach(function(e){return t(r,e)}),rs&&Xr(r,m),c}function g(r,a,l,c){var u=D(l);if("function"!==typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var h=u=null,m=a,g=a=0,_=null,v=l.next();null!==m&&!v.done;g++,v=l.next()){m.index>g?(_=m,m=null):_=m.sibling;var y=f(r,m,v.value,c);if(null===y){null===m&&(m=_);break}e&&m&&null===y.alternate&&t(r,m),a=o(y,a,g),null===h?u=y:h.sibling=y,h=y,m=_}if(v.done)return n(r,m),rs&&Xr(r,g),u;if(null===m){for(;!v.done;g++,v=l.next())null!==(v=d(r,v.value,c))&&(a=o(v,a,g),null===h?u=v:h.sibling=v,h=v);return rs&&Xr(r,g),u}for(m=i(r,m);!v.done;g++,v=l.next())null!==(v=p(m,r,g,v.value,c))&&(e&&null!==v.alternate&&m.delete(null===v.key?g:v.key),a=o(v,a,g),null===h?u=v:h.sibling=v,h=v);return e&&m.forEach(function(e){return t(r,e)}),rs&&Xr(r,g),u}return function e(i,s,o,l){if("object"===typeof o&&null!==o&&o.type===T&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case b:e:{for(var c=o.key,u=s;null!==u;){if(u.key===c){if((c=o.type)===T){if(7===u.tag){n(i,u.sibling),(s=r(u,o.props.children)).return=i,i=s;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===R&&vs(c)===u.type){n(i,u.sibling),(s=r(u,o.props)).ref=gs(i,u,o),s.return=i,i=s;break e}n(i,u);break}t(i,u),u=u.sibling}o.type===T?((s=Dc(o.props.children,i.mode,l,o.key)).return=i,i=s):((l=Oc(o.type,o.key,o.props,null,i.mode,l)).ref=gs(i,s,o),l.return=i,i=l)}return a(i);case E:e:{for(u=o.key;null!==s;){if(s.key===u){if(4===s.tag&&s.stateNode.containerInfo===o.containerInfo&&s.stateNode.implementation===o.implementation){n(i,s.sibling),(s=r(s,o.children||[])).return=i,i=s;break e}n(i,s);break}t(i,s),s=s.sibling}(s=Fc(o,i.mode,l)).return=i,i=s}return a(i);case R:return e(i,s,(u=o._init)(o._payload),l)}if(te(o))return m(i,s,o,l);if(D(o))return g(i,s,o,l);_s(i,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==s&&6===s.tag?(n(i,s.sibling),(s=r(s,o)).return=i,i=s):(n(i,s),(s=jc(o,i.mode,l)).return=i,i=s),a(i)):n(i,s)}}var ws=ys(!0),bs=ys(!1),Es=Cr(null),Ts=null,Cs=null,xs=null;function Ss(){xs=Cs=Ts=null}function Is(e){var t=Es.current;xr(Es),e._currentValue=t}function ks(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Ps(e,t){Ts=e,xs=Cs=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(ya=!0),e.firstContext=null)}function Ns(e){var t=e._currentValue;if(xs!==e)if(e={context:e,memoizedValue:t,next:null},null===Cs){if(null===Ts)throw Error(s(308));Cs=e,Ts.dependencies={lanes:0,firstContext:e}}else Cs=Cs.next=e;return t}var As=null;function Rs(e){null===As?As=[e]:As.push(e)}function Ls(e,t,n,i){var r=t.interleaved;return null===r?(n.next=n,Rs(t)):(n.next=r.next,r.next=n),t.interleaved=n,Os(e,i)}function Os(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ds=!1;function Ms(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function js(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Us(e,t,n){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,0!==(2&kl)){var r=i.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),i.pending=t,Os(e,n)}return null===(r=i.interleaved)?(t.next=t,Rs(i)):(t.next=r.next,r.next=t),i.interleaved=t,Os(e,n)}function zs(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,vt(e,n)}}function Bs(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?r=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?r=s=t:s=s.next=t}else r=s=t;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Vs(e,t,n,i){var r=e.updateQueue;Ds=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(null!==a){r.shared.pending=null;var l=a,c=l.next;l.next=null,null===o?s=c:o.next=c,o=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==s){var h=r.baseState;for(o=0,u=c=l=null,a=s;;){var d=a.lane,f=a.eventTime;if((i&d)===d){null!==u&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,m=a;switch(d=t,f=n,m.tag){case 1:if("function"===typeof(p=m.payload)){h=p.call(f,h,d);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=m.payload)?p.call(f,h,d):p)||void 0===d)break e;h=j({},h,d);break e;case 2:Ds=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(d=r.effects)?r.effects=[a]:d.push(a))}else f={eventTime:f,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=f,l=h):u=u.next=f,o|=d;if(null===(a=a.next)){if(null===(a=r.shared.pending))break;a=(d=a).next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}if(null===u&&(l=h),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,null!==(t=r.shared.interleaved)){r=t;do{o|=r.lane,r=r.next}while(r!==t)}else null===s&&(r.shared.lanes=0);Ml|=o,e.lanes=o,e.memoizedState=h}}function qs(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!==typeof r)throw Error(s(191,r));r.call(i)}}}var Hs={},Ws=Cr(Hs),Ks=Cr(Hs),Gs=Cr(Hs);function Zs(e){if(e===Hs)throw Error(s(174));return e}function Qs(e,t){switch(Sr(Gs,t),Sr(Ks,e),Sr(Ws,Hs),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}xr(Ws),Sr(Ws,t)}function Ys(){xr(Ws),xr(Ks),xr(Gs)}function Js(e){Zs(Gs.current);var t=Zs(Ws.current),n=le(t,e.type);t!==n&&(Sr(Ks,e),Sr(Ws,n))}function Xs(e){Ks.current===e&&(xr(Ws),xr(Ks))}var $s=Cr(0);function eo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var to=[];function no(){for(var e=0;e<to.length;e++)to[e]._workInProgressVersionPrimary=null;to.length=0}var io=w.ReactCurrentDispatcher,ro=w.ReactCurrentBatchConfig,so=0,oo=null,ao=null,lo=null,co=!1,uo=!1,ho=0,fo=0;function po(){throw Error(s(321))}function mo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ai(e[n],t[n]))return!1;return!0}function go(e,t,n,i,r,o){if(so=o,oo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,io.current=null===e||null===e.memoizedState?$o:ea,e=n(i,r),uo){o=0;do{if(uo=!1,ho=0,25<=o)throw Error(s(301));o+=1,lo=ao=null,t.updateQueue=null,io.current=ta,e=n(i,r)}while(uo)}if(io.current=Xo,t=null!==ao&&null!==ao.next,so=0,lo=ao=oo=null,co=!1,t)throw Error(s(300));return e}function _o(){var e=0!==ho;return ho=0,e}function vo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===lo?oo.memoizedState=lo=e:lo=lo.next=e,lo}function yo(){if(null===ao){var e=oo.alternate;e=null!==e?e.memoizedState:null}else e=ao.next;var t=null===lo?oo.memoizedState:lo.next;if(null!==t)lo=t,ao=e;else{if(null===e)throw Error(s(310));e={memoizedState:(ao=e).memoizedState,baseState:ao.baseState,baseQueue:ao.baseQueue,queue:ao.queue,next:null},null===lo?oo.memoizedState=lo=e:lo=lo.next=e}return lo}function wo(e,t){return"function"===typeof t?t(e):t}function bo(e){var t=yo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var i=ao,r=i.baseQueue,o=n.pending;if(null!==o){if(null!==r){var a=r.next;r.next=o.next,o.next=a}i.baseQueue=r=o,n.pending=null}if(null!==r){o=r.next,i=i.baseState;var l=a=null,c=null,u=o;do{var h=u.lane;if((so&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:e(i,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,a=i):c=c.next=d,oo.lanes|=h,Ml|=h}u=u.next}while(null!==u&&u!==o);null===c?a=i:c.next=l,ai(i,t.memoizedState)||(ya=!0),t.memoizedState=i,t.baseState=a,t.baseQueue=c,n.lastRenderedState=i}if(null!==(e=n.interleaved)){r=e;do{o=r.lane,oo.lanes|=o,Ml|=o,r=r.next}while(r!==e)}else null===r&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Eo(e){var t=yo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,o=t.memoizedState;if(null!==r){n.pending=null;var a=r=r.next;do{o=e(o,a.action),a=a.next}while(a!==r);ai(o,t.memoizedState)||(ya=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,i]}function To(){}function Co(e,t){var n=oo,i=yo(),r=t(),o=!ai(i.memoizedState,r);if(o&&(i.memoizedState=r,ya=!0),i=i.queue,Mo(Io.bind(null,n,i,e),[e]),i.getSnapshot!==t||o||null!==lo&&1&lo.memoizedState.tag){if(n.flags|=2048,Ao(9,So.bind(null,n,i,r,t),void 0,null),null===Pl)throw Error(s(349));0!==(30&so)||xo(n,t,r)}return r}function xo(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function So(e,t,n,i){t.value=n,t.getSnapshot=i,ko(t)&&Po(e)}function Io(e,t,n){return n(function(){ko(t)&&Po(e)})}function ko(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ai(e,n)}catch(i){return!0}}function Po(e){var t=Os(e,1);null!==t&&nc(t,e,1,-1)}function No(e){var t=vo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wo,lastRenderedState:e},t.queue=e,e=e.dispatch=Zo.bind(null,oo,e),[t.memoizedState,e]}function Ao(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function Ro(){return yo().memoizedState}function Lo(e,t,n,i){var r=vo();oo.flags|=e,r.memoizedState=Ao(1|t,n,void 0,void 0===i?null:i)}function Oo(e,t,n,i){var r=yo();i=void 0===i?null:i;var s=void 0;if(null!==ao){var o=ao.memoizedState;if(s=o.destroy,null!==i&&mo(i,o.deps))return void(r.memoizedState=Ao(t,n,s,i))}oo.flags|=e,r.memoizedState=Ao(1|t,n,s,i)}function Do(e,t){return Lo(8390656,8,e,t)}function Mo(e,t){return Oo(2048,8,e,t)}function jo(e,t){return Oo(4,2,e,t)}function Fo(e,t){return Oo(4,4,e,t)}function Uo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function zo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Oo(4,4,Uo.bind(null,t,e),n)}function Bo(){}function Vo(e,t){var n=yo();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&mo(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function qo(e,t){var n=yo();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&mo(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function Ho(e,t,n){return 0===(21&so)?(e.baseState&&(e.baseState=!1,ya=!0),e.memoizedState=n):(ai(n,t)||(n=mt(),oo.lanes|=n,Ml|=n,e.baseState=!0),t)}function Wo(e,t){var n=yt;yt=0!==n&&4>n?n:4,e(!0);var i=ro.transition;ro.transition={};try{e(!1),t()}finally{yt=n,ro.transition=i}}function Ko(){return yo().memoizedState}function Go(e,t,n){var i=tc(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},Qo(e))Yo(t,n);else if(null!==(n=Ls(e,t,n,i))){nc(n,e,i,ec()),Jo(n,t,i)}}function Zo(e,t,n){var i=tc(e),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qo(e))Yo(t,r);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,n);if(r.hasEagerState=!0,r.eagerState=a,ai(a,o)){var l=t.interleaved;return null===l?(r.next=r,Rs(t)):(r.next=l.next,l.next=r),void(t.interleaved=r)}}catch(c){}null!==(n=Ls(e,t,r,i))&&(nc(n,e,i,r=ec()),Jo(n,t,i))}}function Qo(e){var t=e.alternate;return e===oo||null!==t&&t===oo}function Yo(e,t){uo=co=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Jo(e,t,n){if(0!==(4194240&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,vt(e,n)}}var Xo={readContext:Ns,useCallback:po,useContext:po,useEffect:po,useImperativeHandle:po,useInsertionEffect:po,useLayoutEffect:po,useMemo:po,useReducer:po,useRef:po,useState:po,useDebugValue:po,useDeferredValue:po,useTransition:po,useMutableSource:po,useSyncExternalStore:po,useId:po,unstable_isNewReconciler:!1},$o={readContext:Ns,useCallback:function(e,t){return vo().memoizedState=[e,void 0===t?null:t],e},useContext:Ns,useEffect:Do,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Lo(4194308,4,Uo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Lo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Lo(4,2,e,t)},useMemo:function(e,t){var n=vo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=vo();return t=void 0!==n?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=Go.bind(null,oo,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},vo().memoizedState=e},useState:No,useDebugValue:Bo,useDeferredValue:function(e){return vo().memoizedState=e},useTransition:function(){var e=No(!1),t=e[0];return e=Wo.bind(null,e[1]),vo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=oo,r=vo();if(rs){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Pl)throw Error(s(349));0!==(30&so)||xo(i,t,n)}r.memoizedState=n;var o={value:n,getSnapshot:t};return r.queue=o,Do(Io.bind(null,i,o,e),[e]),i.flags|=2048,Ao(9,So.bind(null,i,o,n,t),void 0,null),n},useId:function(){var e=vo(),t=Pl.identifierPrefix;if(rs){var n=Jr;t=":"+t+"R"+(n=(Yr&~(1<<32-ot(Yr)-1)).toString(32)+n),0<(n=ho++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=fo++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ea={readContext:Ns,useCallback:Vo,useContext:Ns,useEffect:Mo,useImperativeHandle:zo,useInsertionEffect:jo,useLayoutEffect:Fo,useMemo:qo,useReducer:bo,useRef:Ro,useState:function(){return bo(wo)},useDebugValue:Bo,useDeferredValue:function(e){return Ho(yo(),ao.memoizedState,e)},useTransition:function(){return[bo(wo)[0],yo().memoizedState]},useMutableSource:To,useSyncExternalStore:Co,useId:Ko,unstable_isNewReconciler:!1},ta={readContext:Ns,useCallback:Vo,useContext:Ns,useEffect:Mo,useImperativeHandle:zo,useInsertionEffect:jo,useLayoutEffect:Fo,useMemo:qo,useReducer:Eo,useRef:Ro,useState:function(){return Eo(wo)},useDebugValue:Bo,useDeferredValue:function(e){var t=yo();return null===ao?t.memoizedState=e:Ho(t,ao.memoizedState,e)},useTransition:function(){return[Eo(wo)[0],yo().memoizedState]},useMutableSource:To,useSyncExternalStore:Co,useId:Ko,unstable_isNewReconciler:!1};function na(e,t){if(e&&e.defaultProps){for(var n in t=j({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function ia(e,t,n,i){n=null===(n=n(i,t=e.memoizedState))||void 0===n?t:j({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ra={isMounted:function(e){return!!(e=e._reactInternals)&&Ve(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=ec(),r=tc(e),s=Fs(i,r);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Us(e,s,r))&&(nc(t,e,r,i),zs(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=ec(),r=tc(e),s=Fs(i,r);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Us(e,s,r))&&(nc(t,e,r,i),zs(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),i=tc(e),r=Fs(n,i);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=Us(e,r,i))&&(nc(t,e,i,n),zs(t,e,i))}};function sa(e,t,n,i,r,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!li(n,i)||!li(r,s))}function oa(e,t,n){var i=!1,r=Ir,s=t.contextType;return"object"===typeof s&&null!==s?s=Ns(s):(r=Rr(t)?Nr:kr.current,s=(i=null!==(i=t.contextTypes)&&void 0!==i)?Ar(e,r):Ir),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ra,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=s),t}function aa(e,t,n,i){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&ra.enqueueReplaceState(t,t.state,null)}function la(e,t,n,i){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs={},Ms(e);var s=t.contextType;"object"===typeof s&&null!==s?r.context=Ns(s):(s=Rr(t)?Nr:kr.current,r.context=Ar(e,s)),r.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(ia(e,t,s,n),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&ra.enqueueReplaceState(r,r.state,null),Vs(e,n,r,i),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}function ca(e,t){try{var n="",i=t;do{n+=B(i),i=i.return}while(i);var r=n}catch(s){r="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:r,digest:null}}function ua(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ha(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var da="function"===typeof WeakMap?WeakMap:Map;function fa(e,t,n){(n=Fs(-1,n)).tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){Hl||(Hl=!0,Wl=i),ha(0,t)},n}function pa(e,t,n){(n=Fs(-1,n)).tag=3;var i=e.type.getDerivedStateFromError;if("function"===typeof i){var r=t.value;n.payload=function(){return i(r)},n.callback=function(){ha(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){ha(0,t),"function"!==typeof i&&(null===Kl?Kl=new Set([this]):Kl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ma(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new da;var r=new Set;i.set(t,r)}else void 0===(r=i.get(t))&&(r=new Set,i.set(t,r));r.has(n)||(r.add(n),e=xc.bind(null,e,t,n),t.then(e,e))}function ga(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function _a(e,t,n,i,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Fs(-1,1)).tag=2,Us(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var va=w.ReactCurrentOwner,ya=!1;function wa(e,t,n,i){t.child=null===e?bs(t,null,n,i):ws(t,e.child,n,i)}function ba(e,t,n,i,r){n=n.render;var s=t.ref;return Ps(t,r),i=go(e,t,n,i,s,r),n=_o(),null===e||ya?(rs&&n&&es(t),t.flags|=1,wa(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Ha(e,t,r))}function Ea(e,t,n,i,r){if(null===e){var s=n.type;return"function"!==typeof s||Rc(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Oc(n.type,null,i,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Ta(e,t,s,i,r))}if(s=e.child,0===(e.lanes&r)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:li)(o,i)&&e.ref===t.ref)return Ha(e,t,r)}return t.flags|=1,(e=Lc(s,i)).ref=t.ref,e.return=t,t.child=e}function Ta(e,t,n,i,r){if(null!==e){var s=e.memoizedProps;if(li(s,i)&&e.ref===t.ref){if(ya=!1,t.pendingProps=i=s,0===(e.lanes&r))return t.lanes=e.lanes,Ha(e,t,r);0!==(131072&e.flags)&&(ya=!0)}}return Sa(e,t,n,i,r)}function Ca(e,t,n){var i=t.pendingProps,r=i.children,s=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Sr(Ll,Rl),Rl|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Sr(Ll,Rl),Rl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==s?s.baseLanes:n,Sr(Ll,Rl),Rl|=i}else null!==s?(i=s.baseLanes|n,t.memoizedState=null):i=n,Sr(Ll,Rl),Rl|=i;return wa(e,t,r,n),t.child}function xa(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Sa(e,t,n,i,r){var s=Rr(n)?Nr:kr.current;return s=Ar(t,s),Ps(t,r),n=go(e,t,n,i,s,r),i=_o(),null===e||ya?(rs&&i&&es(t),t.flags|=1,wa(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Ha(e,t,r))}function Ia(e,t,n,i,r){if(Rr(n)){var s=!0;Mr(t)}else s=!1;if(Ps(t,r),null===t.stateNode)qa(e,t),oa(t,n,i),la(t,n,i,r),i=!0;else if(null===e){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ns(c):c=Ar(t,c=Rr(n)?Nr:kr.current);var u=n.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==i||l!==c)&&aa(t,o,i,c),Ds=!1;var d=t.memoizedState;o.state=d,Vs(t,i,o,r),l=t.memoizedState,a!==i||d!==l||Pr.current||Ds?("function"===typeof u&&(ia(t,n,u,i),l=t.memoizedState),(a=Ds||sa(t,n,a,i,d,l,c))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),o.props=i,o.state=l,o.context=c,i=a):("function"===typeof o.componentDidMount&&(t.flags|=4194308),i=!1)}else{o=t.stateNode,js(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:na(t.type,a),o.props=c,h=t.pendingProps,d=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ns(l):l=Ar(t,l=Rr(n)?Nr:kr.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==h||d!==l)&&aa(t,o,i,l),Ds=!1,d=t.memoizedState,o.state=d,Vs(t,i,o,r);var p=t.memoizedState;a!==h||d!==p||Pr.current||Ds?("function"===typeof f&&(ia(t,n,f,i),p=t.memoizedState),(c=Ds||sa(t,n,c,i,d,p,l)||!1)?(u||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(i,p,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(i,p,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=p),o.props=i,o.state=p,o.context=l,i=c):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),i=!1)}return ka(e,t,n,i,s,r)}function ka(e,t,n,i,r,s){xa(e,t);var o=0!==(128&t.flags);if(!i&&!o)return r&&jr(t,n,!1),Ha(e,t,s);i=t.stateNode,va.current=t;var a=o&&"function"!==typeof n.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&o?(t.child=ws(t,e.child,null,s),t.child=ws(t,null,a,s)):wa(e,t,a,s),t.memoizedState=i.state,r&&jr(t,n,!0),t.child}function Pa(e){var t=e.stateNode;t.pendingContext?Or(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Or(0,t.context,!1),Qs(e,t.containerInfo)}function Na(e,t,n,i,r){return fs(),ps(r),t.flags|=256,wa(e,t,n,i),t.child}var Aa,Ra,La,Oa,Da={dehydrated:null,treeContext:null,retryLane:0};function Ma(e){return{baseLanes:e,cachePool:null,transitions:null}}function ja(e,t,n){var i,r=t.pendingProps,o=$s.current,a=!1,l=0!==(128&t.flags);if((i=l)||(i=(null===e||null!==e.memoizedState)&&0!==(2&o)),i?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Sr($s,1&o),null===e)return cs(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=r.children,e=r.fallback,a?(r=t.mode,a=t.child,l={mode:"hidden",children:l},0===(1&r)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=Mc(l,r,0,null),e=Dc(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Ma(n),t.memoizedState=Da,e):Fa(t,l));if(null!==(o=e.memoizedState)&&null!==(i=o.dehydrated))return function(e,t,n,i,r,o,a){if(n)return 256&t.flags?(t.flags&=-257,Ua(e,t,a,i=ua(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=i.fallback,r=t.mode,i=Mc({mode:"visible",children:i.children},r,0,null),(o=Dc(o,r,a,null)).flags|=2,i.return=t,o.return=t,i.sibling=o,t.child=i,0!==(1&t.mode)&&ws(t,e.child,null,a),t.child.memoizedState=Ma(a),t.memoizedState=Da,o);if(0===(1&t.mode))return Ua(e,t,a,null);if("$!"===r.data){if(i=r.nextSibling&&r.nextSibling.dataset)var l=i.dgst;return i=l,Ua(e,t,a,i=ua(o=Error(s(419)),i,void 0))}if(l=0!==(a&e.childLanes),ya||l){if(null!==(i=Pl)){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(i.suspendedLanes|a))?0:r)&&r!==o.retryLane&&(o.retryLane=r,Os(e,r),nc(i,e,r,-1))}return mc(),Ua(e,t,a,i=ua(Error(s(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=Ic.bind(null,e),r._reactRetry=t,null):(e=o.treeContext,is=cr(r.nextSibling),ns=t,rs=!0,ss=null,null!==e&&(Gr[Zr++]=Yr,Gr[Zr++]=Jr,Gr[Zr++]=Qr,Yr=e.id,Jr=e.overflow,Qr=t),t=Fa(t,i.children),t.flags|=4096,t)}(e,t,l,r,i,o,n);if(a){a=r.fallback,l=t.mode,i=(o=e.child).sibling;var c={mode:"hidden",children:r.children};return 0===(1&l)&&t.child!==o?((r=t.child).childLanes=0,r.pendingProps=c,t.deletions=null):(r=Lc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==i?a=Lc(i,a):(a=Dc(a,l,n,null)).flags|=2,a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,l=null===(l=e.child.memoizedState)?Ma(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=Da,r}return e=(a=e.child).sibling,r=Lc(a,{mode:"visible",children:r.children}),0===(1&t.mode)&&(r.lanes=n),r.return=t,r.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Fa(e,t){return(t=Mc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ua(e,t,n,i){return null!==i&&ps(i),ws(t,e.child,null,n),(e=Fa(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function za(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),ks(e.return,t,n)}function Ba(e,t,n,i,r){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function Va(e,t,n){var i=t.pendingProps,r=i.revealOrder,s=i.tail;if(wa(e,t,i.children,n),0!==(2&(i=$s.current)))i=1&i|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&za(e,n,t);else if(19===e.tag)za(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(Sr($s,i),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===eo(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),Ba(t,!1,r,n,s);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===eo(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}Ba(t,!0,n,null,s);break;case"together":Ba(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function qa(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ha(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ml|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Lc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Lc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Wa(e,t){if(!rs)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Ka(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=14680064&r.subtreeFlags,i|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function Ga(e,t,n){var i=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ka(t),null;case 1:case 17:return Rr(t.type)&&Lr(),Ka(t),null;case 3:return i=t.stateNode,Ys(),xr(Pr),xr(kr),no(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(hs(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(oc(ss),ss=null))),Ra(e,t),Ka(t),null;case 5:Xs(t);var r=Zs(Gs.current);if(n=t.type,null!==e&&null!=t.stateNode)La(e,t,n,i,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(s(166));return Ka(t),null}if(e=Zs(Ws.current),hs(t)){i=t.stateNode,n=t.type;var o=t.memoizedProps;switch(i[dr]=t,i[fr]=o,e=0!==(1&t.mode),n){case"dialog":Ui("cancel",i),Ui("close",i);break;case"iframe":case"object":case"embed":Ui("load",i);break;case"video":case"audio":for(r=0;r<Di.length;r++)Ui(Di[r],i);break;case"source":Ui("error",i);break;case"img":case"image":case"link":Ui("error",i),Ui("load",i);break;case"details":Ui("toggle",i);break;case"input":Y(i,o),Ui("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!o.multiple},Ui("invalid",i);break;case"textarea":re(i,o),Ui("invalid",i)}for(var l in ve(n,o),r=null,o)if(o.hasOwnProperty(l)){var c=o[l];"children"===l?"string"===typeof c?i.textContent!==c&&(!0!==o.suppressHydrationWarning&&Xi(i.textContent,c,e),r=["children",c]):"number"===typeof c&&i.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Xi(i.textContent,c,e),r=["children",""+c]):a.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Ui("scroll",i)}switch(n){case"input":K(i),$(i,o,!0);break;case"textarea":K(i),oe(i);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(i.onclick=$i)}i=r,t.updateQueue=i,null!==i&&(t.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof i.is?e=l.createElement(n,{is:i.is}):(e=l.createElement(n),"select"===n&&(l=e,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):e=l.createElementNS(e,n),e[dr]=t,e[fr]=i,Aa(e,t,!1,!1),t.stateNode=e;e:{switch(l=ye(n,i),n){case"dialog":Ui("cancel",e),Ui("close",e),r=i;break;case"iframe":case"object":case"embed":Ui("load",e),r=i;break;case"video":case"audio":for(r=0;r<Di.length;r++)Ui(Di[r],e);r=i;break;case"source":Ui("error",e),r=i;break;case"img":case"image":case"link":Ui("error",e),Ui("load",e),r=i;break;case"details":Ui("toggle",e),r=i;break;case"input":Y(e,i),r=Q(e,i),Ui("invalid",e);break;case"option":default:r=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},r=j({},i,{value:void 0}),Ui("invalid",e);break;case"textarea":re(e,i),r=ie(e,i),Ui("invalid",e)}for(o in ve(n,r),c=r)if(c.hasOwnProperty(o)){var u=c[o];"style"===o?ge(e,u):"dangerouslySetInnerHTML"===o?null!=(u=u?u.__html:void 0)&&he(e,u):"children"===o?"string"===typeof u?("textarea"!==n||""!==u)&&de(e,u):"number"===typeof u&&de(e,""+u):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(a.hasOwnProperty(o)?null!=u&&"onScroll"===o&&Ui("scroll",e):null!=u&&y(e,o,u,l))}switch(n){case"input":K(e),$(e,i,!1);break;case"textarea":K(e),oe(e);break;case"option":null!=i.value&&e.setAttribute("value",""+H(i.value));break;case"select":e.multiple=!!i.multiple,null!=(o=i.value)?ne(e,!!i.multiple,o,!1):null!=i.defaultValue&&ne(e,!!i.multiple,i.defaultValue,!0);break;default:"function"===typeof r.onClick&&(e.onclick=$i)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ka(t),null;case 6:if(e&&null!=t.stateNode)Oa(e,t,e.memoizedProps,i);else{if("string"!==typeof i&&null===t.stateNode)throw Error(s(166));if(n=Zs(Gs.current),Zs(Ws.current),hs(t)){if(i=t.stateNode,n=t.memoizedProps,i[dr]=t,(o=i.nodeValue!==n)&&null!==(e=ns))switch(e.tag){case 3:Xi(i.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xi(i.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[dr]=t,t.stateNode=i}return Ka(t),null;case 13:if(xr($s),i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(rs&&null!==is&&0!==(1&t.mode)&&0===(128&t.flags))ds(),fs(),t.flags|=98560,o=!1;else if(o=hs(t),null!==i&&null!==i.dehydrated){if(null===e){if(!o)throw Error(s(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(s(317));o[dr]=t}else fs(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ka(t),o=!1}else null!==ss&&(oc(ss),ss=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((i=null!==i)!==(null!==e&&null!==e.memoizedState)&&i&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&$s.current)?0===Ol&&(Ol=3):mc())),null!==t.updateQueue&&(t.flags|=4),Ka(t),null);case 4:return Ys(),Ra(e,t),null===e&&Vi(t.stateNode.containerInfo),Ka(t),null;case 10:return Is(t.type._context),Ka(t),null;case 19:if(xr($s),null===(o=t.memoizedState))return Ka(t),null;if(i=0!==(128&t.flags),null===(l=o.rendering))if(i)Wa(o,!1);else{if(0!==Ol||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=eo(e))){for(t.flags|=128,Wa(o,!1),null!==(i=l.updateQueue)&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;null!==n;)e=i,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Sr($s,1&$s.current|2),t.child}e=e.sibling}null!==o.tail&&Je()>Vl&&(t.flags|=128,i=!0,Wa(o,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=eo(l))){if(t.flags|=128,i=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Wa(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!rs)return Ka(t),null}else 2*Je()-o.renderingStartTime>Vl&&1073741824!==n&&(t.flags|=128,i=!0,Wa(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=o.last)?n.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Je(),t.sibling=null,n=$s.current,Sr($s,i?1&n|2:1&n),t):(Ka(t),null);case 22:case 23:return hc(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&0!==(1&t.mode)?0!==(1073741824&Rl)&&(Ka(t),6&t.subtreeFlags&&(t.flags|=8192)):Ka(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Za(e,t){switch(ts(t),t.tag){case 1:return Rr(t.type)&&Lr(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ys(),xr(Pr),xr(kr),no(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Xs(t),null;case 13:if(xr($s),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));fs()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return xr($s),null;case 4:return Ys(),null;case 10:return Is(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}Aa=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ra=function(){},La=function(e,t,n,i){var r=e.memoizedProps;if(r!==i){e=t.stateNode,Zs(Ws.current);var s,o=null;switch(n){case"input":r=Q(e,r),i=Q(e,i),o=[];break;case"select":r=j({},r,{value:void 0}),i=j({},i,{value:void 0}),o=[];break;case"textarea":r=ie(e,r),i=ie(e,i),o=[];break;default:"function"!==typeof r.onClick&&"function"===typeof i.onClick&&(e.onclick=$i)}for(u in ve(n,i),n=null,r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&null!=r[u])if("style"===u){var l=r[u];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in i){var c=i[u];if(l=null!=r?r[u]:void 0,i.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(o||(o=[]),o.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(o=o||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Ui("scroll",e),o||l===c||(o=[])):(o=o||[]).push(u,c))}n&&(o=o||[]).push("style",n);var u=o;(t.updateQueue=u)&&(t.flags|=4)}},Oa=function(e,t,n,i){n!==i&&(t.flags|=4)};var Qa=!1,Ya=!1,Ja="function"===typeof WeakSet?WeakSet:Set,Xa=null;function $a(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(i){Cc(e,t,i)}else n.current=null}function el(e,t,n){try{n()}catch(i){Cc(e,t,i)}}var tl=!1;function nl(e,t,n){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var r=i=i.next;do{if((r.tag&e)===e){var s=r.destroy;r.destroy=void 0,void 0!==s&&el(t,n,s)}r=r.next}while(r!==i)}}function il(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function rl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[dr],delete t[fr],delete t[mr],delete t[gr],delete t[_r])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ol(e){return 5===e.tag||3===e.tag||4===e.tag}function al(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ol(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=$i));else if(4!==i&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var ul=null,hl=!1;function dl(e,t,n){for(n=n.child;null!==n;)fl(e,t,n),n=n.sibling}function fl(e,t,n){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(rt,n)}catch(a){}switch(n.tag){case 5:Ya||$a(n,t);case 6:var i=ul,r=hl;ul=null,dl(e,t,n),hl=r,null!==(ul=i)&&(hl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(hl?(e=ul,n=n.stateNode,8===e.nodeType?lr(e.parentNode,n):1===e.nodeType&&lr(e,n),Vt(e)):lr(ul,n.stateNode));break;case 4:i=ul,r=hl,ul=n.stateNode.containerInfo,hl=!0,dl(e,t,n),ul=i,hl=r;break;case 0:case 11:case 14:case 15:if(!Ya&&(null!==(i=n.updateQueue)&&null!==(i=i.lastEffect))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,void 0!==o&&(0!==(2&s)||0!==(4&s))&&el(n,t,o),r=r.next}while(r!==i)}dl(e,t,n);break;case 1:if(!Ya&&($a(n,t),"function"===typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){Cc(n,t,a)}dl(e,t,n);break;case 21:dl(e,t,n);break;case 22:1&n.mode?(Ya=(i=Ya)||null!==n.memoizedState,dl(e,t,n),Ya=i):dl(e,t,n);break;default:dl(e,t,n)}}function pl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Ja),t.forEach(function(t){var i=kc.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))})}}function ml(e,t){var n=t.deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i];try{var o=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,hl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===ul)throw Error(s(160));fl(o,a,r),ul=null,hl=!1;var c=r.alternate;null!==c&&(c.return=null),r.return=null}catch(u){Cc(r,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),_l(e),4&i){try{nl(3,e,e.return),il(3,e)}catch(g){Cc(e,e.return,g)}try{nl(5,e,e.return)}catch(g){Cc(e,e.return,g)}}break;case 1:ml(t,e),_l(e),512&i&&null!==n&&$a(n,n.return);break;case 5:if(ml(t,e),_l(e),512&i&&null!==n&&$a(n,n.return),32&e.flags){var r=e.stateNode;try{de(r,"")}catch(g){Cc(e,e.return,g)}}if(4&i&&null!=(r=e.stateNode)){var o=e.memoizedProps,a=null!==n?n.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===o.type&&null!=o.name&&J(r,o),ye(l,a);var u=ye(l,o);for(a=0;a<c.length;a+=2){var h=c[a],d=c[a+1];"style"===h?ge(r,d):"dangerouslySetInnerHTML"===h?he(r,d):"children"===h?de(r,d):y(r,h,d,u)}switch(l){case"input":X(r,o);break;case"textarea":se(r,o);break;case"select":var f=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?ne(r,!!o.multiple,p,!1):f!==!!o.multiple&&(null!=o.defaultValue?ne(r,!!o.multiple,o.defaultValue,!0):ne(r,!!o.multiple,o.multiple?[]:"",!1))}r[fr]=o}catch(g){Cc(e,e.return,g)}}break;case 6:if(ml(t,e),_l(e),4&i){if(null===e.stateNode)throw Error(s(162));r=e.stateNode,o=e.memoizedProps;try{r.nodeValue=o}catch(g){Cc(e,e.return,g)}}break;case 3:if(ml(t,e),_l(e),4&i&&null!==n&&n.memoizedState.isDehydrated)try{Vt(t.containerInfo)}catch(g){Cc(e,e.return,g)}break;case 4:default:ml(t,e),_l(e);break;case 13:ml(t,e),_l(e),8192&(r=e.child).flags&&(o=null!==r.memoizedState,r.stateNode.isHidden=o,!o||null!==r.alternate&&null!==r.alternate.memoizedState||(Bl=Je())),4&i&&pl(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?(Ya=(u=Ya)||h,ml(t,e),Ya=u):ml(t,e),_l(e),8192&i){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&0!==(1&e.mode))for(Xa=e,h=e.child;null!==h;){for(d=Xa=h;null!==Xa;){switch(p=(f=Xa).child,f.tag){case 0:case 11:case 14:case 15:nl(4,f,f.return);break;case 1:$a(f,f.return);var m=f.stateNode;if("function"===typeof m.componentWillUnmount){i=f,n=f.return;try{t=i,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Cc(i,n,g)}}break;case 5:$a(f,f.return);break;case 22:if(null!==f.memoizedState){bl(d);continue}}null!==p?(p.return=f,Xa=p):bl(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{r=d.stateNode,u?"function"===typeof(o=r.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=d.stateNode,a=void 0!==(c=d.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",a))}catch(g){Cc(e,e.return,g)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){Cc(e,e.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ml(t,e),_l(e),4&i&&pl(e);case 21:}}function _l(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ol(n)){var i=n;break e}n=n.return}throw Error(s(160))}switch(i.tag){case 5:var r=i.stateNode;32&i.flags&&(de(r,""),i.flags&=-33),cl(e,al(e),r);break;case 3:case 4:var o=i.stateNode.containerInfo;ll(e,al(e),o);break;default:throw Error(s(161))}}catch(a){Cc(e,e.return,a)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vl(e,t,n){Xa=e,yl(e,t,n)}function yl(e,t,n){for(var i=0!==(1&e.mode);null!==Xa;){var r=Xa,s=r.child;if(22===r.tag&&i){var o=null!==r.memoizedState||Qa;if(!o){var a=r.alternate,l=null!==a&&null!==a.memoizedState||Ya;a=Qa;var c=Ya;if(Qa=o,(Ya=l)&&!c)for(Xa=r;null!==Xa;)l=(o=Xa).child,22===o.tag&&null!==o.memoizedState?El(r):null!==l?(l.return=o,Xa=l):El(r);for(;null!==s;)Xa=s,yl(s,t,n),s=s.sibling;Xa=r,Qa=a,Ya=c}wl(e)}else 0!==(8772&r.subtreeFlags)&&null!==s?(s.return=r,Xa=s):wl(e)}}function wl(e){for(;null!==Xa;){var t=Xa;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ya||il(5,t);break;case 1:var i=t.stateNode;if(4&t.flags&&!Ya)if(null===n)i.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:na(t.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&qs(t,o,i);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}qs(t,a,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&Vt(d)}}}break;default:throw Error(s(163))}Ya||512&t.flags&&rl(t)}catch(f){Cc(t,t.return,f)}}if(t===e){Xa=null;break}if(null!==(n=t.sibling)){n.return=t.return,Xa=n;break}Xa=t.return}}function bl(e){for(;null!==Xa;){var t=Xa;if(t===e){Xa=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Xa=n;break}Xa=t.return}}function El(e){for(;null!==Xa;){var t=Xa;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{il(4,t)}catch(l){Cc(t,n,l)}break;case 1:var i=t.stateNode;if("function"===typeof i.componentDidMount){var r=t.return;try{i.componentDidMount()}catch(l){Cc(t,r,l)}}var s=t.return;try{rl(t)}catch(l){Cc(t,s,l)}break;case 5:var o=t.return;try{rl(t)}catch(l){Cc(t,o,l)}}}catch(l){Cc(t,t.return,l)}if(t===e){Xa=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Xa=a;break}Xa=t.return}}var Tl,Cl=Math.ceil,xl=w.ReactCurrentDispatcher,Sl=w.ReactCurrentOwner,Il=w.ReactCurrentBatchConfig,kl=0,Pl=null,Nl=null,Al=0,Rl=0,Ll=Cr(0),Ol=0,Dl=null,Ml=0,jl=0,Fl=0,Ul=null,zl=null,Bl=0,Vl=1/0,ql=null,Hl=!1,Wl=null,Kl=null,Gl=!1,Zl=null,Ql=0,Yl=0,Jl=null,Xl=-1,$l=0;function ec(){return 0!==(6&kl)?Je():-1!==Xl?Xl:Xl=Je()}function tc(e){return 0===(1&e.mode)?1:0!==(2&kl)&&0!==Al?Al&-Al:null!==ms.transition?(0===$l&&($l=mt()),$l):0!==(e=yt)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function nc(e,t,n,i){if(50<Yl)throw Yl=0,Jl=null,Error(s(185));_t(e,n,i),0!==(2&kl)&&e===Pl||(e===Pl&&(0===(2&kl)&&(jl|=n),4===Ol&&ac(e,Al)),ic(e,i),1===n&&0===kl&&0===(1&t.mode)&&(Vl=Je()+500,Ur&&Vr()))}function ic(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-ot(s),a=1<<o,l=r[o];-1===l?0!==(a&n)&&0===(a&i)||(r[o]=ft(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}(e,t);var i=dt(e,e===Pl?Al:0);if(0===i)null!==n&&Ze(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=n&&Ze(n),1===t)0===e.tag?function(e){Ur=!0,Br(e)}(lc.bind(null,e)):Br(lc.bind(null,e)),or(function(){0===(6&kl)&&Vr()}),n=null;else{switch(wt(i)){case 1:n=$e;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=it}n=Pc(n,rc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function rc(e,t){if(Xl=-1,$l=0,0!==(6&kl))throw Error(s(327));var n=e.callbackNode;if(Ec()&&e.callbackNode!==n)return null;var i=dt(e,e===Pl?Al:0);if(0===i)return null;if(0!==(30&i)||0!==(i&e.expiredLanes)||t)t=gc(e,i);else{t=i;var r=kl;kl|=2;var o=pc();for(Pl===e&&Al===t||(ql=null,Vl=Je()+500,dc(e,t));;)try{vc();break}catch(l){fc(e,l)}Ss(),xl.current=o,kl=r,null!==Nl?t=0:(Pl=null,Al=0,t=Ol)}if(0!==t){if(2===t&&(0!==(r=pt(e))&&(i=r,t=sc(e,r))),1===t)throw n=Dl,dc(e,0),ac(e,i),ic(e,Je()),n;if(6===t)ac(e,i);else{if(r=e.current.alternate,0===(30&i)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!ai(s(),r))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=gc(e,i))&&(0!==(o=pt(e))&&(i=o,t=sc(e,o))),1===t))throw n=Dl,dc(e,0),ac(e,i),ic(e,Je()),n;switch(e.finishedWork=r,e.finishedLanes=i,t){case 0:case 1:throw Error(s(345));case 2:case 5:bc(e,zl,ql);break;case 3:if(ac(e,i),(130023424&i)===i&&10<(t=Bl+500-Je())){if(0!==dt(e,0))break;if(((r=e.suspendedLanes)&i)!==i){ec(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=ir(bc.bind(null,e,zl,ql),t);break}bc(e,zl,ql);break;case 4:if(ac(e,i),(4194240&i)===i)break;for(t=e.eventTimes,r=-1;0<i;){var a=31-ot(i);o=1<<a,(a=t[a])>r&&(r=a),i&=~o}if(i=r,10<(i=(120>(i=Je()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Cl(i/1960))-i)){e.timeoutHandle=ir(bc.bind(null,e,zl,ql),i);break}bc(e,zl,ql);break;default:throw Error(s(329))}}}return ic(e,Je()),e.callbackNode===n?rc.bind(null,e):null}function sc(e,t){var n=Ul;return e.current.memoizedState.isDehydrated&&(dc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=zl,zl=n,null!==t&&oc(t)),e}function oc(e){null===zl?zl=e:zl.push.apply(zl,e)}function ac(e,t){for(t&=~Fl,t&=~jl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),i=1<<n;e[n]=-1,t&=~i}}function lc(e){if(0!==(6&kl))throw Error(s(327));Ec();var t=dt(e,0);if(0===(1&t))return ic(e,Je()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var i=pt(e);0!==i&&(t=i,n=sc(e,i))}if(1===n)throw n=Dl,dc(e,0),ac(e,t),ic(e,Je()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,bc(e,zl,ql),ic(e,Je()),null}function cc(e,t){var n=kl;kl|=1;try{return e(t)}finally{0===(kl=n)&&(Vl=Je()+500,Ur&&Vr())}}function uc(e){null!==Zl&&0===Zl.tag&&0===(6&kl)&&Ec();var t=kl;kl|=1;var n=Il.transition,i=yt;try{if(Il.transition=null,yt=1,e)return e()}finally{yt=i,Il.transition=n,0===(6&(kl=t))&&Vr()}}function hc(){Rl=Ll.current,xr(Ll)}function dc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,rr(n)),null!==Nl)for(n=Nl.return;null!==n;){var i=n;switch(ts(i),i.tag){case 1:null!==(i=i.type.childContextTypes)&&void 0!==i&&Lr();break;case 3:Ys(),xr(Pr),xr(kr),no();break;case 5:Xs(i);break;case 4:Ys();break;case 13:case 19:xr($s);break;case 10:Is(i.type._context);break;case 22:case 23:hc()}n=n.return}if(Pl=e,Nl=e=Lc(e.current,null),Al=Rl=t,Ol=0,Dl=null,Fl=jl=Ml=0,zl=Ul=null,null!==As){for(t=0;t<As.length;t++)if(null!==(i=(n=As[t]).interleaved)){n.interleaved=null;var r=i.next,s=n.pending;if(null!==s){var o=s.next;s.next=r,i.next=o}n.pending=i}As=null}return e}function fc(e,t){for(;;){var n=Nl;try{if(Ss(),io.current=Xo,co){for(var i=oo.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}co=!1}if(so=0,lo=ao=oo=null,uo=!1,ho=0,Sl.current=null,null===n||null===n.return){Ol=1,Dl=t,Nl=null;break}e:{var o=e,a=n.return,l=n,c=t;if(t=Al,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=ga(a);if(null!==p){p.flags&=-257,_a(p,a,l,0,t),1&p.mode&&ma(o,u,t),c=u;var m=(t=p).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){ma(o,u,t),mc();break e}c=Error(s(426))}else if(rs&&1&l.mode){var _=ga(a);if(null!==_){0===(65536&_.flags)&&(_.flags|=256),_a(_,a,l,0,t),ps(ca(c,l));break e}}o=c=ca(c,l),4!==Ol&&(Ol=2),null===Ul?Ul=[o]:Ul.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Bs(o,fa(0,c,t));break e;case 1:l=c;var v=o.type,y=o.stateNode;if(0===(128&o.flags)&&("function"===typeof v.getDerivedStateFromError||null!==y&&"function"===typeof y.componentDidCatch&&(null===Kl||!Kl.has(y)))){o.flags|=65536,t&=-t,o.lanes|=t,Bs(o,pa(o,l,t));break e}}o=o.return}while(null!==o)}wc(n)}catch(w){t=w,Nl===n&&null!==n&&(Nl=n=n.return);continue}break}}function pc(){var e=xl.current;return xl.current=Xo,null===e?Xo:e}function mc(){0!==Ol&&3!==Ol&&2!==Ol||(Ol=4),null===Pl||0===(268435455&Ml)&&0===(268435455&jl)||ac(Pl,Al)}function gc(e,t){var n=kl;kl|=2;var i=pc();for(Pl===e&&Al===t||(ql=null,dc(e,t));;)try{_c();break}catch(r){fc(e,r)}if(Ss(),kl=n,xl.current=i,null!==Nl)throw Error(s(261));return Pl=null,Al=0,Ol}function _c(){for(;null!==Nl;)yc(Nl)}function vc(){for(;null!==Nl&&!Qe();)yc(Nl)}function yc(e){var t=Tl(e.alternate,e,Rl);e.memoizedProps=e.pendingProps,null===t?wc(e):Nl=t,Sl.current=null}function wc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ga(n,t,Rl)))return void(Nl=n)}else{if(null!==(n=Za(n,t)))return n.flags&=32767,void(Nl=n);if(null===e)return Ol=6,void(Nl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Nl=t);Nl=t=e}while(null!==t);0===Ol&&(Ol=5)}function bc(e,t,n){var i=yt,r=Il.transition;try{Il.transition=null,yt=1,function(e,t,n,i){do{Ec()}while(null!==Zl);if(0!==(6&kl))throw Error(s(327));n=e.finishedWork;var r=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-ot(n),s=1<<r;t[r]=0,i[r]=-1,e[r]=-1,n&=~s}}(e,o),e===Pl&&(Nl=Pl=null,Al=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Gl||(Gl=!0,Pc(tt,function(){return Ec(),null})),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Il.transition,Il.transition=null;var a=yt;yt=1;var l=kl;kl|=4,Sl.current=null,function(e,t){if(er=Ht,fi(e=di())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var r=i.anchorOffset,o=i.focusNode;i=i.focusOffset;try{n.nodeType,o.nodeType}catch(b){n=null;break e}var a=0,l=-1,c=-1,u=0,h=0,d=e,f=null;t:for(;;){for(var p;d!==n||0!==r&&3!==d.nodeType||(l=a+r),d!==o||0!==i&&3!==d.nodeType||(c=a+i),3===d.nodeType&&(a+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===e)break t;if(f===n&&++u===r&&(l=a),f===o&&++h===i&&(c=a),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(tr={focusedElem:e,selectionRange:n},Ht=!1,Xa=t;null!==Xa;)if(e=(t=Xa).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Xa=e;else for(;null!==Xa;){t=Xa;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,_=m.memoizedState,v=t.stateNode,y=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:na(t.type,g),_);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(s(163))}}catch(b){Cc(t,t.return,b)}if(null!==(e=t.sibling)){e.return=t.return,Xa=e;break}Xa=t.return}m=tl,tl=!1}(e,n),gl(n,e),pi(tr),Ht=!!er,tr=er=null,e.current=n,vl(n,e,r),Ye(),kl=l,yt=a,Il.transition=o}else e.current=n;if(Gl&&(Gl=!1,Zl=e,Ql=r),o=e.pendingLanes,0===o&&(Kl=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ic(e,Je()),null!==t)for(i=e.onRecoverableError,n=0;n<t.length;n++)r=t[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(Hl)throw Hl=!1,e=Wl,Wl=null,e;0!==(1&Ql)&&0!==e.tag&&Ec(),o=e.pendingLanes,0!==(1&o)?e===Jl?Yl++:(Yl=0,Jl=e):Yl=0,Vr()}(e,t,n,i)}finally{Il.transition=r,yt=i}return null}function Ec(){if(null!==Zl){var e=wt(Ql),t=Il.transition,n=yt;try{if(Il.transition=null,yt=16>e?16:e,null===Zl)var i=!1;else{if(e=Zl,Zl=null,Ql=0,0!==(6&kl))throw Error(s(331));var r=kl;for(kl|=4,Xa=e.current;null!==Xa;){var o=Xa,a=o.child;if(0!==(16&Xa.flags)){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Xa=u;null!==Xa;){var h=Xa;switch(h.tag){case 0:case 11:case 15:nl(8,h,o)}var d=h.child;if(null!==d)d.return=h,Xa=d;else for(;null!==Xa;){var f=(h=Xa).sibling,p=h.return;if(sl(h),h===u){Xa=null;break}if(null!==f){f.return=p,Xa=f;break}Xa=p}}}var m=o.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var _=g.sibling;g.sibling=null,g=_}while(null!==g)}}Xa=o}}if(0!==(2064&o.subtreeFlags)&&null!==a)a.return=o,Xa=a;else e:for(;null!==Xa;){if(0!==(2048&(o=Xa).flags))switch(o.tag){case 0:case 11:case 15:nl(9,o,o.return)}var v=o.sibling;if(null!==v){v.return=o.return,Xa=v;break e}Xa=o.return}}var y=e.current;for(Xa=y;null!==Xa;){var w=(a=Xa).child;if(0!==(2064&a.subtreeFlags)&&null!==w)w.return=a,Xa=w;else e:for(a=y;null!==Xa;){if(0!==(2048&(l=Xa).flags))try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(E){Cc(l,l.return,E)}if(l===a){Xa=null;break e}var b=l.sibling;if(null!==b){b.return=l.return,Xa=b;break e}Xa=l.return}}if(kl=r,Vr(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(rt,e)}catch(E){}i=!0}return i}finally{yt=n,Il.transition=t}}return!1}function Tc(e,t,n){e=Us(e,t=fa(0,t=ca(n,t),1),1),t=ec(),null!==e&&(_t(e,1,t),ic(e,t))}function Cc(e,t,n){if(3===e.tag)Tc(e,e,n);else for(;null!==t;){if(3===t.tag){Tc(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===Kl||!Kl.has(i))){t=Us(t,e=pa(t,e=ca(n,e),1),1),e=ec(),null!==t&&(_t(t,1,e),ic(t,e));break}}t=t.return}}function xc(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Pl===e&&(Al&n)===n&&(4===Ol||3===Ol&&(130023424&Al)===Al&&500>Je()-Bl?dc(e,0):Fl|=n),ic(e,t)}function Sc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=ec();null!==(e=Os(e,t))&&(_t(e,t,n),ic(e,n))}function Ic(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Sc(e,n)}function kc(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(s(314))}null!==i&&i.delete(t),Sc(e,n)}function Pc(e,t){return Ge(e,t)}function Nc(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ac(e,t,n,i){return new Nc(e,t,n,i)}function Rc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Lc(e,t){var n=e.alternate;return null===n?((n=Ac(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Oc(e,t,n,i,r,o){var a=2;if(i=e,"function"===typeof e)Rc(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case T:return Dc(n.children,r,o,t);case C:a=8,r|=8;break;case x:return(e=Ac(12,n,t,2|r)).elementType=x,e.lanes=o,e;case P:return(e=Ac(13,n,t,r)).elementType=P,e.lanes=o,e;case N:return(e=Ac(19,n,t,r)).elementType=N,e.lanes=o,e;case L:return Mc(n,r,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case S:a=10;break e;case I:a=9;break e;case k:a=11;break e;case A:a=14;break e;case R:a=16,i=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Ac(a,n,t,r)).elementType=e,t.type=i,t.lanes=o,t}function Dc(e,t,n,i){return(e=Ac(7,e,i,t)).lanes=n,e}function Mc(e,t,n,i){return(e=Ac(22,e,i,t)).elementType=L,e.lanes=n,e.stateNode={isHidden:!1},e}function jc(e,t,n){return(e=Ac(6,e,null,t)).lanes=n,e}function Fc(e,t,n){return(t=Ac(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uc(e,t,n,i,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function zc(e,t,n,i,r,s,o,a,l){return e=new Uc(e,t,n,a,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Ac(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ms(s),e}function Bc(e){if(!e)return Ir;e:{if(Ve(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Rr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Rr(n))return Dr(e,n,t)}return t}function Vc(e,t,n,i,r,s,o,a,l){return(e=zc(n,i,!0,e,0,s,0,a,l)).context=Bc(null),n=e.current,(s=Fs(i=ec(),r=tc(n))).callback=void 0!==t&&null!==t?t:null,Us(n,s,r),e.current.lanes=r,_t(e,r,i),ic(e,i),e}function qc(e,t,n,i){var r=t.current,s=ec(),o=tc(r);return n=Bc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Fs(s,o)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),null!==(e=Us(r,t,o))&&(nc(e,r,o,s),zs(e,r,o)),o}function Hc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Wc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Kc(e,t){Wc(e,t),(e=e.alternate)&&Wc(e,t)}Tl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Pr.current)ya=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return ya=!1,function(e,t,n){switch(t.tag){case 3:Pa(t),fs();break;case 5:Js(t);break;case 1:Rr(t.type)&&Mr(t);break;case 4:Qs(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,r=t.memoizedProps.value;Sr(Es,i._currentValue),i._currentValue=r;break;case 13:if(null!==(i=t.memoizedState))return null!==i.dehydrated?(Sr($s,1&$s.current),t.flags|=128,null):0!==(n&t.child.childLanes)?ja(e,t,n):(Sr($s,1&$s.current),null!==(e=Ha(e,t,n))?e.sibling:null);Sr($s,1&$s.current);break;case 19:if(i=0!==(n&t.childLanes),0!==(128&e.flags)){if(i)return Va(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Sr($s,$s.current),i)break;return null;case 22:case 23:return t.lanes=0,Ca(e,t,n)}return Ha(e,t,n)}(e,t,n);ya=0!==(131072&e.flags)}else ya=!1,rs&&0!==(1048576&t.flags)&&$r(t,Kr,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;qa(e,t),e=t.pendingProps;var r=Ar(t,kr.current);Ps(t,n),r=go(null,t,i,e,r,n);var o=_o();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Rr(i)?(o=!0,Mr(t)):o=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Ms(t),r.updater=ra,t.stateNode=r,r._reactInternals=t,la(t,i,e,n),t=ka(null,t,i,!0,o,n)):(t.tag=0,rs&&o&&es(t),wa(null,t,r,n),t=t.child),t;case 16:i=t.elementType;e:{switch(qa(e,t),e=t.pendingProps,i=(r=i._init)(i._payload),t.type=i,r=t.tag=function(e){if("function"===typeof e)return Rc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===k)return 11;if(e===A)return 14}return 2}(i),e=na(i,e),r){case 0:t=Sa(null,t,i,e,n);break e;case 1:t=Ia(null,t,i,e,n);break e;case 11:t=ba(null,t,i,e,n);break e;case 14:t=Ea(null,t,i,na(i.type,e),n);break e}throw Error(s(306,i,""))}return t;case 0:return i=t.type,r=t.pendingProps,Sa(e,t,i,r=t.elementType===i?r:na(i,r),n);case 1:return i=t.type,r=t.pendingProps,Ia(e,t,i,r=t.elementType===i?r:na(i,r),n);case 3:e:{if(Pa(t),null===e)throw Error(s(387));i=t.pendingProps,r=(o=t.memoizedState).element,js(e,t),Vs(t,i,null,n);var a=t.memoizedState;if(i=a.element,o.isDehydrated){if(o={element:i,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Na(e,t,i,n,r=ca(Error(s(423)),t));break e}if(i!==r){t=Na(e,t,i,n,r=ca(Error(s(424)),t));break e}for(is=cr(t.stateNode.containerInfo.firstChild),ns=t,rs=!0,ss=null,n=bs(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fs(),i===r){t=Ha(e,t,n);break e}wa(e,t,i,n)}t=t.child}return t;case 5:return Js(t),null===e&&cs(t),i=t.type,r=t.pendingProps,o=null!==e?e.memoizedProps:null,a=r.children,nr(i,r)?a=null:null!==o&&nr(i,o)&&(t.flags|=32),xa(e,t),wa(e,t,a,n),t.child;case 6:return null===e&&cs(t),null;case 13:return ja(e,t,n);case 4:return Qs(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=ws(t,null,i,n):wa(e,t,i,n),t.child;case 11:return i=t.type,r=t.pendingProps,ba(e,t,i,r=t.elementType===i?r:na(i,r),n);case 7:return wa(e,t,t.pendingProps,n),t.child;case 8:case 12:return wa(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,r=t.pendingProps,o=t.memoizedProps,a=r.value,Sr(Es,i._currentValue),i._currentValue=a,null!==o)if(ai(o.value,a)){if(o.children===r.children&&!Pr.current){t=Ha(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){a=o.child;for(var c=l.firstContext;null!==c;){if(c.context===i){if(1===o.tag){(c=Fs(-1,n&-n)).tag=2;var u=o.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),ks(o.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===o.tag)a=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(a=o.return))throw Error(s(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),ks(a,n,t),a=o.sibling}else a=o.child;if(null!==a)a.return=o;else for(a=o;null!==a;){if(a===t){a=null;break}if(null!==(o=a.sibling)){o.return=a.return,a=o;break}a=a.return}o=a}wa(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,i=t.pendingProps.children,Ps(t,n),i=i(r=Ns(r)),t.flags|=1,wa(e,t,i,n),t.child;case 14:return r=na(i=t.type,t.pendingProps),Ea(e,t,i,r=na(i.type,r),n);case 15:return Ta(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:na(i,r),qa(e,t),t.tag=1,Rr(i)?(e=!0,Mr(t)):e=!1,Ps(t,n),oa(t,i,r),la(t,i,r,n),ka(null,t,i,!0,e,n);case 19:return Va(e,t,n);case 22:return Ca(e,t,n)}throw Error(s(156,t.tag))};var Gc="function"===typeof reportError?reportError:function(e){console.error(e)};function Zc(e){this._internalRoot=e}function Qc(e){this._internalRoot=e}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Xc(){}function $c(e,t,n,i,r){var s=n._reactRootContainer;if(s){var o=s;if("function"===typeof r){var a=r;r=function(){var e=Hc(o);a.call(e)}}qc(t,o,e,r)}else o=function(e,t,n,i,r){if(r){if("function"===typeof i){var s=i;i=function(){var e=Hc(o);s.call(e)}}var o=Vc(t,i,e,0,null,!1,0,"",Xc);return e._reactRootContainer=o,e[pr]=o.current,Vi(8===e.nodeType?e.parentNode:e),uc(),o}for(;r=e.lastChild;)e.removeChild(r);if("function"===typeof i){var a=i;i=function(){var e=Hc(l);a.call(e)}}var l=zc(e,0,!1,null,0,!1,0,"",Xc);return e._reactRootContainer=l,e[pr]=l.current,Vi(8===e.nodeType?e.parentNode:e),uc(function(){qc(t,l,n,i)}),l}(n,t,e,r,i);return Hc(o)}Qc.prototype.render=Zc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));qc(e,t,null,null)},Qc.prototype.unmount=Zc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc(function(){qc(null,e,null,null)}),t[pr]=null}},Qc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ct();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Lt.length&&0!==t&&t<Lt[n].priority;n++);Lt.splice(n,0,e),0===n&&jt(e)}},bt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(vt(t,1|n),ic(t,Je()),0===(6&kl)&&(Vl=Je()+500,Vr()))}break;case 13:uc(function(){var t=Os(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}}),Kc(e,1)}},Et=function(e){if(13===e.tag){var t=Os(e,134217728);if(null!==t)nc(t,e,134217728,ec());Kc(e,134217728)}},Tt=function(e){if(13===e.tag){var t=tc(e),n=Os(e,t);if(null!==n)nc(n,e,t,ec());Kc(e,t)}},Ct=function(){return yt},xt=function(e,t){var n=yt;try{return yt=e,t()}finally{yt=n}},Ee=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var r=br(i);if(!r)throw Error(s(90));G(i),X(i,r)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},ke=cc,Pe=uc;var eu={usingClientEntryPoint:!1,Events:[yr,wr,br,Se,Ie,cc]},tu={findFiberByHostInstance:vr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{rt=iu.inject(nu),st=iu}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yc(t))throw Error(s(200));return function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:E,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Yc(e))throw Error(s(299));var n=!1,i="",r=Gc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=zc(e,1,!1,null,0,n,0,i,r),e[pr]=t.current,Vi(8===e.nodeType?e.parentNode:e),new Zc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Jc(t))throw Error(s(200));return $c(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Yc(e))throw Error(s(405));var i=null!=n&&n.hydratedSources||null,r=!1,o="",a=Gc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=Vc(t,null,e,1,null!=n?n:null,r,0,o,a),e[pr]=t.current,Vi(e),i)for(e=0;e<i.length;e++)r=(r=(n=i[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new Qc(t)},t.render=function(e,t,n){if(!Jc(t))throw Error(s(200));return $c(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(s(40));return!!e._reactRootContainer&&(uc(function(){$c(null,null,e,!1,function(){e._reactRootContainer=null,e[pr]=null})}),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!Jc(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return $c(e,t,n,!1,i)},t.version="18.3.1-next-f1338f8080-20240426"},853:(e,t,n)=>{"use strict";e.exports=n(234)},950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var s=t[i]={exports:{}};return e[i].call(s.exports,s,s.exports,n),s.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(i,r){if(1&r&&(i=this(i)),8&r)return i;if("object"===typeof i&&i){if(4&r&&i.__esModule)return i;if(16&r&&"function"===typeof i.then)return i}var s=Object.create(null);n.r(s);var o={};e=e||[null,t({}),t([]),t(t)];for(var a=2&r&&i;("object"==typeof a||"function"==typeof a)&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach(e=>o[e]=()=>i[e]);return o.default=()=>i,n.d(s,o),s}})(),n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,i)=>(n.f[i](e,t),t),[])),n.u=e=>"static/js/"+e+".7ebdcd24.chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="Fetchr:";n.l=(i,r,s,o)=>{if(e[i])e[i].push(r);else{var a,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var h=c[u];if(h.getAttribute("src")==i||h.getAttribute("data-webpack")==t+s){a=h;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,n.nc&&a.setAttribute("nonce",n.nc),a.setAttribute("data-webpack",t+s),a.src=i),e[i]=[r];var d=(t,n)=>{a.onerror=a.onload=null,clearTimeout(f);var r=e[i];if(delete e[i],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach(e=>e(n)),t)return t(n)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),l&&document.head.appendChild(a)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/",(()=>{var e={792:0};n.f.j=(t,i)=>{var r=n.o(e,t)?e[t]:void 0;if(0!==r)if(r)i.push(r[2]);else{var s=new Promise((n,i)=>r=e[t]=[n,i]);i.push(r[2]=s);var o=n.p+n.u(t),a=new Error;n.l(o,i=>{if(n.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var s=i&&("load"===i.type?"missing":i.type),o=i&&i.target&&i.target.src;a.message="Loading chunk "+t+" failed.\n("+s+": "+o+")",a.name="ChunkLoadError",a.type=s,a.request=o,r[1](a)}},"chunk-"+t,t)}};var t=(t,i)=>{var r,s,o=i[0],a=i[1],l=i[2],c=0;if(o.some(t=>0!==e[t])){for(r in a)n.o(a,r)&&(n.m[r]=a[r]);if(l)l(n)}for(t&&t(i);c<o.length;c++)s=o[c],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0},i=self.webpackChunkFetchr=self.webpackChunkFetchr||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})(),(()=>{"use strict";var e,t=n(43),i=n.t(t,2),r=n(391),s=n(950),o=n.t(s,2);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},a.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(e||(e={}));const l="popstate";function c(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function u(e,t){return{usr:e.state,key:e.key,idx:t}}function h(e,t,n,i){return void 0===n&&(n=null),a({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?f(t):t,{state:n,key:t&&t.key||i||Math.random().toString(36).substr(2,8)})}function d(e){let{pathname:t="/",search:n="",hash:i=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),i&&"#"!==i&&(t+="#"===i.charAt(0)?i:"#"+i),t}function f(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let i=e.indexOf("?");i>=0&&(t.search=e.substr(i),e=e.substr(0,i)),e&&(t.pathname=e)}return t}function p(t,n,i,r){void 0===r&&(r={});let{window:s=document.defaultView,v5Compat:o=!1}=r,f=s.history,p=e.Pop,m=null,g=_();function _(){return(f.state||{idx:null}).idx}function v(){p=e.Pop;let t=_(),n=null==t?null:t-g;g=t,m&&m({action:p,location:w.location,delta:n})}function y(e){let t="null"!==s.location.origin?s.location.origin:s.location.href,n="string"===typeof e?e:d(e);return n=n.replace(/ $/,"%20"),c(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==g&&(g=0,f.replaceState(a({},f.state,{idx:g}),""));let w={get action(){return p},get location(){return t(s,f)},listen(e){if(m)throw new Error("A history only accepts one active listener");return s.addEventListener(l,v),m=e,()=>{s.removeEventListener(l,v),m=null}},createHref:e=>n(s,e),createURL:y,encodeLocation(e){let t=y(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(t,n){p=e.Push;let r=h(w.location,t,n);i&&i(r,t),g=_()+1;let a=u(r,g),l=w.createHref(r);try{f.pushState(a,"",l)}catch(I_){if(I_ instanceof DOMException&&"DataCloneError"===I_.name)throw I_;s.location.assign(l)}o&&m&&m({action:p,location:w.location,delta:1})},replace:function(t,n){p=e.Replace;let r=h(w.location,t,n);i&&i(r,t),g=_();let s=u(r,g),a=w.createHref(r);f.replaceState(s,"",a),o&&m&&m({action:p,location:w.location,delta:0})},go:e=>f.go(e)};return w}var m;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(m||(m={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function g(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,i=e.charAt(n);return i&&"/"!==i?null:e.slice(n)||"/"}Error;const _=["post","put","patch","delete"],v=(new Set(_),["get",..._]);new Set(v),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function y(){return y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},y.apply(this,arguments)}const w=t.createContext(null);const b=t.createContext(null);function E(){return null!=t.useContext(b)}t.Component;function T(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}i.startTransition;function C(n){let{basename:i="/",children:r=null,location:s,navigationType:o=e.Pop,navigator:a,static:l=!1,future:u}=n;E()&&c(!1);let h=i.replace(/^\/*/,"/"),d=t.useMemo(()=>({basename:h,navigator:a,static:l,future:y({v7_relativeSplatPath:!1},u)}),[h,u,a,l]);"string"===typeof s&&(s=f(s));let{pathname:p="/",search:m="",hash:_="",state:v=null,key:T="default"}=s,C=t.useMemo(()=>{let e=g(p,h);return null==e?null:{location:{pathname:e,search:m,hash:_,state:v,key:T},navigationType:o}},[h,p,m,_,v,T,o]);return null==C?null:t.createElement(w.Provider,{value:d},t.createElement(b.Provider,{children:r,value:C}))}new Promise(()=>{});t.Component;new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);try{window.__reactRouterVersion="6"}catch(aC){}new Map;const x=i.startTransition;o.flushSync,i.useId;function S(e){let{basename:n,children:i,future:r,window:s}=e,o=t.useRef();var a;null==o.current&&(o.current=(void 0===(a={window:s,v5Compat:!0})&&(a={}),p(function(e,t){let{pathname:n,search:i,hash:r}=e.location;return h("",{pathname:n,search:i,hash:r},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:d(t)},null,a)));let l=o.current,[c,u]=t.useState({action:l.action,location:l.location}),{v7_startTransition:f}=r||{},m=t.useCallback(e=>{f&&x?x(()=>u(e)):u(e)},[u,f]);return t.useLayoutEffect(()=>l.listen(m),[l,m]),t.useEffect(()=>T(r),[r]),t.createElement(C,{basename:n,children:i,location:c.location,navigationType:c.action,navigator:l,future:r})}"undefined"!==typeof window&&"undefined"!==typeof window.document&&window.document.createElement;var I,k;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(I||(I={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(k||(k={}));const P=!1,N=!1,A="${JSCORE_VERSION}",R=function(e,t){if(!e)throw L(t)},L=function(e){return new Error("Firebase Database ("+A+") INTERNAL ASSERT FAILED: "+e)},O=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);r<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296===(64512&r)&&i+1<e.length&&56320===(64512&e.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&e.charCodeAt(++i)),t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128)}return t},D={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<e.length;r+=3){const t=e[r],s=r+1<e.length,o=s?e[r+1]:0,a=r+2<e.length,l=a?e[r+2]:0,c=t>>2,u=(3&t)<<4|o>>4;let h=(15&o)<<2|l>>6,d=63&l;a||(d=64,s||(h=64)),i.push(n[c],n[u],n[h],n[d])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(O(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,i=0;for(;n<e.length;){const r=e[n++];if(r<128)t[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=e[n++];t[i++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){const s=((7&r)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[i++]=String.fromCharCode(55296+(s>>10)),t[i++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[i++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<e.length;){const t=n[e.charAt(r++)],s=r<e.length?n[e.charAt(r)]:0;++r;const o=r<e.length?n[e.charAt(r)]:64;++r;const a=r<e.length?n[e.charAt(r)]:64;if(++r,null==t||null==s||null==o||null==a)throw new M;const l=t<<2|s>>4;if(i.push(l),64!==o){const e=s<<4&240|o>>2;if(i.push(e),64!==a){const e=o<<6&192|a;i.push(e)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class M extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const j=function(e){const t=O(e);return D.encodeByteArray(t,!0)},F=function(e){return j(e).replace(/\./g,"")},U=function(e){try{return D.decodeString(e,!0)}catch(aC){console.error("base64Decode failed: ",aC)}return null};function z(e){return B(void 0,e)}function B(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&V(n)&&(e[n]=B(e[n],t[n]));return e}function V(e){return"__proto__"!==e}const q=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,H=()=>{try{return q()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyDoWYF5rEHMliG2tAbiE4OM8qvjAssT8Pc",REACT_APP_FIREBASE_AUTH_DOMAIN:"hackru-cc78a.firebaseapp.com",REACT_APP_FIREBASE_DATABASE_URL:"https://hackru-cc78a-default-rtdb.firebaseio.com",REACT_APP_FIREBASE_PROJECT_ID:"hackru-cc78a",REACT_APP_FIREBASE_STORAGE_BUCKET:"hackru-cc78a.firebasestorage.app",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"53406972833",REACT_APP_FIREBASE_APP_ID:"1:53406972833:web:0a038d10f85d215b1829e0",REACT_APP_FIREBASE_MEASUREMENT_ID:"G-3D65B0W7J7",REACT_APP_API_BASE:"http://localhost:8080",REACT_APP_SERVER_IP:"10.74.159.48"}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(aC){return}const t=e&&U(e[1]);return t&&JSON.parse(t)})()}catch(aC){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(aC))}},W=e=>{var t,n;return null===(n=null===(t=H())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},K=e=>{const t=W(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));const i=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),i]:[t.substring(0,n),i]},G=()=>{var e;return null===(e=H())||void 0===e?void 0:e.config},Z=e=>{var t;return null===(t=H())||void 0===t?void 0:t["_".concat(e)]};class Q{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function Y(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",i=e.iat||0,r=e.sub||e.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},e);return[F(JSON.stringify({alg:"none",type:"JWT"})),F(JSON.stringify(s)),""].join(".")}function J(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function X(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(J())}function $(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function ee(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function te(){return!0===P||!0===N}function ne(){return!function(){var e;const t=null===(e=H())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(aC){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ie(){try{return"object"===typeof indexedDB}catch(aC){return!1}}function re(){return new Promise((e,t)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),e(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var e;t((null===(e=r.error)||void 0===e?void 0:e.message)||"")}}catch(I_){t(I_)}})}class se extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,se.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,oe.prototype.create)}}class oe{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),i=this.errors[e],r=i?function(e,t){return e.replace(ae,(e,n)=>{const i=t[n];return null!=i?String(i):"<".concat(n,"?>")})}(i,t):"Error",s="".concat(this.serviceName,": ").concat(r," (").concat(n,").");return new se(n,s,t)}}const ae=/\{\$([^}]+)}/g;function le(e){return JSON.parse(e)}function ce(e){return JSON.stringify(e)}const ue=function(e){let t={},n={},i={},r="";try{const s=e.split(".");t=le(U(s[0])||""),n=le(U(s[1])||""),r=s[2],i=n.d||{},delete n.d}catch(aC){}return{header:t,claims:n,data:i,signature:r}};function he(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function de(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function fe(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function pe(e,t,n){const i={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=t.call(n,e[r],r,e));return i}function me(e,t){if(e===t)return!0;const n=Object.keys(e),i=Object.keys(t);for(const r of n){if(!i.includes(r))return!1;const n=e[r],s=t[r];if(ge(n)&&ge(s)){if(!me(n,s))return!1}else if(n!==s)return!1}for(const r of i)if(!n.includes(r))return!1;return!0}function ge(e){return null!==e&&"object"===typeof e}function _e(e){const t=[];for(const[n,i]of Object.entries(e))Array.isArray(i)?i.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}function ve(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[n,i]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(i)}}),t}function ye(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class we{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if("string"===typeof e)for(let u=0;u<16;u++)n[u]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let u=0;u<16;u++)n[u]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let u=16;u<80;u++){const e=n[u-3]^n[u-8]^n[u-14]^n[u-16];n[u]=4294967295&(e<<1|e>>>31)}let i,r,s=this.chain_[0],o=this.chain_[1],a=this.chain_[2],l=this.chain_[3],c=this.chain_[4];for(let u=0;u<80;u++){u<40?u<20?(i=l^o&(a^l),r=1518500249):(i=o^a^l,r=1859775393):u<60?(i=o&a|l&(o|a),r=2400959708):(i=o^a^l,r=3395469782);const e=(s<<5|s>>>27)+i+c+r+n[u]&4294967295;c=l,l=a,a=4294967295&(o<<30|o>>>2),o=s,s=e}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const n=t-this.blockSize;let i=0;const r=this.buf_;let s=this.inbuf_;for(;i<t;){if(0===s)for(;i<=n;)this.compress_(e,i),i+=this.blockSize;if("string"===typeof e){for(;i<t;)if(r[s]=e.charCodeAt(i),++s,++i,s===this.blockSize){this.compress_(r),s=0;break}}else for(;i<t;)if(r[s]=e[i],++s,++i,s===this.blockSize){this.compress_(r),s=0;break}}this.inbuf_=s,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let i=0;i<5;i++)for(let t=24;t>=0;t-=8)e[n]=this.chain_[i]>>t&255,++n;return e}}class be{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let i;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");i=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===i.next&&(i.next=Ee),void 0===i.error&&(i.error=Ee),void 0===i.complete&&(i.complete=Ee);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(aC){}}),this.observers.push(i),r}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(aC){"undefined"!==typeof console&&console.error&&console.error(aC)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Ee(){}function Te(e,t){return"".concat(e," failed: ").concat(t," argument ")}const Ce=function(e){let t=0;for(let n=0;n<e.length;n++){const i=e.charCodeAt(n);i<128?t++:i<2048?t+=2:i>=55296&&i<=56319?(t+=4,n++):t+=3}return t};function xe(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3)*Math.pow(t,e),i=Math.round(.5*n*(Math.random()-.5)*2);return Math.min(144e5,n+i)}function Se(e){return e&&e._delegate?e._delegate:e}class Ie{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const ke="[DEFAULT]";class Pe{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new Q;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(aC){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),i=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(aC){if(i)return null;throw aC}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:ke})}catch(aC){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(aC){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ke;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ke;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ke;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[r,s]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(r)&&s.resolve(i)}return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(e),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch(i){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:(r=t,r===ke?void 0:r),options:n}),this.instances.set(t,i),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch(s){}var r;return i||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ke;return this.component?this.component.multipleInstances?e:ke:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Ne{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Pe(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const Ae=[];var Re;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(Re||(Re={}));const Le={debug:Re.DEBUG,verbose:Re.VERBOSE,info:Re.INFO,warn:Re.WARN,error:Re.ERROR,silent:Re.SILENT},Oe=Re.INFO,De={[Re.DEBUG]:"log",[Re.VERBOSE]:"log",[Re.INFO]:"info",[Re.WARN]:"warn",[Re.ERROR]:"error"},Me=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),i=De[t];if(!i)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var r=arguments.length,s=new Array(r>2?r-2:0),o=2;o<r;o++)s[o-2]=arguments[o];console[i]("[".concat(n,"]  ").concat(e.name,":"),...s)};class je{constructor(e){this.name=e,this._logLevel=Oe,this._logHandler=Me,this._userLogHandler=null,Ae.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Re))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?Le[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Re.DEBUG,...t),this._logHandler(this,Re.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Re.VERBOSE,...t),this._logHandler(this,Re.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Re.INFO,...t),this._logHandler(this,Re.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Re.WARN,...t),this._logHandler(this,Re.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Re.ERROR,...t),this._logHandler(this,Re.ERROR,...t)}}function Fe(e){return Fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fe(e)}function Ue(e){var t=function(e,t){if("object"!=Fe(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=Fe(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Fe(t)?t:t+""}function ze(e,t,n){return(t=Ue(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function Ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(n),!0).forEach(function(t){ze(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Be(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}let qe,He;const We=new WeakMap,Ke=new WeakMap,Ge=new WeakMap,Ze=new WeakMap,Qe=new WeakMap;let Ye={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Ke.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Ge.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return $e(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Je(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(He||(He=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e.apply(et(this),n),$e(We.get(this))}:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return $e(e.apply(et(this),n))}:function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];const s=e.call(et(this),t,...i);return Ge.set(s,t.sort?t.sort():[t]),$e(s)}}function Xe(e){return"function"===typeof e?Je(e):(e instanceof IDBTransaction&&function(e){if(Ke.has(e))return;const t=new Promise((t,n)=>{const i=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",s),e.removeEventListener("abort",s)},r=()=>{t(),i()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",r),e.addEventListener("error",s),e.addEventListener("abort",s)});Ke.set(e,t)}(e),t=e,(qe||(qe=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,Ye):e);var t}function $e(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const i=()=>{e.removeEventListener("success",r),e.removeEventListener("error",s)},r=()=>{t($e(e.result)),i()},s=()=>{n(e.error),i()};e.addEventListener("success",r),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&We.set(t,e)}).catch(()=>{}),Qe.set(t,e),t}(e);if(Ze.has(e))return Ze.get(e);const t=Xe(e);return t!==e&&(Ze.set(e,t),Qe.set(t,e)),t}const et=e=>Qe.get(e);function tt(e,t){let{blocked:n,upgrade:i,blocking:r,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=indexedDB.open(e,t),a=$e(o);return i&&o.addEventListener("upgradeneeded",e=>{i($e(o.result),e.oldVersion,e.newVersion,$e(o.transaction),e)}),n&&o.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),a.then(e=>{s&&e.addEventListener("close",()=>s()),r&&e.addEventListener("versionchange",e=>r(e.oldVersion,e.newVersion,e))}).catch(()=>{}),a}const nt=["get","getKey","getAll","getAllKeys","count"],it=["put","add","delete","clear"],rt=new Map;function st(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(rt.get(t))return rt.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,r=it.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!nt.includes(n))return;const s=async function(e){const t=this.transaction(e,r?"readwrite":"readonly");let s=t.store;for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];return i&&(s=s.index(a.shift())),(await Promise.all([s[n](...a),r&&t.done]))[0]};return rt.set(t,s),s}Ye=(e=>Ve(Ve({},e),{},{get:(t,n,i)=>st(t,n)||e.get(t,n,i),has:(t,n)=>!!st(t,n)||e.has(t,n)}))(Ye);class ot{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(e=>e).join(" ")}}const at="@firebase/app",lt="0.10.13",ct=new je("@firebase/app"),ut="@firebase/app-compat",ht="@firebase/analytics-compat",dt="@firebase/analytics",ft="@firebase/app-check-compat",pt="@firebase/app-check",mt="@firebase/auth",gt="@firebase/auth-compat",_t="@firebase/database",vt="@firebase/data-connect",yt="@firebase/database-compat",wt="@firebase/functions",bt="@firebase/functions-compat",Et="@firebase/installations",Tt="@firebase/installations-compat",Ct="@firebase/messaging",xt="@firebase/messaging-compat",St="@firebase/performance",It="@firebase/performance-compat",kt="@firebase/remote-config",Pt="@firebase/remote-config-compat",Nt="@firebase/storage",At="@firebase/storage-compat",Rt="@firebase/firestore",Lt="@firebase/vertexai-preview",Ot="@firebase/firestore-compat",Dt="firebase",Mt="[DEFAULT]",jt={[at]:"fire-core",[ut]:"fire-core-compat",[dt]:"fire-analytics",[ht]:"fire-analytics-compat",[pt]:"fire-app-check",[ft]:"fire-app-check-compat",[mt]:"fire-auth",[gt]:"fire-auth-compat",[_t]:"fire-rtdb",[vt]:"fire-data-connect",[yt]:"fire-rtdb-compat",[wt]:"fire-fn",[bt]:"fire-fn-compat",[Et]:"fire-iid",[Tt]:"fire-iid-compat",[Ct]:"fire-fcm",[xt]:"fire-fcm-compat",[St]:"fire-perf",[It]:"fire-perf-compat",[kt]:"fire-rc",[Pt]:"fire-rc-compat",[Nt]:"fire-gcs",[At]:"fire-gcs-compat",[Rt]:"fire-fst",[Ot]:"fire-fst-compat",[Lt]:"fire-vertex","fire-js":"fire-js",[Dt]:"fire-js-all"},Ft=new Map,Ut=new Map,zt=new Map;function Bt(e,t){try{e.container.addComponent(t)}catch(aC){ct.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),aC)}}function Vt(e){const t=e.name;if(zt.has(t))return ct.debug("There were multiple attempts to register component ".concat(t,".")),!1;zt.set(t,e);for(const n of Ft.values())Bt(n,e);for(const n of Ut.values())Bt(n,e);return!0}function qt(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function Ht(e){return void 0!==e.settings}const Wt=new oe("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class Kt{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Ie("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Wt.create("app-deleted",{appName:this._name})}}const Gt="10.14.1";function Zt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const i=Object.assign({name:Mt,automaticDataCollectionEnabled:!1},t),r=i.name;if("string"!==typeof r||!r)throw Wt.create("bad-app-name",{appName:String(r)});if(n||(n=G()),!n)throw Wt.create("no-options");const s=Ft.get(r);if(s){if(me(n,s.options)&&me(i,s.config))return s;throw Wt.create("duplicate-app",{appName:r})}const o=new Ne(r);for(const l of zt.values())o.addComponent(l);const a=new Kt(n,i,o);return Ft.set(r,a),a}function Qt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mt;const t=Ft.get(e);if(!t&&e===Mt&&G())return Zt();if(!t)throw Wt.create("no-app",{appName:e});return t}function Yt(e,t,n){var i;let r=null!==(i=jt[e])&&void 0!==i?i:e;n&&(r+="-".concat(n));const s=r.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=['Unable to register library "'.concat(r,'" with version "').concat(t,'":')];return s&&e.push('library name "'.concat(r,'" contains illegal characters (whitespace or "/")')),s&&o&&e.push("and"),o&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void ct.warn(e.join(" "))}Vt(new Ie("".concat(r,"-version"),()=>({library:r,version:t}),"VERSION"))}const Jt="firebase-heartbeat-store";let Xt=null;function $t(){return Xt||(Xt=tt("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(Jt)}catch(aC){console.warn(aC)}}}).catch(e=>{throw Wt.create("idb-open",{originalErrorMessage:e.message})})),Xt}async function en(e,t){try{const n=(await $t()).transaction(Jt,"readwrite"),i=n.objectStore(Jt);await i.put(t,tn(e)),await n.done}catch(aC){if(aC instanceof se)ct.warn(aC.message);else{const t=Wt.create("idb-set",{originalErrorMessage:null===aC||void 0===aC?void 0:aC.message});ct.warn(t.message)}}}function tn(e){return"".concat(e.name,"!").concat(e.options.appId)}class nn{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new sn(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=rn();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(e=>e.date===i))return;return this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6}),this._storage.overwrite(this._heartbeatsCache)}catch(aC){ct.warn(aC)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=rn(),{heartbeatsToSend:n,unsentEntries:i}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let i=e.slice();for(const r of e){const e=n.find(e=>e.agent===r.agent);if(e){if(e.dates.push(r.date),on(n)>t){e.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),on(n)>t){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),r=F(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(aC){return ct.warn(aC),""}}}function rn(){return(new Date).toISOString().substring(0,10)}class sn{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!ie()&&re().then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await $t()).transaction(Jt),n=await t.objectStore(Jt).get(tn(e));return await t.done,n}catch(aC){if(aC instanceof se)ct.warn(aC.message);else{const t=Wt.create("idb-get",{originalErrorMessage:null===aC||void 0===aC?void 0:aC.message});ct.warn(t.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return en(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return en(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function on(e){return F(JSON.stringify({version:2,heartbeats:e})).length}var an;an="",Vt(new Ie("platform-logger",e=>new ot(e),"PRIVATE")),Vt(new Ie("heartbeat",e=>new nn(e),"PRIVATE")),Yt(at,lt,an),Yt(at,lt,"esm2017"),Yt("fire-js","");function ln(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;function cn(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const un=cn,hn=new oe("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),dn=new je("@firebase/auth");function fn(e){if(dn.logLevel<=Re.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];dn.error("Auth (".concat(Gt,"): ").concat(e),...n)}}function pn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];throw yn(e,...n)}function mn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return yn(e,...n)}function gn(e,t,n){const i=Object.assign(Object.assign({},un()),{[t]:n});return new oe("auth","Firebase",i).create(t,{appName:e.name})}function _n(e){return gn(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function vn(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&pn(e,"argument-error"),gn(e,"argument-error","Type of ".concat(t.constructor.name," does not match expected instance.")+"Did you pass a reference from a different Auth SDK?")}function yn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if("string"!==typeof e){const t=n[0],i=[...n.slice(1)];return i[0]&&(i[0].appName=e.name),e._errorFactory.create(t,...i)}return hn.create(e,...n)}function wn(e,t){if(!e){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];throw yn(t,...i)}}function bn(e){const t="INTERNAL ASSERTION FAILED: "+e;throw fn(t),new Error(t)}function En(e,t){e||bn(t)}function Tn(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Cn(){return"http:"===xn()||"https:"===xn()}function xn(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class Sn{constructor(e,t){this.shortDelay=e,this.longDelay=t,En(t>e,"Short delay should be less than long delay!"),this.isMobile=X()||ee()}get(){return"undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(Cn()||$()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function In(e,t){En(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}class kn{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void bn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void bn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void bn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Pn={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Nn=new Sn(3e4,6e4);function An(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Rn(e,t,n,i){return Ln(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},async()=>{let r={},s={};i&&("GET"===t?s=i:r={body:JSON.stringify(i)});const o=_e(Object.assign({key:e.config.apiKey},s)).slice(1),a=await e._getAdditionalHeaders();a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode);const l=Object.assign({method:t,headers:a},r);return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),kn.fetch()(Dn(e,e.config.apiHost,n,o),l)})}async function Ln(e,t,n){e._canInitEmulator=!1;const i=Object.assign(Object.assign({},Pn),t);try{const t=new jn(e),r=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await r.json();if("needConfirmation"in s)throw Fn(e,"account-exists-with-different-credential",s);if(r.ok&&!("errorMessage"in s))return s;{const t=r.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Fn(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw Fn(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw Fn(e,"user-disabled",s);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw gn(e,a,o);pn(e,a)}}catch(aC){if(aC instanceof se)throw aC;pn(e,"network-request-failed",{message:String(aC)})}}async function On(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const s=await Rn(e,t,n,i,r);return"mfaPendingCredential"in s&&pn(e,"multi-factor-auth-required",{_serverResponse:s}),s}function Dn(e,t,n,i){const r="".concat(t).concat(n,"?").concat(i);return e.config.emulator?In(e.config,r):"".concat(e.config.apiScheme,"://").concat(r)}function Mn(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class jn{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(mn(this.auth,"network-request-failed")),Nn.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Fn(e,t,n){const i={appName:e.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=mn(e,t,i);return r.customData._tokenResponse=n,r}function Un(e){return void 0!==e&&void 0!==e.enterprise}class zn{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Mn(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}}async function Bn(e,t){return Rn(e,"GET","/v2/recaptchaConfig",An(e,t))}async function Vn(e,t){return Rn(e,"POST","/v1/accounts:lookup",t)}function qn(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(aC){}}function Hn(e){return 1e3*Number(e)}function Wn(e){const[t,n,i]=e.split(".");if(void 0===t||void 0===n||void 0===i)return fn("JWT malformed, contained fewer than 3 sections"),null;try{const e=U(n);return e?JSON.parse(e):(fn("Failed to decode base64 JWT payload"),null)}catch(aC){return fn("Caught error parsing JWT payload as JSON",null===aC||void 0===aC?void 0:aC.toString()),null}}function Kn(e){const t=Wn(e);return wn(t,"internal-error"),wn("undefined"!==typeof t.exp,"internal-error"),wn("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function Gn(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(aC){throw aC instanceof se&&function(e){let{code:t}=e;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}(aC)&&e.auth.currentUser===e&&await e.auth.signOut(),aC}}class Zn{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(aC){return void((null===aC||void 0===aC?void 0:aC.code)==="auth/".concat("network-request-failed")&&this.schedule(!0))}this.schedule()}}class Qn{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=qn(this.lastLoginAt),this.creationTime=qn(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Yn(e){var t;const n=e.auth,i=await e.getIdToken(),r=await Gn(e,Vn(n,{idToken:i}));wn(null===r||void 0===r?void 0:r.users.length,n,"internal-error");const s=r.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?Jn(s.providerUserInfo):[],a=(l=e.providerData,c=o,[...l.filter(e=>!c.some(t=>t.providerId===e.providerId)),...c]);var l,c;const u=e.isAnonymous,h=!(e.email&&s.passwordHash)&&!(null===a||void 0===a?void 0:a.length),d=!!u&&h,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Qn(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,f)}function Jn(e){return e.map(e=>{var{providerId:t}=e,n=ln(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}class Xn{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){wn(e.idToken,"internal-error"),wn("undefined"!==typeof e.idToken,"internal-error"),wn("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):Kn(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){wn(0!==e.length,"internal-error");const t=Kn(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(wn(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:r}=await async function(e,t){const n=await Ln(e,{},async()=>{const n=_e({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:r}=e.config,s=Dn(e,i,"/v1/token","key=".concat(r)),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",kn.fetch()(s,{method:"POST",headers:o,body:n})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,i,Number(r))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:r}=t,s=new Xn;return n&&(wn("string"===typeof n,"internal-error",{appName:e}),s.refreshToken=n),i&&(wn("string"===typeof i,"internal-error",{appName:e}),s.accessToken=i),r&&(wn("number"===typeof r,"internal-error",{appName:e}),s.expirationTime=r),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Xn,this.toJSON())}_performRefresh(){return bn("not implemented")}}function $n(e,t){wn("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class ei{constructor(e){var{uid:t,auth:n,stsTokenManager:i}=e,r=ln(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Zn(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Qn(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await Gn(this,this.stsTokenManager.getToken(this.auth,e));return wn(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=Se(e),i=await n.getIdToken(t),r=Wn(i);wn(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const s="object"===typeof r.firebase?r.firebase:void 0,o=null===s||void 0===s?void 0:s.sign_in_provider;return{claims:r,token:i,authTime:qn(Hn(r.auth_time)),issuedAtTime:qn(Hn(r.iat)),expirationTime:qn(Hn(r.exp)),signInProvider:o||null,signInSecondFactor:(null===s||void 0===s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=Se(e);await Yn(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(wn(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ei(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){wn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Yn(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ht(this.auth.app))return Promise.reject(_n(this.auth));const e=await this.getIdToken();return await Gn(this,async function(e,t){return Rn(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,r,s,o,a,l,c;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(i=t.email)&&void 0!==i?i:void 0,d=null!==(r=t.phoneNumber)&&void 0!==r?r:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,m=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,g=null!==(l=t.createdAt)&&void 0!==l?l:void 0,_=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:v,emailVerified:y,isAnonymous:w,providerData:b,stsTokenManager:E}=t;wn(v&&E,e,"internal-error");const T=Xn.fromJSON(this.name,E);wn("string"===typeof v,e,"internal-error"),$n(u,e.name),$n(h,e.name),wn("boolean"===typeof y,e,"internal-error"),wn("boolean"===typeof w,e,"internal-error"),$n(d,e.name),$n(f,e.name),$n(p,e.name),$n(m,e.name),$n(g,e.name),$n(_,e.name);const C=new ei({uid:v,auth:e,email:h,emailVerified:y,displayName:u,isAnonymous:w,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:T,createdAt:g,lastLoginAt:_});return b&&Array.isArray(b)&&(C.providerData=b.map(e=>Object.assign({},e))),m&&(C._redirectEventId=m),C}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=new Xn;i.updateFromServerResponse(t);const r=new ei({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await Yn(r),r}static async _fromGetAccountInfoResponse(e,t,n){const i=t.users[0];wn(void 0!==i.localId,"internal-error");const r=void 0!==i.providerUserInfo?Jn(i.providerUserInfo):[],s=!(i.email&&i.passwordHash)&&!(null===r||void 0===r?void 0:r.length),o=new Xn;o.updateFromIdToken(n);const a=new ei({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:s}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:r,metadata:new Qn(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(null===r||void 0===r?void 0:r.length)};return Object.assign(a,l),a}}const ti=new Map;function ni(e){En(e instanceof Function,"Expected a class definition");let t=ti.get(e);return t?(En(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,ti.set(e,t),t)}class ii{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}ii.type="NONE";const ri=ii;function si(e,t,n){return"firebase".concat(":",e,":").concat(t,":").concat(n)}class oi{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=si(this.userKey,i.apiKey,r),this.fullPersistenceKey=si("persistence",i.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?ei._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new oi(ni(ri),e,n);const i=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let r=i[0]||ni(ri);const s=si(n,e.config.apiKey,e.name);let o=null;for(const c of t)try{const t=await c._get(s);if(t){const n=ei._fromJSON(e,t);c!==r&&(o=n),r=c;break}}catch(l){}const a=i.filter(e=>e._shouldAllowMigration);return r._shouldAllowMigration&&a.length?(r=a[0],o&&await r._set(s,o.toJSON()),await Promise.all(t.map(async e=>{if(e!==r)try{await e._remove(s)}catch(l){}})),new oi(r,e,n)):new oi(r,e,n)}}function ai(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(hi(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(li(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(fi(t))return"Blackberry";if(pi(t))return"Webos";if(ci(t))return"Safari";if((t.includes("chrome/")||ui(t))&&!t.includes("edge/"))return"Chrome";if(di(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function li(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J();return/firefox\//i.test(e)}function ci(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:J()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ui(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J();return/crios\//i.test(e)}function hi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J();return/iemobile/i.test(e)}function di(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J();return/android/i.test(e)}function fi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J();return/blackberry/i.test(e)}function pi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J();return/webos/i.test(e)}function mi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function gi(){return function(){const e=J();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function _i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J();return mi(e)||di(e)||pi(e)||fi(e)||/windows phone/i.test(e)||hi(e)}function vi(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=ai(J());break;case"Worker":t="".concat(ai(J()),"-").concat(e);break;default:t=e}const i=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(Gt,"/").concat(i)}class yi{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,i)=>{try{n(e(t))}catch(aC){i(aC)}});n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(aC){t.reverse();for(const i of t)try{i()}catch(n){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===aC||void 0===aC?void 0:aC.message})}}}class wi{constructor(e){var t,n,i,r;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=s.minPasswordLength)&&void 0!==t?t:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(i=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==i?i:"",this.forceUpgradeOnSignin=null!==(r=e.forceUpgradeOnSignin)&&void 0!==r&&r,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,i,r,s,o;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,a),this.validatePasswordCharacterOptions(e,a),a.isValid&&(a.isValid=null===(t=a.meetsMinPasswordLength)||void 0===t||t),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(i=a.containsLowercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(r=a.containsUppercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(s=a.containsNumericCharacter)||void 0===s||s),a.isValid&&(a.isValid=null===(o=a.containsNonAlphanumericCharacter)||void 0===o||o),a}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,i,r){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=r))}}class bi{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ti(this),this.idTokenSubscription=new Ti(this),this.beforeStateQueue=new yi(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=hn,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ni(t)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await oi.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(aC){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await Vn(this,{idToken:e}),n=await ei._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Ht(this.app)){const e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null===i||void 0===i?void 0:i._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==s||!(null===o||void 0===o?void 0:o.user)||(i=o.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(aC){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(aC))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return wn(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(aC){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Yn(e)}catch(aC){if((null===aC||void 0===aC?void 0:aC.code)!=="auth/".concat("network-request-failed"))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ht(this.app))return Promise.reject(_n(this));const t=e?Se(e):null;return t&&wn(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&wn(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ht(this.app)?Promise.reject(_n(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ht(this.app)?Promise.reject(_n(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ni(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return Rn(e,"GET","/v2/passwordPolicy",An(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new wi(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new oe("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return Rn(e,"POST","/v2/accounts:revokeToken",An(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ni(e)||this._popupRedirectResolver;wn(t,this,"argument-error"),this.redirectPersistenceManager=await oi.create(this,[ni(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const r="function"===typeof t?t:t.next.bind(t);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(wn(o,this,"internal-error"),o.then(()=>{s||r(this.currentUser)}),"function"===typeof t){const r=e.addObserver(t,n,i);return()=>{s=!0,r()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return wn(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=vi(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(dn.logLevel<=Re.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];dn.warn("Auth (".concat(Gt,"): ").concat(e),...n)}}("Error while retrieving App Check token: ".concat(t.error)),null===t||void 0===t?void 0:t.token}}function Ei(e){return Se(e)}class Ti{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new be(e,t);return n.subscribe.bind(n)}(e=>this.observer=e)}get next(){return wn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Ci={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function xi(e){return Ci.loadJS(e)}function Si(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}class Ii{constructor(e){this.type="recaptcha-enterprise",this.auth=Ei(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,i){const r=window.grecaptcha;Un(r)?r.enterprise.ready(()=>{r.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n("NO_RECAPTCHA")})}):i(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((e,i)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{Bn(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(i=>{if(void 0!==i.recaptchaKey){const n=new zn(i);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})})})(this.auth).then(r=>{if(!t&&Un(window.grecaptcha))n(r,e,i);else{if("undefined"===typeof window)return void i(new Error("RecaptchaVerifier is only supported in browser"));let t=Ci.recaptchaEnterpriseScript;0!==t.length&&(t+=r),xi(t).then(()=>{n(r,e,i)}).catch(e=>{i(e)})}}).catch(e=>{i(e)})})}}async function ki(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=new Ii(e);let s;try{s=await r.verify(n)}catch(I_){s=await r.verify(n,!0)}const o=Object.assign({},t);return i?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Pi(e,t,n,i){var r;if(null===(r=e._getRecaptchaConfig())||void 0===r?void 0:r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const r=await ki(e,t,n,"getOobCode"===n);return i(e,r)}return i(e,t).catch(async r=>{if(r.code==="auth/".concat("missing-recaptcha-token")){console.log("".concat(n," is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow."));const r=await ki(e,t,n,"getOobCode"===n);return i(e,r)}return Promise.reject(r)})}function Ni(e,t){const n=qt(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(me(n.getOptions(),null!==t&&void 0!==t?t:{}))return e;pn(e,"already-initialized")}return n.initialize({options:t})}function Ai(e,t,n){const i=Ei(e);wn(i._canInitEmulator,i,"emulator-config-failed"),wn(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const r=!!(null===n||void 0===n?void 0:n.disableWarnings),s=Ri(t),{host:o,port:a}=function(e){const t=Ri(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const e=r[1];return{host:e,port:Li(i.substr(e.length+1))}}{const[e,t]=i.split(":");return{host:e,port:Li(t)}}}(t),l=null===a?"":":".concat(a);i.config.emulator={url:"".concat(s,"//").concat(o).concat(l,"/")},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Ri(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Li(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Oi{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return bn("not implemented")}_getIdTokenResponse(e){return bn("not implemented")}_linkToIdToken(e,t){return bn("not implemented")}_getReauthenticationResolver(e){return bn("not implemented")}}async function Di(e,t){return Rn(e,"POST","/v1/accounts:signUp",t)}async function Mi(e,t){return On(e,"POST","/v1/accounts:signInWithPassword",An(e,t))}class ji extends Oi{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new ji(e,t,"password")}static _fromEmailAndCode(e,t){return new ji(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Pi(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Mi);case"emailLink":return async function(e,t){return On(e,"POST","/v1/accounts:signInWithEmailLink",An(e,t))}(e,{email:this._email,oobCode:this._password});default:pn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Pi(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Di);case"emailLink":return async function(e,t){return On(e,"POST","/v1/accounts:signInWithEmailLink",An(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:pn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Fi(e,t){return On(e,"POST","/v1/accounts:signInWithIdp",An(e,t))}class Ui extends Oi{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ui(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):pn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i}=t,r=ln(t,["providerId","signInMethod"]);if(!n||!i)return null;const s=new Ui(n,i);return s.idToken=r.idToken||void 0,s.accessToken=r.accessToken||void 0,s.secret=r.secret,s.nonce=r.nonce,s.pendingToken=r.pendingToken||null,s}_getIdTokenResponse(e){return Fi(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Fi(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Fi(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=_e(t)}return e}}const zi={USER_NOT_FOUND:"user-not-found"};class Bi extends Oi{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Bi({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Bi({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return On(e,"POST","/v1/accounts:signInWithPhoneNumber",An(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await On(e,"POST","/v1/accounts:signInWithPhoneNumber",An(e,t));if(n.temporaryProof)throw Fn(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return On(e,"POST","/v1/accounts:signInWithPhoneNumber",An(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),zi)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}=e;return n||t||i||r?new Bi({verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}):null}}class Vi{constructor(e){var t,n,i,r,s,o;const a=ve(ye(e)),l=null!==(t=a.apiKey)&&void 0!==t?t:null,c=null!==(n=a.oobCode)&&void 0!==n?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=a.mode)&&void 0!==i?i:null);wn(l&&c&&u,"argument-error"),this.apiKey=l,this.operation=u,this.code=c,this.continueUrl=null!==(r=a.continueUrl)&&void 0!==r?r:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=ve(ye(e)).link,n=t?ve(ye(t)).deep_link_id:null,i=ve(ye(e)).deep_link_id;return(i?ve(ye(i)).link:null)||i||n||t||e}(e);try{return new Vi(t)}catch(n){return null}}}class qi{constructor(){this.providerId=qi.PROVIDER_ID}static credential(e,t){return ji._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Vi.parseLink(t);return wn(n,"argument-error"),ji._fromEmailAndCode(e,n.code,n.tenantId)}}qi.PROVIDER_ID="password",qi.EMAIL_PASSWORD_SIGN_IN_METHOD="password",qi.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Hi{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Wi extends Hi{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ki extends Wi{constructor(){super("facebook.com")}static credential(e){return Ui._fromParams({providerId:Ki.PROVIDER_ID,signInMethod:Ki.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ki.credentialFromTaggedObject(e)}static credentialFromError(e){return Ki.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Ki.credential(t.oauthAccessToken)}catch(n){return null}}}Ki.FACEBOOK_SIGN_IN_METHOD="facebook.com",Ki.PROVIDER_ID="facebook.com";class Gi extends Wi{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ui._fromParams({providerId:Gi.PROVIDER_ID,signInMethod:Gi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Gi.credentialFromTaggedObject(e)}static credentialFromError(e){return Gi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:i}=t;if(!n&&!i)return null;try{return Gi.credential(n,i)}catch(r){return null}}}Gi.GOOGLE_SIGN_IN_METHOD="google.com",Gi.PROVIDER_ID="google.com";class Zi extends Wi{constructor(){super("github.com")}static credential(e){return Ui._fromParams({providerId:Zi.PROVIDER_ID,signInMethod:Zi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Zi.credentialFromTaggedObject(e)}static credentialFromError(e){return Zi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Zi.credential(t.oauthAccessToken)}catch(n){return null}}}Zi.GITHUB_SIGN_IN_METHOD="github.com",Zi.PROVIDER_ID="github.com";class Qi extends Wi{constructor(){super("twitter.com")}static credential(e,t){return Ui._fromParams({providerId:Qi.PROVIDER_ID,signInMethod:Qi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Qi.credentialFromTaggedObject(e)}static credentialFromError(e){return Qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:i}=t;if(!n||!i)return null;try{return Qi.credential(n,i)}catch(r){return null}}}async function Yi(e,t){return On(e,"POST","/v1/accounts:signUp",An(e,t))}Qi.TWITTER_SIGN_IN_METHOD="twitter.com",Qi.PROVIDER_ID="twitter.com";class Ji{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=await ei._fromIdTokenResponse(e,n,i),s=Xi(n);return new Ji({user:r,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const i=Xi(n);return new Ji({user:e,providerId:i,_tokenResponse:n,operationType:t})}}function Xi(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class $i extends se{constructor(e,t,n,i){var r;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,$i.prototype),this.customData={appName:e.name,tenantId:null!==(r=e.tenantId)&&void 0!==r?r:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new $i(e,t,n,i)}}function er(e,t,n,i){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if(n.code==="auth/".concat("multi-factor-auth-required"))throw $i._fromErrorAndOperation(e,n,t,i);throw n})}async function tr(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=await Gn(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Ji._forOperation(e,"link",i)}async function nr(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:i}=e;if(Ht(i.app))return Promise.reject(_n(i));const r="reauthenticate";try{const s=await Gn(e,er(i,r,t,e),n);wn(s.idToken,i,"internal-error");const o=Wn(s.idToken);wn(o,i,"internal-error");const{sub:a}=o;return wn(e.uid===a,i,"user-mismatch"),Ji._forOperation(e,r,s)}catch(aC){throw(null===aC||void 0===aC?void 0:aC.code)==="auth/".concat("user-not-found")&&pn(i,"user-mismatch"),aC}}async function ir(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Ht(e.app))return Promise.reject(_n(e));const i="signIn",r=await er(e,i,t),s=await Ji._fromIdTokenResponse(e,i,r);return n||await e._updateCurrentUser(s.user),s}async function rr(e,t){return ir(Ei(e),t)}async function sr(e){const t=Ei(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function or(e,t){let{displayName:n,photoURL:i}=t;if(void 0===n&&void 0===i)return;const r=Se(e),s={idToken:await r.getIdToken(),displayName:n,photoUrl:i,returnSecureToken:!0},o=await Gn(r,async function(e,t){return Rn(e,"POST","/v1/accounts:update",t)}(r.auth,s));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(e=>{let{providerId:t}=e;return"password"===t});a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}new WeakMap;const ar="__sak";class lr{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(ar,"1"),this.storage.removeItem(ar),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class cr extends lr{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=_i(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},r=this.storage.getItem(n);gi()&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,10):i()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}cr.type="LOCAL";const ur=cr;class hr extends lr{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}hr.type="SESSION";const dr=hr;class fr{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new fr(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:i,data:r}=t.data,s=this.handlersMap[i];if(!(null===s||void 0===s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(s).map(async e=>e(t.origin,r)),a=await function(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function pr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let i=0;i<t;i++)n+=Math.floor(10*Math.random());return e+n}fr.receivers=[];class mr{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const i="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,s;return new Promise((o,a)=>{const l=pr("",20);i.port1.start();const c=setTimeout(()=>{a(new Error("unsupported_event"))},n);s={messageChannel:i,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),r=setTimeout(()=>{a(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),o(t.data.response);break;default:clearTimeout(c),clearTimeout(r),a(new Error("invalid_response"))}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}function gr(){return window}function _r(){return"undefined"!==typeof gr().WorkerGlobalScope&&"function"===typeof gr().importScripts}const vr="firebaseLocalStorageDb",yr="firebaseLocalStorage",wr="fbase_key";class br{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Er(e,t){return e.transaction([yr],t?"readwrite":"readonly").objectStore(yr)}function Tr(){const e=indexedDB.open(vr,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(yr,{keyPath:wr})}catch(aC){n(aC)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(yr)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(vr);return new br(e).toPromise()}(),t(await Tr()))})})}async function Cr(e,t,n){const i=Er(e,!0).put({[wr]:t,value:n});return new br(i).toPromise()}function xr(e,t){const n=Er(e,!0).delete(t);return new br(n).toPromise()}class Sr{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await Tr()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(aC){if(t++>3)throw aC;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return _r()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=fr._getInstance(_r()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new mr(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Tr();return await Cr(e,ar,"1"),await xr(e,ar),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>Cr(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>async function(e,t){const n=Er(e,!1).get(t),i=await new br(n).toPromise();return void 0===i?null:i.value}(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>xr(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=Er(e,!1).getAll();return new br(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:i,value:r}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Sr.type="LOCAL";const Ir=Sr;Si("rcb"),new Sn(3e4,6e4);const kr="recaptcha";async function Pr(e,t,n){var i;const r=await n.verify();try{let s;if(wn("string"===typeof r,e,"argument-error"),wn(n.type===kr,e,"argument-error"),s="string"===typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){wn("enroll"===t.type,e,"internal-error");const n=await function(e,t){return Rn(e,"POST","/v2/accounts/mfaEnrollment:start",An(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:r}});return n.phoneSessionInfo.sessionInfo}{wn("signin"===t.type,e,"internal-error");const n=(null===(i=s.multiFactorHint)||void 0===i?void 0:i.uid)||s.multiFactorUid;wn(n,e,"missing-multi-factor-info");const o=await function(e,t){return Rn(e,"POST","/v2/accounts/mfaSignIn:start",An(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:r}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return Rn(e,"POST","/v1/accounts:sendVerificationCode",An(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:r});return t}}finally{n._reset()}}class Nr{constructor(e){this.providerId=Nr.PROVIDER_ID,this.auth=Ei(e)}verifyPhoneNumber(e,t){return Pr(this.auth,e,Se(t))}static credential(e,t){return Bi._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Nr.credentialFromTaggedObject(t)}static credentialFromError(e){return Nr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:i}=t;return n&&i?Bi._fromTokenResponse(n,i):null}}function Ar(e,t){return t?ni(t):(wn(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Nr.PROVIDER_ID="phone",Nr.PHONE_SIGN_IN_METHOD="phone";class Rr extends Oi{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Fi(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Fi(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Fi(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Lr(e){return ir(e.auth,new Rr(e),e.bypassAuthState)}function Or(e){const{auth:t,user:n}=e;return wn(n,t,"internal-error"),nr(n,new Rr(e),e.bypassAuthState)}async function Dr(e){const{auth:t,user:n}=e;return wn(n,t,"internal-error"),tr(n,new Rr(e),e.bypassAuthState)}class Mr{constructor(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(aC){this.reject(aC)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:i,tenantId:r,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(aC){this.reject(aC)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Lr;case"linkViaPopup":case"linkViaRedirect":return Dr;case"reauthViaPopup":case"reauthViaRedirect":return Or;default:pn(this.auth,"internal-error")}}resolve(e){En(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){En(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const jr=new Sn(2e3,1e4);class Fr extends Mr{constructor(e,t,n,i,r){super(e,t,i,r),this.provider=n,this.authWindow=null,this.pollId=null,Fr.currentPopupAction&&Fr.currentPopupAction.cancel(),Fr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return wn(e,this.auth,"internal-error"),e}async onExecution(){En(1===this.filter.length,"Popup operations only handle one event");const e=pr();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(mn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(mn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Fr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(mn(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,jr.get())};e()}}Fr.currentPopupAction=null;const Ur=new Map;class zr extends Mr{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=Ur.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=qr(t),i=Vr(e);if(!await i._isAvailable())return!1;const r="true"===await i._get(n);return await i._remove(n),r}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(aC){e=()=>Promise.reject(aC)}Ur.set(this.auth._key(),e)}return this.bypassAuthState||Ur.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Br(e,t){Ur.set(e._key(),t)}function Vr(e){return ni(e._redirectPersistence)}function qr(e){return si("pendingRedirect",e.config.apiKey,e.name)}async function Hr(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Ht(e.app))return Promise.reject(_n(e));const i=Ei(e),r=Ar(i,t),s=new zr(i,r,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,t)),o}class Wr{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Gr(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Gr(e)){const i=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(mn(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Kr(e))}saveEventToCache(e){this.cachedEventUids.add(Kr(e)),this.lastProcessedEventTime=Date.now()}}function Kr(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function Gr(e){let{type:t,error:n}=e;return"unknown"===t&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}const Zr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Qr=/^https?/;async function Yr(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return Rn(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const i of t)try{if(Jr(i))return}catch(n){}pn(e,"unauthorized-domain")}function Jr(e){const t=Tn(),{protocol:n,hostname:i}=new URL(t);if(e.startsWith("chrome-extension://")){const r=new URL(e);return""===r.hostname&&""===i?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!Qr.test(n))return!1;if(Zr.test(e))return i===e;const r=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const Xr=new Sn(3e4,6e4);function $r(){const e=gr().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function es(e){return new Promise((t,n)=>{var i,r,s;function o(){$r(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{$r(),n(mn(e,"network-request-failed"))},timeout:Xr.get()})}if(null===(r=null===(i=gr().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=gr().gapi)||void 0===s?void 0:s.load)){const t=Si("iframefcb");return gr()[t]=()=>{gapi.load?o():n(mn(e,"network-request-failed"))},xi("".concat(Ci.gapiScript,"?onload=").concat(t)).catch(e=>n(e))}o()}}).catch(e=>{throw ts=null,e})}let ts=null;const ns=new Sn(5e3,15e3),is={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},rs=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ss(e){const t=e.config;wn(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?In(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/").concat("__/auth/iframe"),i={apiKey:t.apiKey,appName:e.name,v:Gt},r=rs.get(e.config.apiHost);r&&(i.eid=r);const s=e._getFrameworks();return s.length&&(i.fw=s.join(",")),"".concat(n,"?").concat(_e(i).slice(1))}async function os(e){const t=await function(e){return ts=ts||es(e),ts}(e),n=gr().gapi;return wn(n,e,"internal-error"),t.open({where:document.body,url:ss(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:is,dontclear:!0},t=>new Promise(async(n,i)=>{await t.restyle({setHideOnLeave:!1});const r=mn(e,"network-request-failed"),s=gr().setTimeout(()=>{i(r)},ns.get());function o(){gr().clearTimeout(s),n(t)}t.ping(o).then(o,()=>{i(r)})}))}const as={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class ls{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(aC){}}}function cs(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const l=Object.assign(Object.assign({},as),{width:i.toString(),height:r.toString(),top:s,left:o}),c=J().toLowerCase();n&&(a=ui(c)?"_blank":n),li(c)&&(t=t||"http://localhost",l.scrollbars="yes");const u=Object.entries(l).reduce((e,t)=>{let[n,i]=t;return"".concat(e).concat(n,"=").concat(i,",")},"");if(function(){var e;return mi(arguments.length>0&&void 0!==arguments[0]?arguments[0]:J())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(t||"",a),new ls(null);const h=window.open(t||"",a,u);wn(h,e,"popup-blocked");try{h.focus()}catch(aC){}return new ls(h)}const us="__/auth/handler",hs="emulator/auth/handler",ds=encodeURIComponent("fac");async function fs(e,t,n,i,r,s){wn(e.config.authDomain,e,"auth-domain-config-required"),wn(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:i,v:Gt,eventId:r};if(t instanceof Hi){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",fe(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof Wi){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const u of Object.keys(a))void 0===a[u]&&delete a[u];const l=await e._getAppCheckToken(),c=l?"#".concat(ds,"=").concat(encodeURIComponent(l)):"";return"".concat(function(e){let{config:t}=e;if(!t.emulator)return"https://".concat(t.authDomain,"/").concat(us);return In(t,hs)}(e),"?").concat(_e(a).slice(1)).concat(c)}const ps="webStorageSupport";const ms=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=dr,this._completeRedirectFn=Hr,this._overrideRedirectResult=Br}async _openPopup(e,t,n,i){var r;En(null===(r=this.eventManagers[e._key()])||void 0===r?void 0:r.manager,"_initialize() not called before _openPopup()");return cs(e,await fs(e,t,n,Tn(),i),pr())}async _openRedirect(e,t,n,i){await this._originValidation(e);return function(e){gr().location.href=e}(await fs(e,t,n,Tn(),i)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(En(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await os(e),n=new Wr(e);return t.register("authEvent",t=>{wn(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(ps,{type:ps},n=>{var i;const r=null===(i=null===n||void 0===n?void 0:n[0])||void 0===i?void 0:i[ps];void 0!==r&&t(!!r),pn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Yr(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return _i()||ci()||mi()}};var gs="@firebase/auth",_s="1.7.9";class vs{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){wn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const ys=Z("authIdTokenMaxAge")||300;let ws=null;function bs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qt();const t=qt(e,"auth");if(t.isInitialized())return t.getImmediate();const n=Ni(e,{popupRedirectResolver:ms,persistence:[Ir,ur,dr]}),i=Z("authTokenSyncURL");if(i&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(i,location.origin);if(location.origin===e.origin){const t=(r=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>ys)return;const i=null===t||void 0===t?void 0:t.token;ws!==i&&(ws=i,await fetch(r,{method:i?"POST":"DELETE",headers:i?{Authorization:"Bearer ".concat(i)}:{}}))});!function(e,t,n){Se(e).beforeAuthStateChanged(t,n)}(n,t,()=>t(n.currentUser)),function(e,t,n,i){Se(e).onIdTokenChanged(t,n,i)}(n,e=>t(e))}}var r;const s=W("auth");return s&&Ai(n,"http://".concat(s)),n}var Es,Ts;Es={loadJS:e=>new Promise((t,n)=>{const i=document.createElement("script");i.setAttribute("src",e),i.onload=t,i.onerror=e=>{const t=mn("internal-error");t.customData=e,n(t)},i.type="text/javascript",i.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(i)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},Ci=Es,Ts="Browser",Vt(new Ie("auth",(e,t)=>{let{options:n}=t;const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=i.options;wn(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const l={apiKey:o,authDomain:a,clientPlatform:Ts,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:vi(Ts)},c=new bi(i,r,s,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],i=(Array.isArray(n)?n:[n]).map(ni);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(i,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),Vt(new Ie("auth-internal",e=>(e=>new vs(e))(Ei(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),Yt(gs,_s,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Ts)),Yt(gs,_s,"esm2017");var Cs,xs,Ss="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},Is={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var i=Array(16);if("string"===typeof t)for(var r=0;16>r;++r)i[r]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(r=0;16>r;++r)i[r]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],r=e.g[2];var s=e.g[3],o=t+(s^n&(r^s))+i[0]+3614090360&4294967295;o=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=n+(o<<7&4294967295|o>>>25))+((o=s+(r^t&(n^r))+i[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(t^n))+i[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(s^t))+i[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(r^s))+i[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^t&(n^r))+i[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(t^n))+i[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(s^t))+i[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(r^s))+i[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^t&(n^r))+i[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(t^n))+i[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(s^t))+i[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(r^s))+i[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^t&(n^r))+i[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(t^n))+i[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(s^t))+i[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(r^s&(n^r))+i[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(t^n))+i[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(s^t))+i[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(r^s))+i[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(r^s&(n^r))+i[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(t^n))+i[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(s^t))+i[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(r^s))+i[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(r^s&(n^r))+i[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(t^n))+i[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(s^t))+i[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(r^s))+i[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(r^s&(n^r))+i[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(t^n))+i[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(s^t))+i[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(r^s))+i[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^r^s)+i[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^r)+i[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^t^n)+i[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^t)+i[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^r^s)+i[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^r)+i[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^t^n)+i[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^t)+i[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^r^s)+i[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^r)+i[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^t^n)+i[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^t)+i[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^r^s)+i[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^r)+i[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^t^n)+i[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^t)+i[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(r^(n|~s))+i[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~r))+i[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=r+(t^(s|~n))+i[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~t))+i[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(r^(n|~s))+i[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~r))+i[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=r+(t^(s|~n))+i[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~t))+i[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(r^(n|~s))+i[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~r))+i[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=r+(t^(s|~n))+i[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~t))+i[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(t=n+((o=t+(r^(n|~s))+i[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~r))+i[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((r=s+((o=r+(t^(s|~n))+i[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+i[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(r+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+r&4294967295,e.g[3]=e.g[3]+s&4294967295}function i(e,t){this.h=t;for(var n=[],i=!0,r=e.length-1;0<=r;r--){var s=0|e[r];i&&s==t||(n[r]=s,i=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,i){for(var r=Array(arguments.length-2),s=2;s<arguments.length;s++)r[s-2]=arguments[s];return t.prototype[n].apply(e,r)}}(t,function(){this.blockSize=-1}),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var i=t-this.blockSize,r=this.B,s=this.h,o=0;o<t;){if(0==s)for(;o<=i;)n(this,e,o),o+=this.blockSize;if("string"===typeof e){for(;o<t;)if(r[s++]=e.charCodeAt(o++),s==this.blockSize){n(this,r),s=0;break}}else for(;o<t;)if(r[s++]=e[o++],s==this.blockSize){n(this,r),s=0;break}}this.h=s,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var i=0;32>i;i+=8)e[n++]=this.g[t]>>>i&255;return e};var r={};function s(e){return-128<=e&&128>e?function(e,t){var n=r;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(e){return new i([0|e],0>e?-1:0)}):new i([0|e],0>e?-1:0)}function o(e){if(isNaN(e)||!isFinite(e))return a;if(0>e)return d(o(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new i(t,0)}var a=s(0),l=s(1),c=s(16777216);function u(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function h(e){return-1==e.h}function d(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new i(n,~e.h).add(l)}function f(e,t){return e.add(d(t))}function p(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function m(e,t){this.g=e,this.h=t}function g(e,t){if(u(t))throw Error("division by zero");if(u(e))return new m(a,a);if(h(e))return t=g(d(e),t),new m(d(t.g),d(t.h));if(h(t))return t=g(e,d(t)),new m(d(t.g),t.h);if(30<e.g.length){if(h(e)||h(t))throw Error("slowDivide_ only works with positive integers.");for(var n=l,i=t;0>=i.l(e);)n=_(n),i=_(i);var r=v(n,1),s=v(i,1);for(i=v(i,2),n=v(n,2);!u(i);){var c=s.add(i);0>=c.l(e)&&(r=r.add(n),s=c),i=v(i,1),n=v(n,1)}return t=f(e,r.j(t)),new m(r,t)}for(r=a;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),i=48>=(i=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,i-48),c=(s=o(n)).j(t);h(c)||0<c.l(e);)c=(s=o(n-=i)).j(t);u(s)&&(s=l),r=r.add(s),e=f(e,c)}return new m(r,e)}function _(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new i(n,e.h)}function v(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,s=[],o=0;o<r;o++)s[o]=0<t?e.i(o+n)>>>t|e.i(o+n+1)<<32-t:e.i(o+n);return new i(s,e.h)}(e=i.prototype).m=function(){if(h(this))return-d(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var i=this.i(n);e+=(0<=i?i:4294967296+i)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(u(this))return"0";if(h(this))return"-"+d(this).toString(e);for(var t=o(Math.pow(e,6)),n=this,i="";;){var r=g(n,t).g,s=((0<(n=f(n,r.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(u(n=r))return s+i;for(;6>s.length;)s="0"+s;i=s+i}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return h(e=f(this,e))?-1:u(e)?0:1},e.abs=function(){return h(this)?d(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,s=0;s<=t;s++){var o=r+(65535&this.i(s))+(65535&e.i(s)),a=(o>>>16)+(this.i(s)>>>16)+(e.i(s)>>>16);r=a>>>16,o&=65535,a&=65535,n[s]=a<<16|o}return new i(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(u(this)||u(e))return a;if(h(this))return h(e)?d(this).j(d(e)):d(d(this).j(e));if(h(e))return d(this.j(d(e)));if(0>this.l(c)&&0>e.l(c))return o(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var s=0;s<e.g.length;s++){var l=this.i(r)>>>16,f=65535&this.i(r),m=e.i(s)>>>16,g=65535&e.i(s);n[2*r+2*s]+=f*g,p(n,2*r+2*s),n[2*r+2*s+1]+=l*g,p(n,2*r+2*s+1),n[2*r+2*s+1]+=f*m,p(n,2*r+2*s+1),n[2*r+2*s+2]+=l*m,p(n,2*r+2*s+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new i(n,0)},e.A=function(e){return g(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new i(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new i(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new i(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,xs=Is.Md5=t,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.A,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=o,i.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return d(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=o(Math.pow(n,8)),r=a,s=0;s<t.length;s+=8){var l=Math.min(8,t.length-s),c=parseInt(t.substring(s,s+l),n);8>l?(l=o(Math.pow(n,l)),r=r.j(l).add(o(c))):r=(r=r.j(i)).add(o(c))}return r},Cs=Is.Integer=i}).apply("undefined"!==typeof Ss?Ss:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var ks,Ps,Ns,As,Rs,Ls,Os,Ds,Ms="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},js={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof Ms&&Ms];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,i){if(i)e:{var r=n;e=e.split(".");for(var s=0;s<e.length-1;s++){var o=e[s];if(!(o in r))break e;r=r[o]}(i=i(s=r[e=e[e.length-1]]))!=s&&null!=i&&t(r,e,{configurable:!0,writable:!0,value:i})}}("Array.prototype.values",function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,i=!1,r={next:function(){if(!i&&n<e.length){var r=n++;return{value:t(r,e[r]),done:!1}}return i=!0,{done:!0,value:void 0}}};return r[Symbol.iterator]=function(){return r},r}(this,function(e,t){return t})}});var i=i||{},r=this||self;function s(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function o(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function a(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function c(e,t,n){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?a:l).apply(null,arguments)}function u(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function h(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,i){for(var r=Array(arguments.length-2),s=2;s<arguments.length;s++)r[s-2]=arguments[s];return t.prototype[n].apply(e,r)}}function d(e){const t=e.length;if(0<t){const n=Array(t);for(let i=0;i<t;i++)n[i]=e[i];return n}return[]}function f(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(s(t)){const n=e.length||0,i=t.length||0;e.length=n+i;for(let r=0;r<i;r++)e[n+r]=t[r]}else e.push(t)}}function p(e){return/^[\s\xa0]*$/.test(e)}function m(){var e=r.navigator;return e&&(e=e.userAgent)?e:""}function g(e){return g[" "](e),e}g[" "]=function(){};var _=-1!=m().indexOf("Gecko")&&!(-1!=m().toLowerCase().indexOf("webkit")&&-1==m().indexOf("Edge"))&&!(-1!=m().indexOf("Trident")||-1!=m().indexOf("MSIE"))&&-1==m().indexOf("Edge");function v(e,t,n){for(const i in e)t.call(n,e[i],i,e)}function y(e){const t={};for(const n in e)t[n]=e[n];return t}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function b(e,t){let n,i;for(let r=1;r<arguments.length;r++){for(n in i=arguments[r],i)e[n]=i[n];for(let t=0;t<w.length;t++)n=w[t],Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}}function E(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function T(e){r.setTimeout(()=>{throw e},0)}function C(){var e=P;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var x=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new S,e=>e.reset());class S{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let I,k=!1,P=new class{constructor(){this.h=this.g=null}add(e,t){const n=x.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},N=()=>{const e=r.Promise.resolve(void 0);I=()=>{e.then(A)}};var A=()=>{for(var e;e=C();){try{e.h.call(e.g)}catch(n){T(n)}var t=x;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}k=!1};function R(){this.s=this.s,this.C=this.C}function L(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}R.prototype.s=!1,R.prototype.ma=function(){this.s||(this.s=!0,this.N())},R.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},L.prototype.h=function(){this.defaultPrevented=!0};var O=function(){if(!r.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};r.addEventListener("test",e,t),r.removeEventListener("test",e,t)}catch(n){}return e}();function D(e,t){if(L.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,i=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(_){e:{try{g(t.nodeName);var r=!0;break e}catch(s){}r=!1}r||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:M[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&D.aa.h.call(this)}}h(D,L);var M={2:"touch",3:"pen",4:"mouse"};D.prototype.h=function(){D.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var j="closure_listenable_"+(1e6*Math.random()|0),F=0;function U(e,t,n,i,r){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!i,this.ha=r,this.key=++F,this.da=this.fa=!1}function z(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function B(e){this.src=e,this.g={},this.h=0}function V(e,t){var n=t.type;if(n in e.g){var i,r=e.g[n],s=Array.prototype.indexOf.call(r,t,void 0);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(z(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function q(e,t,n,i){for(var r=0;r<e.length;++r){var s=e[r];if(!s.da&&s.listener==t&&s.capture==!!n&&s.ha==i)return r}return-1}B.prototype.add=function(e,t,n,i,r){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=q(e,t,i,r);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new U(t,this.src,s,!!i,r)).fa=n,e.push(t)),t};var H="closure_lm_"+(1e6*Math.random()|0),W={};function K(e,t,n,i,r){if(i&&i.once)return Z(e,t,n,i,r);if(Array.isArray(t)){for(var s=0;s<t.length;s++)K(e,t[s],n,i,r);return null}return n=te(n),e&&e[j]?e.K(t,n,o(i)?!!i.capture:!!i,r):G(e,t,n,!1,i,r)}function G(e,t,n,i,r,s){if(!t)throw Error("Invalid event type");var a=o(r)?!!r.capture:!!r,l=$(e);if(l||(e[H]=l=new B(e)),(n=l.add(t,n,i,a,s)).proxy)return n;if(i=function(){function e(n){return t.call(e.src,e.listener,n)}const t=X;return e}(),n.proxy=i,i.src=e,i.listener=n,e.addEventListener)O||(r=a),void 0===r&&(r=!1),e.addEventListener(t.toString(),i,r);else if(e.attachEvent)e.attachEvent(J(t.toString()),i);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(i)}return n}function Z(e,t,n,i,r){if(Array.isArray(t)){for(var s=0;s<t.length;s++)Z(e,t[s],n,i,r);return null}return n=te(n),e&&e[j]?e.L(t,n,o(i)?!!i.capture:!!i,r):G(e,t,n,!0,i,r)}function Q(e,t,n,i,r){if(Array.isArray(t))for(var s=0;s<t.length;s++)Q(e,t[s],n,i,r);else i=o(i)?!!i.capture:!!i,n=te(n),e&&e[j]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=q(s=e.g[t],n,i,r))&&(z(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--)))):e&&(e=$(e))&&(t=e.g[t.toString()],e=-1,t&&(e=q(t,n,i,r)),(n=-1<e?t[e]:null)&&Y(n))}function Y(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[j])V(t.i,e);else{var n=e.type,i=e.proxy;t.removeEventListener?t.removeEventListener(n,i,e.capture):t.detachEvent?t.detachEvent(J(n),i):t.addListener&&t.removeListener&&t.removeListener(i),(n=$(t))?(V(n,e),0==n.h&&(n.src=null,t[H]=null)):z(e)}}}function J(e){return e in W?W[e]:W[e]="on"+e}function X(e,t){if(e.da)e=!0;else{t=new D(t,this);var n=e.listener,i=e.ha||e.src;e.fa&&Y(e),e=n.call(i,t)}return e}function $(e){return(e=e[H])instanceof B?e:null}var ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function te(e){return"function"===typeof e?e:(e[ee]||(e[ee]=function(t){return e.handleEvent(t)}),e[ee])}function ne(){R.call(this),this.i=new B(this),this.M=this,this.F=null}function ie(e,t){var n,i=e.F;if(i)for(n=[];i;i=i.F)n.push(i);if(e=e.M,i=t.type||t,"string"===typeof t)t=new L(t,e);else if(t instanceof L)t.target=t.target||e;else{var r=t;b(t=new L(i,e),r)}if(r=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];r=re(o,i,!0,t)&&r}if(r=re(o=t.g=e,i,!0,t)&&r,r=re(o,i,!1,t)&&r,n)for(s=0;s<n.length;s++)r=re(o=t.g=n[s],i,!1,t)&&r}function re(e,t,n,i){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var r=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.da&&o.capture==n){var a=o.listener,l=o.ha||o.src;o.fa&&V(e.i,o),r=!1!==a.call(l,i)&&r}}return r&&!i.defaultPrevented}function se(e,t,n){if("function"===typeof e)n&&(e=c(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return 2147483647<Number(t)?-1:r.setTimeout(e,t||0)}function oe(e){e.g=se(()=>{e.g=null,e.i&&(e.i=!1,oe(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}h(ne,R),ne.prototype[j]=!0,ne.prototype.removeEventListener=function(e,t,n,i){Q(this,e,t,n,i)},ne.prototype.N=function(){if(ne.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],i=0;i<n.length;i++)z(n[i]);delete t.g[e],t.h--}}this.F=null},ne.prototype.K=function(e,t,n,i){return this.i.add(String(e),t,!1,n,i)},ne.prototype.L=function(e,t,n,i){return this.i.add(String(e),t,!0,n,i)};class ae extends R{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:oe(this)}N(){super.N(),this.g&&(r.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function le(e){R.call(this),this.h=e,this.g={}}h(le,R);var ce=[];function ue(e){v(e.g,function(e,t){this.g.hasOwnProperty(t)&&Y(e)},e),e.g={}}le.prototype.N=function(){le.aa.N.call(this),ue(this)},le.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var he=r.JSON.stringify,de=r.JSON.parse,fe=class{stringify(e){return r.JSON.stringify(e,void 0)}parse(e){return r.JSON.parse(e,void 0)}};function pe(){}function me(e){return e.h||(e.h=e.i())}function ge(){}pe.prototype.h=null;var _e={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ve(){L.call(this,"d")}function ye(){L.call(this,"c")}h(ve,L),h(ye,L);var we={},be=null;function Ee(){return be=be||new ne}function Te(e){L.call(this,we.La,e)}function Ce(e){const t=Ee();ie(t,new Te(t))}function xe(e,t){L.call(this,we.STAT_EVENT,e),this.stat=t}function Se(e){const t=Ee();ie(t,new xe(t,e))}function Ie(e,t){L.call(this,we.Ma,e),this.size=t}function ke(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return r.setTimeout(function(){e()},t)}function Pe(){this.g=!0}function Ne(e,t,n,i){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var i=n[e];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<r.length;o++)r[o]=""}}}return he(n)}catch(a){return t}}(e,n)+(i?" "+i:"")})}we.La="serverreachability",h(Te,L),we.STAT_EVENT="statevent",h(xe,L),we.Ma="timingevent",h(Ie,L),Pe.prototype.xa=function(){this.g=!1},Pe.prototype.info=function(){};var Ae,Re={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Le={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Oe(){}function De(e,t,n,i){this.j=e,this.i=t,this.l=n,this.R=i||1,this.U=new le(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Me}function Me(){this.i=null,this.g="",this.h=!1}h(Oe,pe),Oe.prototype.g=function(){return new XMLHttpRequest},Oe.prototype.i=function(){return{}},Ae=new Oe;var je={},Fe={};function Ue(e,t,n){e.L=1,e.v=ht(ot(t)),e.m=n,e.P=!0,ze(e,null)}function ze(e,t){e.F=Date.now(),qe(e),e.A=ot(e.v);var n=e.A,i=e.R;Array.isArray(i)||(i=[String(i)]),xt(n.i,"t",i),e.C=0,n=e.j.J,e.h=new Me,e.g=fn(e.j,n?t:null,!e.m),0<e.O&&(e.M=new ae(c(e.Y,e,e.g),e.O)),t=e.U,n=e.g,i=e.ca;var r="readystatechange";Array.isArray(r)||(r&&(ce[0]=r.toString()),r=ce);for(var s=0;s<r.length;s++){var o=K(n,r[s],i||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}t=e.H?y(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Ce(),function(e,t,n,i,r,s){e.info(function(){if(e.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var u=c[0];c=c[1];var h=u.split("_");o=2<=h.length&&"type"==h[1]?o+(u+"=")+c+"&":o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+t+"\n"+n+"\n"+o})}(e.i,e.u,e.A,e.l,e.R,e.m)}function Be(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function Ve(e,t){var n=e.C,i=t.indexOf("\n",n);return-1==i?Fe:(n=Number(t.substring(n,i)),isNaN(n)?je:(i+=1)+n>t.length?Fe:(t=t.slice(i,i+n),e.C=i+n,t))}function qe(e){e.S=Date.now()+e.I,He(e,e.I)}function He(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=ke(c(e.ba,e),t)}function We(e){e.B&&(r.clearTimeout(e.B),e.B=null)}function Ke(e){0==e.j.G||e.J||ln(e.j,e)}function Ge(e){We(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,ue(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function Ze(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||$e(n.h,e)))if(!e.K&&$e(n.h,e)&&3==n.G){try{var i=n.Da.g.parse(t)}catch(u){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;an(n),Yt(n)}rn(n),Se(18)}}else n.za=r[1],0<n.za-n.T&&37500>r[2]&&n.F&&0==n.v&&!n.C&&(n.C=ke(c(n.Za,n),6e3));if(1>=Xe(n.h)&&n.ca){try{n.ca()}catch(u){}n.ca=void 0}}else un(n,11)}else if((e.K||n.g==e)&&an(n),!p(t))for(r=n.Da.g.parse(t),t=0;t<r.length;t++){let c=r[t];if(n.T=c[0],c=c[1],2==n.G)if("c"==c[0]){n.K=c[1],n.ia=c[2];const t=c[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const r=c[4];null!=r&&(n.Aa=r,n.j.info("SVER="+n.Aa));const u=c[5];null!=u&&"number"===typeof u&&0<u&&(i=1.5*u,n.L=i,n.j.info("backChannelRequestTimeoutMs_="+i)),i=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=i.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(et(s,s.h),s.h=null))}if(i.D){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(i.ya=e,ut(i.I,i.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var o=e;if((i=n).qa=dn(i,i.J?i.ia:null,i.W),o.K){tt(i.h,o);var a=o,l=i.L;l&&(a.I=l),a.B&&(We(a),qe(a)),i.g=o}else nn(i);0<n.i.length&&Xt(n)}else"stop"!=c[0]&&"close"!=c[0]||un(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?un(n,7):Qt(n):"noop"!=c[0]&&n.l&&n.l.ta(c),n.v=0)}Ce()}catch(u){}}De.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==Wt(e)?t.j():this.Y(e)},De.prototype.Y=function(e){try{if(e==this.g)e:{const d=Wt(this.g);var t=this.g.Ba();this.g.Z();if(!(3>d)&&(3!=d||this.g&&(this.h.h||this.g.oa()||Kt(this.g)))){this.J||4!=d||7==t||Ce(),We(this);var n=this.g.Z();this.X=n;t:if(Be(this)){var i=Kt(this.g);e="";var s=i.length,o=4==Wt(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Ge(this),Ke(this);var a="";break t}this.h.i=new r.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,e+=this.h.i.decode(i[t],{stream:!(o&&t==s-1)});i.length=0,this.h.g+=e,this.C=0,a=this.h.g}else a=this.g.oa();if(this.o=200==n,function(e,t,n,i,r,s,o){e.info(function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+t+"\n"+n+"\n"+s+" "+o})}(this.i,this.u,this.A,this.l,this.R,d,n),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p(l)){var u=l;break t}}u=null}if(!(n=u)){this.o=!1,this.s=3,Se(12),Ge(this),Ke(this);break e}Ne(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ze(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<a.length;){if(e=Ve(this,a),e==Fe){4==d&&(this.s=4,Se(14),n=!1),Ne(this.i,this.l,null,"[Incomplete Response]");break}if(e==je){this.s=4,Se(15),Ne(this.i,this.l,a,"[Invalid Chunk]"),n=!1;break}Ne(this.i,this.l,e,null),Ze(this,e)}if(Be(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=d||0!=a.length||this.h.h||(this.s=1,Se(16),n=!1),this.o=this.o&&n,n){if(0<a.length&&!this.W){this.W=!0;var h=this.j;h.g==this&&h.ba&&!h.M&&(h.j.info("Great, no buffering proxy detected. Bytes received: "+a.length),sn(h),h.M=!0,Se(11))}}else Ne(this.i,this.l,a,"[Invalid Chunked Response]"),Ge(this),Ke(this)}else Ne(this.i,this.l,a,null),Ze(this,a);4==d&&Ge(this),this.o&&!this.J&&(4==d?ln(this.j,this):(this.o=!1,qe(this)))}else(function(e){const t={};e=(e.g&&2<=Wt(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<e.length;i++){if(p(e[i]))continue;var n=E(e[i]);const r=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const s=t[r]||[];t[r]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==n&&0<a.indexOf("Unknown SID")?(this.s=3,Se(12)):(this.s=0,Se(13)),Ge(this),Ke(this)}}}catch(Fs){}},De.prototype.cancel=function(){this.J=!0,Ge(this)},De.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.A),2!=this.L&&(Ce(),Se(17)),Ge(this),this.s=2,Ke(this)):He(this,this.S-e)};var Qe=class{constructor(e,t){this.g=e,this.map=t}};function Ye(e){this.l=e||10,r.PerformanceNavigationTiming?e=0<(e=r.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(r.chrome&&r.chrome.loadTimes&&r.chrome.loadTimes()&&r.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Je(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Xe(e){return e.h?1:e.g?e.g.size:0}function $e(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function et(e,t){e.g?e.g.add(t):e.h=t}function tt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function nt(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return d(e.i)}function it(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(s(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(s(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const i in e)t[n++]=i;return t}}}(e),i=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(s(e)){for(var t=[],n=e.length,i=0;i<n;i++)t.push(e[i]);return t}for(i in t=[],n=0,e)t[n++]=e[i];return t}(e),r=i.length,o=0;o<r;o++)t.call(void 0,i[o],n&&n[o],e)}Ye.prototype.cancel=function(){if(this.i=nt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var rt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function st(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof st){this.h=e.h,at(this,e.j),this.o=e.o,this.g=e.g,lt(this,e.s),this.l=e.l;var t=e.i,n=new bt;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),ct(this,n),this.m=e.m}else e&&(t=String(e).match(rt))?(this.h=!1,at(this,t[1]||"",!0),this.o=dt(t[2]||""),this.g=dt(t[3]||"",!0),lt(this,t[4]),this.l=dt(t[5]||"",!0),ct(this,t[6]||"",!0),this.m=dt(t[7]||"")):(this.h=!1,this.i=new bt(null,this.h))}function ot(e){return new st(e)}function at(e,t,n){e.j=n?dt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function lt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function ct(e,t,n){t instanceof bt?(e.i=t,function(e,t){t&&!e.j&&(Et(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(Tt(this,t),xt(this,n,e))},e)),e.j=t}(e.i,e.h)):(n||(t=ft(t,yt)),e.i=new bt(t,e.h))}function ut(e,t,n){e.i.set(t,n)}function ht(e){return ut(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function dt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function ft(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,pt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function pt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}st.prototype.toString=function(){var e=[],t=this.j;t&&e.push(ft(t,gt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(ft(t,gt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(ft(n,"/"==n.charAt(0)?vt:_t,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",ft(n,wt)),e.join("")};var mt,gt=/[#\/\?@]/g,_t=/[#\?:]/g,vt=/[#\?]/g,yt=/[#\?@]/g,wt=/#/g;function bt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Et(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var i=e[n].indexOf("="),r=null;if(0<=i){var s=e[n].substring(0,i);r=e[n].substring(i+1)}else s=e[n];t(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function Tt(e,t){Et(e),t=St(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Ct(e,t){return Et(e),t=St(e,t),e.g.has(t)}function xt(e,t,n){Tt(e,t),0<n.length&&(e.i=null,e.g.set(St(e,t),d(n)),e.h+=n.length)}function St(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function It(e,t,n,i,r){try{r&&(r.onload=null,r.onerror=null,r.onabort=null,r.ontimeout=null),i(n)}catch(s){}}function kt(){this.g=new fe}function Pt(e,t,n){const i=n||"";try{it(e,function(e,n){let r=e;o(e)&&(r=he(e)),t.push(i+n+"="+encodeURIComponent(r))})}catch(aC){throw t.push(i+"type="+encodeURIComponent("_badmap")),aC}}function Nt(e){this.l=e.Ub||null,this.j=e.eb||!1}function At(e,t){ne.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Rt(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Lt(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Ot(e)}function Ot(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Dt(e){let t="";return v(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function Mt(e,t,n){e:{for(i in n){var i=!1;break e}i=!0}i||(n=Dt(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):ut(e,t,n))}function jt(e){ne.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=bt.prototype).add=function(e,t){Et(this),this.i=null,e=St(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){Et(this),this.g.forEach(function(n,i){n.forEach(function(n){e.call(t,n,i,this)},this)},this)},e.na=function(){Et(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let i=0;i<t.length;i++){const r=e[i];for(let e=0;e<r.length;e++)n.push(t[i])}return n},e.V=function(e){Et(this);let t=[];if("string"===typeof e)Ct(this,e)&&(t=t.concat(this.g.get(St(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return Et(this),this.i=null,Ct(this,e=St(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var i=t[n];const s=encodeURIComponent(String(i)),o=this.V(i);for(i=0;i<o.length;i++){var r=s;""!==o[i]&&(r+="="+encodeURIComponent(String(o[i]))),e.push(r)}}return this.i=e.join("&")},h(Nt,pe),Nt.prototype.g=function(){return new At(this.l,this.j)},Nt.prototype.i=(mt={},function(){return mt}),h(At,ne),(e=At.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Ot(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||r).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Lt(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Ot(this)),this.g&&(this.readyState=3,Ot(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof r.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Rt(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Lt(this):Ot(this),3==this.readyState&&Rt(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,Lt(this))},e.Qa=function(e){this.g&&(this.response=e,Lt(this))},e.ga=function(){this.g&&Lt(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(At.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),h(jt,ne);var Ft=/^https?$/i,Ut=["POST","PUT"];function zt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Bt(e),qt(e)}function Bt(e){e.A||(e.A=!0,ie(e,"complete"),ie(e,"error"))}function Vt(e){if(e.h&&"undefined"!=typeof i&&(!e.v[1]||4!=Wt(e)||2!=e.Z()))if(e.u&&4==Wt(e))se(e.Ea,0,e);else if(ie(e,"readystatechange"),4==Wt(e)){e.h=!1;try{const i=e.Z();e:switch(i){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var s;if(s=0===i){var o=String(e.D).match(rt)[1]||null;!o&&r.self&&r.self.location&&(o=r.self.location.protocol.slice(0,-1)),s=!Ft.test(o?o.toLowerCase():"")}n=s}if(n)ie(e,"complete"),ie(e,"success");else{e.m=6;try{var a=2<Wt(e)?e.g.statusText:""}catch(l){a=""}e.l=a+" ["+e.Z()+"]",Bt(e)}}finally{qt(e)}}}function qt(e,t){if(e.g){Ht(e);const n=e.g,i=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||ie(e,"ready");try{n.onreadystatechange=i}catch(aC){}}}function Ht(e){e.I&&(r.clearTimeout(e.I),e.I=null)}function Wt(e){return e.g?e.g.readyState:0}function Kt(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(Bs){return null}}function Gt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Zt(e){this.Aa=0,this.i=[],this.j=new Pe,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Gt("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Gt("baseRetryDelayMs",5e3,e),this.cb=Gt("retryDelaySeedMs",1e4,e),this.Wa=Gt("forwardChannelMaxRetries",2,e),this.wa=Gt("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Ye(e&&e.concurrentRequestLimit),this.Da=new kt,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function Qt(e){if(Jt(e),3==e.G){var t=e.U++,n=ot(e.I);if(ut(n,"SID",e.K),ut(n,"RID",t),ut(n,"TYPE","terminate"),en(e,n),(t=new De(e,e.j,t)).L=2,t.v=ht(ot(n)),n=!1,r.navigator&&r.navigator.sendBeacon)try{n=r.navigator.sendBeacon(t.v.toString(),"")}catch(i){}!n&&r.Image&&((new Image).src=t.v,n=!0),n||(t.g=fn(t.j,null),t.g.ea(t.v)),t.F=Date.now(),qe(t)}hn(e)}function Yt(e){e.g&&(sn(e),e.g.cancel(),e.g=null)}function Jt(e){Yt(e),e.u&&(r.clearTimeout(e.u),e.u=null),an(e),e.h.cancel(),e.s&&("number"===typeof e.s&&r.clearTimeout(e.s),e.s=null)}function Xt(e){if(!Je(e.h)&&!e.s){e.s=!0;var t=e.Ga;I||N(),k||(I(),k=!0),P.add(t,e),e.B=0}}function $t(e,t){var n;n=t?t.l:e.U++;const i=ot(e.I);ut(i,"SID",e.K),ut(i,"RID",n),ut(i,"AID",e.T),en(e,i),e.m&&e.o&&Mt(i,e.m,e.o),n=new De(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=tn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),et(e.h,n),Ue(n,i,t)}function en(e,t){e.H&&v(e.H,function(e,n){ut(t,n,e)}),e.l&&it({},function(e,n){ut(t,n,e)})}function tn(e,t,n){n=Math.min(e.i.length,n);var i=e.l?c(e.l.Na,e.l,e):null;e:{var r=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=r[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let o=0;o<n;o++){let n=r[o].g;const a=r[o].map;if(n-=t,0>n)t=Math.max(0,r[o].g-100),s=!1;else try{Pt(a,e,"req"+n+"_")}catch(Fs){i&&i(a)}}if(s){i=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,i}function nn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;I||N(),k||(I(),k=!0),P.add(t,e),e.v=0}}function rn(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=ke(c(e.Fa,e),cn(e,e.v)),e.v++,!0)}function sn(e){null!=e.A&&(r.clearTimeout(e.A),e.A=null)}function on(e){e.g=new De(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=ot(e.qa);ut(t,"RID","rpc"),ut(t,"SID",e.K),ut(t,"AID",e.T),ut(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&ut(t,"TO",e.ja),ut(t,"TYPE","xmlhttp"),en(e,t),e.m&&e.o&&Mt(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=ht(ot(t)),n.m=null,n.P=!0,ze(n,e)}function an(e){null!=e.C&&(r.clearTimeout(e.C),e.C=null)}function ln(e,t){var n=null;if(e.g==t){an(e),sn(e),e.g=null;var i=2}else{if(!$e(e.h,t))return;n=t.D,tt(e.h,t),i=1}if(0!=e.G)if(t.o)if(1==i){n=t.m?t.m.length:0,t=Date.now()-t.F;var r=e.B;ie(i=Ee(),new Ie(i,n)),Xt(e)}else nn(e);else if(3==(r=t.s)||0==r&&0<t.X||!(1==i&&function(e,t){return!(Xe(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=ke(c(e.Ga,e,t),cn(e,e.B)),e.B++,!0))}(e,t)||2==i&&rn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),r){case 1:un(e,5);break;case 4:un(e,10);break;case 3:un(e,6);break;default:un(e,2)}}function cn(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function un(e,t){if(e.j.info("Error code "+t),2==t){var n=c(e.fb,e),i=e.Xa;const t=!i;i=new st(i||"//www.google.com/images/cleardot.gif"),r.location&&"http"==r.location.protocol||at(i,"https"),ht(i),t?function(e,t){const n=new Pe;if(r.Image){const i=new Image;i.onload=u(It,n,"TestLoadImage: loaded",!0,t,i),i.onerror=u(It,n,"TestLoadImage: error",!1,t,i),i.onabort=u(It,n,"TestLoadImage: abort",!1,t,i),i.ontimeout=u(It,n,"TestLoadImage: timeout",!1,t,i),r.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=e}else t(!1)}(i.toString(),n):function(e,t){new Pe;const n=new AbortController,i=setTimeout(()=>{n.abort(),It(0,0,!1,t)},1e4);fetch(e,{signal:n.signal}).then(e=>{clearTimeout(i),e.ok?It(0,0,!0,t):It(0,0,!1,t)}).catch(()=>{clearTimeout(i),It(0,0,!1,t)})}(i.toString(),n)}else Se(2);e.G=0,e.l&&e.l.sa(t),hn(e),Jt(e)}function hn(e){if(e.G=0,e.ka=[],e.l){const t=nt(e.h);0==t.length&&0==e.i.length||(f(e.ka,t),f(e.ka,e.i),e.h.i.length=0,d(e.i),e.i.length=0),e.l.ra()}}function dn(e,t,n){var i=n instanceof st?ot(n):new st(n);if(""!=i.g)t&&(i.g=t+"."+i.g),lt(i,i.s);else{var s=r.location;i=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;var o=new st(null);i&&at(o,i),t&&(o.g=t),s&&lt(o,s),n&&(o.l=n),i=o}return n=e.D,t=e.ya,n&&t&&ut(i,n,t),ut(i,"VER",e.la),en(e,i),i}function fn(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new jt(new Nt({eb:n})):new jt(e.pa)).Ha(e.J),t}function pn(){}function mn(){}function gn(e,t){ne.call(this),this.g=new Zt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!p(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!p(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new yn(this)}function _n(e){ve.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function vn(){ye.call(this),this.status=1}function yn(e){this.g=e}(e=jt.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ae.g(),this.v=this.o?me(this.o):me(Ae),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(o){return void zt(this,o)}if(e=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var s in i)n.set(s,i[s]);else{if("function"!==typeof i.keys||"function"!==typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const e of i.keys())n.set(e,i.get(e))}i=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),s=r.FormData&&e instanceof r.FormData,!(0<=Array.prototype.indexOf.call(Ut,t,void 0))||i||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[r,a]of n)this.g.setRequestHeader(r,a);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ht(this),this.u=!0,this.g.send(e),this.u=!1}catch(o){zt(this,o)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,ie(this,"complete"),ie(this,"abort"),qt(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),qt(this,!0)),jt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Vt(this):this.bb())},e.bb=function(){Vt(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<Wt(this)?this.g.status:-1}catch(mt){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(mt){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),de(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=Zt.prototype).la=8,e.G=1,e.connect=function(e,t,n,i){Se(0),this.W=e,this.H=t||{},n&&void 0!==i&&(this.H.OSID=n,this.H.OAID=i),this.F=this.X,this.I=dn(this,null,this.W),Xt(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const r=new De(this,this.j,e);let s=this.o;if(this.S&&(s?(s=y(s),b(s,this.S)):s=this.S),null!==this.m||this.O||(r.H=s,s=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var i=this.i[n];if(void 0===(i="__data__"in i.map&&"string"===typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(t+=i)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=tn(this,r,t),ut(n=ot(this.I),"RID",e),ut(n,"CVER",22),this.D&&ut(n,"X-HTTP-Session-Id",this.D),en(this,n),s&&(this.O?t="headers="+encodeURIComponent(String(Dt(s)))+"&"+t:this.m&&Mt(n,this.m,s)),et(this.h,r),this.Ua&&ut(n,"TYPE","init"),this.P?(ut(n,"$req",t),ut(n,"SID","null"),r.T=!0,Ue(r,n,null)):Ue(r,n,t),this.G=2}}else 3==this.G&&(e?$t(this,e):0==this.i.length||Je(this.h)||$t(this))},e.Fa=function(){if(this.u=null,on(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=ke(c(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Se(10),Yt(this),on(this))},e.Za=function(){null!=this.C&&(this.C=null,Yt(this),rn(this),Se(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Se(2)):(this.j.info("Failed to ping google.com"),Se(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=pn.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},mn.prototype.g=function(e,t){return new gn(e,t)},h(gn,ne),gn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},gn.prototype.close=function(){Qt(this.g)},gn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=he(e),e=n);t.i.push(new Qe(t.Ya++,e)),3==t.G&&Xt(t)},gn.prototype.N=function(){this.g.l=null,delete this.j,Qt(this.g),delete this.g,gn.aa.N.call(this)},h(_n,ve),h(vn,ye),h(yn,pn),yn.prototype.ua=function(){ie(this.g,"a")},yn.prototype.ta=function(e){ie(this.g,new _n(e))},yn.prototype.sa=function(e){ie(this.g,new vn)},yn.prototype.ra=function(){ie(this.g,"b")},mn.prototype.createWebChannel=mn.prototype.g,gn.prototype.send=gn.prototype.o,gn.prototype.open=gn.prototype.m,gn.prototype.close=gn.prototype.close,Ds=js.createWebChannelTransport=function(){return new mn},Os=js.getStatEventTarget=function(){return Ee()},Ls=js.Event=we,Rs=js.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Re.NO_ERROR=0,Re.TIMEOUT=8,Re.HTTP_ERROR=6,As=js.ErrorCode=Re,Le.COMPLETE="complete",Ns=js.EventType=Le,ge.EventType=_e,_e.OPEN="a",_e.CLOSE="b",_e.ERROR="c",_e.MESSAGE="d",ne.prototype.listen=ne.prototype.K,Ps=js.WebChannel=ge,js.FetchXmlHttpFactory=Nt,jt.prototype.listenOnce=jt.prototype.L,jt.prototype.getLastError=jt.prototype.Ka,jt.prototype.getLastErrorCode=jt.prototype.Ba,jt.prototype.getStatus=jt.prototype.Z,jt.prototype.getResponseJson=jt.prototype.Oa,jt.prototype.getResponseText=jt.prototype.oa,jt.prototype.send=jt.prototype.ea,jt.prototype.setWithCredentials=jt.prototype.Ha,ks=js.XhrIo=jt}).apply("undefined"!==typeof Ms?Ms:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const Fs="@firebase/firestore";class Us{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Us.UNAUTHENTICATED=new Us(null),Us.GOOGLE_CREDENTIALS=new Us("google-credentials-uid"),Us.FIRST_PARTY=new Us("first-party-uid"),Us.MOCK_USER=new Us("mock-user");let zs="10.14.0";const Bs=new je("@firebase/firestore");function Vs(){return Bs.logLevel}function qs(e){if(Bs.logLevel<=Re.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const r=n.map(Ks);Bs.debug("Firestore (".concat(zs,"): ").concat(e),...r)}}function Hs(e){if(Bs.logLevel<=Re.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const r=n.map(Ks);Bs.error("Firestore (".concat(zs,"): ").concat(e),...r)}}function Ws(e){if(Bs.logLevel<=Re.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const r=n.map(Ks);Bs.warn("Firestore (".concat(zs,"): ").concat(e),...r)}}function Ks(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function Gs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state";const t="FIRESTORE (".concat(zs,") INTERNAL ASSERTION FAILED: ")+e;throw Hs(t),new Error(t)}function Zs(e,t){e||Gs()}function Qs(e,t){return e}const Ys={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Js extends se{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class Xs{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class $s{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))}}class eo{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Us.UNAUTHENTICATED))}shutdown(){}}class to{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class no{constructor(e){this.t=e,this.currentUser=Us.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Zs(void 0===this.o);let n=this.i;const i=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let r=new Xs;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new Xs,e.enqueueRetryable(()=>i(this.currentUser))};const s=()=>{const t=r;e.enqueueRetryable(async()=>{await t.promise,await i(this.currentUser)})},o=e=>{qs("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(e=>o(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(qs("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new Xs)}},0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(qs("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Zs("string"==typeof t.accessToken),new $s(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Zs(null===e||"string"==typeof e),new Us(e)}}class io{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=Us.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class ro{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new io(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Us.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class so{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class oo{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Zs(void 0===this.o);const n=e=>{null!=e.error&&qs("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));const n=e.token!==this.R;return this.R=e.token,qs("FirebaseAppCheckTokenProvider","Received ".concat(n?"new":"existing"," token.")),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const i=e=>{qs("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(e=>i(e)),setTimeout(()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?i(e):qs("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(Zs("string"==typeof e.token),this.R=e.token,new so(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function ao(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let i=0;i<e;i++)n[i]=Math.floor(256*Math.random());return n}class lo{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let n="";for(;n.length<20;){const i=ao(40);for(let r=0;r<i.length;++r)n.length<20&&i[r]<t&&(n+=e.charAt(i[r]%62))}return n}}function co(e,t){return e<t?-1:e>t?1:0}function uo(e,t,n){return e.length===t.length&&e.every((e,i)=>n(e,t[i]))}class ho{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Js(Ys.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Js(Ys.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Js(Ys.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Js(Ys.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return ho.fromMillis(Date.now())}static fromDate(e){return ho.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new ho(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?co(this.nanoseconds,e.nanoseconds):co(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class fo{constructor(e){this.timestamp=e}static fromTimestamp(e){return new fo(e)}static min(){return new fo(new ho(0,0))}static max(){return new fo(new ho(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class po{constructor(e,t,n){void 0===t?t=0:t>e.length&&Gs(),void 0===n?n=e.length-t:n>e.length-t&&Gs(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===po.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof po?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const n=e.get(i),r=t.get(i);if(n<r)return-1;if(n>r)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class mo extends po{construct(e,t,n){return new mo(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];for(const r of n){if(r.indexOf("//")>=0)throw new Js(Ys.INVALID_ARGUMENT,"Invalid segment (".concat(r,"). Paths must not contain // in them."));e.push(...r.split("/").filter(e=>e.length>0))}return new mo(e)}static emptyPath(){return new mo([])}}const go=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class _o extends po{construct(e,t,n){return new _o(e,t,n)}static isValidIdentifier(e){return go.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),_o.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new _o(["__name__"])}static fromServerFormat(e){const t=[];let n="",i=0;const r=()=>{if(0===n.length)throw new Js(Ys.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(n),n=""};let s=!1;for(;i<e.length;){const t=e[i];if("\\"===t){if(i+1===e.length)throw new Js(Ys.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[i+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Js(Ys.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,i+=2}else"`"===t?(s=!s,i++):"."!==t||s?(n+=t,i++):(r(),i++)}if(r(),s)throw new Js(Ys.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new _o(t)}static emptyPath(){return new _o([])}}class vo{constructor(e){this.path=e}static fromPath(e){return new vo(mo.fromString(e))}static fromName(e){return new vo(mo.fromString(e).popFirst(5))}static empty(){return new vo(mo.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===mo.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return mo.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new vo(new mo(e.slice()))}}class yo{constructor(e,t,n,i){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=i}}yo.UNKNOWN_ID=-1;function wo(e,t){const n=e.toTimestamp().seconds,i=e.toTimestamp().nanoseconds+1,r=fo.fromTimestamp(1e9===i?new ho(n+1,0):new ho(n,i));return new Eo(r,vo.empty(),t)}function bo(e){return new Eo(e.readTime,e.key,-1)}class Eo{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Eo(fo.min(),vo.empty(),-1)}static max(){return new Eo(fo.max(),vo.empty(),-1)}}function To(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=vo.comparator(e.documentKey,t.documentKey),0!==n?n:co(e.largestBatchId,t.largestBatchId))}const Co="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class xo{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function So(e){if(e.code!==Ys.FAILED_PRECONDITION||e.message!==Co)throw e;qs("LocalStore","Unexpectedly lost primary lease")}class Io{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Gs(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Io((n,i)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,i)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Io?t:Io.resolve(t)}catch(e){return Io.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Io.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Io.reject(t)}static resolve(e){return new Io((t,n)=>{t(e)})}static reject(e){return new Io((t,n)=>{n(e)})}static waitFor(e){return new Io((t,n)=>{let i=0,r=0,s=!1;e.forEach(e=>{++i,e.next(()=>{++r,s&&r===i&&t()},e=>n(e))}),s=!0,r===i&&t()})}static or(e){let t=Io.resolve(!1);for(const n of e)t=t.next(e=>e?Io.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,i)=>{n.push(t.call(this,e,i))}),this.waitFor(n)}static mapArray(e,t){return new Io((n,i)=>{const r=e.length,s=new Array(r);let o=0;for(let a=0;a<r;a++){const l=a;t(e[l]).next(e=>{s[l]=e,++o,o===r&&n(s)},e=>i(e))}})}static doWhile(e,t){return new Io((n,i)=>{const r=()=>{!0===e()?t().next(()=>{r()},i):n()};r()})}}function ko(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Po(e){return"IndexedDbTransactionError"===e.name}class No{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ie(e),this.se=e=>t.writeSequenceNumber(e))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}function Ao(e){return null==e}function Ro(e){return 0===e&&1/e==-1/0}function Lo(e){return"number"==typeof e&&Number.isInteger(e)&&!Ro(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}No.oe=-1;const Oo=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Do=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Mo=Do,jo=[...Mo,"indexConfiguration","indexState","indexEntries"];function Fo(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Uo(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function zo(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Bo{constructor(e,t){this.comparator=e,this.root=t||qo.EMPTY}insert(e,t){return new Bo(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,qo.BLACK,null,null))}remove(e){return new Bo(this.comparator,this.root.remove(e,this.comparator).copy(null,null,qo.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(0===i)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push("".concat(t,":").concat(n)),!1)),"{".concat(e.join(", "),"}")}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Vo(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Vo(this.root,e,this.comparator,!1)}getReverseIterator(){return new Vo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Vo(this.root,e,this.comparator,!0)}}class Vo{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!e.isEmpty();)if(r=t?n(e.key,t):1,t&&i&&(r*=-1),r<0)e=this.isReverse?e.left:e.right;else{if(0===r){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class qo{constructor(e,t,n,i,r){this.key=e,this.value=t,this.color=null!=n?n:qo.RED,this.left=null!=i?i:qo.EMPTY,this.right=null!=r?r:qo.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,r){return new qo(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const r=n(e,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===r?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return qo.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return qo.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,qo.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,qo.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Gs();if(this.right.isRed())throw Gs();const e=this.left.check();if(e!==this.right.check())throw Gs();return e+(this.isRed()?0:1)}}qo.EMPTY=null,qo.RED=!0,qo.BLACK=!1,qo.EMPTY=new class{constructor(){this.size=0}get key(){throw Gs()}get value(){throw Gs()}get color(){throw Gs()}get left(){throw Gs()}get right(){throw Gs()}copy(e,t,n,i,r){return this}insert(e,t,n){return new qo(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ho{constructor(e){this.comparator=e,this.data=new Bo(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Wo(this.data.getIterator())}getIteratorFrom(e){return new Wo(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof Ho))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,i=n.getNext().key;if(0!==this.comparator(e,i))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Ho(this.comparator);return t.data=e,t}}class Wo{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Ko{constructor(e){this.fields=e,e.sort(_o.comparator)}static empty(){return new Ko([])}unionWith(e){let t=new Ho(_o.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Ko(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return uo(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class Go extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Zo{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Go("Invalid base64 string: "+e):e}}(e);return new Zo(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Zo(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return co(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Zo.EMPTY_BYTE_STRING=new Zo("");const Qo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Yo(e){if(Zs(!!e),"string"==typeof e){let t=0;const n=Qo.exec(e);if(Zs(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:Jo(e.seconds),nanos:Jo(e.nanos)}}function Jo(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Xo(e){return"string"==typeof e?Zo.fromBase64String(e):Zo.fromUint8Array(e)}function $o(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ea(e){const t=e.mapValue.fields.__previous_value__;return $o(t)?ea(t):t}function ta(e){const t=Yo(e.mapValue.fields.__local_write_time__.timestampValue);return new ho(t.seconds,t.nanos)}class na{constructor(e,t,n,i,r,s,o,a,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=r,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=l}}class ia{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new ia("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof ia&&e.projectId===this.projectId&&e.database===this.database}}const ra={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function sa(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?$o(e)?4:ba(e)?9007199254740991:ya(e)?10:11:Gs()}function oa(e,t){if(e===t)return!0;const n=sa(e);if(n!==sa(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return ta(e).isEqual(ta(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Yo(e.timestampValue),i=Yo(t.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Xo(e.bytesValue).isEqual(Xo(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Jo(e.geoPointValue.latitude)===Jo(t.geoPointValue.latitude)&&Jo(e.geoPointValue.longitude)===Jo(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Jo(e.integerValue)===Jo(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Jo(e.doubleValue),i=Jo(t.doubleValue);return n===i?Ro(n)===Ro(i):isNaN(n)&&isNaN(i)}return!1}(e,t);case 9:return uo(e.arrayValue.values||[],t.arrayValue.values||[],oa);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},i=t.mapValue.fields||{};if(Fo(n)!==Fo(i))return!1;for(const r in n)if(n.hasOwnProperty(r)&&(void 0===i[r]||!oa(n[r],i[r])))return!1;return!0}(e,t);default:return Gs()}}function aa(e,t){return void 0!==(e.values||[]).find(e=>oa(e,t))}function la(e,t){if(e===t)return 0;const n=sa(e),i=sa(t);if(n!==i)return co(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return co(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Jo(e.integerValue||e.doubleValue),i=Jo(t.integerValue||t.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(e,t);case 3:return ca(e.timestampValue,t.timestampValue);case 4:return ca(ta(e),ta(t));case 5:return co(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Xo(e),i=Xo(t);return n.compareTo(i)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),i=t.split("/");for(let r=0;r<n.length&&r<i.length;r++){const e=co(n[r],i[r]);if(0!==e)return e}return co(n.length,i.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=co(Jo(e.latitude),Jo(t.latitude));return 0!==n?n:co(Jo(e.longitude),Jo(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return ua(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,i,r,s;const o=e.fields||{},a=t.fields||{},l=null===(n=o.value)||void 0===n?void 0:n.arrayValue,c=null===(i=a.value)||void 0===i?void 0:i.arrayValue,u=co((null===(r=null==l?void 0:l.values)||void 0===r?void 0:r.length)||0,(null===(s=null==c?void 0:c.values)||void 0===s?void 0:s.length)||0);return 0!==u?u:ua(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===ra.mapValue&&t===ra.mapValue)return 0;if(e===ra.mapValue)return 1;if(t===ra.mapValue)return-1;const n=e.fields||{},i=Object.keys(n),r=t.fields||{},s=Object.keys(r);i.sort(),s.sort();for(let o=0;o<i.length&&o<s.length;++o){const e=co(i[o],s[o]);if(0!==e)return e;const t=la(n[i[o]],r[s[o]]);if(0!==t)return t}return co(i.length,s.length)}(e.mapValue,t.mapValue);default:throw Gs()}}function ca(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return co(e,t);const n=Yo(e),i=Yo(t),r=co(n.seconds,i.seconds);return 0!==r?r:co(n.nanos,i.nanos)}function ua(e,t){const n=e.values||[],i=t.values||[];for(let r=0;r<n.length&&r<i.length;++r){const e=la(n[r],i[r]);if(e)return e}return co(n.length,i.length)}function ha(e){return da(e)}function da(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Yo(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return Xo(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return vo.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return"geo(".concat(e.latitude,",").concat(e.longitude,")")}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const i of e.values||[])n?n=!1:t+=",",t+=da(i);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",i=!0;for(const r of t)i?i=!1:n+=",",n+="".concat(r,":").concat(da(e.fields[r]));return n+"}"}(e.mapValue):Gs()}function fa(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function pa(e){return!!e&&"integerValue"in e}function ma(e){return!!e&&"arrayValue"in e}function ga(e){return!!e&&"nullValue"in e}function _a(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function va(e){return!!e&&"mapValue"in e}function ya(e){var t,n;return"__vector__"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function wa(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Uo(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=wa(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=wa(e.arrayValue.values[n]);return t}return Object.assign({},e)}function ba(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}class Ea{constructor(e){this.value=e}static empty(){return new Ea({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!va(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=wa(t)}setAll(e){let t=_o.emptyPath(),n={},i=[];e.forEach((e,r)=>{if(!t.isImmediateParentOf(r)){const e=this.getFieldsMap(t);this.applyChanges(e,n,i),n={},i=[],t=r.popLast()}e?n[r.lastSegment()]=wa(e):i.push(r.lastSegment())});const r=this.getFieldsMap(t);this.applyChanges(r,n,i)}delete(e){const t=this.field(e.popLast());va(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return oa(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];va(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){Uo(t,(t,n)=>e[t]=n);for(const i of n)delete e[i]}clone(){return new Ea(wa(this.value))}}function Ta(e){const t=[];return Uo(e.fields,(e,n)=>{const i=new _o([e]);if(va(n)){const e=Ta(n.mapValue).fields;if(0===e.length)t.push(i);else for(const n of e)t.push(i.child(n))}else t.push(i)}),new Ko(t)}class Ca{constructor(e,t,n,i,r,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=r,this.data=s,this.documentState=o}static newInvalidDocument(e){return new Ca(e,0,fo.min(),fo.min(),fo.min(),Ea.empty(),0)}static newFoundDocument(e,t,n,i){return new Ca(e,1,t,fo.min(),n,i,0)}static newNoDocument(e,t){return new Ca(e,2,t,fo.min(),fo.min(),Ea.empty(),0)}static newUnknownDocument(e,t){return new Ca(e,3,t,fo.min(),fo.min(),Ea.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(fo.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ea.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ea.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=fo.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Ca&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ca(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class xa{constructor(e,t){this.position=e,this.inclusive=t}}function Sa(e,t,n){let i=0;for(let r=0;r<e.position.length;r++){const s=t[r],o=e.position[r];if(i=s.field.isKeyField()?vo.comparator(vo.fromName(o.referenceValue),n.key):la(o,n.data.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return i}function Ia(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!oa(e.position[n],t.position[n]))return!1;return!0}class ka{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function Pa(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class Na{}class Aa extends Na{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Ua(e,t,n):"array-contains"===t?new qa(e,n):"in"===t?new Ha(e,n):"not-in"===t?new Wa(e,n):"array-contains-any"===t?new Ka(e,n):new Aa(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new za(e,n):new Ba(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(la(t,this.value)):null!==t&&sa(this.value)===sa(t)&&this.matchesComparison(la(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Gs()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ra extends Na{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new Ra(e,t)}matches(e){return La(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.ae||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function La(e){return"and"===e.op}function Oa(e){return Da(e)&&La(e)}function Da(e){for(const t of e.filters)if(t instanceof Ra)return!1;return!0}function Ma(e){if(e instanceof Aa)return e.field.canonicalString()+e.op.toString()+ha(e.value);if(Oa(e))return e.filters.map(e=>Ma(e)).join(",");{const t=e.filters.map(e=>Ma(e)).join(",");return"".concat(e.op,"(").concat(t,")")}}function ja(e,t){return e instanceof Aa?function(e,t){return t instanceof Aa&&e.op===t.op&&e.field.isEqual(t.field)&&oa(e.value,t.value)}(e,t):e instanceof Ra?function(e,t){return t instanceof Ra&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,i)=>e&&ja(n,t.filters[i]),!0)}(e,t):void Gs()}function Fa(e){return e instanceof Aa?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(ha(e.value))}(e):e instanceof Ra?function(e){return e.op.toString()+" {"+e.getFilters().map(Fa).join(" ,")+"}"}(e):"Filter"}class Ua extends Aa{constructor(e,t,n){super(e,t,n),this.key=vo.fromName(n.referenceValue)}matches(e){const t=vo.comparator(e.key,this.key);return this.matchesComparison(t)}}class za extends Aa{constructor(e,t){super(e,"in",t),this.keys=Va("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Ba extends Aa{constructor(e,t){super(e,"not-in",t),this.keys=Va("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Va(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>vo.fromName(e.referenceValue))}class qa extends Aa{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return ma(t)&&aa(t.arrayValue,this.value)}}class Ha extends Aa{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&aa(this.value.arrayValue,t)}}class Wa extends Aa{constructor(e,t){super(e,"not-in",t)}matches(e){if(aa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!aa(this.value.arrayValue,t)}}class Ka extends Aa{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!ma(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>aa(this.value.arrayValue,e))}}class Ga{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=s,this.endAt=o,this.ue=null}}function Za(e){return new Ga(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Qa(e){const t=Qs(e);if(null===t.ue){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>Ma(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),Ao(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>ha(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>ha(e)).join(",")),t.ue=e}return t.ue}function Ya(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Pa(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!ja(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Ia(e.startAt,t.startAt)&&Ia(e.endAt,t.endAt)}function Ja(e){return vo.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class Xa{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=r,this.limitType=s,this.startAt=o,this.endAt=a,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function $a(e,t,n,i,r,s,o,a){return new Xa(e,t,n,i,r,s,o,a)}function el(e){return new Xa(e)}function tl(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function nl(e){return null!==e.collectionGroup}function il(e){const t=Qs(e);if(null===t.ce){t.ce=[];const e=new Set;for(const r of t.explicitOrderBy)t.ce.push(r),e.add(r.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",i=function(e){let t=new Ho(_o.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t}(t);i.forEach(i=>{e.has(i.canonicalString())||i.isKeyField()||t.ce.push(new ka(i,n))}),e.has(_o.keyField().canonicalString())||t.ce.push(new ka(_o.keyField(),n))}return t.ce}function rl(e){const t=Qs(e);return t.le||(t.le=sl(t,il(e))),t.le}function sl(e,t){if("F"===e.limitType)return Za(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new ka(e.field,t)});const n=e.endAt?new xa(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new xa(e.startAt.position,e.startAt.inclusive):null;return Za(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}}function ol(e,t){const n=e.filters.concat([t]);return new Xa(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function al(e,t,n){return new Xa(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function ll(e,t){return Ya(rl(e),rl(t))&&e.limitType===t.limitType}function cl(e){return"".concat(Qa(rl(e)),"|lt:").concat(e.limitType)}function ul(e){return"Query(target=".concat(function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(e=>Fa(e)).join(", "),"]")),Ao(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(e=>function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>ha(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>ha(e)).join(",")),"Target(".concat(t,")")}(rl(e)),"; limitType=").concat(e.limitType,")")}function hl(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):vo.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of il(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const i=Sa(e,t,n);return e.inclusive?i<=0:i<0}(e.startAt,il(e),t))&&!(e.endAt&&!function(e,t,n){const i=Sa(e,t,n);return e.inclusive?i>=0:i>0}(e.endAt,il(e),t))}(e,t)}function dl(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function fl(e){return(t,n)=>{let i=!1;for(const r of il(e)){const e=pl(r,t,n);if(0!==e)return e;i=i||r.field.isKeyField()}return 0}}function pl(e,t,n){const i=e.field.isKeyField()?vo.comparator(t.key,n.key):function(e,t,n){const i=t.data.field(e),r=n.data.field(e);return null!==i&&null!==r?la(i,r):Gs()}(e.field,t,n);switch(e.dir){case"asc":return i;case"desc":return-1*i;default:return Gs()}}class ml{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[i,r]of n)if(this.equalsFn(i,e))return r}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(void 0===i)return this.inner[n]=[[e,t]],void this.innerSize++;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return void(i[r]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return 1===n.length?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Uo(this.inner,(t,n)=>{for(const[i,r]of n)e(i,r)})}isEmpty(){return zo(this.inner)}size(){return this.innerSize}}const gl=new Bo(vo.comparator);function _l(){return gl}const vl=new Bo(vo.comparator);function yl(){let e=vl;for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];for(const r of n)e=e.insert(r.key,r);return e}function wl(e){let t=vl;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function bl(){return Tl()}function El(){return Tl()}function Tl(){return new ml(e=>e.toString(),(e,t)=>e.isEqual(t))}const Cl=new Bo(vo.comparator),xl=new Ho(vo.comparator);function Sl(){let e=xl;for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];for(const r of n)e=e.add(r);return e}const Il=new Ho(co);function kl(){return Il}function Pl(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ro(t)?"-0":t}}function Nl(e){return{integerValue:""+e}}function Al(e,t){return Lo(t)?Nl(t):Pl(e,t)}class Rl{constructor(){this._=void 0}}function Ll(e,t,n){return e instanceof Ml?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&$o(t)&&(t=ea(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof jl?Fl(e,t):e instanceof Ul?zl(e,t):function(e,t){const n=Dl(e,t),i=Vl(n)+Vl(e.Pe);return pa(n)&&pa(e.Pe)?Nl(i):Pl(e.serializer,i)}(e,t)}function Ol(e,t,n){return e instanceof jl?Fl(e,t):e instanceof Ul?zl(e,t):n}function Dl(e,t){return e instanceof Bl?function(e){return pa(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class Ml extends Rl{}class jl extends Rl{constructor(e){super(),this.elements=e}}function Fl(e,t){const n=ql(t);for(const i of e.elements)n.some(e=>oa(e,i))||n.push(i);return{arrayValue:{values:n}}}class Ul extends Rl{constructor(e){super(),this.elements=e}}function zl(e,t){let n=ql(t);for(const i of e.elements)n=n.filter(e=>!oa(e,i));return{arrayValue:{values:n}}}class Bl extends Rl{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function Vl(e){return Jo(e.integerValue||e.doubleValue)}function ql(e){return ma(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Hl{constructor(e,t){this.field=e,this.transform=t}}class Wl{constructor(e,t){this.version=e,this.transformResults=t}}class Kl{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Kl}static exists(e){return new Kl(void 0,e)}static updateTime(e){return new Kl(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Gl(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Zl{}function Ql(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new sc(e.key,Kl.none()):new ec(e.key,e.data,Kl.none());{const n=e.data,i=Ea.empty();let r=new Ho(_o.comparator);for(let e of t.fields)if(!r.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?i.delete(e):i.set(e,t),r=r.add(e)}return new tc(e.key,i,new Ko(r.toArray()),Kl.none())}}function Yl(e,t,n){e instanceof ec?function(e,t,n){const i=e.value.clone(),r=ic(e.fieldTransforms,t,n.transformResults);i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):e instanceof tc?function(e,t,n){if(!Gl(e.precondition,t))return void t.convertToUnknownDocument(n.version);const i=ic(e.fieldTransforms,t,n.transformResults),r=t.data;r.setAll(nc(e)),r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Jl(e,t,n,i){return e instanceof ec?function(e,t,n,i){if(!Gl(e.precondition,t))return n;const r=e.value.clone(),s=rc(e.fieldTransforms,i,t);return r.setAll(s),t.convertToFoundDocument(t.version,r).setHasLocalMutations(),null}(e,t,n,i):e instanceof tc?function(e,t,n,i){if(!Gl(e.precondition,t))return n;const r=rc(e.fieldTransforms,i,t),s=t.data;return s.setAll(nc(e)),s.setAll(r),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,i):function(e,t,n){return Gl(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Xl(e,t){let n=null;for(const i of e.fieldTransforms){const e=t.data.field(i.field),r=Dl(i.transform,e||null);null!=r&&(null===n&&(n=Ea.empty()),n.set(i.field,r))}return n||null}function $l(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&uo(e,t,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof jl&&t instanceof jl||e instanceof Ul&&t instanceof Ul?uo(e.elements,t.elements,oa):e instanceof Bl&&t instanceof Bl?oa(e.Pe,t.Pe):e instanceof Ml&&t instanceof Ml}(e.transform,t.transform)}(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class ec extends Zl{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class tc extends Zl{constructor(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function nc(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const i=e.data.field(n);t.set(n,i)}}),t}function ic(e,t,n){const i=new Map;Zs(e.length===n.length);for(let r=0;r<n.length;r++){const s=e[r],o=s.transform,a=t.data.field(s.field);i.set(s.field,Ol(o,a,n[r]))}return i}function rc(e,t,n){const i=new Map;for(const r of e){const e=r.transform,s=n.data.field(r.field);i.set(r.field,Ll(e,s,t))}return i}class sc extends Zl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class oc extends Zl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class ac{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const t=this.mutations[i];t.key.isEqual(e.key)&&Yl(t,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Jl(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Jl(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=El();return this.mutations.forEach(i=>{const r=e.get(i.key),s=r.overlayedDocument;let o=this.applyToLocalView(s,r.mutatedFields);o=t.has(i.key)?null:o;const a=Ql(s,o);null!==a&&n.set(i.key,a),s.isValidDocument()||s.convertToNoDocument(fo.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Sl())}isEqual(e){return this.batchId===e.batchId&&uo(this.mutations,e.mutations,(e,t)=>$l(e,t))&&uo(this.baseMutations,e.baseMutations,(e,t)=>$l(e,t))}}class lc{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){Zs(e.mutations.length===n.length);let i=Cl;const r=e.mutations;for(let s=0;s<r.length;s++)i=i.insert(r[s].key,n[s].version);return new lc(e,t,n,i)}}class cc{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class uc{constructor(e,t){this.count=e,this.unchangedNames=t}}var hc,dc;function fc(e){switch(e){default:return Gs();case Ys.CANCELLED:case Ys.UNKNOWN:case Ys.DEADLINE_EXCEEDED:case Ys.RESOURCE_EXHAUSTED:case Ys.INTERNAL:case Ys.UNAVAILABLE:case Ys.UNAUTHENTICATED:return!1;case Ys.INVALID_ARGUMENT:case Ys.NOT_FOUND:case Ys.ALREADY_EXISTS:case Ys.PERMISSION_DENIED:case Ys.FAILED_PRECONDITION:case Ys.ABORTED:case Ys.OUT_OF_RANGE:case Ys.UNIMPLEMENTED:case Ys.DATA_LOSS:return!0}}function pc(e){if(void 0===e)return Hs("GRPC error has no .code"),Ys.UNKNOWN;switch(e){case hc.OK:return Ys.OK;case hc.CANCELLED:return Ys.CANCELLED;case hc.UNKNOWN:return Ys.UNKNOWN;case hc.DEADLINE_EXCEEDED:return Ys.DEADLINE_EXCEEDED;case hc.RESOURCE_EXHAUSTED:return Ys.RESOURCE_EXHAUSTED;case hc.INTERNAL:return Ys.INTERNAL;case hc.UNAVAILABLE:return Ys.UNAVAILABLE;case hc.UNAUTHENTICATED:return Ys.UNAUTHENTICATED;case hc.INVALID_ARGUMENT:return Ys.INVALID_ARGUMENT;case hc.NOT_FOUND:return Ys.NOT_FOUND;case hc.ALREADY_EXISTS:return Ys.ALREADY_EXISTS;case hc.PERMISSION_DENIED:return Ys.PERMISSION_DENIED;case hc.FAILED_PRECONDITION:return Ys.FAILED_PRECONDITION;case hc.ABORTED:return Ys.ABORTED;case hc.OUT_OF_RANGE:return Ys.OUT_OF_RANGE;case hc.UNIMPLEMENTED:return Ys.UNIMPLEMENTED;case hc.DATA_LOSS:return Ys.DATA_LOSS;default:return Gs()}}(dc=hc||(hc={}))[dc.OK=0]="OK",dc[dc.CANCELLED=1]="CANCELLED",dc[dc.UNKNOWN=2]="UNKNOWN",dc[dc.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",dc[dc.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",dc[dc.NOT_FOUND=5]="NOT_FOUND",dc[dc.ALREADY_EXISTS=6]="ALREADY_EXISTS",dc[dc.PERMISSION_DENIED=7]="PERMISSION_DENIED",dc[dc.UNAUTHENTICATED=16]="UNAUTHENTICATED",dc[dc.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",dc[dc.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",dc[dc.ABORTED=10]="ABORTED",dc[dc.OUT_OF_RANGE=11]="OUT_OF_RANGE",dc[dc.UNIMPLEMENTED=12]="UNIMPLEMENTED",dc[dc.INTERNAL=13]="INTERNAL",dc[dc.UNAVAILABLE=14]="UNAVAILABLE",dc[dc.DATA_LOSS=15]="DATA_LOSS";let mc=null;function gc(){return new TextEncoder}const _c=new Cs([4294967295,4294967295],0);function vc(e){const t=gc().encode(e),n=new xs;return n.update(t),new Uint8Array(n.digest())}function yc(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),i=t.getUint32(4,!0),r=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new Cs([n,i],0),new Cs([r,s],0)]}class wc{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new bc("Invalid padding: ".concat(t));if(n<0)throw new bc("Invalid hash count: ".concat(n));if(e.length>0&&0===this.hashCount)throw new bc("Invalid hash count: ".concat(n));if(0===e.length&&0!==t)throw new bc("Invalid padding when bitmap length is 0: ".concat(t));this.Ie=8*e.length-t,this.Te=Cs.fromNumber(this.Ie)}Ee(e,t,n){let i=e.add(t.multiply(Cs.fromNumber(n)));return 1===i.compare(_c)&&(i=new Cs([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ie)return!1;const t=vc(e),[n,i]=yc(t);for(let r=0;r<this.hashCount;r++){const e=this.Ee(n,i,r);if(!this.de(e))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,r=new Uint8Array(Math.ceil(e/8)),s=new wc(r,i,t);return n.forEach(e=>s.insert(e)),s}insert(e){if(0===this.Ie)return;const t=vc(e),[n,i]=yc(t);for(let r=0;r<this.hashCount;r++){const e=this.Ee(n,i,r);this.Ae(e)}}Ae(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class bc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Ec{constructor(e,t,n,i,r){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,Tc.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Ec(fo.min(),i,new Bo(co),_l(),Sl())}}class Tc{constructor(e,t,n,i,r){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Tc(n,t,Sl(),Sl(),Sl())}}class Cc{constructor(e,t,n,i){this.Re=e,this.removedTargetIds=t,this.key=n,this.Ve=i}}class xc{constructor(e,t){this.targetId=e,this.me=t}}class Sc{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Zo.EMPTY_BYTE_STRING,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class Ic{constructor(){this.fe=0,this.ge=Nc(),this.pe=Zo.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return 0!==this.fe}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Sl(),t=Sl(),n=Sl();return this.ge.forEach((i,r)=>{switch(r){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:Gs()}}),new Tc(this.pe,this.ye,e,t,n)}Ce(){this.we=!1,this.ge=Nc()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Zs(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class kc{constructor(e){this.Le=e,this.Be=new Map,this.ke=_l(),this.qe=Pc(),this.Qe=new Bo(co)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const n=this.Ge(t);switch(e.state){case 0:this.ze(t)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),n.De(e.resumeToken));break;default:Gs()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((e,n)=>{this.ze(n)&&t(n)})}He(e){const t=e.targetId,n=e.me.count,i=this.Je(t);if(i){const r=i.target;if(Ja(r))if(0===n){const e=new vo(r.path);this.Ue(t,e,Ca.newNoDocument(e,fo.min()))}else Zs(1===n);else{const i=this.Ye(t);if(i!==n){const n=this.Ze(e),r=n?this.Xe(n,e,i):1;if(0!==r){this.je(t);const e=2===r?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,e)}null==mc||mc.et(function(e,t,n,i,r){var s,o,a,l,c,u;const h={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},d=t.unchangedNames;return d&&(h.bloomFilter={applied:0===r,hashCount:null!==(s=null==d?void 0:d.hashCount)&&void 0!==s?s:0,bitmapLength:null!==(l=null===(a=null===(o=null==d?void 0:d.bits)||void 0===o?void 0:o.bitmap)||void 0===a?void 0:a.length)&&void 0!==l?l:0,padding:null!==(u=null===(c=null==d?void 0:d.bits)||void 0===c?void 0:c.padding)&&void 0!==u?u:0,mightContain:e=>{var t;return null!==(t=null==i?void 0:i.mightContain(e))&&void 0!==t&&t}}),h}(i,e.me,this.Le.tt(),n,r))}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:r=0}=t;let s,o;try{s=Xo(n).toUint8Array()}catch(e){if(e instanceof Go)return Ws("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{o=new wc(s,i,r)}catch(e){return Ws(e instanceof bc?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===o.Ie?null:o}Xe(e,t,n){return t.me.count===n-this.nt(e,t.targetId)?0:2}nt(e,t){const n=this.Le.getRemoteKeysForTarget(t);let i=0;return n.forEach(n=>{const r=this.Le.tt(),s="projects/".concat(r.projectId,"/databases/").concat(r.database,"/documents/").concat(n.path.canonicalString());e.mightContain(s)||(this.Ue(t,n,null),i++)}),i}rt(e){const t=new Map;this.Be.forEach((n,i)=>{const r=this.Je(i);if(r){if(n.current&&Ja(r.target)){const t=new vo(r.target.path);null!==this.ke.get(t)||this.it(i,t)||this.Ue(i,t,Ca.newNoDocument(t,e))}n.be&&(t.set(i,n.ve()),n.Ce())}});let n=Sl();this.qe.forEach((e,t)=>{let i=!0;t.forEachWhile(e=>{const t=this.Je(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(i=!1,!1)}),i&&(n=n.add(e))}),this.ke.forEach((t,n)=>n.setReadTime(e));const i=new Ec(e,t,this.Qe,this.ke,n);return this.ke=_l(),this.qe=Pc(),this.Qe=new Bo(co),i}$e(e,t){if(!this.ze(e))return;const n=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,n),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,n){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),n&&(this.ke=this.ke.insert(t,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Ic,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Ho(co),this.qe=this.qe.insert(e,t)),t}ze(e){const t=null!==this.Je(e);return t||qs("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Ic),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function Pc(){return new Bo(vo.comparator)}function Nc(){return new Bo(vo.comparator)}const Ac={asc:"ASCENDING",desc:"DESCENDING"},Rc={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Lc={and:"AND",or:"OR"};class Oc{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Dc(e,t){return e.useProto3Json||Ao(t)?t:{value:t}}function Mc(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function jc(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Fc(e,t){return Mc(e,t.toTimestamp())}function Uc(e){return Zs(!!e),fo.fromTimestamp(function(e){const t=Yo(e);return new ho(t.seconds,t.nanos)}(e))}function zc(e,t){return Bc(e,t).canonicalString()}function Bc(e,t){const n=function(e){return new mo(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function Vc(e){const t=mo.fromString(e);return Zs(lu(t)),t}function qc(e,t){return zc(e.databaseId,t.path)}function Hc(e,t){const n=Vc(t);if(n.get(1)!==e.databaseId.projectId)throw new Js(Ys.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Js(Ys.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new vo(Zc(n))}function Wc(e,t){return zc(e.databaseId,t)}function Kc(e){const t=Vc(e);return 4===t.length?mo.emptyPath():Zc(t)}function Gc(e){return new mo(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Zc(e){return Zs(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function Qc(e,t,n){return{name:qc(e,t),fields:n.value.mapValue.fields}}function Yc(e,t){let n;if(t instanceof ec)n={update:Qc(e,t.key,t.value)};else if(t instanceof sc)n={delete:qc(e,t.key)};else if(t instanceof tc)n={update:Qc(e,t.key,t.data),updateMask:au(t.fieldMask)};else{if(!(t instanceof oc))return Gs();n={verify:qc(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof Ml)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof jl)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Ul)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Bl)return{fieldPath:t.field.canonicalString(),increment:n.Pe};throw Gs()}(0,e))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Fc(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Gs()}(e,t.precondition)),n}function Jc(e,t){return{documents:[Wc(e,t.path)]}}function Xc(e,t){const n={structuredQuery:{}},i=t.path;let r;null!==t.collectionGroup?(r=i,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(r=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=Wc(e,r);const s=function(e){if(0!==e.length)return ou(Ra.create(e,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const o=function(e){if(0!==e.length)return e.map(e=>function(e){return{field:ru(e.field),direction:tu(e.dir)}}(e))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Dc(e,t.limit);return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{_t:n,parent:r}}function $c(e){let t=Kc(e.parent);const n=e.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){Zs(1===i);const e=n.from[0];e.allDescendants?r=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=eu(e);return t instanceof Ra&&Oa(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map(e=>function(e){return new ka(su(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,Ao(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new xa(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new xa(n,t)}(n.endAt)),$a(t,r,o,s,a,"F",l,c)}function eu(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=su(e.unaryFilter.field);return Aa.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=su(e.unaryFilter.field);return Aa.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=su(e.unaryFilter.field);return Aa.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=su(e.unaryFilter.field);return Aa.create(r,"!=",{nullValue:"NULL_VALUE"});default:return Gs()}}(e):void 0!==e.fieldFilter?function(e){return Aa.create(su(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Gs()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Ra.create(e.compositeFilter.filters.map(e=>eu(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Gs()}}(e.compositeFilter.op))}(e):Gs()}function tu(e){return Ac[e]}function nu(e){return Rc[e]}function iu(e){return Lc[e]}function ru(e){return{fieldPath:e.canonicalString()}}function su(e){return _o.fromServerFormat(e.fieldPath)}function ou(e){return e instanceof Aa?function(e){if("=="===e.op){if(_a(e.value))return{unaryFilter:{field:ru(e.field),op:"IS_NAN"}};if(ga(e.value))return{unaryFilter:{field:ru(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(_a(e.value))return{unaryFilter:{field:ru(e.field),op:"IS_NOT_NAN"}};if(ga(e.value))return{unaryFilter:{field:ru(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ru(e.field),op:nu(e.op),value:e.value}}}(e):e instanceof Ra?function(e){const t=e.getFilters().map(e=>ou(e));return 1===t.length?t[0]:{compositeFilter:{op:iu(e.op),filters:t}}}(e):Gs()}function au(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function lu(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class cu{constructor(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:fo.min(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:fo.min(),o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Zo.EMPTY_BYTE_STRING,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new cu(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new cu(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new cu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new cu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class uu{constructor(e){this.ct=e}}function hu(e){const t=$c({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?al(t,t.limit,"L"):t}class du{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Jo(e.integerValue));else if("doubleValue"in e){const n=Jo(e.doubleValue);isNaN(n)?this.dt(t,13):(this.dt(t,15),Ro(n)?t.At(0):t.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(t,20),"string"==typeof n&&(n=Yo(n)),t.Rt("".concat(n.seconds||"")),t.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Xo(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.dt(t,45),t.At(n.latitude||0),t.At(n.longitude||0)}else"mapValue"in e?ba(e)?this.dt(t,Number.MAX_SAFE_INTEGER):ya(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):Gs()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const n=e.fields||{};this.dt(t,55);for(const i of Object.keys(n))this.Vt(i,t),this.Tt(n[i],t)}wt(e,t){var n,i;const r=e.fields||{};this.dt(t,53);const s="value",o=(null===(i=null===(n=r[s].arrayValue)||void 0===n?void 0:n.values)||void 0===i?void 0:i.length)||0;this.dt(t,15),t.At(Jo(o)),this.Vt(s,t),this.Tt(r[s],t)}bt(e,t){const n=e.values||[];this.dt(t,50);for(const i of n)this.Tt(i,t)}yt(e,t){this.dt(t,37),vo.fromName(e).path.forEach(e=>{this.dt(t,60),this.Dt(e,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}}du.vt=new du;class fu{constructor(){this.un=new pu}addToCollectionParentIndex(e,t){return this.un.add(t),Io.resolve()}getCollectionParents(e,t){return Io.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return Io.resolve()}deleteFieldIndex(e,t){return Io.resolve()}deleteAllFieldIndexes(e){return Io.resolve()}createTargetIndexes(e,t){return Io.resolve()}getDocumentsMatchingTarget(e,t){return Io.resolve(null)}getIndexType(e,t){return Io.resolve(0)}getFieldIndexes(e,t){return Io.resolve([])}getNextCollectionGroupToUpdate(e){return Io.resolve(null)}getMinOffset(e,t){return Io.resolve(Eo.min())}getMinOffsetFromCollectionGroup(e,t){return Io.resolve(Eo.min())}updateCollectionGroup(e,t,n){return Io.resolve()}updateIndexEntries(e,t){return Io.resolve()}}class pu{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new Ho(mo.comparator),r=!i.has(n);return this.index[t]=i.add(n),r}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Ho(mo.comparator)).toArray()}}new Uint8Array(0);class mu{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new mu(e,mu.DEFAULT_COLLECTION_PERCENTILE,mu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}mu.DEFAULT_COLLECTION_PERCENTILE=10,mu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,mu.DEFAULT=new mu(41943040,mu.DEFAULT_COLLECTION_PERCENTILE,mu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),mu.DISABLED=new mu(-1,0,0);class gu{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new gu(0)}static kn(){return new gu(-1)}}class _u{constructor(){this.changes=new ml(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ca.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Io.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class vu{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class yu{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&Jl(n.mutation,e,Ko.empty(),ho.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,Sl()).next(()=>t))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Sl();const i=bl();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(e=>{let t=yl();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=bl();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Sl()))}populateOverlays(e,t,n){const i=[];return n.forEach(e=>{t.has(e)||i.push(e)}),this.documentOverlayCache.getOverlays(e,i).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,i){let r=_l();const s=Tl(),o=Tl();return t.forEach((e,t)=>{const o=n.get(t.key);i.has(t.key)&&(void 0===o||o.mutation instanceof tc)?r=r.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),Jl(o.mutation,t,o.mutation.getFieldMask(),ho.now())):s.set(t.key,Ko.empty())}),this.recalculateAndSaveOverlays(e,r).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>{var n;return o.set(e,new vu(t,null!==(n=s.get(e))&&void 0!==n?n:null))}),o))}recalculateAndSaveOverlays(e,t){const n=Tl();let i=new Bo((e,t)=>e-t),r=Sl();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const r of e)r.keys().forEach(e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||Ko.empty();o=r.applyToLocalView(s,o),n.set(e,o);const a=(i.get(r.batchId)||Sl()).add(e);i=i.insert(r.batchId,a)})}).next(()=>{const s=[],o=i.getReverseIterator();for(;o.hasNext();){const i=o.getNext(),a=i.key,l=i.value,c=El();l.forEach(e=>{if(!r.has(e)){const i=Ql(t.get(e),n.get(e));null!==i&&c.set(e,i),r=r.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,a,c))}return Io.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n,i){return function(e){return vo.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):nl(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(r=>{const s=i-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-r.size):Io.resolve(bl());let o=-1,a=r;return s.next(t=>Io.forEach(t,(t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),r.get(t)?Io.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{a=a.insert(t,e)}))).next(()=>this.populateOverlays(e,t,r)).next(()=>this.computeViews(e,a,t,Sl())).next(e=>({batchId:o,changes:wl(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new vo(t)).next(e=>{let t=yl();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){const r=t.collectionGroup;let s=yl();return this.indexManager.getCollectionParents(e,r).next(o=>Io.forEach(o,o=>{const a=function(e,t){return new Xa(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(r));return this.getDocumentsMatchingCollectionQuery(e,a,n,i).next(e=>{e.forEach((e,t)=>{s=s.insert(e,t)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,n,i){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(s=>(r=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,r,i))).next(e=>{r.forEach((t,n)=>{const i=n.getKey();null===e.get(i)&&(e=e.insert(i,Ca.newInvalidDocument(i)))});let n=yl();return e.forEach((e,i)=>{const s=r.get(e);void 0!==s&&Jl(s.mutation,i,Ko.empty(),ho.now()),hl(t,i)&&(n=n.insert(e,i))}),n})}}class wu{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return Io.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Uc(e.createTime)}}(t)),Io.resolve()}getNamedQuery(e,t){return Io.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(e){return{name:e.name,query:hu(e.bundledQuery),readTime:Uc(e.readTime)}}(t)),Io.resolve()}}class bu{constructor(){this.overlays=new Bo(vo.comparator),this.Ir=new Map}getOverlay(e,t){return Io.resolve(this.overlays.get(t))}getOverlays(e,t){const n=bl();return Io.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,i)=>{this.ht(e,t,i)}),Io.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.Ir.get(n);return void 0!==i&&(i.forEach(e=>this.overlays=this.overlays.remove(e)),this.Ir.delete(n)),Io.resolve()}getOverlaysForCollection(e,t,n){const i=bl(),r=t.length+1,s=new vo(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===r&&e.largestBatchId>n&&i.set(e.getKey(),e)}return Io.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let r=new Bo((e,t)=>e-t);const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=r.get(e.largestBatchId);null===t&&(t=bl(),r=r.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=bl(),a=r.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((e,t)=>o.set(e,t)),!(o.size()>=i)););return Io.resolve(o)}ht(e,t,n){const i=this.overlays.get(n.key);if(null!==i){const e=this.Ir.get(i.largestBatchId).delete(n.key);this.Ir.set(i.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new cc(t,n));let r=this.Ir.get(t);void 0===r&&(r=Sl(),this.Ir.set(t,r)),this.Ir.set(t,r.add(n.key))}}class Eu{constructor(){this.sessionToken=Zo.EMPTY_BYTE_STRING}getSessionToken(e){return Io.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Io.resolve()}}class Tu{constructor(){this.Tr=new Ho(Cu.Er),this.dr=new Ho(Cu.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const n=new Cu(e,t);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Vr(new Cu(e,t))}mr(e,t){e.forEach(e=>this.removeReference(e,t))}gr(e){const t=new vo(new mo([])),n=new Cu(t,e),i=new Cu(t,e+1),r=[];return this.dr.forEachInRange([n,i],e=>{this.Vr(e),r.push(e.key)}),r}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new vo(new mo([])),n=new Cu(t,e),i=new Cu(t,e+1);let r=Sl();return this.dr.forEachInRange([n,i],e=>{r=r.add(e.key)}),r}containsKey(e){const t=new Cu(e,0),n=this.Tr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Cu{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return vo.comparator(e.key,t.key)||co(e.wr,t.wr)}static Ar(e,t){return co(e.wr,t.wr)||vo.comparator(e.key,t.key)}}class xu{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Ho(Cu.Er)}checkEmpty(e){return Io.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,i){const r=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new ac(r,t,n,i);this.mutationQueue.push(s);for(const o of i)this.br=this.br.add(new Cu(o.key,r)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Io.resolve(s)}lookupMutationBatch(e,t){return Io.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.vr(n),r=i<0?0:i;return Io.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return Io.resolve(0===this.mutationQueue.length?-1:this.Sr-1)}getAllMutationBatches(e){return Io.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Cu(t,0),i=new Cu(t,Number.POSITIVE_INFINITY),r=[];return this.br.forEachInRange([n,i],e=>{const t=this.Dr(e.wr);r.push(t)}),Io.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Ho(co);return t.forEach(e=>{const t=new Cu(e,0),i=new Cu(e,Number.POSITIVE_INFINITY);this.br.forEachInRange([t,i],e=>{n=n.add(e.wr)})}),Io.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let r=n;vo.isDocumentKey(r)||(r=r.child(""));const s=new Cu(new vo(r),0);let o=new Ho(co);return this.br.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===i&&(o=o.add(e.wr)),!0)},s),Io.resolve(this.Cr(o))}Cr(e){const t=[];return e.forEach(e=>{const n=this.Dr(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){Zs(0===this.Fr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.br;return Io.forEach(t.mutations,i=>{const r=new Cu(i.key,t.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,t){const n=new Cu(t,0),i=this.br.firstAfterOrEqual(n);return Io.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Io.resolve()}Fr(e,t){return this.vr(e)}vr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Su{constructor(e){this.Mr=e,this.docs=new Bo(vo.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),r=i?i.size:0,s=this.Mr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-r,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Io.resolve(n?n.document.mutableCopy():Ca.newInvalidDocument(t))}getEntries(e,t){let n=_l();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Ca.newInvalidDocument(e))}),Io.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let r=_l();const s=t.path,o=new vo(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||To(bo(o),n)<=0||(i.has(o.key)||hl(t,o))&&(r=r.insert(o.key,o.mutableCopy()))}return Io.resolve(r)}getAllFromCollectionGroup(e,t,n,i){Gs()}Or(e,t){return Io.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new Iu(this)}getSize(e){return Io.resolve(this.size)}}class Iu extends _u{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(n)}),Io.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}class ku{constructor(e){this.persistence=e,this.Nr=new ml(e=>Qa(e),Ya),this.lastRemoteSnapshotVersion=fo.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Tu,this.targetCount=0,this.kr=gu.Bn()}forEachTarget(e,t){return this.Nr.forEach((e,n)=>t(n)),Io.resolve()}getLastRemoteSnapshotVersion(e){return Io.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Io.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Io.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Lr&&(this.Lr=t),Io.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new gu(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,Io.resolve()}updateTargetData(e,t){return this.Kn(t),Io.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,Io.resolve()}removeTargets(e,t,n){let i=0;const r=[];return this.Nr.forEach((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.Nr.delete(s),r.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),Io.waitFor(r).next(()=>i)}getTargetCount(e){return Io.resolve(this.targetCount)}getTargetData(e,t){const n=this.Nr.get(t)||null;return Io.resolve(n)}addMatchingKeys(e,t,n){return this.Br.Rr(t,n),Io.resolve()}removeMatchingKeys(e,t,n){this.Br.mr(t,n);const i=this.persistence.referenceDelegate,r=[];return i&&t.forEach(t=>{r.push(i.markPotentiallyOrphaned(e,t))}),Io.waitFor(r)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),Io.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Br.yr(t);return Io.resolve(n)}containsKey(e,t){return Io.resolve(this.Br.containsKey(t))}}class Pu{constructor(e,t){this.qr={},this.overlays={},this.Qr=new No(0),this.Kr=!1,this.Kr=!0,this.$r=new Eu,this.referenceDelegate=e(this),this.Ur=new ku(this),this.indexManager=new fu,this.remoteDocumentCache=function(e){return new Su(e)}(e=>this.referenceDelegate.Wr(e)),this.serializer=new uu(t),this.Gr=new wu(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new bu,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.qr[e.toKey()];return n||(n=new xu(t,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,n){qs("MemoryPersistence","Starting transaction:",e);const i=new Nu(this.Qr.next());return this.referenceDelegate.zr(),n(i).next(e=>this.referenceDelegate.jr(i).next(()=>e)).toPromise().then(e=>(i.raiseOnCommittedEvent(),e))}Hr(e,t){return Io.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,t)))}}class Nu extends xo{constructor(e){super(),this.currentSequenceNumber=e}}class Au{constructor(e){this.persistence=e,this.Jr=new Tu,this.Yr=null}static Zr(e){return new Au(e)}get Xr(){if(this.Yr)return this.Yr;throw Gs()}addReference(e,t,n){return this.Jr.addReference(n,t),this.Xr.delete(n.toString()),Io.resolve()}removeReference(e,t,n){return this.Jr.removeReference(n,t),this.Xr.add(n.toString()),Io.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),Io.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(e=>this.Xr.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.Xr.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Io.forEach(this.Xr,n=>{const i=vo.fromPath(n);return this.ei(e,i).next(e=>{e||t.removeEntry(i,fo.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(e=>{e?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return Io.or([()=>Io.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}class Ru{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.$i=n,this.Ui=i}static Wi(e,t){let n=Sl(),i=Sl();for(const r of t.docChanges)switch(r.type){case 0:n=n.add(r.doc.key);break;case 1:i=i.add(r.doc.key)}return new Ru(e,t.fromCache,n,i)}}class Lu{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Ou{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=ne()?8:ko(J())>0?6:4}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,n,i){const r={result:null};return this.Yi(e,t).next(e=>{r.result=e}).next(()=>{if(!r.result)return this.Zi(e,t,i,n).next(e=>{r.result=e})}).next(()=>{if(r.result)return;const n=new Lu;return this.Xi(e,t,n).next(i=>{if(r.result=i,this.zi)return this.es(e,t,n,i.size)})}).next(()=>r.result)}es(e,t,n,i){return n.documentReadCount<this.ji?(Vs()<=Re.DEBUG&&qs("QueryEngine","SDK will not create cache indexes for query:",ul(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Io.resolve()):(Vs()<=Re.DEBUG&&qs("QueryEngine","Query:",ul(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Hi*i?(Vs()<=Re.DEBUG&&qs("QueryEngine","The SDK decides to create cache indexes for query:",ul(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,rl(t))):Io.resolve())}Yi(e,t){if(tl(t))return Io.resolve(null);let n=rl(t);return this.indexManager.getIndexType(e,n).next(i=>0===i?null:(null!==t.limit&&1===i&&(t=al(t,null,"F"),n=rl(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const r=Sl(...i);return this.Ji.getDocuments(e,r).next(i=>this.indexManager.getMinOffset(e,n).next(n=>{const s=this.ts(t,i);return this.ns(t,s,r,n.readTime)?this.Yi(e,al(t,null,"F")):this.rs(e,s,t,n)}))})))}Zi(e,t,n,i){return tl(t)||i.isEqual(fo.min())?Io.resolve(null):this.Ji.getDocuments(e,n).next(r=>{const s=this.ts(t,r);return this.ns(t,s,n,i)?Io.resolve(null):(Vs()<=Re.DEBUG&&qs("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ul(t)),this.rs(e,s,t,wo(i,-1)).next(e=>e))})}ts(e,t){let n=new Ho(fl(e));return t.forEach((t,i)=>{hl(e,i)&&(n=n.add(i))}),n}ns(e,t,n,i){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const r="F"===e.limitType?t.last():t.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Xi(e,t,n){return Vs()<=Re.DEBUG&&qs("QueryEngine","Using full collection scan to execute query:",ul(t)),this.Ji.getDocumentsMatchingQuery(e,t,Eo.min(),n)}rs(e,t,n,i){return this.Ji.getDocumentsMatchingQuery(e,n,i).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}class Du{constructor(e,t,n,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new Bo(co),this._s=new ml(e=>Qa(e),Ya),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new yu(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function Mu(e,t,n,i){return new Du(e,t,n,i)}async function ju(e,t){const n=Qs(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let i;return n.mutationQueue.getAllMutationBatches(e).next(r=>(i=r,n.ls(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const r=[],s=[];let o=Sl();for(const e of i){r.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next(e=>({hs:e,removedBatchIds:r,addedBatchIds:s}))})})}function Fu(e){const t=Qs(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Ur.getLastRemoteSnapshotVersion(e))}function Uu(e,t,n){let i=Sl(),r=Sl();return n.forEach(e=>i=i.add(e)),t.getEntries(e,i).next(e=>{let i=_l();return n.forEach((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(r=r.add(n)),s.isNoDocument()&&s.version.isEqual(fo.min())?(t.removeEntry(n,s.readTime),i=i.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),i=i.insert(n,s)):qs("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)}),{Ps:i,Is:r}})}function zu(e,t){const n=Qs(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function Bu(e,t){const n=Qs(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let i;return n.Ur.getTargetData(e,t).next(r=>r?(i=r,Io.resolve(i)):n.Ur.allocateTargetId(e).next(r=>(i=new cu(t,r,"TargetPurposeListen",e.currentSequenceNumber),n.Ur.addTargetData(e,i).next(()=>i))))}).then(e=>{const i=n.os.get(e.targetId);return(null===i||e.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(e.targetId,e),n._s.set(t,e.targetId)),e})}async function Vu(e,t,n){const i=Qs(e),r=i.os.get(t),s=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",s,e=>i.persistence.referenceDelegate.removeTarget(e,r))}catch(e){if(!Po(e))throw e;qs("LocalStore","Failed to update sequence numbers for target ".concat(t,": ").concat(e))}i.os=i.os.remove(t),i._s.delete(r.target)}function qu(e,t,n){const i=Qs(e);let r=fo.min(),s=Sl();return i.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,n){const i=Qs(e),r=i._s.get(n);return void 0!==r?Io.resolve(i.os.get(r)):i.Ur.getTargetData(t,n)}(i,e,rl(t)).next(t=>{if(t)return r=t.lastLimboFreeSnapshotVersion,i.Ur.getMatchingKeysForTargetId(e,t.targetId).next(e=>{s=e})}).next(()=>i.ss.getDocumentsMatchingQuery(e,t,n?r:fo.min(),n?s:Sl())).next(e=>(Hu(i,dl(t),e),{documents:e,Ts:s})))}function Hu(e,t,n){let i=e.us.get(t)||fo.min();n.forEach((e,t)=>{t.readTime.compareTo(i)>0&&(i=t.readTime)}),e.us.set(t,i)}class Wu{constructor(){this.activeTargetIds=kl()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Ku{constructor(){this.so=new Wu,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,n){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Wu,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Gu{_o(e){}shutdown(){}}class Zu{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){qs("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){qs("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Qu=null;function Yu(){return null===Qu?Qu=268435456+Math.round(2147483648*Math.random()):Qu++,"0x"+Qu.toString(16)}const Ju={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Xu{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}const $u="WebChannelConnection";class eh extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=t+"://"+e.host,this.vo="projects/".concat(n,"/databases/").concat(i),this.Co="(default)"===this.databaseId.database?"project_id=".concat(n):"project_id=".concat(n,"&database_id=").concat(i)}get Fo(){return!1}Mo(e,t,n,i,r){const s=Yu(),o=this.xo(e,t.toUriEncodedString());qs("RestConnection","Sending RPC '".concat(e,"' ").concat(s,":"),o,n);const a={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(a,i,r),this.No(e,o,a,n).then(t=>(qs("RestConnection","Received RPC '".concat(e,"' ").concat(s,": "),t),t),t=>{throw Ws("RestConnection","RPC '".concat(e,"' ").concat(s," failed with error: "),t,"url: ",o,"request:",n),t})}Lo(e,t,n,i,r,s){return this.Mo(e,t,n,i,r)}Oo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+zs,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}xo(e,t){const n=Ju[e];return"".concat(this.Do,"/v1/").concat(t,":").concat(n)}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,n,i){const r=Yu();return new Promise((s,o)=>{const a=new ks;a.setWithCredentials(!0),a.listenOnce(Ns.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case As.NO_ERROR:const t=a.getResponseJson();qs($u,"XHR for RPC '".concat(e,"' ").concat(r," received:"),JSON.stringify(t)),s(t);break;case As.TIMEOUT:qs($u,"RPC '".concat(e,"' ").concat(r," timed out")),o(new Js(Ys.DEADLINE_EXCEEDED,"Request time out"));break;case As.HTTP_ERROR:const n=a.getStatus();if(qs($u,"RPC '".concat(e,"' ").concat(r," failed with status:"),n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Ys).indexOf(t)>=0?t:Ys.UNKNOWN}(t.status);o(new Js(e,t.message))}else o(new Js(Ys.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new Js(Ys.UNAVAILABLE,"Connection failed."));break;default:Gs()}}finally{qs($u,"RPC '".concat(e,"' ").concat(r," completed."))}});const l=JSON.stringify(i);qs($u,"RPC '".concat(e,"' ").concat(r," sending request:"),i),a.send(t,"POST",l,n,15)})}Bo(e,t,n){const i=Yu(),r=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=Ds(),o=Os(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Oo(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const c=r.join("");qs($u,"Creating RPC '".concat(e,"' stream ").concat(i,": ").concat(c),a);const u=s.createWebChannel(c,a);let h=!1,d=!1;const f=new Xu({Io:t=>{d?qs($u,"Not sending because RPC '".concat(e,"' stream ").concat(i," is closed:"),t):(h||(qs($u,"Opening RPC '".concat(e,"' stream ").concat(i," transport.")),u.open(),h=!0),qs($u,"RPC '".concat(e,"' stream ").concat(i," sending:"),t),u.send(t))},To:()=>u.close()}),p=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return p(u,Ps.EventType.OPEN,()=>{d||(qs($u,"RPC '".concat(e,"' stream ").concat(i," transport opened.")),f.yo())}),p(u,Ps.EventType.CLOSE,()=>{d||(d=!0,qs($u,"RPC '".concat(e,"' stream ").concat(i," transport closed")),f.So())}),p(u,Ps.EventType.ERROR,t=>{d||(d=!0,Ws($u,"RPC '".concat(e,"' stream ").concat(i," transport errored:"),t),f.So(new Js(Ys.UNAVAILABLE,"The operation could not be completed")))}),p(u,Ps.EventType.MESSAGE,t=>{var n;if(!d){const r=t.data[0];Zs(!!r);const s=r,o=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){qs($u,"RPC '".concat(e,"' stream ").concat(i," received error:"),o);const t=o.status;let n=function(e){const t=hc[e];if(void 0!==t)return pc(t)}(t),r=o.message;void 0===n&&(n=Ys.INTERNAL,r="Unknown error status: "+t+" with message "+o.message),d=!0,f.So(new Js(n,r)),u.close()}else qs($u,"RPC '".concat(e,"' stream ").concat(i," received:"),r),f.bo(r)}}),p(o,Ls.STAT_EVENT,t=>{t.stat===Rs.PROXY?qs($u,"RPC '".concat(e,"' stream ").concat(i," detected buffering proxy")):t.stat===Rs.NOPROXY&&qs($u,"RPC '".concat(e,"' stream ").concat(i," detected no buffering proxy"))}),setTimeout(()=>{f.wo()},0),f}}function th(){return"undefined"!=typeof document?document:null}function nh(e){return new Oc(e,!0)}class ih{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.ui=e,this.timerId=t,this.ko=n,this.qo=i,this.Qo=r,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-n);i>0&&qs("ExponentialBackoff","Backing off for ".concat(i," ms (base delay: ").concat(this.Ko," ms, delay with jitter: ").concat(t," ms, last attempt: ").concat(n," ms ago)")),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){null!==this.$o&&(this.$o.skipDelay(),this.$o=null)}cancel(){null!==this.$o&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}class rh{constructor(e,t,n,i,r,s,o,a){this.ui=e,this.Ho=n,this.Jo=i,this.connection=r,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new ih(e,t)}n_(){return 1===this.state||5===this.state||this.r_()}r_(){return 2===this.state||3===this.state}start(){this.e_=0,4!==this.state?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&null===this.Zo&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,4!==e?this.t_.reset():t&&t.code===Ys.RESOURCE_EXHAUSTED?(Hs(t.toString()),Hs("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===Ys.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(e=>{let[n,i]=e;this.Yo===t&&this.P_(n,i)},t=>{e(()=>{const e=new Js(Ys.UNKNOWN,"Fetching auth token failed: "+t.message);return this.I_(e)})})}P_(e,t){const n=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(e=>{n(()=>this.I_(e))}),this.stream.onMessage(e=>{n(()=>1==++this.e_?this.E_(e):this.onNext(e))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return qs("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(qs("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class sh extends rh{constructor(e,t,n,i,r,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,s),this.serializer=r}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const i=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Gs()}(t.targetChange.targetChangeType||"NO_CHANGE"),r=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(Zs(void 0===t||"string"==typeof t),Zo.fromBase64String(t||"")):(Zs(void 0===t||t instanceof Buffer||t instanceof Uint8Array),Zo.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?Ys.UNKNOWN:pc(e.code);return new Js(t,e.message||"")}(o);n=new Sc(i,r,s,a||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const r=Hc(e,i.document.name),s=Uc(i.document.updateTime),o=i.document.createTime?Uc(i.document.createTime):fo.min(),a=new Ea({mapValue:{fields:i.document.fields}}),l=Ca.newFoundDocument(r,s,o,a),c=i.targetIds||[],u=i.removedTargetIds||[];n=new Cc(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const r=Hc(e,i.document),s=i.readTime?Uc(i.readTime):fo.min(),o=Ca.newNoDocument(r,s),a=i.removedTargetIds||[];n=new Cc([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const r=Hc(e,i.document),s=i.removedTargetIds||[];n=new Cc([],s,r,null)}else{if(!("filter"in t))return Gs();{t.filter;const e=t.filter;e.targetId;const{count:i=0,unchangedNames:r}=e,s=new uc(i,r),o=e.targetId;n=new xc(o,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return fo.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?fo.min():t.readTime?Uc(t.readTime):fo.min()}(e);return this.listener.d_(t,n)}A_(e){const t={};t.database=Gc(this.serializer),t.addTarget=function(e,t){let n;const i=t.target;if(n=Ja(i)?{documents:Jc(e,i)}:{query:Xc(e,i)._t},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=jc(e,t.resumeToken);const i=Dc(e,t.expectedCount);null!==i&&(n.expectedCount=i)}else if(t.snapshotVersion.compareTo(fo.min())>0){n.readTime=Mc(e,t.snapshotVersion.toTimestamp());const i=Dc(e,t.expectedCount);null!==i&&(n.expectedCount=i)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Gs()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.a_(t)}R_(e){const t={};t.database=Gc(this.serializer),t.removeTarget=e,this.a_(t)}}class oh extends rh{constructor(e,t,n,i,r,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,s),this.serializer=r}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Zs(!!e.streamToken),this.lastStreamToken=e.streamToken,Zs(!e.writeResults||0===e.writeResults.length),this.listener.f_()}onNext(e){Zs(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=function(e,t){return e&&e.length>0?(Zs(void 0!==t),e.map(e=>function(e,t){let n=e.updateTime?Uc(e.updateTime):Uc(t);return n.isEqual(fo.min())&&(n=Uc(t)),new Wl(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=Uc(e.commitTime);return this.listener.g_(n,t)}p_(){const e={};e.database=Gc(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>Yc(this.serializer,e))};this.a_(t)}}class ah extends class{}{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new Js(Ys.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(r=>{let[s,o]=r;return this.connection.Mo(e,Bc(t,n),i,s,o)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===Ys.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Js(Ys.UNKNOWN,e.toString())})}Lo(e,t,n,i,r){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(s=>{let[o,a]=s;return this.connection.Lo(e,Bc(t,n),i,o,a,r)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===Ys.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Js(Ys.UNKNOWN,e.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class lh{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){0===this.S_&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){"Online"===this.state?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.C_("Offline")))}set(e){this.x_(),this.S_=0,"Online"===e&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.D_?(Hs(t),this.D_=!1):qs("OnlineStateTracker",t)}x_(){null!==this.b_&&(this.b_.cancel(),this.b_=null)}}class ch{constructor(e,t,n,i,r){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=r,this.k_._o(e=>{n.enqueueAndForget(async()=>{vh(this)&&(qs("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=Qs(e);t.L_.add(4),await hh(t),t.q_.set("Unknown"),t.L_.delete(4),await uh(t)}(this))})}),this.q_=new lh(n,i)}}async function uh(e){if(vh(e))for(const t of e.B_)await t(!0)}async function hh(e){for(const t of e.B_)await t(!1)}function dh(e,t){const n=Qs(e);n.N_.has(t.targetId)||(n.N_.set(t.targetId,t),_h(n)?gh(n):jh(n).r_()&&ph(n,t))}function fh(e,t){const n=Qs(e),i=jh(n);n.N_.delete(t),i.r_()&&mh(n,t),0===n.N_.size&&(i.r_()?i.o_():vh(n)&&n.q_.set("Unknown"))}function ph(e,t){if(e.Q_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(fo.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}jh(e).A_(t)}function mh(e,t){e.Q_.xe(t),jh(e).R_(t)}function gh(e){e.Q_=new kc({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>e.N_.get(t)||null,tt:()=>e.datastore.serializer.databaseId}),jh(e).start(),e.q_.v_()}function _h(e){return vh(e)&&!jh(e).n_()&&e.N_.size>0}function vh(e){return 0===Qs(e).L_.size}function yh(e){e.Q_=void 0}async function wh(e){e.q_.set("Online")}async function bh(e){e.N_.forEach((t,n)=>{ph(e,t)})}async function Eh(e,t){yh(e),_h(e)?(e.q_.M_(t),gh(e)):e.q_.set("Unknown")}async function Th(e,t,n){if(e.q_.set("Online"),t instanceof Sc&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const i of t.targetIds)e.N_.has(i)&&(await e.remoteSyncer.rejectListen(i,n),e.N_.delete(i),e.Q_.removeTarget(i))}(e,t)}catch(n){qs("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Ch(e,n)}else if(t instanceof Cc?e.Q_.Ke(t):t instanceof xc?e.Q_.He(t):e.Q_.We(t),!n.isEqual(fo.min()))try{const t=await Fu(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Q_.rt(t);return n.targetChanges.forEach((n,i)=>{if(n.resumeToken.approximateByteSize()>0){const r=e.N_.get(i);r&&e.N_.set(i,r.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const i=e.N_.get(t);if(!i)return;e.N_.set(t,i.withResumeToken(Zo.EMPTY_BYTE_STRING,i.snapshotVersion)),mh(e,t);const r=new cu(i.target,t,n,i.sequenceNumber);ph(e,r)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){qs("RemoteStore","Failed to raise snapshot:",t),await Ch(e,t)}}async function Ch(e,t,n){if(!Po(t))throw t;e.L_.add(1),await hh(e),e.q_.set("Offline"),n||(n=()=>Fu(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{qs("RemoteStore","Retrying IndexedDB access"),await n(),e.L_.delete(1),await uh(e)})}function xh(e,t){return t().catch(n=>Ch(e,n,t))}async function Sh(e){const t=Qs(e),n=Fh(t);let i=t.O_.length>0?t.O_[t.O_.length-1].batchId:-1;for(;Ih(t);)try{const e=await zu(t.localStore,i);if(null===e){0===t.O_.length&&n.o_();break}i=e.batchId,kh(t,e)}catch(e){await Ch(t,e)}Ph(t)&&Nh(t)}function Ih(e){return vh(e)&&e.O_.length<10}function kh(e,t){e.O_.push(t);const n=Fh(e);n.r_()&&n.V_&&n.m_(t.mutations)}function Ph(e){return vh(e)&&!Fh(e).n_()&&e.O_.length>0}function Nh(e){Fh(e).start()}async function Ah(e){Fh(e).p_()}async function Rh(e){const t=Fh(e);for(const n of e.O_)t.m_(n.mutations)}async function Lh(e,t,n){const i=e.O_.shift(),r=lc.from(i,t,n);await xh(e,()=>e.remoteSyncer.applySuccessfulWrite(r)),await Sh(e)}async function Oh(e,t){t&&Fh(e).V_&&await async function(e,t){if(function(e){return fc(e)&&e!==Ys.ABORTED}(t.code)){const n=e.O_.shift();Fh(e).s_(),await xh(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await Sh(e)}}(e,t),Ph(e)&&Nh(e)}async function Dh(e,t){const n=Qs(e);n.asyncQueue.verifyOperationInProgress(),qs("RemoteStore","RemoteStore received new credentials");const i=vh(n);n.L_.add(3),await hh(n),i&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.L_.delete(3),await uh(n)}async function Mh(e,t){const n=Qs(e);t?(n.L_.delete(2),await uh(n)):t||(n.L_.add(2),await hh(n),n.q_.set("Unknown"))}function jh(e){return e.K_||(e.K_=function(e,t,n){const i=Qs(e);return i.w_(),new sh(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(e.datastore,e.asyncQueue,{Eo:wh.bind(null,e),Ro:bh.bind(null,e),mo:Eh.bind(null,e),d_:Th.bind(null,e)}),e.B_.push(async t=>{t?(e.K_.s_(),_h(e)?gh(e):e.q_.set("Unknown")):(await e.K_.stop(),yh(e))})),e.K_}function Fh(e){return e.U_||(e.U_=function(e,t,n){const i=Qs(e);return i.w_(),new oh(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(e.datastore,e.asyncQueue,{Eo:()=>Promise.resolve(),Ro:Ah.bind(null,e),mo:Oh.bind(null,e),f_:Rh.bind(null,e),g_:Lh.bind(null,e)}),e.B_.push(async t=>{t?(e.U_.s_(),await Sh(e)):(await e.U_.stop(),e.O_.length>0&&(qs("RemoteStore","Stopping write stream with ".concat(e.O_.length," pending writes")),e.O_=[]))})),e.U_}class Uh{constructor(e,t,n,i,r){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=r,this.deferred=new Xs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,r){const s=Date.now()+n,o=new Uh(e,t,s,i,r);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Js(Ys.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function zh(e,t){if(Hs("AsyncQueue","".concat(t,": ").concat(e)),Po(e))return new Js(Ys.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}class Bh{constructor(e){this.comparator=e?(t,n)=>e(t,n)||vo.comparator(t.key,n.key):(e,t)=>vo.comparator(e.key,t.key),this.keyedMap=yl(),this.sortedSet=new Bo(this.comparator)}static emptySet(e){return new Bh(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Bh))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,i=n.getNext().key;if(!e.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new Bh;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Vh{constructor(){this.W_=new Bo(vo.comparator)}track(e){const t=e.doc.key,n=this.W_.get(t);n?0!==e.type&&3===n.type?this.W_=this.W_.insert(t,e):3===e.type&&1!==n.type?this.W_=this.W_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.W_=this.W_.remove(t):1===e.type&&2===n.type?this.W_=this.W_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):Gs():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,n)=>{e.push(n)}),e}}class qh{constructor(e,t,n,i,r,s,o,a,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=r,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,i,r){const s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new qh(e,t,Bh.emptySet(t),s,n,i,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ll(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}class Hh{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class Wh{constructor(){this.queries=Kh(),this.onlineState="Unknown",this.Y_=new Set}terminate(){!function(e,t){const n=Qs(e),i=n.queries;n.queries=Kh(),i.forEach((e,n)=>{for(const i of n.j_)i.onError(t)})}(this,new Js(Ys.ABORTED,"Firestore shutting down"))}}function Kh(){return new ml(e=>cl(e),ll)}async function Gh(e,t){const n=Qs(e);let i=3;const r=t.query;let s=n.queries.get(r);s?!s.H_()&&t.J_()&&(i=2):(s=new Hh,i=t.J_()?0:1);try{switch(i){case 0:s.z_=await n.onListen(r,!0);break;case 1:s.z_=await n.onListen(r,!1);break;case 2:await n.onFirstRemoteStoreListen(r)}}catch(e){const n=zh(e,"Initialization of query '".concat(ul(t.query),"' failed"));return void t.onError(n)}n.queries.set(r,s),s.j_.push(t),t.Z_(n.onlineState),s.z_&&t.X_(s.z_)&&Jh(n)}async function Zh(e,t){const n=Qs(e),i=t.query;let r=3;const s=n.queries.get(i);if(s){const e=s.j_.indexOf(t);e>=0&&(s.j_.splice(e,1),0===s.j_.length?r=t.J_()?0:1:!s.H_()&&t.J_()&&(r=2))}switch(r){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function Qh(e,t){const n=Qs(e);let i=!1;for(const r of t){const e=r.query,t=n.queries.get(e);if(t){for(const e of t.j_)e.X_(r)&&(i=!0);t.z_=r}}i&&Jh(n)}function Yh(e,t,n){const i=Qs(e),r=i.queries.get(t);if(r)for(const s of r.j_)s.onError(n);i.queries.delete(t)}function Jh(e){e.Y_.forEach(e=>{e.next()})}var Xh,$h;($h=Xh||(Xh={})).ea="default",$h.Cache="cache";class ed{constructor(e,t,n){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new qh(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache)return!0;if(!this.J_())return!0;const n="Offline"!==t;return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}oa(e){e=qh.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Xh.Cache}}class td{constructor(e){this.key=e}}class nd{constructor(e){this.key=e}}class id{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Sl(),this.mutatedKeys=Sl(),this.Aa=fl(e),this.Ra=new Bh(this.Aa)}get Va(){return this.Ta}ma(e,t){const n=t?t.fa:new Vh,i=t?t.Ra:this.Ra;let r=t?t.mutatedKeys:this.mutatedKeys,s=i,o=!1;const a="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,l="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((e,t)=>{const c=i.get(e),u=hl(this.query,t)?t:null,h=!!c&&this.mutatedKeys.has(c.key),d=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?h!==d&&(n.track({type:3,doc:u}),f=!0):this.ga(c,u)||(n.track({type:2,doc:u}),f=!0,(a&&this.Aa(u,a)>0||l&&this.Aa(u,l)<0)&&(o=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(a||l)&&(o=!0)),f&&(u?(s=s.add(u),r=d?r.add(e):r.delete(e)):(s=s.delete(e),r=r.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),r=r.delete(e.key),n.track({type:1,doc:e})}return{Ra:s,fa:n,ns:o,mutatedKeys:r}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,i){const r=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const s=e.fa.G_();s.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Gs()}};return n(e)-n(t)}(e.type,t.type)||this.Aa(e.doc,t.doc)),this.pa(n),i=null!=i&&i;const o=t&&!i?this.ya():[],a=0===this.da.size&&this.current&&!i?1:0,l=a!==this.Ea;return this.Ea=a,0!==s.length||l?{snapshot:new qh(this.query,e.Ra,r,s,e.mutatedKeys,0===a,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Vh,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(e=>this.Ta=this.Ta.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ta=this.Ta.delete(e)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Sl(),this.Ra.forEach(e=>{this.Sa(e.key)&&(this.da=this.da.add(e.key))});const t=[];return e.forEach(e=>{this.da.has(e)||t.push(new nd(e))}),this.da.forEach(n=>{e.has(n)||t.push(new td(n))}),t}ba(e){this.Ta=e.Ts,this.da=Sl();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return qh.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,0===this.Ea,this.hasCachedResults)}}class rd{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class sd{constructor(e){this.key=e,this.va=!1}}class od{constructor(e,t,n,i,r,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=s,this.Ca={},this.Fa=new ml(e=>cl(e),ll),this.Ma=new Map,this.xa=new Set,this.Oa=new Bo(vo.comparator),this.Na=new Map,this.La=new Tu,this.Ba={},this.ka=new Map,this.qa=gu.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return!0===this.Qa}}async function ad(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=kd(e);let r;const s=i.Fa.get(t);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.Da()):r=await cd(i,t,n,!0),r}async function ld(e,t){const n=kd(e);await cd(n,t,!0,!1)}async function cd(e,t,n,i){const r=await Bu(e.localStore,rl(t)),s=r.targetId,o=e.sharedClientState.addLocalQueryTarget(s,n);let a;return i&&(a=await ud(e,t,s,"current"===o,r.resumeToken)),e.isPrimaryClient&&n&&dh(e.remoteStore,r),a}async function ud(e,t,n,i,r){e.Ka=(t,n,i)=>async function(e,t,n,i){let r=t.view.ma(n);r.ns&&(r=await qu(e.localStore,t.query,!1).then(e=>{let{documents:n}=e;return t.view.ma(n,r)}));const s=i&&i.targetChanges.get(t.targetId),o=i&&null!=i.targetMismatches.get(t.targetId),a=t.view.applyChanges(r,e.isPrimaryClient,s,o);return Ed(e,t.targetId,a.wa),a.snapshot}(e,t,n,i);const s=await qu(e.localStore,t,!0),o=new id(t,s.Ts),a=o.ma(s.documents),l=Tc.createSynthesizedTargetChangeForCurrentChange(n,i&&"Offline"!==e.onlineState,r),c=o.applyChanges(a,e.isPrimaryClient,l);Ed(e,n,c.wa);const u=new rd(t,n,o);return e.Fa.set(t,u),e.Ma.has(n)?e.Ma.get(n).push(t):e.Ma.set(n,[t]),c.snapshot}async function hd(e,t,n){const i=Qs(e),r=i.Fa.get(t),s=i.Ma.get(r.targetId);if(s.length>1)return i.Ma.set(r.targetId,s.filter(e=>!ll(e,t))),void i.Fa.delete(t);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await Vu(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),n&&fh(i.remoteStore,r.targetId),wd(i,r.targetId)}).catch(So)):(wd(i,r.targetId),await Vu(i.localStore,r.targetId,!0))}async function dd(e,t){const n=Qs(e),i=n.Fa.get(t),r=n.Ma.get(i.targetId);n.isPrimaryClient&&1===r.length&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),fh(n.remoteStore,i.targetId))}async function fd(e,t){const n=Qs(e);try{const e=await function(e,t){const n=Qs(e),i=t.snapshotVersion;let r=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const s=n.cs.newChangeBuffer({trackRemovals:!0});r=n.os;const o=[];t.targetChanges.forEach((s,a)=>{const l=r.get(a);if(!l)return;o.push(n.Ur.removeMatchingKeys(e,s.removedDocuments,a).next(()=>n.Ur.addMatchingKeys(e,s.addedDocuments,a)));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?c=c.withResumeToken(Zo.EMPTY_BYTE_STRING,fo.min()).withLastLimboFreeSnapshotVersion(fo.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,i)),r=r.insert(a,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(l,c,s)&&o.push(n.Ur.updateTargetData(e,c))});let a=_l(),l=Sl();if(t.documentUpdates.forEach(i=>{t.resolvedLimboDocuments.has(i)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,i))}),o.push(Uu(e,s,t.documentUpdates).next(e=>{a=e.Ps,l=e.Is})),!i.isEqual(fo.min())){const t=n.Ur.getLastRemoteSnapshotVersion(e).next(t=>n.Ur.setTargetsMetadata(e,e.currentSequenceNumber,i));o.push(t)}return Io.waitFor(o).next(()=>s.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,a,l)).next(()=>a)}).then(e=>(n.os=r,e))}(n.localStore,t);t.targetChanges.forEach((e,t)=>{const i=n.Na.get(t);i&&(Zs(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?i.va=!0:e.modifiedDocuments.size>0?Zs(i.va):e.removedDocuments.size>0&&(Zs(i.va),i.va=!1))}),await xd(n,e,t)}catch(e){await So(e)}}function pd(e,t,n){const i=Qs(e);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const e=[];i.Fa.forEach((n,i)=>{const r=i.view.Z_(t);r.snapshot&&e.push(r.snapshot)}),function(e,t){const n=Qs(e);n.onlineState=t;let i=!1;n.queries.forEach((e,n)=>{for(const r of n.j_)r.Z_(t)&&(i=!0)}),i&&Jh(n)}(i.eventManager,t),e.length&&i.Ca.d_(e),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function md(e,t,n){const i=Qs(e);i.sharedClientState.updateQueryState(t,"rejected",n);const r=i.Na.get(t),s=r&&r.key;if(s){let e=new Bo(vo.comparator);e=e.insert(s,Ca.newNoDocument(s,fo.min()));const n=Sl().add(s),r=new Ec(fo.min(),new Map,new Bo(co),e,n);await fd(i,r),i.Oa=i.Oa.remove(s),i.Na.delete(t),Cd(i)}else await Vu(i.localStore,t,!1).then(()=>wd(i,t,n)).catch(So)}async function gd(e,t){const n=Qs(e),i=t.batch.batchId;try{const e=await function(e,t){const n=Qs(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const i=t.batch.keys(),r=n.cs.newChangeBuffer({trackRemovals:!0});return function(e,t,n,i){const r=n.batch,s=r.keys();let o=Io.resolve();return s.forEach(e=>{o=o.next(()=>i.getEntry(t,e)).next(t=>{const s=n.docVersions.get(e);Zs(null!==s),t.version.compareTo(s)<0&&(r.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),i.addEntry(t)))})}),o.next(()=>e.mutationQueue.removeMutationBatch(t,r))}(n,e,t,r).next(()=>r.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,i,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Sl();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,i))})}(n.localStore,t);yd(n,i,null),vd(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await xd(n,e)}catch(e){await So(e)}}async function _d(e,t,n){const i=Qs(e);try{const e=await function(e,t){const n=Qs(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let i;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(Zs(null!==t),i=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,i,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,i)).next(()=>n.localDocuments.getDocuments(e,i))})}(i.localStore,t);yd(i,t,n),vd(i,t),i.sharedClientState.updateMutationState(t,"rejected",n),await xd(i,e)}catch(n){await So(n)}}function vd(e,t){(e.ka.get(t)||[]).forEach(e=>{e.resolve()}),e.ka.delete(t)}function yd(e,t,n){const i=Qs(e);let r=i.Ba[i.currentUser.toKey()];if(r){const e=r.get(t);e&&(n?e.reject(n):e.resolve(),r=r.remove(t)),i.Ba[i.currentUser.toKey()]=r}}function wd(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const i of e.Ma.get(t))e.Fa.delete(i),n&&e.Ca.$a(i,n);e.Ma.delete(t),e.isPrimaryClient&&e.La.gr(t).forEach(t=>{e.La.containsKey(t)||bd(e,t)})}function bd(e,t){e.xa.delete(t.path.canonicalString());const n=e.Oa.get(t);null!==n&&(fh(e.remoteStore,n),e.Oa=e.Oa.remove(t),e.Na.delete(n),Cd(e))}function Ed(e,t,n){for(const i of n)i instanceof td?(e.La.addReference(i.key,t),Td(e,i)):i instanceof nd?(qs("SyncEngine","Document no longer in limbo: "+i.key),e.La.removeReference(i.key,t),e.La.containsKey(i.key)||bd(e,i.key)):Gs()}function Td(e,t){const n=t.key,i=n.path.canonicalString();e.Oa.get(n)||e.xa.has(i)||(qs("SyncEngine","New document in limbo: "+n),e.xa.add(i),Cd(e))}function Cd(e){for(;e.xa.size>0&&e.Oa.size<e.maxConcurrentLimboResolutions;){const t=e.xa.values().next().value;e.xa.delete(t);const n=new vo(mo.fromString(t)),i=e.qa.next();e.Na.set(i,new sd(n)),e.Oa=e.Oa.insert(n,i),dh(e.remoteStore,new cu(rl(el(n.path)),i,"TargetPurposeLimboResolution",No.oe))}}async function xd(e,t,n){const i=Qs(e),r=[],s=[],o=[];i.Fa.isEmpty()||(i.Fa.forEach((e,a)=>{o.push(i.Ka(a,t,n).then(e=>{var t;if((e||n)&&i.isPrimaryClient){const r=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(a.targetId))||void 0===t?void 0:t.current;i.sharedClientState.updateQueryState(a.targetId,r?"current":"not-current")}if(e){r.push(e);const t=Ru.Wi(a.targetId,e);s.push(t)}}))}),await Promise.all(o),i.Ca.d_(r),await async function(e,t){const n=Qs(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>Io.forEach(t,t=>Io.forEach(t.$i,i=>n.persistence.referenceDelegate.addReference(e,t.targetId,i)).next(()=>Io.forEach(t.Ui,i=>n.persistence.referenceDelegate.removeReference(e,t.targetId,i)))))}catch(e){if(!Po(e))throw e;qs("LocalStore","Failed to update sequence numbers: "+e)}for(const i of t){const e=i.targetId;if(!i.fromCache){const t=n.os.get(e),i=t.snapshotVersion,r=t.withLastLimboFreeSnapshotVersion(i);n.os=n.os.insert(e,r)}}}(i.localStore,s))}async function Sd(e,t){const n=Qs(e);if(!n.currentUser.isEqual(t)){qs("SyncEngine","User change. New user:",t.toKey());const e=await ju(n.localStore,t);n.currentUser=t,function(e,t){e.ka.forEach(e=>{e.forEach(e=>{e.reject(new Js(Ys.CANCELLED,t))})}),e.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await xd(n,e.hs)}}function Id(e,t){const n=Qs(e),i=n.Na.get(t);if(i&&i.va)return Sl().add(i.key);{let e=Sl();const i=n.Ma.get(t);if(!i)return e;for(const t of i){const i=n.Fa.get(t);e=e.unionWith(i.view.Va)}return e}}function kd(e){const t=Qs(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=fd.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Id.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=md.bind(null,t),t.Ca.d_=Qh.bind(null,t.eventManager),t.Ca.$a=Yh.bind(null,t.eventManager),t}function Pd(e){const t=Qs(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=gd.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=_d.bind(null,t),t}class Nd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=nh(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return Mu(this.persistence,new Ou,e.initialUser,this.serializer)}Ga(e){return new Pu(Au.Zr,this.serializer)}Wa(e){return new Ku}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Nd.provider={build:()=>new Nd};class Ad{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>pd(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Sd.bind(null,this.syncEngine),await Mh(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Wh}createDatastore(e){const t=nh(e.databaseInfo.databaseId),n=function(e){return new eh(e)}(e.databaseInfo);return function(e,t,n,i){return new ah(e,t,n,i)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,i,r){return new ch(e,t,n,i,r)}(this.localStore,this.datastore,e.asyncQueue,e=>pd(this.syncEngine,e,0),Zu.D()?new Zu:new Gu)}createSyncEngine(e,t){return function(e,t,n,i,r,s,o){const a=new od(e,t,n,i,r,s);return o&&(a.Qa=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=Qs(e);qs("RemoteStore","RemoteStore shutting down."),t.L_.add(5),await hh(t),t.k_.shutdown(),t.q_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}Ad.provider={build:()=>new Ad};class Rd{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Hs("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}class Ld{constructor(e,t,n,i,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=Us.UNAUTHENTICATED,this.clientId=lo.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=r,this.authCredentials.start(n,async e=>{qs("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(qs("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Xs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=zh(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Od(e,t){e.asyncQueue.verifyOperationInProgress(),qs("FirestoreClient","Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let i=n.initialUser;e.setCredentialChangeListener(async e=>{i.isEqual(e)||(await ju(t.localStore,e),i=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function Dd(e,t){e.asyncQueue.verifyOperationInProgress();const n=await Md(e);qs("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(e=>Dh(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>Dh(t.remoteStore,n)),e._onlineComponents=t}async function Md(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){qs("FirestoreClient","Using user provided OfflineComponentProvider");try{await Od(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===Ys.FAILED_PRECONDITION||e.code===Ys.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;Ws("Error using user provided cache. Falling back to memory cache: "+n),await Od(e,new Nd)}}else qs("FirestoreClient","Using default OfflineComponentProvider"),await Od(e,new Nd);return e._offlineComponents}async function jd(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(qs("FirestoreClient","Using user provided OnlineComponentProvider"),await Dd(e,e._uninitializedComponentsProvider._online)):(qs("FirestoreClient","Using default OnlineComponentProvider"),await Dd(e,new Ad))),e._onlineComponents}function Fd(e){return jd(e).then(e=>e.syncEngine)}async function Ud(e){const t=await jd(e),n=t.eventManager;return n.onListen=ad.bind(null,t.syncEngine),n.onUnlisten=hd.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=ld.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=dd.bind(null,t.syncEngine),n}function zd(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=new Xs;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,i,r){const s=new Rd({next:a=>{s.Za(),t.enqueueAndForget(()=>Zh(e,o));const l=a.docs.has(n);!l&&a.fromCache?r.reject(new Js(Ys.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&a.fromCache&&i&&"server"===i.source?r.reject(new Js(Ys.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):r.resolve(a)},error:e=>r.reject(e)}),o=new ed(el(n.path),s,{includeMetadataChanges:!0,_a:!0});return Gh(e,o)}(await Ud(e),e.asyncQueue,t,n,i)),i.promise}function Bd(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=new Xs;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,i,r){const s=new Rd({next:n=>{s.Za(),t.enqueueAndForget(()=>Zh(e,o)),n.fromCache&&"server"===i.source?r.reject(new Js(Ys.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):r.resolve(n)},error:e=>r.reject(e)}),o=new ed(n,s,{includeMetadataChanges:!0,_a:!0});return Gh(e,o)}(await Ud(e),e.asyncQueue,t,n,i)),i.promise}function Vd(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const qd=new Map;function Hd(e,t,n){if(!n)throw new Js(Ys.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function Wd(e){if(!vo.isDocumentKey(e))throw new Js(Ys.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function Kd(e){if(vo.isDocumentKey(e))throw new Js(Ys.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function Gd(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}}return"function"==typeof e?"a function":Gs()}function Zd(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Js(Ys.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Gd(e);throw new Js(Ys.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}}return e}function Qd(e,t){if(t<=0)throw new Js(Ys.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}class Yd{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Js(Ys.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Js(Ys.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,i){if(!0===t&&!0===i)throw new Js(Ys.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Vd(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Js(Ys.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new Js(Ys.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new Js(Ys.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Jd{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Yd({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Js(Ys.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Js(Ys.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Yd(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new eo;switch(e.type){case"firstParty":return new ro(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Js(Ys.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=qd.get(e);t&&(qs("ComponentProvider","Removing Datastore"),qd.delete(e),t.terminate())}(this),Promise.resolve()}}class Xd{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Xd(this.firestore,e,this._query)}}class $d{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ef(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new $d(this.firestore,e,this._key)}}class ef extends Xd{constructor(e,t,n){super(e,t,el(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new $d(this.firestore,null,new vo(e))}withConverter(e){return new ef(this.firestore,e,this._path)}}function tf(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];if(e=Se(e),Hd("collection","path",t),e instanceof Jd){const n=mo.fromString(t,...i);return Kd(n),new ef(e,null,n)}{if(!(e instanceof $d||e instanceof ef))throw new Js(Ys.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(mo.fromString(t,...i));return Kd(n),new ef(e.firestore,null,n)}}function nf(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];if(e=Se(e),1===arguments.length&&(t=lo.newId()),Hd("doc","path",t),e instanceof Jd){const n=mo.fromString(t,...i);return Wd(n),new $d(e,null,new vo(n))}{if(!(e instanceof $d||e instanceof ef))throw new Js(Ys.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(mo.fromString(t,...i));return Wd(n),new $d(e.firestore,e instanceof ef?e.converter:null,new vo(n))}}class rf{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new ih(this,"async_queue_retry"),this.Vu=()=>{const e=th();e&&qs("AsyncQueue","Visibility state changed to "+e.visibilityState),this.t_.jo()},this.mu=e;const t=th();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=th();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new Xs;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(0!==this.Pu.length){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(aC){if(!Po(aC))throw aC;qs("AsyncQueue","Operation failed with retryable error: "+aC)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(e=>{this.Eu=e,this.du=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw Hs("INTERNAL UNHANDLED ERROR: ",t),e}).then(e=>(this.du=!1,e))));return this.mu=t,t}enqueueAfterDelay(e,t,n){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const i=Uh.createAndSchedule(this,e,t,n,e=>this.yu(e));return this.Tu.push(i),i}fu(){this.Eu&&Gs()}verifyOperationInProgress(){}async wu(){let e;do{e=this.mu,await e}while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function sf(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const i of t)if(i in n&&"function"==typeof n[i])return!0;return!1}(e,["next","error","complete"])}class of extends Jd{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new rf,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new rf(e),this._firestoreClient=void 0,await e}}}function af(e){if(e._terminated)throw new Js(Ys.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||lf(e),e._firestoreClient}function lf(e){var t,n,i;const r=e._freezeSettings(),s=function(e,t,n,i){return new na(e,t,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,Vd(i.experimentalLongPollingOptions),i.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,r);e._componentsProvider||(null===(n=r.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(i=r.localCache)||void 0===i?void 0:i._onlineComponentProvider)&&(e._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),e._firestoreClient=new Ld(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}class cf{constructor(e){this._byteString=e}static fromBase64String(e){try{return new cf(Zo.fromBase64String(e))}catch(e){throw new Js(Ys.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new cf(Zo.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class uf{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let i=0;i<t.length;++i)if(0===t[i].length)throw new Js(Ys.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new _o(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class hf{constructor(e){this._methodName=e}}class df{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Js(Ys.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Js(Ys.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return co(this._lat,e._lat)||co(this._long,e._long)}}class ff{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}}const pf=/^__.*__$/;class mf{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new tc(e,this.data,this.fieldMask,t,this.fieldTransforms):new ec(e,this.data,t,this.fieldTransforms)}}class gf{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new tc(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function _f(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Gs()}}class vf{constructor(e,t,n,i,r,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===r&&this.vu(),this.fieldTransforms=r||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new vf(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.Fu({path:n,xu:!1});return i.Ou(e),i}Nu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.Fu({path:n,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return jf(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(0===e.length)throw this.Bu("Document fields must not be empty");if(_f(this.Cu)&&pf.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class yf{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||nh(e)}Qu(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new vf({Cu:e,methodName:t,qu:n,path:_o.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function wf(e){const t=e._freezeSettings(),n=nh(e._databaseId);return new yf(e._databaseId,!!t.ignoreUndefinedProperties,n)}function bf(e,t,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const o=e.Qu(s.merge||s.mergeFields?2:0,t,n,r);Lf("Data must be an object, but it was:",o,i);const a=Af(i,o);let l,c;if(s.merge)l=new Ko(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const i of s.mergeFields){const r=Of(t,i,n);if(!o.contains(r))throw new Js(Ys.INVALID_ARGUMENT,"Field '".concat(r,"' is specified in your field mask but missing from your input data."));Ff(e,r)||e.push(r)}l=new Ko(e),c=o.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,c=o.fieldTransforms;return new mf(new Ea(a),l,c)}class Ef extends hf{_toFieldTransform(e){if(2!==e.Cu)throw 1===e.Cu?e.Bu("".concat(this._methodName,"() can only appear at the top level of your update data")):e.Bu("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ef}}function Tf(e,t,n){return new vf({Cu:3,qu:t.settings.qu,methodName:e._methodName,xu:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class Cf extends hf{_toFieldTransform(e){return new Hl(e.path,new Ml)}isEqual(e){return e instanceof Cf}}class xf extends hf{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=Tf(this,e,!0),n=this.Ku.map(e=>Nf(e,t)),i=new jl(n);return new Hl(e.path,i)}isEqual(e){return e instanceof xf&&me(this.Ku,e.Ku)}}class Sf extends hf{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=Tf(this,e,!0),n=this.Ku.map(e=>Nf(e,t)),i=new Ul(n);return new Hl(e.path,i)}isEqual(e){return e instanceof Sf&&me(this.Ku,e.Ku)}}function If(e,t,n,i){const r=e.Qu(1,t,n);Lf("Data must be an object, but it was:",r,i);const s=[],o=Ea.empty();Uo(i,(e,i)=>{const a=Mf(t,e,n);i=Se(i);const l=r.Nu(a);if(i instanceof Ef)s.push(a);else{const e=Nf(i,l);null!=e&&(s.push(a),o.set(a,e))}});const a=new Ko(s);return new gf(o,a,r.fieldTransforms)}function kf(e,t,n,i,r,s){const o=e.Qu(1,t,n),a=[Of(t,i,n)],l=[r];if(s.length%2!=0)throw new Js(Ys.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(let d=0;d<s.length;d+=2)a.push(Of(t,s[d])),l.push(s[d+1]);const c=[],u=Ea.empty();for(let d=a.length-1;d>=0;--d)if(!Ff(c,a[d])){const e=a[d];let t=l[d];t=Se(t);const n=o.Nu(e);if(t instanceof Ef)c.push(e);else{const i=Nf(t,n);null!=i&&(c.push(e),u.set(e,i))}}const h=new Ko(c);return new gf(u,h,o.fieldTransforms)}function Pf(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Nf(n,e.Qu(i?4:3,t))}function Nf(e,t){if(Rf(e=Se(e)))return Lf("Unsupported field value:",t,e),Af(e,t);if(e instanceof hf)return function(e,t){if(!_f(t.Cu))throw t.Bu("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.Bu("".concat(e._methodName,"() is not currently supported inside arrays"));const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.xu&&4!==t.Cu)throw t.Bu("Nested arrays are not supported");return function(e,t){const n=[];let i=0;for(const r of e){let e=Nf(r,t.Lu(i));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),i++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=Se(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Al(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=ho.fromDate(e);return{timestampValue:Mc(t.serializer,n)}}if(e instanceof ho){const n=new ho(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Mc(t.serializer,n)}}if(e instanceof df)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof cf)return{bytesValue:jc(t.serializer,e._byteString)};if(e instanceof $d){const n=t.databaseId,i=e.firestore._databaseId;if(!i.isEqual(n))throw t.Bu("Document reference is for database ".concat(i.projectId,"/").concat(i.database," but should be for database ").concat(n.projectId,"/").concat(n.database));return{referenceValue:zc(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof ff)return function(e,t){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw t.Bu("VectorValues must only contain numeric values.");return Pl(t.serializer,e)})}}}}}}(e,t);throw t.Bu("Unsupported field value: ".concat(Gd(e)))}(e,t)}function Af(e,t){const n={};return zo(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Uo(e,(e,i)=>{const r=Nf(i,t.Mu(e));null!=r&&(n[e]=r)}),{mapValue:{fields:n}}}function Rf(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof ho||e instanceof df||e instanceof cf||e instanceof $d||e instanceof hf||e instanceof ff)}function Lf(e,t,n){if(!Rf(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const i=Gd(n);throw"an object"===i?t.Bu(e+" a custom object"):t.Bu(e+" "+i)}}function Of(e,t,n){if((t=Se(t))instanceof uf)return t._internalPath;if("string"==typeof t)return Mf(e,t);throw jf("Field path arguments must be of type string or ",e,!1,void 0,n)}const Df=new RegExp("[~\\*/\\[\\]]");function Mf(e,t,n){if(t.search(Df)>=0)throw jf("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return new uf(...t.split("."))._internalPath}catch(i){throw jf("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function jf(e,t,n,i,r){const s=i&&!i.isEmpty(),o=void 0!==r;let a="Function ".concat(t,"() called with invalid data");n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=" in field ".concat(i)),o&&(l+=" in document ".concat(r)),l+=")"),new Js(Ys.INVALID_ARGUMENT,a+e+l)}function Ff(e,t){return e.some(e=>e.isEqual(t))}class Uf{constructor(e,t,n,i,r){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new $d(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new zf(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Bf("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class zf extends Uf{data(){return super.data()}}function Bf(e,t){return"string"==typeof t?Mf(e,t):t instanceof uf?t._internalPath:t._delegate._internalPath}function Vf(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Js(Ys.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class qf{}class Hf extends qf{}function Wf(e,t){let n=[];for(var i=arguments.length,r=new Array(i>2?i-2:0),s=2;s<i;s++)r[s-2]=arguments[s];t instanceof qf&&n.push(t),n=n.concat(r),function(e){const t=e.filter(e=>e instanceof Zf).length,n=e.filter(e=>e instanceof Kf).length;if(t>1||t>0&&n>0)throw new Js(Ys.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const o of n)e=o._apply(e);return e}class Kf extends Hf{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Kf(e,t,n)}_apply(e){const t=this._parse(e);return np(e._query,t),new Xd(e.firestore,e.converter,ol(e._query,t))}_parse(e){const t=wf(e.firestore),n=function(e,t,n,i,r,s,o){let a;if(r.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new Js(Ys.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(s,"' queries on documentId()."));if("in"===s||"not-in"===s){tp(o,s);const t=[];for(const n of o)t.push(ep(i,e,n));a={arrayValue:{values:t}}}else a=ep(i,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||tp(o,s),a=Pf(n,t,o,"in"===s||"not-in"===s);return Aa.create(r,s,a)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}function Gf(e,t,n){const i=t,r=Bf("where",e);return Kf._create(r,i,n)}class Zf extends qf{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Zf(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:Ra.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const i=t.getFlattenedFilters();for(const r of i)np(n,r),n=ol(n,r)}(e._query,t),new Xd(e.firestore,e.converter,ol(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}function Qf(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.forEach(e=>ip("or",e)),Zf._create("or",t)}class Yf extends Hf{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Yf(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new Js(Ys.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Js(Ys.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ka(t,n)}(e._query,this._field,this._direction);return new Xd(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new Xa(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function Jf(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=Bf("orderBy",e);return Yf._create(n,t)}class Xf extends Hf{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new Xf(e,t,n)}_apply(e){return new Xd(e.firestore,e.converter,al(e._query,this._limit,this._limitType))}}function $f(e){return Qd("limit",e),Xf._create("limit",e,"F")}function ep(e,t,n){if("string"==typeof(n=Se(n))){if(""===n)throw new Js(Ys.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!nl(t)&&-1!==n.indexOf("/"))throw new Js(Ys.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));const i=t.path.child(mo.fromString(n));if(!vo.isDocumentKey(i))throw new Js(Ys.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(i,"' is not because it has an odd number of segments (").concat(i.length,")."));return fa(e,new vo(i))}if(n instanceof $d)return fa(e,n._key);throw new Js(Ys.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(Gd(n),"."))}function tp(e,t){if(!Array.isArray(e)||0===e.length)throw new Js(Ys.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function np(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new Js(Ys.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new Js(Ys.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(n.toString(),"' filters."))}function ip(e,t){if(!(t instanceof Kf||t instanceof Zf))throw new Js(Ys.INVALID_ARGUMENT,"Function ".concat(e,"() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'."))}class rp{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(sa(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Jo(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Xo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Gs()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return Uo(e,(e,i)=>{n[e]=this.convertValue(i,t)}),n}convertVectorValue(e){var t,n,i;const r=null===(i=null===(n=null===(t=e.fields)||void 0===t?void 0:t.value.arrayValue)||void 0===n?void 0:n.values)||void 0===i?void 0:i.map(e=>Jo(e.doubleValue));return new ff(r)}convertGeoPoint(e){return new df(Jo(e.latitude),Jo(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=ea(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(ta(e));default:return null}}convertTimestamp(e){const t=Yo(e);return new ho(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=mo.fromString(e);Zs(lu(n));const i=new ia(n.get(1),n.get(3)),r=new vo(n.popFirst(5));return i.isEqual(t)||Hs("Document ".concat(r," contains a document reference within a different database (").concat(i.projectId,"/").concat(i.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),r}}function sp(e,t,n){let i;return i=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,i}class op{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ap extends Uf{constructor(e,t,n,i,r,s){super(e,t,n,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=r}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new lp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(Bf("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class lp extends ap{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class cp{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new op(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new lp(this._firestore,this._userDataWriter,n.key,n,new op(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Js(Ys.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const i=new lp(e._firestore,e._userDataWriter,n.doc.key,n.doc,new op(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:i,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const i=new lp(e._firestore,e._userDataWriter,t.doc.key,t.doc,new op(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let r=-1,s=-1;return 0!==t.type&&(r=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:up(t.type),doc:i,oldIndex:r,newIndex:s}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function up(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Gs()}}function hp(e){e=Zd(e,$d);const t=Zd(e.firestore,of);return zd(af(t),e._key).then(n=>yp(t,e,n))}class dp extends rp{constructor(e){super(),this.firestore=e}convertBytes(e){return new cf(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new $d(this.firestore,null,t)}}function fp(e){e=Zd(e,Xd);const t=Zd(e.firestore,of),n=af(t),i=new dp(t);return Vf(e._query),Bd(n,e._query).then(n=>new cp(t,i,e,n))}function pp(e,t,n){e=Zd(e,$d);const i=Zd(e.firestore,of),r=wf(i);let s;for(var o=arguments.length,a=new Array(o>3?o-3:0),l=3;l<o;l++)a[l-3]=arguments[l];return s="string"==typeof(t=Se(t))||t instanceof uf?kf(r,"updateDoc",e._key,t,n,a):If(r,"updateDoc",e._key,t),vp(i,[s.toMutation(e._key,Kl.exists(!0))])}function mp(e){return vp(Zd(e.firestore,of),[new sc(e._key,Kl.none())])}function gp(e,t){const n=Zd(e.firestore,of),i=nf(e),r=sp(e.converter,t);return vp(n,[bf(wf(e.firestore),"addDoc",i._key,r,null!==e.converter,{}).toMutation(i._key,Kl.exists(!1))]).then(()=>i)}function _p(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r,s,o;e=Se(e);let a={includeMetadataChanges:!1,source:"default"},l=0;"object"!=typeof n[l]||sf(n[l])||(a=n[l],l++);const c={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(sf(n[l])){const e=n[l];n[l]=null===(r=e.next)||void 0===r?void 0:r.bind(e),n[l+1]=null===(s=e.error)||void 0===s?void 0:s.bind(e),n[l+2]=null===(o=e.complete)||void 0===o?void 0:o.bind(e)}let u,h,d;if(e instanceof $d)h=Zd(e.firestore,of),d=el(e._key.path),u={next:t=>{n[l]&&n[l](yp(h,e,t))},error:n[l+1],complete:n[l+2]};else{const t=Zd(e,Xd);h=Zd(t.firestore,of),d=t._query;const i=new dp(h);u={next:e=>{n[l]&&n[l](new cp(h,i,t,e))},error:n[l+1],complete:n[l+2]},Vf(e._query)}return function(e,t,n,i){const r=new Rd(i),s=new ed(t,r,n);return e.asyncQueue.enqueueAndForget(async()=>Gh(await Ud(e),s)),()=>{r.Za(),e.asyncQueue.enqueueAndForget(async()=>Zh(await Ud(e),s))}}(af(h),d,c,u)}function vp(e,t){return function(e,t){const n=new Xs;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){const i=Pd(e);try{const e=await function(e,t){const n=Qs(e),i=ho.now(),r=t.reduce((e,t)=>e.add(t.key),Sl());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let a=_l(),l=Sl();return n.cs.getEntries(e,r).next(e=>{a=e,a.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,a)).next(r=>{s=r;const o=[];for(const e of t){const t=Xl(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new tc(e.key,t,Ta(t.value.mapValue),Kl.exists(!0)))}return n.mutationQueue.addMutationBatch(e,i,o,t)}).next(t=>{o=t;const i=t.applyToLocalDocumentSet(s,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,i)})}).then(()=>({batchId:o.batchId,changes:wl(s)}))}(i.localStore,t);i.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let i=e.Ba[e.currentUser.toKey()];i||(i=new Bo(co)),i=i.insert(t,n),e.Ba[e.currentUser.toKey()]=i}(i,e.batchId,n),await xd(i,e.changes),await Sh(i.remoteStore)}catch(e){const t=zh(e,"Failed to persist write");n.reject(t)}}(await Fd(e),t,n)),n.promise}(af(e),t)}function yp(e,t,n){const i=n.docs.get(t._key),r=new dp(e);return new ap(e,r,t._key,i,new op(n.hasPendingWrites,n.fromCache),t.converter)}class wp{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=wf(e)}set(e,t,n){this._verifyNotCommitted();const i=bp(e,this._firestore),r=sp(i.converter,t,n),s=bf(this._dataReader,"WriteBatch.set",i._key,r,null!==i.converter,n);return this._mutations.push(s.toMutation(i._key,Kl.none())),this}update(e,t,n){this._verifyNotCommitted();const i=bp(e,this._firestore);let r;for(var s=arguments.length,o=new Array(s>3?s-3:0),a=3;a<s;a++)o[a-3]=arguments[a];return r="string"==typeof(t=Se(t))||t instanceof uf?kf(this._dataReader,"WriteBatch.update",i._key,t,n,o):If(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(r.toMutation(i._key,Kl.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=bp(e,this._firestore);return this._mutations=this._mutations.concat(new sc(t._key,Kl.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Js(Ys.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function bp(e,t){if((e=Se(e)).firestore!==t)throw new Js(Ys.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function Ep(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new xf("arrayUnion",t)}function Tp(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Sf("arrayRemove",t)}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){zs=e}(Gt),Vt(new Ie("firestore",(e,n)=>{let{instanceIdentifier:i,options:r}=n;const s=e.getProvider("app").getImmediate(),o=new of(new no(e.getProvider("auth-internal")),new oo(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Js(Ys.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ia(e.options.projectId,t)}(s,i),s);return r=Object.assign({useFetchStreams:t},r),o._setSettings(r),o},"PUBLIC").setMultipleInstances(!0)),Yt(Fs,"4.7.3",e),Yt(Fs,"4.7.3","esm2017")}();Yt("firebase","10.14.1","app");const Cp="firebasestorage.googleapis.com",xp="storageBucket";class Sp extends se{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(Pp(e),"Firebase Storage: ".concat(t," (").concat(Pp(e),")")),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Sp.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Pp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message="".concat(this._baseMessage,"\n").concat(this.customData.serverResponse):this.message=this._baseMessage}}var Ip,kp;function Pp(e){return"storage/"+e}function Np(){return new Sp(Ip.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function Ap(){return new Sp(Ip.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Rp(){return new Sp(Ip.CANCELED,"User canceled the upload/download.")}function Lp(){return new Sp(Ip.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Op(e){return new Sp(Ip.INVALID_ARGUMENT,e)}function Dp(){return new Sp(Ip.APP_DELETED,"The Firebase app was deleted.")}function Mp(e,t){return new Sp(Ip.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function jp(e){throw new Sp(Ip.INTERNAL_ERROR,"Internal error: "+e)}!function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(Ip||(Ip={}));class Fp{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=Fp.makeFromUrl(e,t)}catch(aC){return new Fp(e,"")}if(""===n.path)return n;throw i=e,new Sp(Ip.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+i+"'.");var i}static makeFromUrl(e,t){let n=null;const i="([A-Za-z0-9.\\-_]+)";const r=new RegExp("^gs://"+i+"(/(.*))?$","i");function s(e){e.path_=decodeURIComponent(e.path)}const o=t.replace(/[.]/g,"\\."),a=[{regex:r,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp("^https?://".concat(o,"/").concat("v[A-Za-z0-9_]+","/b/").concat(i,"/o").concat("(/([^?#]*).*)?$"),"i"),indices:{bucket:1,path:3},postModify:s},{regex:new RegExp("^https?://".concat(t===Cp?"(?:storage.googleapis.com|storage.cloud.google.com)":t,"/").concat(i,"/").concat("([^?#]*)"),"i"),indices:{bucket:1,path:2},postModify:s}];for(let l=0;l<a.length;l++){const t=a[l],i=t.regex.exec(e);if(i){const e=i[t.indices.bucket];let r=i[t.indices.path];r||(r=""),n=new Fp(e,r),t.postModify(n);break}}if(null==n)throw function(e){return new Sp(Ip.INVALID_URL,"Invalid URL '"+e+"'.")}(e);return n}}class Up{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(){}}function zp(e){return"string"===typeof e||e instanceof String}function Bp(e){return Vp()&&e instanceof Blob}function Vp(){return"undefined"!==typeof Blob}function qp(e,t,n,i){if(i<t)throw Op("Invalid value for '".concat(e,"'. Expected ").concat(t," or greater."));if(i>n)throw Op("Invalid value for '".concat(e,"'. Expected ").concat(n," or less."))}function Hp(e,t,n){let i=t;return null==n&&(i="https://".concat(t)),"".concat(n,"://").concat(i,"/v0").concat(e)}function Wp(e){const t=encodeURIComponent;let n="?";for(const i in e)if(e.hasOwnProperty(i)){n=n+(t(i)+"="+t(e[i]))+"&"}return n=n.slice(0,-1),n}function Kp(e,t){const n=e>=500&&e<600,i=-1!==[408,429].indexOf(e),r=-1!==t.indexOf(e);return n||i||r}!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(kp||(kp={}));class Gp{constructor(e,t,n,i,r,s,o,a,l,c,u){let h=!(arguments.length>11&&void 0!==arguments[11])||arguments[11];this.url_=e,this.method_=t,this.headers_=n,this.body_=i,this.successCodes_=r,this.additionalRetryCodes_=s,this.callback_=o,this.errorCallback_=a,this.timeout_=l,this.progressCallback_=c,this.connectionFactory_=u,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()})}start_(){const e=(e,t)=>{if(t)return void e(!1,new Zp(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const i=e=>{const t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&n.addUploadProgressListener(i),n.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(i),this.pendingConnection_=null;const t=n.getErrorCode()===kp.NO_ERROR,r=n.getStatus();if(!t||Kp(r,this.additionalRetryCodes_)&&this.retry){const t=n.getErrorCode()===kp.ABORT;return void e(!1,new Zp(!1,null,t))}const s=-1!==this.successCodes_.indexOf(r);e(!0,new Zp(s,n))})},t=(e,t)=>{const n=this.resolve_,i=this.reject_,r=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(r,r.getResponse());!function(e){return void 0!==e}(e)?n():n(e)}catch(aC){i(aC)}else if(null!==r){const e=Np();e.serverResponse=r.getErrorText(),this.errorCallback_?i(this.errorCallback_(r,e)):i(e)}else if(t.canceled){i(this.appDelete_?Dp():Rp())}else{i(Ap())}};this.canceled_?t(0,new Zp(!1,null,!0)):this.backoffId_=function(e,t,n){let i=1,r=null,s=null,o=!1,a=0;function l(){return 2===a}let c=!1;function u(){if(!c){c=!0;for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];t.apply(null,n)}}function h(t){r=setTimeout(()=>{r=null,e(f,l())},t)}function d(){s&&clearTimeout(s)}function f(e){if(c)return void d();for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(e)return d(),void u.call(null,e,...n);if(l()||o)return d(),void u.call(null,e,...n);let s;i<64&&(i*=2),1===a?(a=2,s=0):s=1e3*(i+Math.random()),h(s)}let p=!1;function m(e){p||(p=!0,d(),c||(null!==r?(e||(a=2),clearTimeout(r),h(0)):e||(a=1)))}return h(0),s=setTimeout(()=>{o=!0,m(!0)},n),m}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class Zp{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function Qp(){return"undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function Yp(){const e=Qp();for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];if(void 0!==e){const t=new e;for(let e=0;e<n.length;e++)t.append(n[e]);return t.getBlob()}if(Vp())return new Blob(n);throw new Sp(Ip.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}function Jp(e){if("undefined"===typeof atob)throw t="base-64",new Sp(Ip.UNSUPPORTED_ENVIRONMENT,"".concat(t," is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information."));var t;return atob(e)}const Xp="raw",$p="base64",em="base64url",tm="data_url";class nm{constructor(e,t){this.data=e,this.contentType=t||null}}function im(e,t){switch(e){case Xp:return new nm(rm(t));case $p:case em:return new nm(sm(e,t));case tm:return new nm(function(e){const t=new om(e);return t.base64?sm($p,t.rest):function(e){let t;try{t=decodeURIComponent(e)}catch(aC){throw Mp(tm,"Malformed data URL.")}return rm(t)}(t.rest)}(t),new om(t).contentType)}throw Np()}function rm(e){const t=[];for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);if(i<=127)t.push(i);else if(i<=2047)t.push(192|i>>6,128|63&i);else if(55296===(64512&i)){if(n<e.length-1&&56320===(64512&e.charCodeAt(n+1))){i=65536|(1023&i)<<10|1023&e.charCodeAt(++n),t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i)}else t.push(239,191,189)}else 56320===(64512&i)?t.push(239,191,189):t.push(224|i>>12,128|i>>6&63,128|63&i)}return new Uint8Array(t)}function sm(e,t){switch(e){case $p:{const n=-1!==t.indexOf("-"),i=-1!==t.indexOf("_");if(n||i){throw Mp(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?")}break}case em:{const n=-1!==t.indexOf("+"),i=-1!==t.indexOf("/");if(n||i){throw Mp(e,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?")}t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=Jp(t)}catch(aC){if(aC.message.includes("polyfill"))throw aC;throw Mp(e,"Invalid character found")}const i=new Uint8Array(n.length);for(let r=0;r<n.length;r++)i[r]=n.charCodeAt(r);return i}class om{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw Mp(tm,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;null!=n&&(this.base64=function(e,t){if(!(e.length>=t.length))return!1;return e.substring(e.length-t.length)===t}(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}class am{constructor(e,t){let n=0,i="";Bp(e)?(this.data_=e,n=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(Bp(this.data_)){const n=function(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}(this.data_,e,t);return null===n?null:new am(n)}{const n=new Uint8Array(this.data_.buffer,e,t-e);return new am(n,!0)}}static getBlob(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(Vp()){const e=t.map(e=>e instanceof am?e.data_:e);return new am(Yp.apply(null,e))}{const e=t.map(e=>zp(e)?im(Xp,e).data:e.data_);let n=0;e.forEach(e=>{n+=e.byteLength});const i=new Uint8Array(n);let r=0;return e.forEach(e=>{for(let t=0;t<e.length;t++)i[r++]=e[t]}),new am(i,!0)}}uploadData(){return this.data_}}function lm(e){let t;try{t=JSON.parse(e)}catch(aC){return null}return function(e){return"object"===typeof e&&!Array.isArray(e)}(t)?t:null}function cm(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function um(e,t){return t}class hm{constructor(e,t,n,i){this.server=e,this.local=t||e,this.writable=!!n,this.xform=i||um}}let dm=null;function fm(){if(dm)return dm;const e=[];e.push(new hm("bucket")),e.push(new hm("generation")),e.push(new hm("metageneration")),e.push(new hm("name","fullPath",!0));const t=new hm("name");t.xform=function(e,t){return function(e){return!zp(e)||e.length<2?e:cm(e)}(t)},e.push(t);const n=new hm("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new hm("timeCreated")),e.push(new hm("updated")),e.push(new hm("md5Hash",null,!0)),e.push(new hm("cacheControl",null,!0)),e.push(new hm("contentDisposition",null,!0)),e.push(new hm("contentEncoding",null,!0)),e.push(new hm("contentLanguage",null,!0)),e.push(new hm("contentType",null,!0)),e.push(new hm("metadata","customMetadata",!0)),dm=e,dm}function pm(e,t,n){const i={type:"file"},r=n.length;for(let s=0;s<r;s++){const e=n[s];i[e.local]=e.xform(i,t[e.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){const n=e.bucket,i=e.fullPath,r=new Fp(n,i);return t._makeStorageReference(r)}})}(i,e),i}function mm(e,t,n){const i=lm(t);if(null===i)return null;return pm(e,i,n)}function gm(e,t){const n={},i=t.length;for(let r=0;r<i;r++){const i=t[r];i.writable&&(n[i.server]=e[i.local])}return JSON.stringify(n)}class _m{constructor(e,t,n,i){this.url=e,this.method=t,this.handler=n,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function vm(e){if(!e)throw Np()}function ym(e,t){return function(n,i){const r=mm(e,i,t);return vm(null!==r),r}}function wm(e,t){return function(n,i){const r=mm(e,i,t);return vm(null!==r),function(e,t,n,i){const r=lm(t);if(null===r)return null;if(!zp(r.downloadTokens))return null;const s=r.downloadTokens;if(0===s.length)return null;const o=encodeURIComponent;return s.split(",").map(t=>{const r=e.bucket,s=e.fullPath;return Hp("/b/"+o(r)+"/o/"+o(s),n,i)+Wp({alt:"media",token:t})})[0]}(r,i,e.host,e._protocol)}}function bm(e){return function(t,n){let i;var r,s;return 401===t.getStatus()?i=t.getErrorText().includes("Firebase App Check token is invalid")?new Sp(Ip.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project."):new Sp(Ip.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(s=e.bucket,i=new Sp(Ip.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===t.getStatus()?(r=e.path,i=new Sp(Ip.UNAUTHORIZED,"User does not have permission to access '"+r+"'.")):i=n,i.status=t.getStatus(),i.serverResponse=n.serverResponse,i}}function Em(e){const t=bm(e);return function(n,i){let r=t(n,i);var s;return 404===n.getStatus()&&(s=e.path,r=new Sp(Ip.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")),r.serverResponse=i.serverResponse,r}}function Tm(e,t,n){const i=Object.assign({},n);return i.fullPath=e.path,i.size=t.size(),i.contentType||(i.contentType=function(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}(null,t)),i}function Cm(e,t,n,i,r){const s=t.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};const a=function(){let e="";for(let t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();o["Content-Type"]="multipart/related; boundary="+a;const l=Tm(t,i,r),c="--"+a+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+gm(l,n)+"\r\n--"+a+"\r\nContent-Type: "+l.contentType+"\r\n\r\n",u="\r\n--"+a+"--",h=am.getBlob(c,i,u);if(null===h)throw Lp();const d={name:l.fullPath},f=Hp(s,e.host,e._protocol),p=e.maxUploadRetryTime,m=new _m(f,"POST",ym(e,n),p);return m.urlParams=d,m.headers=o,m.body=h.uploadData(),m.errorHandler=bm(t),m}class xm{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=kp.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=kp.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=kp.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,n,i){if(this.sent_)throw jp("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==i)for(const r in i)i.hasOwnProperty(r)&&this.xhr_.setRequestHeader(r,i[r].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw jp("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw jp("cannot .getStatus() before sending");try{return this.xhr_.status}catch(aC){return-1}}getResponse(){if(!this.sent_)throw jp("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw jp("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class Sm extends xm{initXhr(){this.xhr_.responseType="text"}}function Im(){return new Sm}class km{constructor(e,t){this._service=e,this._location=t instanceof Fp?t:Fp.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new km(e,t)}get root(){const e=new Fp(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return cm(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new Fp(this._location.bucket,e);return new km(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function(e){return new Sp(Ip.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function Pm(e,t,n){e._throwIfRoot("uploadBytes");const i=Cm(e.storage,e._location,fm(),new am(t,!0),n);return e.storage.makeRequestWithTokens(i,Im).then(t=>({metadata:t,ref:e}))}function Nm(e){e._throwIfRoot("getDownloadURL");const t=function(e,t,n){const i=Hp(t.fullServerUrl(),e.host,e._protocol),r=e.maxOperationRetryTime,s=new _m(i,"GET",wm(e,n),r);return s.errorHandler=Em(t),s}(e.storage,e._location,fm());return e.storage.makeRequestWithTokens(t,Im).then(e=>{if(null===e)throw new Sp(Ip.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return e})}function Am(e){e._throwIfRoot("deleteObject");const t=function(e,t){const n=Hp(t.fullServerUrl(),e.host,e._protocol),i=e.maxOperationRetryTime,r=new _m(n,"DELETE",function(e,t){},i);return r.successCodes=[200,204],r.errorHandler=Em(t),r}(e.storage,e._location);return e.storage.makeRequestWithTokens(t,Im)}function Rm(e,t){const n=function(e,t){const n=t.split("/").filter(e=>e.length>0).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),i=new Fp(e._location.bucket,n);return new km(e.storage,i)}function Lm(e,t){if(e instanceof Mm){const n=e;if(null==n._bucket)throw new Sp(Ip.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+xp+"' property when initializing the app?");const i=new km(n,n._bucket);return null!=t?Lm(i,t):i}return void 0!==t?Rm(e,t):e}function Om(e,t){if(t&&/^[A-Za-z]+:\/\//.test(t)){if(e instanceof Mm)return new km(e,t);throw Op("To use ref(service, url), the first argument must be a Storage instance.")}return Lm(e,t)}function Dm(e,t){const n=null===t||void 0===t?void 0:t[xp];return null==n?null:Fp.makeFromBucketSpec(n,e)}class Mm{constructor(e,t,n,i,r){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=i,this._firebaseVersion=r,this._bucket=null,this._host=Cp,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?Fp.makeFromBucketSpec(i,this._host):Dm(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=Fp.makeFromBucketSpec(this._url,e):this._bucket=Dm(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){qp("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){qp("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});if(e){return(await e.getToken()).token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new km(this,e)}_makeRequest(e,t,n,i){let r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(this._deleted)return new Up(Dp());{const s=function(e,t,n,i,r,s){let o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];const a=Wp(e.urlParams),l=e.url+a,c=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(c,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(c,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!==t&&void 0!==t?t:"AppManager")}(c,s),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(c,i),new Gp(l,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,r,o)}(e,this._appId,n,i,t,this._firebaseVersion,r);return this._requests.add(s),s.getPromise().then(()=>this._requests.delete(s),()=>this._requests.delete(s)),s}}async makeRequestWithTokens(e,t){const[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,i).getPromise()}}const jm="@firebase/storage",Fm="0.13.2",Um="storage";function zm(e,t){return Om(e=Se(e),t)}function Bm(e,t){let{instanceIdentifier:n}=t;const i=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return new Mm(i,r,s,n,Gt)}Vt(new Ie(Um,Bm,"PUBLIC").setMultipleInstances(!0)),Yt(jm,Fm,""),Yt(jm,Fm,"esm2017");const Vm="@firebase/installations",qm="0.6.9",Hm=1e4,Wm="w:".concat(qm),Km="FIS_v2",Gm=36e5,Zm=new oe("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function Qm(e){return e instanceof se&&e.code.includes("request-failed")}function Ym(e){let{projectId:t}=e;return"".concat("https://firebaseinstallations.googleapis.com/v1","/projects/").concat(t,"/installations")}function Jm(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function Xm(e,t){const n=(await t.json()).error;return Zm.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function $m(e){let{apiKey:t}=e;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function eg(e,t){let{refreshToken:n}=t;const i=$m(e);return i.append("Authorization",function(e){return"".concat(Km," ").concat(e)}(n)),i}async function tg(e){const t=await e();return t.status>=500&&t.status<600?e():t}function ng(e){return new Promise(t=>{setTimeout(t,e)})}const ig=/^[cdef][\w-]{21}$/;function rg(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){const t=(n=e,btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_"));var n;return t.substr(0,22)}(e);return ig.test(t)?t:""}catch(e){return""}}function sg(e){return"".concat(e.appName,"!").concat(e.appId)}const og=new Map;function ag(e,t){const n=sg(e);lg(n,t),function(e,t){const n=ug();n&&n.postMessage({key:e,fid:t});hg()}(n,t)}function lg(e,t){const n=og.get(e);if(n)for(const i of n)i(t)}let cg=null;function ug(){return!cg&&"BroadcastChannel"in self&&(cg=new BroadcastChannel("[Firebase] FID Change"),cg.onmessage=e=>{lg(e.data.key,e.data.fid)}),cg}function hg(){0===og.size&&cg&&(cg.close(),cg=null)}const dg="firebase-installations-store";let fg=null;function pg(){return fg||(fg=tt("firebase-installations-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(dg)}})),fg}async function mg(e,t){const n=sg(e),i=(await pg()).transaction(dg,"readwrite"),r=i.objectStore(dg),s=await r.get(n);return await r.put(t,n),await i.done,s&&s.fid===t.fid||ag(e,t.fid),t}async function gg(e){const t=sg(e),n=(await pg()).transaction(dg,"readwrite");await n.objectStore(dg).delete(t),await n.done}async function _g(e,t){const n=sg(e),i=(await pg()).transaction(dg,"readwrite"),r=i.objectStore(dg),s=await r.get(n),o=t(s);return void 0===o?await r.delete(n):await r.put(o,n),await i.done,!o||s&&s.fid===o.fid||ag(e,o.fid),o}async function vg(e){let t;const n=await _g(e.appConfig,n=>{const i=function(e){const t=e||{fid:rg(),registrationStatus:0};return bg(t)}(n),r=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){return{installationEntry:t,registrationPromise:Promise.reject(Zm.create("app-offline"))}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},i=async function(e,t){try{const n=await async function(e,t){let{appConfig:n,heartbeatServiceProvider:i}=e,{fid:r}=t;const s=Ym(n),o=$m(n),a=i.getImmediate({optional:!0});if(a){const e=await a.getHeartbeatsHeader();e&&o.append("x-firebase-client",e)}const l={fid:r,authVersion:Km,appId:n.appId,sdkVersion:Wm},c={method:"POST",headers:o,body:JSON.stringify(l)},u=await tg(()=>fetch(s,c));if(u.ok){const e=await u.json();return{fid:e.fid||r,registrationStatus:2,refreshToken:e.refreshToken,authToken:Jm(e.authToken)}}throw await Xm("Create Installation",u)}(e,t);return mg(e.appConfig,n)}catch(aC){throw Qm(aC)&&409===aC.customData.serverCode?await gg(e.appConfig):await mg(e.appConfig,{fid:t.fid,registrationStatus:0}),aC}}(e,n);return{installationEntry:n,registrationPromise:i}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:yg(e)}:{installationEntry:t}}(e,i);return t=r.registrationPromise,r.installationEntry});return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function yg(e){let t=await wg(e.appConfig);for(;1===t.registrationStatus;)await ng(100),t=await wg(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await vg(e);return n||t}return t}function wg(e){return _g(e,e=>{if(!e)throw Zm.create("installation-not-found");return bg(e)})}function bg(e){return 1===(t=e).registrationStatus&&t.registrationTime+Hm<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function Eg(e,t){let{appConfig:n,heartbeatServiceProvider:i}=e;const r=function(e,t){let{fid:n}=t;return"".concat(Ym(e),"/").concat(n,"/authTokens:generate")}(n,t),s=eg(n,t),o=i.getImmediate({optional:!0});if(o){const e=await o.getHeartbeatsHeader();e&&s.append("x-firebase-client",e)}const a={installation:{sdkVersion:Wm,appId:n.appId}},l={method:"POST",headers:s,body:JSON.stringify(a)},c=await tg(()=>fetch(r,l));if(c.ok){return Jm(await c.json())}throw await Xm("Generate Auth Token",c)}async function Tg(e){let t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=await _g(e.appConfig,i=>{if(!xg(i))throw Zm.create("not-registered");const r=i.authToken;if(!n&&function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+Gm}(e)}(r))return i;if(1===r.requestStatus)return t=async function(e,t){let n=await Cg(e.appConfig);for(;1===n.authToken.requestStatus;)await ng(100),n=await Cg(e.appConfig);const i=n.authToken;return 0===i.requestStatus?Tg(e,t):i}(e,n),i;{if(!navigator.onLine)throw Zm.create("app-offline");const n=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(i);return t=async function(e,t){try{const n=await Eg(e,t),i=Object.assign(Object.assign({},t),{authToken:n});return await mg(e.appConfig,i),n}catch(aC){if(!Qm(aC)||401!==aC.customData.serverCode&&404!==aC.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await mg(e.appConfig,n)}else await gg(e.appConfig);throw aC}}(e,n),n}});return t?await t:i.authToken}function Cg(e){return _g(e,e=>{if(!xg(e))throw Zm.create("not-registered");const t=e.authToken;return 1===(n=t).requestStatus&&n.requestTime+Hm<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var n})}function xg(e){return void 0!==e&&2===e.registrationStatus}async function Sg(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e;await async function(e){const{registrationPromise:t}=await vg(e);t&&await t}(n);return(await Tg(n,t)).token}function Ig(e){return Zm.create("missing-app-config-values",{valueName:e})}const kg="installations",Pg=e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw Ig("App Configuration");if(!e.name)throw Ig("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw Ig(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:qt(t,"heartbeat"),_delete:()=>Promise.resolve()}},Ng=e=>{const t=qt(e.getProvider("app").getImmediate(),kg).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:i}=await vg(t);return i?i.catch(console.error):Tg(t).catch(console.error),n.fid}(t),getToken:e=>Sg(t,e)}};Vt(new Ie(kg,Pg,"PUBLIC")),Vt(new Ie("installations-internal",Ng,"PRIVATE")),Yt(Vm,qm),Yt(Vm,qm,"esm2017");const Ag="analytics",Rg="https://www.googletagmanager.com/gtag/js",Lg=new je("@firebase/analytics"),Og=new oe("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function Dg(e){if(!e.startsWith(Rg)){const t=Og.create("invalid-gtag-resource",{gtagURL:e});return Lg.warn(t.message),""}return e}function Mg(e){return Promise.all(e.map(e=>e.catch(e=>e)))}function jg(e,t){const n=function(e,t){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(e,t)),n}("firebase-js-sdk-policy",{createScriptURL:Dg}),i=document.createElement("script"),r="".concat(Rg,"?l=").concat(e,"&id=").concat(t);i.src=n?null===n||void 0===n?void 0:n.createScriptURL(r):r,i.async=!0,document.head.appendChild(i)}function Fg(e,t,n,i){return async function(r){try{for(var s=arguments.length,o=new Array(s>1?s-1:0),a=1;a<s;a++)o[a-1]=arguments[a];if("event"===r){const[i,r]=o;await async function(e,t,n,i,r){try{let s=[];if(r&&r.send_to){let e=r.send_to;Array.isArray(e)||(e=[e]);const i=await Mg(n);for(const n of e){const e=i.find(e=>e.measurementId===n),r=e&&t[e.appId];if(!r){s=[];break}s.push(r)}}0===s.length&&(s=Object.values(t)),await Promise.all(s),e("event",i,r||{})}catch(aC){Lg.error(aC)}}(e,t,n,i,r)}else if("config"===r){const[r,s]=o;await async function(e,t,n,i,r,s){const o=i[r];try{if(o)await t[o];else{const e=(await Mg(n)).find(e=>e.measurementId===r);e&&await t[e.appId]}}catch(aC){Lg.error(aC)}e("config",r,s)}(e,t,n,i,r,s)}else if("consent"===r){const[t,n]=o;e("consent",t,n)}else if("get"===r){const[t,n,i]=o;e("get",t,n,i)}else if("set"===r){const[t]=o;e("set",t)}else e(r,...o)}catch(aC){Lg.error(aC)}}}const Ug=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function zg(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function Bg(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ug,n=arguments.length>2?arguments[2]:void 0;const{appId:i,apiKey:r,measurementId:s}=e.options;if(!i)throw Og.create("no-app-id");if(!r){if(s)return{measurementId:s,appId:i};throw Og.create("no-api-key")}const o=t.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new qg;return setTimeout(async()=>{a.abort()},void 0!==n?n:6e4),Vg({appId:i,apiKey:r,measurementId:s},o,a,t)}async function Vg(e,t,n){let{throttleEndTimeMillis:i,backoffCount:r}=t,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ug;var o;const{appId:a,measurementId:l}=e;try{await function(e,t){return new Promise((n,i)=>{const r=Math.max(t-Date.now(),0),s=setTimeout(n,r);e.addEventListener(()=>{clearTimeout(s),i(Og.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}(n,i)}catch(aC){if(l)return Lg.warn("Timed out fetching this Firebase app's measurement ID from the server."+" Falling back to the measurement ID ".concat(l)+' provided in the "measurementId" field in the local Firebase config. ['.concat(null===aC||void 0===aC?void 0:aC.message,"]")),{appId:a,measurementId:l};throw aC}try{const t=await async function(e){var t;const{appId:n,apiKey:i}=e,r={method:"GET",headers:zg(i)},s="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),o=await fetch(s,r);if(200!==o.status&&304!==o.status){let e="";try{const n=await o.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch(a){}throw Og.create("config-fetch-failed",{httpStatus:o.status,responseMessage:e})}return o.json()}(e);return s.deleteThrottleMetadata(a),t}catch(aC){const i=aC;if(!function(e){if(!(e instanceof se)||!e.customData)return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(i)){if(s.deleteThrottleMetadata(a),l)return Lg.warn("Failed to fetch this Firebase app's measurement ID from the server."+" Falling back to the measurement ID ".concat(l)+' provided in the "measurementId" field in the local Firebase config. ['.concat(null===i||void 0===i?void 0:i.message,"]")),{appId:a,measurementId:l};throw aC}const c=503===Number(null===(o=null===i||void 0===i?void 0:i.customData)||void 0===o?void 0:o.httpStatus)?xe(r,s.intervalMillis,30):xe(r,s.intervalMillis),u={throttleEndTimeMillis:Date.now()+c,backoffCount:r+1};return s.setThrottleMetadata(a,u),Lg.debug("Calling attemptFetch again in ".concat(c," millis")),Vg(e,u,n,s)}}class qg{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}let Hg,Wg;function Kg(e){Wg=e}function Gg(e){Hg=e}async function Zg(e,t,n,i,r,s,o){var a;const l=Bg(e);l.then(t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&Lg.warn("The measurement ID in the local Firebase config (".concat(e.options.measurementId,")")+" does not match the measurement ID fetched from the server (".concat(t.measurementId,").")+" To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")}).catch(e=>Lg.error(e)),t.push(l);const c=async function(){if(!ie())return Lg.warn(Og.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await re()}catch(aC){return Lg.warn(Og.create("indexeddb-unavailable",{errorInfo:null===aC||void 0===aC?void 0:aC.toString()}).message),!1}return!0}().then(e=>e?i.getId():void 0),[u,h]=await Promise.all([l,c]);(function(e){const t=window.document.getElementsByTagName("script");for(const n of Object.values(t))if(n.src&&n.src.includes(Rg)&&n.src.includes(e))return n;return null})(s)||jg(s,u.measurementId),Wg&&(r("consent","default",Wg),Kg(void 0)),r("js",new Date);const d=null!==(a=null===o||void 0===o?void 0:o.config)&&void 0!==a?a:{};return d.origin="firebase",d.update=!0,null!=h&&(d.firebase_id=h),r("config",u.measurementId,d),Hg&&(r("set",Hg),Gg(void 0)),u.measurementId}class Qg{constructor(e){this.app=e}_delete(){return delete Yg[this.app.options.appId],Promise.resolve()}}let Yg={},Jg=[];const Xg={};let $g,e_,t_="dataLayer",n_="gtag",i_=!1;function r_(){const e=[];if($()&&e.push("This is a browser extension environment."),"undefined"!==typeof navigator&&navigator.cookieEnabled||e.push("Cookies are not available."),e.length>0){const t=e.map((e,t)=>"(".concat(t+1,") ").concat(e)).join(" "),n=Og.create("invalid-analytics-context",{errorInfo:t});Lg.warn(n.message)}}function s_(e,t,n){r_();const i=e.options.appId;if(!i)throw Og.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw Og.create("no-api-key");Lg.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest'+" measurement ID for this Firebase app. Falling back to the measurement ID ".concat(e.options.measurementId)+' provided in the "measurementId" field in the local Firebase config.')}if(null!=Yg[i])throw Og.create("already-exists",{id:i});if(!i_){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(t_);const{wrappedGtag:e,gtagCore:t}=function(e,t,n,i,r){let s=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];window[i].push(arguments)};return window[r]&&"function"===typeof window[r]&&(s=window[r]),window[r]=Fg(s,e,t,n),{gtagCore:s,wrappedGtag:window[r]}}(Yg,Jg,Xg,t_,n_);e_=e,$g=t,i_=!0}Yg[i]=Zg(e,Jg,Xg,t,$g,t_,n);return new Qg(e)}function o_(e,t,n,i){e=Se(e),async function(e,t,n,i,r){if(r&&r.global)e("event",n,i);else{const r=await t;e("event",n,Object.assign(Object.assign({},i),{send_to:r}))}}(e_,Yg[e.app.options.appId],t,n,i).catch(e=>Lg.error(e))}const a_="@firebase/analytics",l_="0.10.8";Vt(new Ie(Ag,(e,t)=>{let{options:n}=t;return s_(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),n)},"PUBLIC")),Vt(new Ie("analytics-internal",function(e){try{const t=e.getProvider(Ag).getImmediate();return{logEvent:(e,n,i)=>o_(t,e,n,i)}}catch(aC){throw Og.create("interop-component-reg-failed",{reason:aC})}},"PRIVATE")),Yt(a_,l_),Yt(a_,l_,"esm2017");const c_="@firebase/database",u_="1.0.8";let h_="";function d_(e){h_=e}class f_{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),ce(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:le(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class p_{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return he(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const m_=function(e){try{if("undefined"!==typeof window&&"undefined"!==typeof window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new f_(t)}}catch(aC){}return new p_},g_=m_("localStorage"),__=m_("sessionStorage"),v_=new je("@firebase/database"),y_=function(){let e=1;return function(){return e++}}(),w_=function(e){const t=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);if(r>=55296&&r<=56319){const t=r-55296;i++,R(i<e.length,"Surrogate pair missing trail surrogate."),r=65536+(t<<10)+(e.charCodeAt(i)-56320)}r<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):r<65536?(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128)}return t}(e),n=new we;n.update(t);const i=n.digest();return D.encodeByteArray(i)},b_=function(){let e="";for(let t=0;t<arguments.length;t++){const n=t<0||arguments.length<=t?void 0:arguments[t];Array.isArray(n)||n&&"object"===typeof n&&"number"===typeof n.length?e+=b_.apply(null,n):e+="object"===typeof n?ce(n):n,e+=" "}return e};let E_=null,T_=!0;const C_=function(e,t){R(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(v_.logLevel=Re.VERBOSE,E_=v_.log.bind(v_),t&&__.set("logging_enabled",!0)):"function"===typeof e?E_=e:(E_=null,__.remove("logging_enabled"))},x_=function(){if(!0===T_&&(T_=!1,null===E_&&!0===__.get("logging_enabled")&&C_(!0)),E_){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const i=b_.apply(null,t);E_(i)}},S_=function(e){return function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];x_(e,...n)}},I_=function(){const e="FIREBASE INTERNAL ERROR: "+b_(...arguments);v_.error(e)},k_=function(){const e="FIREBASE FATAL ERROR: ".concat(b_(...arguments));throw v_.error(e),new Error(e)},P_=function(){const e="FIREBASE WARNING: "+b_(...arguments);v_.warn(e)},N_=function(e){return"number"===typeof e&&(e!==e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},A_="[MIN_NAME]",R_="[MAX_NAME]",L_=function(e,t){if(e===t)return 0;if(e===A_||t===R_)return-1;if(t===A_||e===R_)return 1;{const n=B_(e),i=B_(t);return null!==n?null!==i?n-i===0?e.length-t.length:n-i:-1:null!==i?1:e<t?-1:1}},O_=function(e,t){return e===t?0:e<t?-1:1},D_=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+ce(t))},M_=function(e){if("object"!==typeof e||null===e)return ce(e);const t=[];for(const i in e)t.push(i);t.sort();let n="{";for(let i=0;i<t.length;i++)0!==i&&(n+=","),n+=ce(t[i]),n+=":",n+=M_(e[t[i]]);return n+="}",n},j_=function(e,t){const n=e.length;if(n<=t)return[e];const i=[];for(let r=0;r<n;r+=t)r+t>n?i.push(e.substring(r,n)):i.push(e.substring(r,r+t));return i};function F_(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const U_=function(e){R(!N_(e),"Invalid JSON number");const t=1023;let n,i,r,s,o;0===e?(i=0,r=0,n=1/e===-1/0?1:0):(n=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(s=Math.min(Math.floor(Math.log(e)/Math.LN2),t),i=s+t,r=Math.round(e*Math.pow(2,52-s)-Math.pow(2,52))):(i=0,r=Math.round(e/Math.pow(2,-1074))));const a=[];for(o=52;o;o-=1)a.push(r%2?1:0),r=Math.floor(r/2);for(o=11;o;o-=1)a.push(i%2?1:0),i=Math.floor(i/2);a.push(n?1:0),a.reverse();const l=a.join("");let c="";for(o=0;o<64;o+=8){let e=parseInt(l.substr(o,8),2).toString(16);1===e.length&&(e="0"+e),c+=e}return c.toLowerCase()};const z_=new RegExp("^-?(0*)\\d{1,10}$"),B_=function(e){if(z_.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},V_=function(e){try{e()}catch(aC){setTimeout(()=>{const t=aC.stack||"";throw P_("Exception was thrown by user callback.",t),aC},Math.floor(0))}},q_=function(e,t){const n=setTimeout(e,t);return"number"===typeof n&&"undefined"!==typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"===typeof n&&n.unref&&n.unref(),n};class H_{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null===t||void 0===t?void 0:t.getImmediate({optional:!0}),this.appCheck||null===t||void 0===t||t.get().then(e=>this.appCheck=e)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,n)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,n):t(null)},0)})}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(t=>t.addTokenListener(e))}notifyForInvalidToken(){P_('Provided AppCheck credentials for the app named "'.concat(this.appName_,'" ')+"are invalid. This usually indicates your app was not initialized correctly.")}}class W_{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit(e=>this.auth_=e)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(e=>e&&"auth/token-not-initialized"===e.code?(x_("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)):new Promise((t,n)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,n):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',P_(e)}}class K_{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}K_.OWNER="owner";const G_="5",Z_=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Q_="ac",Y_="websocket",J_="long_polling";class X_{constructor(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],a=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.secure=t,this.namespace=n,this.webSocketOnly=i,this.nodeAdmin=r,this.persistenceKey=s,this.includeNamespaceInQueryParams=o,this.isUsingEmulator=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=g_.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&g_.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?"?ns=".concat(this.namespace):"";return"".concat(e).concat(this.host,"/").concat(t)}}function $_(e,t,n){let i;if(R("string"===typeof t,"typeof type must == string"),R("object"===typeof n,"typeof params must == object"),t===Y_)i=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==J_)throw new Error("Unknown connection type: "+t);i=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);const r=[];return F_(n,(e,t)=>{r.push(e+"="+t)}),i+r.join("&")}class ev{constructor(){this.counters_={}}incrementCounter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;he(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return z(this.counters_)}}const tv={},nv={};function iv(e){const t=e.toString();return tv[t]||(tv[t]=new ev),tv[t]}class rv{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&V_(()=>{this.onMessage_(e[t])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const sv="start";class ov{constructor(e,t,n,i,r,s,o){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=i,this.authToken=r,this.transportSessionId=s,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=S_(e),this.stats_=iv(t),this.urlFn=e=>(this.appCheckToken&&(e[Q_]=this.appCheckToken),$_(t,J_,e))}open(e,t){var n=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new rv(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(e){if(te()||"complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new av(function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];const[r,s,o,a,l]=t;if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,r===sv)n.id=s,n.password=o;else{if("close"!==r)throw new Error("Unrecognized command received: "+r);s?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(s,()=>{n.onClosed_()})):n.onClosed_()}},function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];const[r,s]=t;n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(r,s)},()=>{this.onClosed_()},this.urlFn);const e={};e[sv]="t",e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v=G_,this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e[Q_]=this.appCheckToken),"undefined"!==typeof location&&location.hostname&&Z_.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){ov.forceAllow_=!0}static forceDisallow(){ov.forceDisallow_=!0}static isAvailable(){return!te()&&(!!ov.forceAllow_||!ov.forceDisallow_&&"undefined"!==typeof document&&null!=document.createElement&&!("object"===typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"===typeof Windows&&"object"===typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=ce(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=j(t),i=j_(n,1840);for(let r=0;r<i.length;r++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[r]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(te())return;this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=ce(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class av{constructor(e,t,n,i){if(this.onDisconnect=n,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,te())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=y_(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=av.createIFrame_();let n="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)){n='<script>document.domain="'+document.domain+'";<\/script>'}const i="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(i),this.myIFrame.doc.close()}catch(aC){x_("frame writing exception"),aC.stack&&x_(aC.stack),x_(aC)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||x_("No IE domain setting required")}catch(aC){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",i=0;for(;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;{const e=this.pendingSegs.shift();n=n+"&seg"+i+"="+e.seg+"&ts"+i+"="+e.ts+"&d"+i+"="+e.d,i++}}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(n,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(i),n()})}addTag(e,t){te()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{x_("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(aC){}},Math.floor(1))}}let lv=null;"undefined"!==typeof MozWebSocket?lv=MozWebSocket:"undefined"!==typeof WebSocket&&(lv=WebSocket);class cv{constructor(e,t,n,i,r,s,o){this.connId=e,this.applicationId=n,this.appCheckToken=i,this.authToken=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=S_(this.connId),this.stats_=iv(t),this.connURL=cv.connectionURL_(t,s,o,i,n),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,i,r){const s={};return s.v=G_,!te()&&"undefined"!==typeof location&&location.hostname&&Z_.test(location.hostname)&&(s.r="f"),t&&(s.s=t),n&&(s.ls=n),i&&(s[Q_]=i),r&&(s.p=r),$_(e,Y_,s)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,g_.set("previous_websocket_failure",!0);try{let e;if(te()){const t=this.nodeAdmin?"AdminNode":"Node";e={headers:{"User-Agent":"Firebase/".concat(G_,"/").concat(h_,"/").concat(process.platform,"/").concat(t),"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(e.headers.Authorization="Bearer ".concat(this.authToken)),this.appCheckToken&&(e.headers["X-Firebase-AppCheck"]=this.appCheckToken);const n={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyDoWYF5rEHMliG2tAbiE4OM8qvjAssT8Pc",REACT_APP_FIREBASE_AUTH_DOMAIN:"hackru-cc78a.firebaseapp.com",REACT_APP_FIREBASE_DATABASE_URL:"https://hackru-cc78a-default-rtdb.firebaseio.com",REACT_APP_FIREBASE_PROJECT_ID:"hackru-cc78a",REACT_APP_FIREBASE_STORAGE_BUCKET:"hackru-cc78a.firebasestorage.app",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"53406972833",REACT_APP_FIREBASE_APP_ID:"1:53406972833:web:0a038d10f85d215b1829e0",REACT_APP_FIREBASE_MEASUREMENT_ID:"G-3D65B0W7J7",REACT_APP_API_BASE:"http://localhost:8080",REACT_APP_SERVER_IP:"10.74.159.48"},i=0===this.connURL.indexOf("wss://")?n.HTTPS_PROXY||n.https_proxy:n.HTTP_PROXY||n.http_proxy;i&&(e.proxy={origin:i})}this.mySock=new lv(this.connURL,[],e)}catch(aC){this.log_("Error instantiating WebSocket.");const t=aC.message||aC.data;return t&&this.log_(t),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){cv.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!==typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==lv&&!cv.forceDisallow_}static previouslyFailed(){return g_.isInMemoryStorage||!0===g_.get("previous_websocket_failure")}markConnectionHealthy(){g_.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=le(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(R(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=ce(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=j_(t,16384);n.length>1&&this.sendString_(String(n.length));for(let i=0;i<n.length;i++)this.sendString_(n[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(aC){this.log_("Exception thrown from WebSocket.send():",aC.message||aC.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}cv.responsesRequiredToBeHealthy=2,cv.healthyTimeout=3e4;class uv{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[ov,cv]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=cv&&cv.isAvailable();let n=t&&!cv.previouslyFailed();if(e.webSocketOnly&&(t||P_("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[cv];else{const e=this.transports_=[];for(const t of uv.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t);uv.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}uv.globalTransportInitialized_=!1;class hv{constructor(e,t,n,i,r,s,o,a,l,c){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=i,this.authToken_=r,this.onMessage_=s,this.onReady_=o,this.onDisconnect_=a,this.onKill_=l,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=S_("c:"+this.id+":"),this.transportManager_=new uv(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,n)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=q_(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=D_("t",e),n=D_("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=D_("t",e),n=D_("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=D_("t",e);if("d"in e){const n=e.d;if("h"===t){const e=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(e.h=this.repoInfo_.host),this.onHandshake_(e)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?I_("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):I_("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),G_!==n&&P_("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),q_(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):q_(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(g_.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class dv{put(e,t,n,i){}merge(e,t,n,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}class fv{constructor(e){this.allowedEvents_=e,this.listeners_={},R(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(let e=0;e<r.length;e++)r[e].callback.apply(r[e].context,n)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const i=this.getInitialEvent(e);i&&t.apply(n,i)}off(e,t,n){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let r=0;r<i.length;r++)if(i[r].callback===t&&(!n||n===i[r].context))return void i.splice(r,1)}validateEventType_(e){R(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class pv extends fv{constructor(){super(["online"]),this.online_=!0,"undefined"===typeof window||"undefined"===typeof window.addEventListener||X()||(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new pv}getInitialEvent(e){return R("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class mv{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function gv(){return new mv("")}function _v(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function vv(e){return e.pieces_.length-e.pieceNum_}function yv(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new mv(e.pieces_,t)}function wv(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function bv(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.pieces_.slice(e.pieceNum_+t)}function Ev(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new mv(t,0)}function Tv(e,t){const n=[];for(let i=e.pieceNum_;i<e.pieces_.length;i++)n.push(e.pieces_[i]);if(t instanceof mv)for(let i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&n.push(e[t])}return new mv(n,0)}function Cv(e){return e.pieceNum_>=e.pieces_.length}function xv(e,t){const n=_v(e),i=_v(t);if(null===n)return t;if(n===i)return xv(yv(e),yv(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function Sv(e,t){if(vv(e)!==vv(t))return!1;for(let n=e.pieceNum_,i=t.pieceNum_;n<=e.pieces_.length;n++,i++)if(e.pieces_[n]!==t.pieces_[i])return!1;return!0}function Iv(e,t){let n=e.pieceNum_,i=t.pieceNum_;if(vv(e)>vv(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[i])return!1;++n,++i}return!0}class kv{constructor(e,t){this.errorPrefix_=t,this.parts_=bv(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let n=0;n<this.parts_.length;n++)this.byteLength_+=Ce(this.parts_[n]);Pv(this)}}function Pv(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Nv(e))}function Nv(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}class Av extends fv{constructor(){let e,t;super(["visible"]),"undefined"!==typeof document&&"undefined"!==typeof document.addEventListener&&("undefined"!==typeof document.hidden?(t="visibilitychange",e="hidden"):"undefined"!==typeof document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):"undefined"!==typeof document.msHidden?(t="msvisibilitychange",e="msHidden"):"undefined"!==typeof document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))},!1)}static getInstance(){return new Av}getInitialEvent(e){return R("visible"===e,"Unknown event type: "+e),[this.visible_]}}const Rv=1e3;class Lv extends dv{constructor(e,t,n,i,r,s,o,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=i,this.onServerInfoUpdate_=r,this.authTokenProvider_=s,this.appCheckTokenProvider_=o,this.authOverride_=a,this.id=Lv.nextPersistentConnectionId_++,this.log_=S_("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Rv,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a&&!te())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Av.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&pv.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const i=++this.requestNumber_,r={r:i,a:e,b:t};this.log_(ce(r)),R(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),n&&(this.requestCBHash_[i]=n)}get(e){this.initConnection_();const t=new Q,n={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:e=>{const n=e.d;"ok"===e.s?t.resolve(n):t.reject(n)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(i),t.promise}listen(e,t,n,i){this.initConnection_();const r=e._queryIdentifier,s=e._path.toString();this.log_("Listen called for "+s+" "+r),this.listens.has(s)||this.listens.set(s,new Map),R(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),R(!this.listens.get(s).has(r),"listen() called twice for same path/queryId.");const o={onComplete:i,hashFn:t,query:e,tag:n};this.listens.get(s).set(r,o),this.connected_&&this.sendListen_(o)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)})}sendListen_(e){const t=e.query,n=t._path.toString(),i=t._queryIdentifier;this.log_("Listen on "+n+" for "+i);const r={p:n};e.tag&&(r.q=t._queryObject,r.t=e.tag),r.h=e.hashFn(),this.sendRequest("q",r,r=>{const s=r.d,o=r.s;Lv.warnOnListenWarnings_(s,t);(this.listens.get(n)&&this.listens.get(n).get(i))===e&&(this.log_("listen response",r),"ok"!==o&&this.removeListen_(n,i),e.onComplete&&e.onComplete(o,s))})}static warnOnListenWarnings_(e,t){if(e&&"object"===typeof e&&he(e,"w")){const n=de(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();P_("Using an unspecified index. Your data will be downloaded and "+"filtered on the client. Consider adding ".concat(e," at ")+"".concat(n," to your security rules for better performance."))}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||function(e){const t=ue(e).claims;return"object"===typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=function(e){const t=ue(e).claims;return!!t&&"object"===typeof t&&t.hasOwnProperty("iat")}(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"===typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,t=>{const n=t.s,i=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,i))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)})}unlisten(e,t){const n=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+i),R(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query");this.removeListen_(n,i)&&this.connected_&&this.sendUnlisten_(n,i,e._queryObject,t)}sendUnlisten_(e,t,n,i){this.log_("Unlisten on "+e+" for "+t);const r={p:e};i&&(r.q=n,r.t=i),this.sendRequest("n",r)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,i){const r={p:t,d:n};this.log_("onDisconnect "+e,r),this.sendRequest(e,r,e=>{i&&setTimeout(()=>{i(e.s,e.d)},Math.floor(0))})}put(e,t,n,i){this.putInternal("p",e,t,n,i)}merge(e,t,n,i){this.putInternal("m",e,t,n,i)}putInternal(e,t,n,i,r){this.initConnection_();const s={p:t,d:n};void 0!==r&&(s.h=r),this.outstandingPuts_.push({action:e,request:s,onComplete:i}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),i&&i(n.s,n.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+ce(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):I_("Unrecognized action received from server: "+ce(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){R(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Rv,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Rv,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Rv),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+Lv.nextConnectionId_++,r=this.lastSessionId;let s=!1,o=null;const a=function(){o?o.close():(s=!0,n())},l=function(e){R(o,"sendRequest call when we're not connected not allowed."),o.sendRequest(e)};this.realtime_={close:a,sendRequest:l};const c=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[a,l]=await Promise.all([this.authTokenProvider_.getToken(c),this.appCheckTokenProvider_.getToken(c)]);s?x_("getToken() completed but was canceled"):(x_("getToken() completed. Creating connection."),this.authToken_=a&&a.accessToken,this.appCheckToken_=l&&l.token,o=new hv(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,e=>{P_(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")},r))}catch(I_){this.log_("Failed to get token: "+I_),s||(this.repoInfo_.nodeAdmin&&P_(I_),a())}}}interrupt(e){x_("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){x_("Resuming connection for reason: "+e),delete this.interruptReasons_[e],fe(this.interruptReasons_)&&(this.reconnectDelay_=Rv,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map(e=>M_(e)).join("$"):"default";const i=this.removeListen_(e,n);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,t){const n=new mv(e).toString();let i;if(this.listens.has(n)){const e=this.listens.get(n);i=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else i=void 0;return i}onAuthRevoked_(e,t){x_("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){x_("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";te()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+h_.replace(/\./g,"-")]=1,X()?e["framework.cordova"]=1:ee()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=pv.getInstance().currentlyOnline();return fe(this.interruptReasons_)&&e}}Lv.nextPersistentConnectionId_=0,Lv.nextConnectionId_=0;class Ov{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Ov(e,t)}}class Dv{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new Ov(A_,e),i=new Ov(A_,t);return 0!==this.compare(n,i)}minPost(){return Ov.MIN}}let Mv;class jv extends Dv{static get __EMPTY_NODE(){return Mv}static set __EMPTY_NODE(e){Mv=e}compare(e,t){return L_(e.name,t.name)}isDefinedOn(e){throw L("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Ov.MIN}maxPost(){return new Ov(R_,Mv)}makePost(e,t){return R("string"===typeof e,"KeyIndex indexValue must always be a string."),new Ov(e,Mv)}toString(){return".key"}}const Fv=new jv;class Uv{constructor(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.isReverse_=i,this.resultGenerator_=r,this.nodeStack_=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,i&&(s*=-1),s<0)e=this.isReverse_?e.left:e.right;else{if(0===s){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class zv{constructor(e,t,n,i,r){this.key=e,this.value=t,this.color=null!=n?n:zv.RED,this.left=null!=i?i:Bv.EMPTY_NODE,this.right=null!=r?r:Bv.EMPTY_NODE}copy(e,t,n,i,r){return new zv(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const r=n(e,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===r?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return Bv.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,i;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return Bv.EMPTY_NODE;i=n.right.min_(),n=n.copy(i.key,i.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,zv.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,zv.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}zv.RED=!0,zv.BLACK=!1;class Bv{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Bv.EMPTY_NODE;this.comparator_=e,this.root_=t}insert(e,t){return new Bv(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,zv.BLACK,null,null))}remove(e){return new Bv(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,zv.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,i=null;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t){if(n.left.isEmpty())return i?i.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(i=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Uv(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Uv(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Uv(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Uv(this.root_,null,this.comparator_,!0,e)}}function Vv(e,t){return L_(e.name,t.name)}function qv(e,t){return L_(e,t)}let Hv;Bv.EMPTY_NODE=new class{copy(e,t,n,i,r){return this}insert(e,t,n){return new zv(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const Wv=function(e){return"number"===typeof e?"number:"+U_(e):"string:"+e},Kv=function(e){if(e.isLeafNode()){const t=e.val();R("string"===typeof t||"number"===typeof t||"object"===typeof t&&he(t,".sv"),"Priority must be a string or number.")}else R(e===Hv||e.isEmpty(),"priority of unexpected type.");R(e===Hv||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let Gv,Zv,Qv;class Yv{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Yv.__childrenNodeConstructor.EMPTY_NODE;this.value_=e,this.priorityNode_=t,this.lazyHash_=null,R(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Kv(this.priorityNode_)}static set __childrenNodeConstructor(e){Gv=e}static get __childrenNodeConstructor(){return Gv}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Yv(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:Yv.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Cv(e)?this:".priority"===_v(e)?this.priorityNode_:Yv.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:Yv.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=_v(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:(R(".priority"!==n||1===vv(e),".priority must be the last token in a path"),this.updateImmediateChild(n,Yv.__childrenNodeConstructor.EMPTY_NODE.updateChild(yv(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+Wv(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?U_(this.value_):this.value_,this.lazyHash_=w_(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Yv.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Yv.__childrenNodeConstructor?-1:(R(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,i=Yv.VALUE_TYPE_ORDER.indexOf(t),r=Yv.VALUE_TYPE_ORDER.indexOf(n);return R(i>=0,"Unknown leaf type: "+t),R(r>=0,"Unknown leaf type: "+n),i===r?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:r-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}Yv.VALUE_TYPE_ORDER=["object","boolean","number","string"];const Jv=new class extends Dv{compare(e,t){const n=e.node.getPriority(),i=t.node.getPriority(),r=n.compareTo(i);return 0===r?L_(e.name,t.name):r}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Ov.MIN}maxPost(){return new Ov(R_,new Yv("[PRIORITY-POST]",Qv))}makePost(e,t){const n=Zv(e);return new Ov(t,new Yv("[PRIORITY-POST]",n))}toString(){return".priority"}},Xv=Math.log(2);class $v{constructor(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/Xv,10)),this.current_=this.count-1;const n=(i=this.count,parseInt(Array(i+1).join("1"),2));var i;this.bits_=e+1&n}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const ey=function(e,t,n,i){e.sort(t);const r=function(t,i){const s=i-t;let o,a;if(0===s)return null;if(1===s)return o=e[t],a=n?n(o):o,new zv(a,o.node,zv.BLACK,null,null);{const l=parseInt(s/2,10)+t,c=r(t,l),u=r(l+1,i);return o=e[l],a=n?n(o):o,new zv(a,o.node,zv.BLACK,c,u)}},s=function(t){let i=null,s=null,o=e.length;const a=function(t,i){const s=o-t,a=o;o-=t;const c=r(s+1,a),u=e[s],h=n?n(u):u;l(new zv(h,u.node,i,null,c))},l=function(e){i?(i.left=e,i=e):(s=e,i=e)};for(let e=0;e<t.count;++e){const n=t.nextBitIsOne(),i=Math.pow(2,t.count-(e+1));n?a(i,zv.BLACK):(a(i,zv.BLACK),a(i,zv.RED))}return s}(new $v(e.length));return new Bv(i||t,s)};let ty;const ny={};class iy{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return R(ny&&Jv,"ChildrenNode.ts has not been loaded"),ty=ty||new iy({".priority":ny},{".priority":Jv}),ty}get(e){const t=de(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Bv?t:null}hasIndex(e){return he(this.indexSet_,e.toString())}addIndex(e,t){R(e!==Fv,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let i=!1;const r=t.getIterator(Ov.Wrap);let s,o=r.getNext();for(;o;)i=i||e.isDefinedOn(o.node),n.push(o),o=r.getNext();s=i?ey(n,e.getCompare()):ny;const a=e.toString(),l=Object.assign({},this.indexSet_);l[a]=e;const c=Object.assign({},this.indexes_);return c[a]=s,new iy(c,l)}addToIndexes(e,t){const n=pe(this.indexes_,(n,i)=>{const r=de(this.indexSet_,i);if(R(r,"Missing index implementation for "+i),n===ny){if(r.isDefinedOn(e.node)){const n=[],i=t.getIterator(Ov.Wrap);let s=i.getNext();for(;s;)s.name!==e.name&&n.push(s),s=i.getNext();return n.push(e),ey(n,r.getCompare())}return ny}{const i=t.get(e.name);let r=n;return i&&(r=r.remove(new Ov(e.name,i))),r.insert(e,e.node)}});return new iy(n,this.indexSet_)}removeFromIndexes(e,t){const n=pe(this.indexes_,n=>{if(n===ny)return n;{const i=t.get(e.name);return i?n.remove(new Ov(e.name,i)):n}});return new iy(n,this.indexSet_)}}let ry;class sy{constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Kv(this.priorityNode_),this.children_.isEmpty()&&R(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return ry||(ry=new sy(new Bv(qv),null,iy.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||ry}updatePriority(e){return this.children_.isEmpty()?this:new sy(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?ry:t}}getChild(e){const t=_v(e);return null===t?this:this.getImmediateChild(t).getChild(yv(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if(R(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const n=new Ov(e,t);let i,r;t.isEmpty()?(i=this.children_.remove(e),r=this.indexMap_.removeFromIndexes(n,this.children_)):(i=this.children_.insert(e,t),r=this.indexMap_.addToIndexes(n,this.children_));const s=i.isEmpty()?ry:this.priorityNode_;return new sy(i,s,r)}}updateChild(e,t){const n=_v(e);if(null===n)return t;{R(".priority"!==_v(e)||1===vv(e),".priority must be the last token in a path");const i=this.getImmediateChild(n).updateChild(yv(e),t);return this.updateImmediateChild(n,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,i=0,r=!0;if(this.forEachChild(Jv,(s,o)=>{t[s]=o.val(e),n++,r&&sy.INTEGER_REGEXP_.test(s)?i=Math.max(i,Number(s)):r=!1}),!e&&r&&i<2*n){const e=[];for(const n in t)e[n]=t[n];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+Wv(this.getPriority().val())+":"),this.forEachChild(Jv,(t,n)=>{const i=n.hash();""!==i&&(e+=":"+t+":"+i)}),this.lazyHash_=""===e?"":w_(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const i=this.resolveIndex_(n);if(i){const n=i.getPredecessorKey(new Ov(e,t));return n?n.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Ov(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Ov(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal(e=>t(e.name,e.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,e=>e);{const n=this.children_.getIteratorFrom(e.name,Ov.Wrap);let i=n.peek();for(;null!=i&&t.compare(i,e)<0;)n.getNext(),i=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,e=>e);{const n=this.children_.getReverseIteratorFrom(e.name,Ov.Wrap);let i=n.peek();for(;null!=i&&t.compare(i,e)>0;)n.getNext(),i=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===oy?-1:0}withIndex(e){if(e===Fv||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new sy(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Fv||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator(Jv),n=t.getIterator(Jv);let i=e.getNext(),r=n.getNext();for(;i&&r;){if(i.name!==r.name||!i.node.equals(r.node))return!1;i=e.getNext(),r=n.getNext()}return null===i&&null===r}return!1}return!1}}resolveIndex_(e){return e===Fv?null:this.indexMap_.get(e.toString())}}sy.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const oy=new class extends sy{constructor(){super(new Bv(qv),sy.EMPTY_NODE,iy.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return sy.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(Ov,{MIN:{value:new Ov(A_,sy.EMPTY_NODE)},MAX:{value:new Ov(R_,oy)}}),jv.__EMPTY_NODE=sy.EMPTY_NODE,Yv.__childrenNodeConstructor=sy,Hv=oy,function(e){Qv=e}(oy);function ay(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===e)return sy.EMPTY_NODE;if("object"===typeof e&&".priority"in e&&(t=e[".priority"]),R(null===t||"string"===typeof t||"number"===typeof t||"object"===typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"===typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!==typeof e||".sv"in e){return new Yv(e,ay(t))}if(e instanceof Array){let n=sy.EMPTY_NODE;return F_(e,(t,i)=>{if(he(e,t)&&"."!==t.substring(0,1)){const e=ay(i);!e.isLeafNode()&&e.isEmpty()||(n=n.updateImmediateChild(t,e))}}),n.updatePriority(ay(t))}{const n=[];let i=!1;if(F_(e,(e,t)=>{if("."!==e.substring(0,1)){const r=ay(t);r.isEmpty()||(i=i||!r.getPriority().isEmpty(),n.push(new Ov(e,r)))}}),0===n.length)return sy.EMPTY_NODE;const r=ey(n,Vv,e=>e.name,qv);if(i){const e=ey(n,Jv.getCompare());return new sy(r,ay(t),new iy({".priority":e},{".priority":Jv}))}return new sy(r,ay(t),iy.Default)}}!function(e){Zv=e}(ay);class ly extends Dv{constructor(e){super(),this.indexPath_=e,R(!Cv(e)&&".priority"!==_v(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),i=this.extractChild(t.node),r=n.compareTo(i);return 0===r?L_(e.name,t.name):r}makePost(e,t){const n=ay(e),i=sy.EMPTY_NODE.updateChild(this.indexPath_,n);return new Ov(t,i)}maxPost(){const e=sy.EMPTY_NODE.updateChild(this.indexPath_,oy);return new Ov(R_,e)}toString(){return bv(this.indexPath_,0).join("/")}}const cy=new class extends Dv{compare(e,t){const n=e.node.compareTo(t.node);return 0===n?L_(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Ov.MIN}maxPost(){return Ov.MAX}makePost(e,t){const n=ay(e);return new Ov(t,n)}toString(){return".value"}};function uy(e){return{type:"value",snapshotNode:e}}function hy(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function dy(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function fy(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}class py{constructor(e){this.index_=e}updateChild(e,t,n,i,r,s){R(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const o=e.getImmediateChild(t);return o.getChild(i).equals(n.getChild(i))&&o.isEmpty()===n.isEmpty()?e:(null!=s&&(n.isEmpty()?e.hasChild(t)?s.trackChildChange(dy(t,o)):R(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?s.trackChildChange(hy(t,n)):s.trackChildChange(fy(t,n,o))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}updateFullNode(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(Jv,(e,i)=>{t.hasChild(e)||n.trackChildChange(dy(e,i))}),t.isLeafNode()||t.forEachChild(Jv,(t,i)=>{if(e.hasChild(t)){const r=e.getImmediateChild(t);r.equals(i)||n.trackChildChange(fy(t,i,r))}else n.trackChildChange(hy(t,i))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?sy.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class my{constructor(e){this.indexedFilter_=new py(e.getIndex()),this.index_=e.getIndex(),this.startPost_=my.getStartPost_(e),this.endPost_=my.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,n=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&n}updateChild(e,t,n,i,r,s){return this.matches(new Ov(t,n))||(n=sy.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,i,r,s)}updateFullNode(e,t,n){t.isLeafNode()&&(t=sy.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(sy.EMPTY_NODE);const r=this;return t.forEachChild(Jv,(e,t)=>{r.matches(new Ov(e,t))||(i=i.updateImmediateChild(e,sy.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class gy{constructor(e){this.withinDirectionalStart=e=>this.reverse_?this.withinEndPost(e):this.withinStartPost(e),this.withinDirectionalEnd=e=>this.reverse_?this.withinStartPost(e):this.withinEndPost(e),this.withinStartPost=e=>{const t=this.index_.compare(this.rangedFilter_.getStartPost(),e);return this.startIsInclusive_?t<=0:t<0},this.withinEndPost=e=>{const t=this.index_.compare(e,this.rangedFilter_.getEndPost());return this.endIsInclusive_?t<=0:t<0},this.rangedFilter_=new my(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,n,i,r,s){return this.rangedFilter_.matches(new Ov(t,n))||(n=sy.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,i,r,s):this.fullLimitUpdateChild_(e,t,n,r,s)}updateFullNode(e,t,n){let i;if(t.isLeafNode()||t.isEmpty())i=sy.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;i=sy.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;e.hasNext()&&n<this.limit_;){const t=e.getNext();if(this.withinDirectionalStart(t)){if(!this.withinDirectionalEnd(t))break;i=i.updateImmediateChild(t.name,t.node),n++}}}else{let e;i=t.withIndex(this.index_),i=i.updatePriority(sy.EMPTY_NODE),e=this.reverse_?i.getReverseIterator(this.index_):i.getIterator(this.index_);let n=0;for(;e.hasNext();){const t=e.getNext();n<this.limit_&&this.withinDirectionalStart(t)&&this.withinDirectionalEnd(t)?n++:i=i.updateImmediateChild(t.name,sy.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,n,i,r){let s;if(this.reverse_){const e=this.index_.getCompare();s=(t,n)=>e(n,t)}else s=this.index_.getCompare();const o=e;R(o.numChildren()===this.limit_,"");const a=new Ov(t,n),l=this.reverse_?o.getFirstChild(this.index_):o.getLastChild(this.index_),c=this.rangedFilter_.matches(a);if(o.hasChild(t)){const e=o.getImmediateChild(t);let u=i.getChildAfterChild(this.index_,l,this.reverse_);for(;null!=u&&(u.name===t||o.hasChild(u.name));)u=i.getChildAfterChild(this.index_,u,this.reverse_);const h=null==u?1:s(u,a);if(c&&!n.isEmpty()&&h>=0)return null!=r&&r.trackChildChange(fy(t,n,e)),o.updateImmediateChild(t,n);{null!=r&&r.trackChildChange(dy(t,e));const n=o.updateImmediateChild(t,sy.EMPTY_NODE);return null!=u&&this.rangedFilter_.matches(u)?(null!=r&&r.trackChildChange(hy(u.name,u.node)),n.updateImmediateChild(u.name,u.node)):n}}return n.isEmpty()?e:c&&s(l,a)>=0?(null!=r&&(r.trackChildChange(dy(l.name,l.node)),r.trackChildChange(hy(t,n))),o.updateImmediateChild(t,n).updateImmediateChild(l.name,sy.EMPTY_NODE)):e}}class _y{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Jv}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return R(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return R(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:A_}hasEnd(){return this.endSet_}getIndexEndValue(){return R(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return R(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:R_}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return R(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Jv}copy(){const e=new _y;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function vy(e){const t={};if(e.isDefault())return t;let n;if(e.index_===Jv?n="$priority":e.index_===cy?n="$value":e.index_===Fv?n="$key":(R(e.index_ instanceof ly,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=ce(n),e.startSet_){const n=e.startAfterSet_?"startAfter":"startAt";t[n]=ce(e.indexStartValue_),e.startNameSet_&&(t[n]+=","+ce(e.indexStartName_))}if(e.endSet_){const n=e.endBeforeSet_?"endBefore":"endAt";t[n]=ce(e.indexEndValue_),e.endNameSet_&&(t[n]+=","+ce(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function yy(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==Jv&&(t.i=e.index_.toString()),t}class wy extends dv{constructor(e,t,n,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=i,this.log_=S_("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:(R(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,n,i){const r=e._path.toString();this.log_("Listen called for "+r+" "+e._queryIdentifier);const s=wy.getListenId_(e,n),o={};this.listens_[s]=o;const a=vy(e._queryParams);this.restRequest_(r+".json",a,(e,t)=>{let a=t;if(404===e&&(a=null,e=null),null===e&&this.onDataUpdate_(r,a,!1,n),de(this.listens_,s)===o){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",i(t,null)}})}unlisten(e,t){const n=wy.getListenId_(e,t);delete this.listens_[n]}get(e){const t=vy(e._queryParams),n=e._path.toString(),i=new Q;return this.restRequest_(n+".json",t,(e,t)=>{let r=t;404===e&&(r=null,e=null),null===e?(this.onDataUpdate_(n,r,!1,null),i.resolve(r)):i.reject(new Error(r))}),i.promise}refreshAuthToken(e){}restRequest_(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(i=>{let[r,s]=i;r&&r.accessToken&&(t.auth=r.accessToken),s&&s.token&&(t.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+_e(t);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(n&&4===a.readyState){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let e=null;if(a.status>=200&&a.status<300){try{e=le(a.responseText)}catch(aC){P_("Failed to parse JSON response for "+o+": "+a.responseText)}n(null,e)}else 401!==a.status&&404!==a.status&&P_("Got unsuccessful REST response for "+o+" Status: "+a.status),n(a.status);n=null}},a.open("GET",o,!0),a.send()})}}class by{constructor(){this.rootNode_=sy.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function Ey(){return{value:null,children:new Map}}function Ty(e,t,n){if(Cv(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{const i=_v(t);e.children.has(i)||e.children.set(i,Ey());Ty(e.children.get(i),t=yv(t),n)}}function Cy(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach((e,n)=>{t(n,e)})}(e,(e,i)=>{Cy(i,new mv(t.toString()+"/"+e),n)})}class xy{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&F_(this.last_,(e,n)=>{t[e]=t[e]-n}),this.last_=e,t}}class Sy{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new xy(e);const n=1e4+2e4*Math.random();q_(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;F_(e,(e,i)=>{i>0&&he(this.statsToReport_,e)&&(t[e]=i,n=!0)}),n&&this.server_.reportStats(t),q_(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Iy;function ky(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Iy||(Iy={}));class Py{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=Iy.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(Cv(this.path)){if(null!=this.affectedTree.value)return R(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new mv(e));return new Py(gv(),t,this.revert)}}return R(_v(this.path)===e,"operationForChild called for unrelated child."),new Py(yv(this.path),this.affectedTree,this.revert)}}class Ny{constructor(e,t){this.source=e,this.path=t,this.type=Iy.LISTEN_COMPLETE}operationForChild(e){return Cv(this.path)?new Ny(this.source,gv()):new Ny(this.source,yv(this.path))}}class Ay{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=Iy.OVERWRITE}operationForChild(e){return Cv(this.path)?new Ay(this.source,gv(),this.snap.getImmediateChild(e)):new Ay(this.source,yv(this.path),this.snap)}}class Ry{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=Iy.MERGE}operationForChild(e){if(Cv(this.path)){const t=this.children.subtree(new mv(e));return t.isEmpty()?null:t.value?new Ay(this.source,gv(),t.value):new Ry(this.source,gv(),t)}return R(_v(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Ry(this.source,yv(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Ly{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Cv(e))return this.isFullyInitialized()&&!this.filtered_;const t=_v(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class Oy{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Dy(e,t,n,i,r,s){const o=i.filter(e=>e.type===n);o.sort((t,n)=>function(e,t,n){if(null==t.childName||null==n.childName)throw L("Should only compare child_ events.");const i=new Ov(t.childName,t.snapshotNode),r=new Ov(n.childName,n.snapshotNode);return e.index_.compare(i,r)}(e,t,n)),o.forEach(n=>{const i=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,s);r.forEach(r=>{r.respondsTo(n.type)&&t.push(r.createEvent(i,e.query_))})})}function My(e,t){return{eventCache:e,serverCache:t}}function jy(e,t,n,i){return My(new Ly(t,n,i),e.serverCache)}function Fy(e,t,n,i){return My(e.eventCache,new Ly(t,n,i))}function Uy(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function zy(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}let By;class Vy{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(By||(By=new Bv(O_)),By);this.value=e,this.children=t}static fromObject(e){let t=new Vy(null);return F_(e,(e,n)=>{t=t.set(new mv(e),n)}),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:gv(),value:this.value};if(Cv(e))return null;{const n=_v(e),i=this.children.get(n);if(null!==i){const r=i.findRootMostMatchingPathAndValue(yv(e),t);if(null!=r){return{path:Tv(new mv(n),r.path),value:r.value}}return null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Cv(e))return this;{const t=_v(e),n=this.children.get(t);return null!==n?n.subtree(yv(e)):new Vy(null)}}set(e,t){if(Cv(e))return new Vy(t,this.children);{const n=_v(e),i=(this.children.get(n)||new Vy(null)).set(yv(e),t),r=this.children.insert(n,i);return new Vy(this.value,r)}}remove(e){if(Cv(e))return this.children.isEmpty()?new Vy(null):new Vy(null,this.children);{const t=_v(e),n=this.children.get(t);if(n){const i=n.remove(yv(e));let r;return r=i.isEmpty()?this.children.remove(t):this.children.insert(t,i),null===this.value&&r.isEmpty()?new Vy(null):new Vy(this.value,r)}return this}}get(e){if(Cv(e))return this.value;{const t=_v(e),n=this.children.get(t);return n?n.get(yv(e)):null}}setTree(e,t){if(Cv(e))return t;{const n=_v(e),i=(this.children.get(n)||new Vy(null)).setTree(yv(e),t);let r;return r=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),new Vy(this.value,r)}}fold(e){return this.fold_(gv(),e)}fold_(e,t){const n={};return this.children.inorderTraversal((i,r)=>{n[i]=r.fold_(Tv(e,i),t)}),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,gv(),t)}findOnPath_(e,t,n){const i=!!this.value&&n(t,this.value);if(i)return i;if(Cv(e))return null;{const i=_v(e),r=this.children.get(i);return r?r.findOnPath_(yv(e),Tv(t,i),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,gv(),t)}foreachOnPath_(e,t,n){if(Cv(e))return this;{this.value&&n(t,this.value);const i=_v(e),r=this.children.get(i);return r?r.foreachOnPath_(yv(e),Tv(t,i),n):new Vy(null)}}foreach(e){this.foreach_(gv(),e)}foreach_(e,t){this.children.inorderTraversal((n,i)=>{i.foreach_(Tv(e,n),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,n)=>{n.value&&e(t,n.value)})}}class qy{constructor(e){this.writeTree_=e}static empty(){return new qy(new Vy(null))}}function Hy(e,t,n){if(Cv(t))return new qy(new Vy(n));{const i=e.writeTree_.findRootMostValueAndPath(t);if(null!=i){const r=i.path;let s=i.value;const o=xv(r,t);return s=s.updateChild(o,n),new qy(e.writeTree_.set(r,s))}{const i=new Vy(n),r=e.writeTree_.setTree(t,i);return new qy(r)}}}function Wy(e,t,n){let i=e;return F_(n,(e,n)=>{i=Hy(i,Tv(t,e),n)}),i}function Ky(e,t){if(Cv(t))return qy.empty();{const n=e.writeTree_.setTree(t,new Vy(null));return new qy(n)}}function Gy(e,t){return null!=Zy(e,t)}function Zy(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(xv(n.path,t)):null}function Qy(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(Jv,(e,n)=>{t.push(new Ov(e,n))}):e.writeTree_.children.inorderTraversal((e,n)=>{null!=n.value&&t.push(new Ov(e,n.value))}),t}function Yy(e,t){if(Cv(t))return e;{const n=Zy(e,t);return new qy(null!=n?new Vy(n):e.writeTree_.subtree(t))}}function Jy(e){return e.writeTree_.isEmpty()}function Xy(e,t){return $y(gv(),e.writeTree_,t)}function $y(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);{let i=null;return t.children.inorderTraversal((t,r)=>{".priority"===t?(R(null!==r.value,"Priority writes must always be leaf nodes"),i=r.value):n=$y(Tv(e,t),r,n)}),n.getChild(e).isEmpty()||null===i||(n=n.updateChild(Tv(e,".priority"),i)),n}}function ew(e,t){return fw(t,e)}function tw(e,t){const n=e.allWrites.findIndex(e=>e.writeId===t);R(n>=0,"removeWrite called with nonexistent writeId.");const i=e.allWrites[n];e.allWrites.splice(n,1);let r=i.visible,s=!1,o=e.allWrites.length-1;for(;r&&o>=0;){const t=e.allWrites[o];t.visible&&(o>=n&&nw(t,i.path)?r=!1:Iv(i.path,t.path)&&(s=!0)),o--}if(r){if(s)return function(e){e.visibleWrites=rw(e.allWrites,iw,gv()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0;if(i.snap)e.visibleWrites=Ky(e.visibleWrites,i.path);else{F_(i.children,t=>{e.visibleWrites=Ky(e.visibleWrites,Tv(i.path,t))})}return!0}return!1}function nw(e,t){if(e.snap)return Iv(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&Iv(Tv(e.path,n),t))return!0;return!1}function iw(e){return e.visible}function rw(e,t,n){let i=qy.empty();for(let r=0;r<e.length;++r){const s=e[r];if(t(s)){const e=s.path;let t;if(s.snap)Iv(n,e)?(t=xv(n,e),i=Hy(i,t,s.snap)):Iv(e,n)&&(t=xv(e,n),i=Hy(i,gv(),s.snap.getChild(t)));else{if(!s.children)throw L("WriteRecord should have .snap or .children");if(Iv(n,e))t=xv(n,e),i=Wy(i,t,s.children);else if(Iv(e,n))if(t=xv(e,n),Cv(t))i=Wy(i,gv(),s.children);else{const e=de(s.children,_v(t));if(e){const n=e.getChild(yv(t));i=Hy(i,gv(),n)}}}}}return i}function sw(e,t,n,i,r){if(i||r){const s=Yy(e.visibleWrites,t);if(!r&&Jy(s))return n;if(r||null!=n||Gy(s,gv())){const s=function(e){return(e.visible||r)&&(!i||!~i.indexOf(e.writeId))&&(Iv(e.path,t)||Iv(t,e.path))};return Xy(rw(e.allWrites,s,t),n||sy.EMPTY_NODE)}return null}{const i=Zy(e.visibleWrites,t);if(null!=i)return i;{const i=Yy(e.visibleWrites,t);if(Jy(i))return n;if(null!=n||Gy(i,gv())){return Xy(i,n||sy.EMPTY_NODE)}return null}}}function ow(e,t,n,i){return sw(e.writeTree,e.treePath,t,n,i)}function aw(e,t){return function(e,t,n){let i=sy.EMPTY_NODE;const r=Zy(e.visibleWrites,t);if(r)return r.isLeafNode()||r.forEachChild(Jv,(e,t)=>{i=i.updateImmediateChild(e,t)}),i;if(n){const r=Yy(e.visibleWrites,t);return n.forEachChild(Jv,(e,t)=>{const n=Xy(Yy(r,new mv(e)),t);i=i.updateImmediateChild(e,n)}),Qy(r).forEach(e=>{i=i.updateImmediateChild(e.name,e.node)}),i}return Qy(Yy(e.visibleWrites,t)).forEach(e=>{i=i.updateImmediateChild(e.name,e.node)}),i}(e.writeTree,e.treePath,t)}function lw(e,t,n,i){return function(e,t,n,i,r){R(i||r,"Either existingEventSnap or existingServerSnap must exist");const s=Tv(t,n);if(Gy(e.visibleWrites,s))return null;{const t=Yy(e.visibleWrites,s);return Jy(t)?r.getChild(n):Xy(t,r.getChild(n))}}(e.writeTree,e.treePath,t,n,i)}function cw(e,t){return function(e,t){return Zy(e.visibleWrites,t)}(e.writeTree,Tv(e.treePath,t))}function uw(e,t,n,i,r,s){return function(e,t,n,i,r,s,o){let a;const l=Yy(e.visibleWrites,t),c=Zy(l,gv());if(null!=c)a=c;else{if(null==n)return[];a=Xy(l,n)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const e=[],t=o.getCompare(),n=s?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o);let l=n.getNext();for(;l&&e.length<r;)0!==t(l,i)&&e.push(l),l=n.getNext();return e}}(e.writeTree,e.treePath,t,n,i,r,s)}function hw(e,t,n){return function(e,t,n,i){const r=Tv(t,n),s=Zy(e.visibleWrites,r);if(null!=s)return s;if(i.isCompleteForChild(n))return Xy(Yy(e.visibleWrites,r),i.getNode().getImmediateChild(n));return null}(e.writeTree,e.treePath,t,n)}function dw(e,t){return fw(Tv(e.treePath,t),e.writeTree)}function fw(e,t){return{treePath:e,writeTree:t}}class pw{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,n=e.childName;R("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),R(".priority"!==n,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(n);if(i){const r=i.type;if("child_added"===t&&"child_removed"===r)this.changeMap.set(n,fy(n,e.snapshotNode,i.snapshotNode));else if("child_removed"===t&&"child_added"===r)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===r)this.changeMap.set(n,dy(n,i.oldSnap));else if("child_changed"===t&&"child_added"===r)this.changeMap.set(n,hy(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==r)throw L("Illegal combination of changes: "+e+" occurred after "+i);this.changeMap.set(n,fy(n,e.snapshotNode,i.oldSnap))}}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}const mw=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}};class gw{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new Ly(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return hw(this.writes_,e,t)}}getChildAfterChild(e,t,n){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:zy(this.viewCache_),r=uw(this.writes_,i,t,1,n,e);return 0===r.length?null:r[0]}}function _w(e,t,n,i,r){const s=new pw;let o,a;if(n.type===Iy.OVERWRITE){const l=n;l.source.fromUser?o=ww(e,t,l.path,l.snap,i,r,s):(R(l.source.fromServer,"Unknown source."),a=l.source.tagged||t.serverCache.isFiltered()&&!Cv(l.path),o=yw(e,t,l.path,l.snap,i,r,a,s))}else if(n.type===Iy.MERGE){const l=n;l.source.fromUser?o=function(e,t,n,i,r,s,o){let a=t;return i.foreach((i,l)=>{const c=Tv(n,i);bw(t,_v(c))&&(a=ww(e,a,c,l,r,s,o))}),i.foreach((i,l)=>{const c=Tv(n,i);bw(t,_v(c))||(a=ww(e,a,c,l,r,s,o))}),a}(e,t,l.path,l.children,i,r,s):(R(l.source.fromServer,"Unknown source."),a=l.source.tagged||t.serverCache.isFiltered(),o=Tw(e,t,l.path,l.children,i,r,a,s))}else if(n.type===Iy.ACK_USER_WRITE){const a=n;o=a.revert?function(e,t,n,i,r,s){let o;if(null!=cw(i,n))return t;{const a=new gw(i,t,r),l=t.eventCache.getNode();let c;if(Cv(n)||".priority"===_v(n)){let n;if(t.serverCache.isFullyInitialized())n=ow(i,zy(t));else{const e=t.serverCache.getNode();R(e instanceof sy,"serverChildren would be complete if leaf node"),n=aw(i,e)}c=e.filter.updateFullNode(l,n,s)}else{const r=_v(n);let u=hw(i,r,t.serverCache);null==u&&t.serverCache.isCompleteForChild(r)&&(u=l.getImmediateChild(r)),c=null!=u?e.filter.updateChild(l,r,u,yv(n),a,s):t.eventCache.getNode().hasChild(r)?e.filter.updateChild(l,r,sy.EMPTY_NODE,yv(n),a,s):l,c.isEmpty()&&t.serverCache.isFullyInitialized()&&(o=ow(i,zy(t)),o.isLeafNode()&&(c=e.filter.updateFullNode(c,o,s)))}return o=t.serverCache.isFullyInitialized()||null!=cw(i,gv()),jy(t,c,o,e.filter.filtersNodes())}}(e,t,a.path,i,r,s):function(e,t,n,i,r,s,o){if(null!=cw(r,n))return t;const a=t.serverCache.isFiltered(),l=t.serverCache;if(null!=i.value){if(Cv(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return yw(e,t,n,l.getNode().getChild(n),r,s,a,o);if(Cv(n)){let i=new Vy(null);return l.getNode().forEachChild(Fv,(e,t)=>{i=i.set(new mv(e),t)}),Tw(e,t,n,i,r,s,a,o)}return t}{let c=new Vy(null);return i.foreach((e,t)=>{const i=Tv(n,e);l.isCompleteForPath(i)&&(c=c.set(e,l.getNode().getChild(i)))}),Tw(e,t,n,c,r,s,a,o)}}(e,t,a.path,a.affectedTree,i,r,s)}else{if(n.type!==Iy.LISTEN_COMPLETE)throw L("Unknown operation type: "+n.type);o=function(e,t,n,i,r){const s=t.serverCache,o=Fy(t,s.getNode(),s.isFullyInitialized()||Cv(n),s.isFiltered());return vw(e,o,n,i,mw,r)}(e,t,n.path,i,s)}const l=s.getChanges();return function(e,t,n){const i=t.eventCache;if(i.isFullyInitialized()){const r=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=Uy(e);(n.length>0||!e.eventCache.isFullyInitialized()||r&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&n.push(uy(Uy(t)))}}(t,o,l),{viewCache:o,changes:l}}function vw(e,t,n,i,r,s){const o=t.eventCache;if(null!=cw(i,n))return t;{let a,l;if(Cv(n))if(R(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const n=zy(t),r=aw(i,n instanceof sy?n:sy.EMPTY_NODE);a=e.filter.updateFullNode(t.eventCache.getNode(),r,s)}else{const n=ow(i,zy(t));a=e.filter.updateFullNode(t.eventCache.getNode(),n,s)}else{const c=_v(n);if(".priority"===c){R(1===vv(n),"Can't have a priority with additional path components");const r=o.getNode();l=t.serverCache.getNode();const s=lw(i,n,r,l);a=null!=s?e.filter.updatePriority(r,s):o.getNode()}else{const u=yv(n);let h;if(o.isCompleteForChild(c)){l=t.serverCache.getNode();const e=lw(i,n,o.getNode(),l);h=null!=e?o.getNode().getImmediateChild(c).updateChild(u,e):o.getNode().getImmediateChild(c)}else h=hw(i,c,t.serverCache);a=null!=h?e.filter.updateChild(o.getNode(),c,h,u,r,s):o.getNode()}}return jy(t,a,o.isFullyInitialized()||Cv(n),e.filter.filtersNodes())}}function yw(e,t,n,i,r,s,o,a){const l=t.serverCache;let c;const u=o?e.filter:e.filter.getIndexedFilter();if(Cv(n))c=u.updateFullNode(l.getNode(),i,null);else if(u.filtersNodes()&&!l.isFiltered()){const e=l.getNode().updateChild(n,i);c=u.updateFullNode(l.getNode(),e,null)}else{const e=_v(n);if(!l.isCompleteForPath(n)&&vv(n)>1)return t;const r=yv(n),s=l.getNode().getImmediateChild(e).updateChild(r,i);c=".priority"===e?u.updatePriority(l.getNode(),s):u.updateChild(l.getNode(),e,s,r,mw,null)}const h=Fy(t,c,l.isFullyInitialized()||Cv(n),u.filtersNodes());return vw(e,h,n,r,new gw(r,h,s),a)}function ww(e,t,n,i,r,s,o){const a=t.eventCache;let l,c;const u=new gw(r,t,s);if(Cv(n))c=e.filter.updateFullNode(t.eventCache.getNode(),i,o),l=jy(t,c,!0,e.filter.filtersNodes());else{const r=_v(n);if(".priority"===r)c=e.filter.updatePriority(t.eventCache.getNode(),i),l=jy(t,c,a.isFullyInitialized(),a.isFiltered());else{const s=yv(n),c=a.getNode().getImmediateChild(r);let h;if(Cv(s))h=i;else{const e=u.getCompleteChild(r);h=null!=e?".priority"===wv(s)&&e.getChild(Ev(s)).isEmpty()?e:e.updateChild(s,i):sy.EMPTY_NODE}if(c.equals(h))l=t;else{l=jy(t,e.filter.updateChild(a.getNode(),r,h,s,u,o),a.isFullyInitialized(),e.filter.filtersNodes())}}}return l}function bw(e,t){return e.eventCache.isCompleteForChild(t)}function Ew(e,t,n){return n.foreach((e,n)=>{t=t.updateChild(e,n)}),t}function Tw(e,t,n,i,r,s,o,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let l,c=t;l=Cv(n)?i:new Vy(null).setTree(n,i);const u=t.serverCache.getNode();return l.children.inorderTraversal((n,i)=>{if(u.hasChild(n)){const l=Ew(0,t.serverCache.getNode().getImmediateChild(n),i);c=yw(e,c,new mv(n),l,r,s,o,a)}}),l.children.inorderTraversal((n,i)=>{const l=!t.serverCache.isCompleteForChild(n)&&null===i.value;if(!u.hasChild(n)&&!l){const l=Ew(0,t.serverCache.getNode().getImmediateChild(n),i);c=yw(e,c,new mv(n),l,r,s,o,a)}}),c}class Cw{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,i=new py(n.getIndex()),r=(s=n).loadsAllData()?new py(s.getIndex()):s.hasLimit()?new gy(s):new my(s);var s;this.processor_=function(e){return{filter:e}}(r);const o=t.serverCache,a=t.eventCache,l=i.updateFullNode(sy.EMPTY_NODE,o.getNode(),null),c=r.updateFullNode(sy.EMPTY_NODE,a.getNode(),null),u=new Ly(l,o.isFullyInitialized(),i.filtersNodes()),h=new Ly(c,a.isFullyInitialized(),r.filtersNodes());this.viewCache_=My(h,u),this.eventGenerator_=new Oy(this.query_)}get query(){return this.query_}}function xw(e,t){const n=zy(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!Cv(t)&&!n.getImmediateChild(_v(t)).isEmpty())?n.getChild(t):null}function Sw(e){return 0===e.eventRegistrations_.length}function Iw(e,t,n){const i=[];if(n){R(null==t,"A cancel should cancel all event registrations.");const r=e.query._path;e.eventRegistrations_.forEach(e=>{const t=e.createCancelEvent(n,r);t&&i.push(t)})}if(t){let n=[];for(let i=0;i<e.eventRegistrations_.length;++i){const r=e.eventRegistrations_[i];if(r.matches(t)){if(t.hasAnyCallback()){n=n.concat(e.eventRegistrations_.slice(i+1));break}}else n.push(r)}e.eventRegistrations_=n}else e.eventRegistrations_=[];return i}function kw(e,t,n,i){t.type===Iy.MERGE&&null!==t.source.queryId&&(R(zy(e.viewCache_),"We should always have a full cache before handling merges"),R(Uy(e.viewCache_),"Missing event cache, even though we have a server cache"));const r=e.viewCache_,s=_w(e.processor_,r,t,n,i);var o,a;return o=e.processor_,a=s.viewCache,R(a.eventCache.getNode().isIndexed(o.filter.getIndex()),"Event snap not indexed"),R(a.serverCache.getNode().isIndexed(o.filter.getIndex()),"Server snap not indexed"),R(s.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=s.viewCache,Pw(e,s.changes,s.viewCache.eventCache.getNode(),null)}function Pw(e,t,n,i){const r=i?[i]:e.eventRegistrations_;return function(e,t,n,i){const r=[],s=[];return t.forEach(t=>{var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&s.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))}),Dy(e,r,"child_removed",t,i,n),Dy(e,r,"child_added",t,i,n),Dy(e,r,"child_moved",s,i,n),Dy(e,r,"child_changed",t,i,n),Dy(e,r,"value",t,i,n),r}(e.eventGenerator_,t,n,r)}let Nw,Aw;class Rw{constructor(){this.views=new Map}}function Lw(e,t,n,i){const r=t.source.queryId;if(null!==r){const s=e.views.get(r);return R(null!=s,"SyncTree gave us an op for an invalid query."),kw(s,t,n,i)}{let r=[];for(const s of e.views.values())r=r.concat(kw(s,t,n,i));return r}}function Ow(e,t,n,i,r){const s=t._queryIdentifier,o=e.views.get(s);if(!o){let e=ow(n,r?i:null),s=!1;e?s=!0:i instanceof sy?(e=aw(n,i),s=!1):(e=sy.EMPTY_NODE,s=!1);const o=My(new Ly(e,s,!1),new Ly(i,r,!1));return new Cw(t,o)}return o}function Dw(e,t,n,i,r,s){const o=Ow(e,t,i,r,s);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,o),function(e,t){e.eventRegistrations_.push(t)}(o,n),function(e,t){const n=e.viewCache_.eventCache,i=[];n.getNode().isLeafNode()||n.getNode().forEachChild(Jv,(e,t)=>{i.push(hy(e,t))});return n.isFullyInitialized()&&i.push(uy(n.getNode())),Pw(e,i,n.getNode(),t)}(o,n)}function Mw(e,t,n,i){const r=t._queryIdentifier,s=[];let o=[];const a=Bw(e);if("default"===r)for(const[l,c]of e.views.entries())o=o.concat(Iw(c,n,i)),Sw(c)&&(e.views.delete(l),c.query._queryParams.loadsAllData()||s.push(c.query));else{const t=e.views.get(r);t&&(o=o.concat(Iw(t,n,i)),Sw(t)&&(e.views.delete(r),t.query._queryParams.loadsAllData()||s.push(t.query)))}return a&&!Bw(e)&&s.push(new(R(Nw,"Reference.ts has not been loaded"),Nw)(t._repo,t._path)),{removed:s,events:o}}function jw(e){const t=[];for(const n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function Fw(e,t){let n=null;for(const i of e.views.values())n=n||xw(i,t);return n}function Uw(e,t){if(t._queryParams.loadsAllData())return Vw(e);{const n=t._queryIdentifier;return e.views.get(n)}}function zw(e,t){return null!=Uw(e,t)}function Bw(e){return null!=Vw(e)}function Vw(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}let qw=1;class Hw{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Vy(null),this.pendingWriteTree_={visibleWrites:qy.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Ww(e,t,n,i,r){return function(e,t,n,i,r){R(i>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),e.allWrites.push({path:t,snap:n,writeId:i,visible:r}),r&&(e.visibleWrites=Hy(e.visibleWrites,t,n)),e.lastWriteId=i}(e.pendingWriteTree_,t,n,i,r),r?Xw(e,new Ay({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function Kw(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=function(e,t){for(let n=0;n<e.allWrites.length;n++){const i=e.allWrites[n];if(i.writeId===t)return i}return null}(e.pendingWriteTree_,t);if(tw(e.pendingWriteTree_,t)){let t=new Vy(null);return null!=i.snap?t=t.set(gv(),!0):F_(i.children,e=>{t=t.set(new mv(e),!0)}),Xw(e,new Py(i.path,t,n))}return[]}function Gw(e,t,n){return Xw(e,new Ay({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function Zw(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const s=t._path,o=e.syncPointTree_.get(s);let a=[];if(o&&("default"===t._queryIdentifier||zw(o,t))){const l=Mw(o,t,n,i);0===o.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(s));const c=l.removed;if(a=l.events,!r){const n=-1!==c.findIndex(e=>e._queryParams.loadsAllData()),r=e.syncPointTree_.findOnPath(s,(e,t)=>Bw(t));if(n&&!r){const t=e.syncPointTree_.subtree(s);if(!t.isEmpty()){const n=function(e){return e.fold((e,t,n)=>{if(t&&Bw(t)){return[Vw(t)]}{let e=[];return t&&(e=jw(t)),F_(n,(t,n)=>{e=e.concat(n)}),e}})}(t);for(let t=0;t<n.length;++t){const i=n[t],r=i.query,s=tb(e,i);e.listenProvider_.startListening(ab(r),nb(e,r),s.hashFn,s.onComplete)}}}if(!r&&c.length>0&&!i)if(n){const n=null;e.listenProvider_.stopListening(ab(t),n)}else c.forEach(t=>{const n=e.queryToTagMap.get(ib(t));e.listenProvider_.stopListening(ab(t),n)})}!function(e,t){for(let n=0;n<t.length;++n){const i=t[n];if(!i._queryParams.loadsAllData()){const t=ib(i),n=e.queryToTagMap.get(t);e.queryToTagMap.delete(t),e.tagToQueryMap.delete(n)}}}(e,c)}return a}function Qw(e,t,n,i){const r=rb(e,i);if(null!=r){const i=sb(r),s=i.path,o=i.queryId,a=xv(s,t);return ob(e,s,new Ay(ky(o),a,n))}return[]}function Yw(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=t._path;let s=null,o=!1;e.syncPointTree_.foreachOnPath(r,(e,t)=>{const n=xv(e,r);s=s||Fw(t,n),o=o||Bw(t)});let a,l=e.syncPointTree_.get(r);if(l?(o=o||Bw(l),s=s||Fw(l,gv())):(l=new Rw,e.syncPointTree_=e.syncPointTree_.set(r,l)),null!=s)a=!0;else{a=!1,s=sy.EMPTY_NODE;e.syncPointTree_.subtree(r).foreachChild((e,t)=>{const n=Fw(t,gv());n&&(s=s.updateImmediateChild(e,n))})}const c=zw(l,t);if(!c&&!t._queryParams.loadsAllData()){const n=ib(t);R(!e.queryToTagMap.has(n),"View does not exist, but we have a tag");const i=qw++;e.queryToTagMap.set(n,i),e.tagToQueryMap.set(i,n)}let u=Dw(l,t,n,ew(e.pendingWriteTree_,r),s,a);if(!c&&!o&&!i){const n=Uw(l,t);u=u.concat(function(e,t,n){const i=t._path,r=nb(e,t),s=tb(e,n),o=e.listenProvider_.startListening(ab(t),r,s.hashFn,s.onComplete),a=e.syncPointTree_.subtree(i);if(r)R(!Bw(a.value),"If we're adding a query, it shouldn't be shadowed");else{const t=a.fold((e,t,n)=>{if(!Cv(e)&&t&&Bw(t))return[Vw(t).query];{let e=[];return t&&(e=e.concat(jw(t).map(e=>e.query))),F_(n,(t,n)=>{e=e.concat(n)}),e}});for(let n=0;n<t.length;++n){const i=t[n];e.listenProvider_.stopListening(ab(i),nb(e,i))}}return o}(e,t,n))}return u}function Jw(e,t,n){const i=e.pendingWriteTree_,r=e.syncPointTree_.findOnPath(t,(e,n)=>{const i=Fw(n,xv(e,t));if(i)return i});return sw(i,t,r,n,!0)}function Xw(e,t){return $w(t,e.syncPointTree_,null,ew(e.pendingWriteTree_,gv()))}function $w(e,t,n,i){if(Cv(e.path))return eb(e,t,n,i);{const r=t.get(gv());null==n&&null!=r&&(n=Fw(r,gv()));let s=[];const o=_v(e.path),a=e.operationForChild(o),l=t.children.get(o);if(l&&a){const e=n?n.getImmediateChild(o):null,t=dw(i,o);s=s.concat($w(a,l,e,t))}return r&&(s=s.concat(Lw(r,e,i,n))),s}}function eb(e,t,n,i){const r=t.get(gv());null==n&&null!=r&&(n=Fw(r,gv()));let s=[];return t.children.inorderTraversal((t,r)=>{const o=n?n.getImmediateChild(t):null,a=dw(i,t),l=e.operationForChild(t);l&&(s=s.concat(eb(l,r,o,a)))}),r&&(s=s.concat(Lw(r,e,i,n))),s}function tb(e,t){const n=t.query,i=nb(e,n);return{hashFn:()=>{const e=function(e){return e.viewCache_.serverCache.getNode()}(t)||sy.EMPTY_NODE;return e.hash()},onComplete:t=>{if("ok"===t)return i?function(e,t,n){const i=rb(e,n);if(i){const n=sb(i),r=n.path,s=n.queryId,o=xv(r,t);return ob(e,r,new Ny(ky(s),o))}return[]}(e,n._path,i):function(e,t){return Xw(e,new Ny({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);{const i=function(e,t){let n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");const i=new Error(e+" at "+t._path.toString()+": "+n);return i.code=e.toUpperCase(),i}(t,n);return Zw(e,n,null,i)}}}}function nb(e,t){const n=ib(t);return e.queryToTagMap.get(n)}function ib(e){return e._path.toString()+"$"+e._queryIdentifier}function rb(e,t){return e.tagToQueryMap.get(t)}function sb(e){const t=e.indexOf("$");return R(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new mv(e.substr(0,t))}}function ob(e,t,n){const i=e.syncPointTree_.get(t);R(i,"Missing sync point for query tag that we're tracking");return Lw(i,n,ew(e.pendingWriteTree_,t),null)}function ab(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(R(Aw,"Reference.ts has not been loaded"),Aw)(e._repo,e._path):e}class lb{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new lb(t)}node(){return this.node_}}class cb{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Tv(this.path_,e);return new cb(this.syncTree_,t)}node(){return Jw(this.syncTree_,this.path_)}}const ub=function(e,t,n){return e&&"object"===typeof e?(R(".sv"in e,"Unexpected leaf node or priority contents"),"string"===typeof e[".sv"]?hb(e[".sv"],t,n):"object"===typeof e[".sv"]?db(e[".sv"],t):void R(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},hb=function(e,t,n){if("timestamp"===e)return n.timestamp;R(!1,"Unexpected server value: "+e)},db=function(e,t,n){e.hasOwnProperty("increment")||R(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const i=e.increment;"number"!==typeof i&&R(!1,"Unexpected increment value: "+i);const r=t.node();if(R(null!==r&&"undefined"!==typeof r,"Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;const s=r.getValue();return"number"!==typeof s?i:s+i},fb=function(e,t,n,i){return mb(t,new cb(n,e),i)},pb=function(e,t,n){return mb(e,new lb(t),n)};function mb(e,t,n){const i=e.getPriority().val(),r=ub(i,t.getImmediateChild(".priority"),n);let s;if(e.isLeafNode()){const i=e,s=ub(i.getValue(),t,n);return s!==i.getValue()||r!==i.getPriority().val()?new Yv(s,ay(r)):e}{const i=e;return s=i,r!==i.getPriority().val()&&(s=s.updatePriority(new Yv(r))),i.forEachChild(Jv,(e,i)=>{const r=mb(i,t.getImmediateChild(e),n);r!==i&&(s=s.updateImmediateChild(e,r))}),s}}class gb{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{children:{},childCount:0};this.name=e,this.parent=t,this.node=n}}function _b(e,t){let n=t instanceof mv?t:new mv(t),i=e,r=_v(n);for(;null!==r;){const e=de(i.node.children,r)||{children:{},childCount:0};i=new gb(r,i,e),n=yv(n),r=_v(n)}return i}function vb(e){return e.node.value}function yb(e,t){e.node.value=t,Cb(e)}function wb(e){return e.node.childCount>0}function bb(e,t){F_(e.node.children,(n,i)=>{t(new gb(n,e,i))})}function Eb(e,t,n,i){n&&!i&&t(e),bb(e,e=>{Eb(e,t,!0,i)}),n&&i&&t(e)}function Tb(e){return new mv(null===e.parent?e.name:Tb(e.parent)+"/"+e.name)}function Cb(e){null!==e.parent&&function(e,t,n){const i=function(e){return void 0===vb(e)&&!wb(e)}(n),r=he(e.node.children,t);i&&r?(delete e.node.children[t],e.node.childCount--,Cb(e)):i||r||(e.node.children[t]=n.node,e.node.childCount++,Cb(e))}(e.parent,e.name,e)}const xb=/[\[\].#$\/\u0000-\u001F\u007F]/,Sb=/[\[\].#$\u0000-\u001F\u007F]/,Ib=10485760,kb=function(e){return"string"===typeof e&&0!==e.length&&!xb.test(e)},Pb=function(e){return"string"===typeof e&&0!==e.length&&!Sb.test(e)},Nb=function(e,t,n){const i=n instanceof mv?new kv(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+Nv(i));if("function"===typeof t)throw new Error(e+"contains a function "+Nv(i)+" with contents = "+t.toString());if(N_(t))throw new Error(e+"contains "+t.toString()+" "+Nv(i));if("string"===typeof t&&t.length>Ib/3&&Ce(t)>Ib)throw new Error(e+"contains a string greater than "+Ib+" utf8 bytes "+Nv(i)+" ('"+t.substring(0,50)+"...')");if(t&&"object"===typeof t){let n=!1,r=!1;if(F_(t,(t,s)=>{if(".value"===t)n=!0;else if(".priority"!==t&&".sv"!==t&&(r=!0,!kb(t)))throw new Error(e+" contains an invalid key ("+t+") "+Nv(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=Ce(t),Pv(e)}(i,t),Nb(e,s,i),function(e){const t=e.parts_.pop();e.byteLength_-=Ce(t),e.parts_.length>0&&(e.byteLength_-=1)}(i)}),n&&r)throw new Error(e+' contains ".value" child '+Nv(i)+" in addition to actual children.")}},Ab=function(e,t,n,i){if((!i||void 0!==n)&&!Pb(n))throw new Error(Te(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Rb=function(e,t){const n=t.path.toString();if("string"!==typeof t.repoInfo.host||0===t.repoInfo.host.length||!kb(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Pb(e)}(n))throw new Error(Te(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class Lb{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Ob(e,t){let n=null;for(let i=0;i<t.length;i++){const r=t[i],s=r.getPath();null===n||Sv(s,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:s}),n.events.push(r)}n&&e.eventLists_.push(n)}function Db(e,t,n){Ob(e,n),jb(e,e=>Sv(e,t))}function Mb(e,t,n){Ob(e,n),jb(e,e=>Iv(e,t)||Iv(t,e))}function jb(e,t){e.recursionDepth_++;let n=!0;for(let i=0;i<e.eventLists_.length;i++){const r=e.eventLists_[i];if(r){t(r.path)?(Fb(e.eventLists_[i]),e.eventLists_[i]=null):n=!1}}n&&(e.eventLists_=[]),e.recursionDepth_--}function Fb(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(null!==n){e.events[t]=null;const i=n.getEventRunner();E_&&x_("event: "+n.toString()),V_(i)}}}const Ub="repo_interrupt";class zb{constructor(e,t,n,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Lb,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Ey(),this.transactionQueueTree_=new gb,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function Bb(e,t,n){if(e.stats_=iv(e.repoInfo_),e.forceRestClient_||("object"===typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new wy(e.repoInfo_,(t,n,i,r)=>{Hb(e,t,n,i,r)},e.authTokenProvider_,e.appCheckProvider_),setTimeout(()=>Wb(e,!0),0);else{if("undefined"!==typeof n&&null!==n){if("object"!==typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{ce(n)}catch(aC){throw new Error("Invalid authOverride provided: "+aC)}}e.persistentConnection_=new Lv(e.repoInfo_,t,(t,n,i,r)=>{Hb(e,t,n,i,r)},t=>{Wb(e,t)},t=>{!function(e,t){F_(t,(t,n)=>{Kb(e,t,n)})}(e,t)},e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener(t=>{e.server_.refreshAuthToken(t)}),e.appCheckProvider_.addTokenChangeListener(t=>{e.server_.refreshAppCheckToken(t.token)}),e.statsReporter_=function(e,t){const n=e.toString();return nv[n]||(nv[n]=t()),nv[n]}(e.repoInfo_,()=>new Sy(e.stats_,e.server_)),e.infoData_=new by,e.infoSyncTree_=new Hw({startListening:(t,n,i,r)=>{let s=[];const o=e.infoData_.getNode(t._path);return o.isEmpty()||(s=Gw(e.infoSyncTree_,t._path,o),setTimeout(()=>{r("ok")},0)),s},stopListening:()=>{}}),Kb(e,"connected",!1),e.serverSyncTree_=new Hw({startListening:(t,n,i,r)=>(e.server_.listen(t,i,n,(n,i)=>{const s=r(n,i);Mb(e.eventQueue_,t._path,s)}),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}function Vb(e){const t=e.infoData_.getNode(new mv(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function qb(e){return(t=(t={timestamp:Vb(e)})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t}function Hb(e,t,n,i,r){e.dataUpdateCount++;const s=new mv(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let o=[];if(r)if(i){const t=pe(n,e=>ay(e));o=function(e,t,n,i){const r=rb(e,i);if(r){const i=sb(r),s=i.path,o=i.queryId,a=xv(s,t),l=Vy.fromObject(n);return ob(e,s,new Ry(ky(o),a,l))}return[]}(e.serverSyncTree_,s,t,r)}else{const t=ay(n);o=Qw(e.serverSyncTree_,s,t,r)}else if(i){const t=pe(n,e=>ay(e));o=function(e,t,n){const i=Vy.fromObject(n);return Xw(e,new Ry({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,i))}(e.serverSyncTree_,s,t)}else{const t=ay(n);o=Gw(e.serverSyncTree_,s,t)}let a=s;o.length>0&&(a=$b(e,s)),Mb(e.eventQueue_,a,o)}function Wb(e,t){Kb(e,"connected",t),!1===t&&function(e){Yb(e,"onDisconnectEvents");const t=qb(e),n=Ey();Cy(e.onDisconnect_,gv(),(i,r)=>{const s=fb(i,r,e.serverSyncTree_,t);Ty(n,i,s)});let i=[];Cy(n,gv(),(t,n)=>{i=i.concat(Gw(e.serverSyncTree_,t,n));const r=rE(e,t);$b(e,r)}),e.onDisconnect_=Ey(),Mb(e.eventQueue_,gv(),i)}(e)}function Kb(e,t,n){const i=new mv("/.info/"+t),r=ay(n);e.infoData_.updateSnapshot(i,r);const s=Gw(e.infoSyncTree_,i,r);Mb(e.eventQueue_,i,s)}function Gb(e){return e.nextWriteId_++}function Zb(e,t,n){let i;i=".info"===_v(t._path)?Zw(e.infoSyncTree_,t,n):Zw(e.serverSyncTree_,t,n),Db(e.eventQueue_,t._path,i)}function Qb(e){e.persistentConnection_&&e.persistentConnection_.interrupt(Ub)}function Yb(e){let t="";e.persistentConnection_&&(t=e.persistentConnection_.id+":");for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];x_(t,...i)}function Jb(e,t,n){return Jw(e.serverSyncTree_,t,n)||sy.EMPTY_NODE}function Xb(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.transactionQueueTree_;if(t||iE(e,t),vb(t)){const n=tE(e,t);R(n.length>0,"Sending zero length transaction queue");n.every(e=>0===e.status)&&function(e,t,n){const i=n.map(e=>e.currentWriteId),r=Jb(e,t,i);let s=r;const o=r.hash();for(let c=0;c<n.length;c++){const e=n[c];R(0===e.status,"tryToSendTransactionQueue_: items in queue should all be run."),e.status=1,e.retryCount++;const i=xv(t,e.path);s=s.updateChild(i,e.currentOutputSnapshotRaw)}const a=s.val(!0),l=t;e.server_.put(l.toString(),a,i=>{Yb(e,"transaction put response",{path:l.toString(),status:i});let r=[];if("ok"===i){const i=[];for(let t=0;t<n.length;t++)n[t].status=2,r=r.concat(Kw(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&i.push(()=>n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved)),n[t].unwatcher();iE(e,_b(e.transactionQueueTree_,t)),Xb(e,e.transactionQueueTree_),Mb(e.eventQueue_,t,r);for(let e=0;e<i.length;e++)V_(i[e])}else{if("datastale"===i)for(let e=0;e<n.length;e++)3===n[e].status?n[e].status=4:n[e].status=0;else{P_("transaction at "+l.toString()+" failed: "+i);for(let e=0;e<n.length;e++)n[e].status=4,n[e].abortReason=i}$b(e,t)}},o)}(e,Tb(t),n)}else wb(t)&&bb(t,t=>{Xb(e,t)})}function $b(e,t){const n=eE(e,t),i=Tb(n);return function(e,t,n){if(0===t.length)return;const i=[];let r=[];const s=t.filter(e=>0===e.status),o=s.map(e=>e.currentWriteId);for(let a=0;a<t.length;a++){const s=t[a],l=xv(n,s.path);let c,u=!1;if(R(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),4===s.status)u=!0,c=s.abortReason,r=r.concat(Kw(e.serverSyncTree_,s.currentWriteId,!0));else if(0===s.status)if(s.retryCount>=25)u=!0,c="maxretry",r=r.concat(Kw(e.serverSyncTree_,s.currentWriteId,!0));else{const n=Jb(e,s.path,o);s.currentInputSnapshot=n;const i=t[a].update(n.val());if(void 0!==i){Nb("transaction failed: Data returned ",i,s.path);let t=ay(i);"object"===typeof i&&null!=i&&he(i,".priority")||(t=t.updatePriority(n.getPriority()));const a=s.currentWriteId,l=qb(e),c=pb(t,n,l);s.currentOutputSnapshotRaw=t,s.currentOutputSnapshotResolved=c,s.currentWriteId=Gb(e),o.splice(o.indexOf(a),1),r=r.concat(Ww(e.serverSyncTree_,s.path,c,s.currentWriteId,s.applyLocally)),r=r.concat(Kw(e.serverSyncTree_,a,!0))}else u=!0,c="nodata",r=r.concat(Kw(e.serverSyncTree_,s.currentWriteId,!0))}Mb(e.eventQueue_,n,r),r=[],u&&(t[a].status=2,function(e){setTimeout(e,Math.floor(0))}(t[a].unwatcher),t[a].onComplete&&("nodata"===c?i.push(()=>t[a].onComplete(null,!1,t[a].currentInputSnapshot)):i.push(()=>t[a].onComplete(new Error(c),!1,null))))}iE(e,e.transactionQueueTree_);for(let a=0;a<i.length;a++)V_(i[a]);Xb(e,e.transactionQueueTree_)}(e,tE(e,n),i),i}function eE(e,t){let n,i=e.transactionQueueTree_;for(n=_v(t);null!==n&&void 0===vb(i);)i=_b(i,n),n=_v(t=yv(t));return i}function tE(e,t){const n=[];return nE(e,t,n),n.sort((e,t)=>e.order-t.order),n}function nE(e,t,n){const i=vb(t);if(i)for(let r=0;r<i.length;r++)n.push(i[r]);bb(t,t=>{nE(e,t,n)})}function iE(e,t){const n=vb(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,yb(t,n.length>0?n:void 0)}bb(t,t=>{iE(e,t)})}function rE(e,t){const n=Tb(eE(e,t)),i=_b(e.transactionQueueTree_,t);return function(e,t,n){let i=n?e:e.parent;for(;null!==i;){if(t(i))return!0;i=i.parent}}(i,t=>{sE(e,t)}),sE(e,i),Eb(i,t=>{sE(e,t)}),n}function sE(e,t){const n=vb(t);if(n){const i=[];let r=[],s=-1;for(let t=0;t<n.length;t++)3===n[t].status||(1===n[t].status?(R(s===t-1,"All SENT items should be at beginning of queue."),s=t,n[t].status=3,n[t].abortReason="set"):(R(0===n[t].status,"Unexpected transaction status in abort"),n[t].unwatcher(),r=r.concat(Kw(e.serverSyncTree_,n[t].currentWriteId,!0)),n[t].onComplete&&i.push(n[t].onComplete.bind(null,new Error("set"),!1,null))));-1===s?yb(t,void 0):n.length=s+1,Mb(e.eventQueue_,Tb(t),r);for(let e=0;e<i.length;e++)V_(i[e])}}const oE=function(e,t){const n=aE(e),i=n.namespace;"firebase.com"===n.domain&&k_(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),i&&"undefined"!==i||"localhost"===n.domain||k_("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&P_("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const r="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new X_(n.host,n.secure,i,r,t,"",i!==n.subdomain),path:new mv(n.pathString)}},aE=function(e){let t="",n="",i="",r="",s="",o=!0,a="https",l=443;if("string"===typeof e){let c=e.indexOf("//");c>=0&&(a=e.substring(0,c-1),e=e.substring(c+2));let u=e.indexOf("/");-1===u&&(u=e.length);let h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(u,h)),u<h&&(r=function(e){let t="";const n=e.split("/");for(let i=0;i<n.length;i++)if(n[i].length>0){let e=n[i];try{e=decodeURIComponent(e.replace(/\+/g," "))}catch(aC){}t+="/"+e}return t}(e.substring(u,h)));const d=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const i=n.split("=");2===i.length?t[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):P_("Invalid query segment '".concat(n,"' in query '").concat(e,"'"))}return t}(e.substring(Math.min(e.length,h)));c=t.indexOf(":"),c>=0?(o="https"===a||"wss"===a,l=parseInt(t.substring(c+1),10)):c=t.length;const f=t.slice(0,c);if("localhost"===f.toLowerCase())n="localhost";else if(f.split(".").length<=2)n=f;else{const e=t.indexOf(".");i=t.substring(0,e).toLowerCase(),n=t.substring(e+1),s=i}"ns"in d&&(s=d.ns)}return{host:t,port:l,domain:n,subdomain:i,secure:o,scheme:a,pathString:r,namespace:s}},lE="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz";!function(){let e=0;const t=[]}();class cE{constructor(e,t,n,i){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=i}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+ce(this.snapshot.exportVal())}}class uE{constructor(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class hE{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return R(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class dE{constructor(e,t,n,i){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=i}get key(){return Cv(this._path)?null:wv(this._path)}get ref(){return new fE(this._repo,this._path)}get _queryIdentifier(){const e=yy(this._queryParams),t=M_(e);return"{}"===t?"default":t}get _queryObject(){return yy(this._queryParams)}isEqual(e){if(!((e=Se(e))instanceof dE))return!1;const t=this._repo===e._repo,n=Sv(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&n&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}class fE extends dE{constructor(e,t){super(e,t,new _y,!1)}get parent(){const e=Ev(this._path);return null===e?null:new fE(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class pE{constructor(e,t,n){this._node=e,this.ref=t,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new mv(e),n=gE(this.ref,e);return new pE(this._node.getChild(t),n,Jv)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){if(this._node.isLeafNode())return!1;return!!this._node.forEachChild(this._index,(t,n)=>e(new pE(n,gE(this.ref,t),Jv)))}hasChild(e){const t=new mv(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function mE(e,t){return(e=Se(e))._checkNotDeleted("ref"),void 0!==t?gE(e._root,t):e._root}function gE(e,t){var n,i,r,s;return null===_v((e=Se(e))._path)?(n="child",i="path",s=!1,(r=t)&&(r=r.replace(/^\/*\.info(\/|$)/,"/")),Ab(n,i,r,s)):Ab("child","path",t,!1),new fE(e._repo,Tv(e._path,t))}class _E{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const n=t._queryParams.getIndex();return new cE("value",this,new pE(e.snapshotNode,new fE(t._repo,t._path),n))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new uE(this,e,t):null}matches(e){return e instanceof _E&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class vE{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new uE(this,e,t):null}createEvent(e,t){R(null!=e.childName,"Child events should have a childName.");const n=gE(new fE(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new cE(e.type,this,new pE(e.snapshotNode,n,i),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof vE&&(this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)))}hasAnyCallback(){return!!this.callbackContext}}function yE(e,t,n,i,r){let s;if("object"===typeof i&&(s=void 0,r=i),"function"===typeof i&&(s=i),r&&r.onlyOnce){const t=n,i=(n,i)=>{Zb(e._repo,e,a),t(n,i)};i.userCallback=n.userCallback,i.context=n.context,n=i}const o=new hE(n,s||void 0),a="value"===t?new _E(o):new vE(t,o);return function(e,t,n){let i;i=".info"===_v(t._path)?Yw(e.infoSyncTree_,t,n):Yw(e.serverSyncTree_,t,n),Db(e.eventQueue_,t._path,i)}(e._repo,e,a),()=>Zb(e._repo,e,a)}function wE(e,t,n,i){return yE(e,"value",t,n,i)}!function(e){R(!Nw,"__referenceConstructor has already been defined"),Nw=e}(fE),function(e){R(!Aw,"__referenceConstructor has already been defined"),Aw=e}(fE);const bE={};let EE=!1;function TE(e,t,n,i,r){let s=i||e.options.databaseURL;void 0===s&&(e.options.projectId||k_("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),x_("Using default host for project ",e.options.projectId),s="".concat(e.options.projectId,"-default-rtdb.firebaseio.com"));let o,a,l=oE(s,r),c=l.repoInfo;"undefined"!==typeof process&&(a={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyDoWYF5rEHMliG2tAbiE4OM8qvjAssT8Pc",REACT_APP_FIREBASE_AUTH_DOMAIN:"hackru-cc78a.firebaseapp.com",REACT_APP_FIREBASE_DATABASE_URL:"https://hackru-cc78a-default-rtdb.firebaseio.com",REACT_APP_FIREBASE_PROJECT_ID:"hackru-cc78a",REACT_APP_FIREBASE_STORAGE_BUCKET:"hackru-cc78a.firebasestorage.app",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"53406972833",REACT_APP_FIREBASE_APP_ID:"1:53406972833:web:0a038d10f85d215b1829e0",REACT_APP_FIREBASE_MEASUREMENT_ID:"G-3D65B0W7J7",REACT_APP_API_BASE:"http://localhost:8080",REACT_APP_SERVER_IP:"10.74.159.48"}.FIREBASE_DATABASE_EMULATOR_HOST),a?(o=!0,s="http://".concat(a,"?ns=").concat(c.namespace),l=oE(s,r),c=l.repoInfo):o=!l.repoInfo.secure;const u=r&&o?new K_(K_.OWNER):new W_(e.name,e.options,t);Rb("Invalid Firebase Database URL",l),Cv(l.path)||k_("Database URL must point to the root of a Firebase Database (not including a child path).");const h=function(e,t,n,i){let r=bE[t.name];r||(r={},bE[t.name]=r);let s=r[e.toURLString()];s&&k_("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return s=new zb(e,EE,n,i),r[e.toURLString()]=s,s}(c,e,u,new H_(e.name,n));return new CE(h,e)}class CE{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Bb(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new fE(this._repo,gv())),this._rootInternal}_delete(){return null!==this._rootInternal&&(!function(e,t){const n=bE[t];n&&n[e.key]===e||k_("Database ".concat(t,"(").concat(e.repoInfo_,") has already been deleted.")),Qb(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&k_("Cannot call "+e+" on a deleted database.")}}Lv.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},Lv.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};!function(e){d_(Gt),Vt(new Ie("database",(e,t)=>{let{instanceIdentifier:n}=t;return TE(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),n)},"PUBLIC").setMultipleInstances(!0)),Yt(c_,u_,e),Yt(c_,u_,"esm2017")}();const xE=("undefined"!==typeof window&&window.location.protocol,{apiKey:"AIzaSyDoWYF5rEHMliG2tAbiE4OM8qvjAssT8Pc",authDomain:"hackru-cc78a.firebaseapp.com",databaseURL:"https://hackru-cc78a-default-rtdb.firebaseio.com",projectId:"hackru-cc78a",storageBucket:"hackru-cc78a.firebasestorage.app",messagingSenderId:"53406972833",appId:"1:53406972833:web:0a038d10f85d215b1829e0",measurementId:"G-3D65B0W7J7"}),SE=["apiKey","authDomain","projectId"].filter(e=>!xE[e]);if(SE.length>0)throw new Error("Firebase configuration is incomplete. Missing: ".concat(SE.join(", ")));if(xE.authDomain&&xE.authDomain.includes("your_project_id"))throw new Error("Please update Firebase configuration with actual project values");const IE=Zt(xE);if("undefined"!==typeof window&&"capacitor:"!==window.location.protocol)try{!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qt();e=Se(e);const t=qt(e,Ag);t.isInitialized()?t.getImmediate():function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=qt(e,Ag);if(n.isInitialized()){const e=n.getImmediate();if(me(t,n.getOptions()))return e;throw Og.create("already-initialized")}n.initialize({options:t})}(e)}(IE)}catch(I_){}let kE;try{if("undefined"!==typeof window&&"capacitor:"===window.location.protocol)try{kE=Ni(IE,{persistence:Ir})}catch(lC){if("auth/already-initialized"!==lC.code)throw lC;kE=bs(IE)}else kE=bs(IE)}catch(I_){kE=bs(IE)}const PE=function(e,t){const n="string"==typeof e?e:t||"(default)",i=qt("object"==typeof e?e:Qt(),"firestore").getImmediate({identifier:n});if(!i._initialized){const e=K("firestore");e&&function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var r;const s=(e=Zd(e,Jd))._getSettings(),o="".concat(t,":").concat(n);if("firestore.googleapis.com"!==s.host&&s.host!==o&&Ws("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),i.mockUserToken){let t,n;if("string"==typeof i.mockUserToken)t=i.mockUserToken,n=Us.MOCK_USER;else{t=Y(i.mockUserToken,null===(r=e._app)||void 0===r?void 0:r.options.projectId);const s=i.mockUserToken.sub||i.mockUserToken.user_id;if(!s)throw new Js(Ys.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Us(s)}e._authCredentials=new to(new $s(t,n))}}(i,...e)}return i}(IE),NE=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qt(),t=arguments.length>1?arguments[1]:void 0;e=Se(e);const n=qt(e,Um).getImmediate({identifier:t}),i=K("storage");return i&&function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};!function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.host="".concat(t,":").concat(n),e._protocol="http";const{mockUserToken:r}=i;r&&(e._overrideAuthToken="string"===typeof r?r:Y(r,e.app.options.projectId))}(e,t,n,i)}(n,...i),n}(IE),AE=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qt(),t=arguments.length>1?arguments[1]:void 0;const n=qt(e,"database").getImmediate({identifier:t});if(!n._instanceStarted){const e=K("database");e&&function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e=Se(e),e._checkNotDeleted("useEmulator"),e._instanceStarted&&k_("Cannot call useEmulator() after instance has already been initialized.");const r=e._repoInternal;let s;if(r.repoInfo_.nodeAdmin)i.mockUserToken&&k_('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new K_(K_.OWNER);else if(i.mockUserToken){const t="string"===typeof i.mockUserToken?i.mockUserToken:Y(i.mockUserToken,e.app.options.projectId);s=new K_(t)}!function(e,t,n,i){e.repoInfo_=new X_("".concat(t,":").concat(n),!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0),i&&(e.authTokenProvider_=i)}(r,t,n,s)}(n,...e)}return n}(IE),RE=new Gi;class LE{static async getUserProfile(e){try{const t=hp(nf(PE,this.USERS_COLLECTION,e)),n=new Promise((e,t)=>{setTimeout(()=>{t(new Error("Request timeout - please check your internet connection"))},1e4)}),i=await Promise.race([t,n]);return i.exists()?Ve({id:i.id},i.data()):null}catch(I_){const t=(null===I_||void 0===I_?void 0:I_.code)||"unknown";if("permission-denied"===t)throw new Error("You do not have permission to access this user profile");if("unavailable"===t)throw new Error("Service temporarily unavailable - please try again");throw new Error("Failed to get user profile")}}static async getOrCreateUserProfile(e){try{let t=await this.getUserProfile(e.id);if(!t){const n=Ve(Ve({},e),{},{tags:e.tags||[],pets:[],isOnline:!0,lastSeen:(new Date).toISOString()});await this.createOrUpdateUserProfile(n),t=n}return t}catch(I_){throw new Error("Failed to get or create user profile")}}static async createOrUpdateUserProfile(e){try{const t=nf(PE,this.USERS_COLLECTION,e.id);await function(e,t,n){e=Zd(e,$d);const i=Zd(e.firestore,of),r=sp(e.converter,t,n);return vp(i,[bf(wf(i),"setDoc",e._key,r,null!==e.converter,n).toMutation(e._key,Kl.none())])}(t,Ve(Ve({},e),{},{createdAt:e.createdAt||(new Date).toISOString()}),{merge:!0})}catch(I_){throw new Error("Failed to create/update user profile")}}static async updateUserTags(e,t){try{const n=nf(PE,this.USERS_COLLECTION,e);await pp(n,{tags:t})}catch(I_){throw new Error("Failed to update user tags")}}static async updateUserOnlineStatus(e,t){try{const n=nf(PE,this.USERS_COLLECTION,e);await pp(n,{isOnline:t,lastSeen:(new Date).toISOString()})}catch(I_){}}}LE.USERS_COLLECTION="users";const OE=LE;class DE{constructor(){this.authStateListeners=[],this.testConnectivity(),function(e,t,n,i){Se(e).onAuthStateChanged(t,n,i)}(kE,async e=>{try{const t=e?await this.convertFirebaseUser(e):null;this.authStateListeners.forEach(e=>e(t))}catch(I_){this.authStateListeners.forEach(e=>e(null))}},e=>{this.authStateListeners.forEach(e=>e(null))})}async testConnectivity(){try{await fetch("https://www.google.com",{method:"HEAD",mode:"no-cors",cache:"no-cache"})}catch(I_){}}static getInstance(){return DE.instance||(DE.instance=new DE),DE.instance}async signInWithGoogle(){try{if("undefined"!==typeof window&&"capacitor:"===window.location.protocol)throw new Error("Google Sign-In is not supported in native apps. Please use email/password authentication.");const e=await async function(e,t,n){if(Ht(e.app))return Promise.reject(mn(e,"operation-not-supported-in-this-environment"));const i=Ei(e);vn(e,t,Hi);const r=Ar(i,n);return new Fr(i,"signInViaPopup",t,r).executeNotNull()}(kE,RE);return await this.ensureUserDocument(e.user),await this.convertFirebaseUser(e.user)}catch(I_){throw I_}}async signInWithEmailAndPassword(e,t){try{const n=new Promise((e,t)=>{setTimeout(()=>{t(new Error("Authentication timeout - please check your internet connection"))},15e3)}),i=function(e,t,n){return Ht(e.app)?Promise.reject(_n(e)):rr(Se(e),qi.credential(t,n)).catch(async t=>{throw t.code==="auth/".concat("password-does-not-meet-requirements")&&sr(e),t})}(kE,e,t),r=await Promise.race([i,n]);await this.ensureUserDocument(r.user);return await this.convertFirebaseUser(r.user)}catch(I_){throw I_}}async signUpWithEmailAndPassword(e,t,n){try{const i=new Promise((e,t)=>{setTimeout(()=>{t(new Error("Sign up timeout - please check your internet connection"))},15e3)}),r=async function(e,t,n){if(Ht(e.app))return Promise.reject(_n(e));const i=Ei(e),r=Pi(i,{returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Yi),s=await r.catch(t=>{throw t.code==="auth/".concat("password-does-not-meet-requirements")&&sr(e),t}),o=await Ji._fromIdTokenResponse(i,"signIn",s);return await i._updateCurrentUser(o.user),o}(kE,e,t),s=await Promise.race([r,i]);await or(s.user,{displayName:n});const o={id:s.user.uid,displayName:n,email:s.user.email||"",createdAt:(new Date).toISOString()};await OE.createOrUpdateUserProfile(o);return await this.convertFirebaseUser(s.user)}catch(I_){throw I_}}async signOut(){try{await function(e){return Se(e).signOut()}(kE)}catch(I_){throw I_}}async getIdToken(){try{const e=kE.currentUser;return e?await e.getIdToken():null}catch(I_){return null}}async getCurrentUser(){const e=kE.currentUser;return e?await this.convertFirebaseUser(e):null}onAuthStateChange(e){return this.authStateListeners.push(e),()=>{const t=this.authStateListeners.indexOf(e);t>-1&&this.authStateListeners.splice(t,1)}}async ensureUserDocument(e){try{if(!(await hp(nf(PE,"users",e.uid))).exists()){const t={id:e.uid,displayName:e.displayName||"Unknown User",email:e.email||"",createdAt:(new Date).toISOString()};await OE.createOrUpdateUserProfile(t)}}catch(I_){}}async convertFirebaseUser(e){try{const t=await OE.getUserProfile(e.uid);if(t)return t}catch(I_){}return{id:e.uid,displayName:e.displayName||"Unknown User",email:e.email||""}}}DE.instance=void 0;const ME=DE.getInstance();var jE=n(579);const FE=()=>{const[e,n]=(0,t.useState)(!1),[i,r]=(0,t.useState)(!1),[s,o]=(0,t.useState)(null),[a,l]=(0,t.useState)(""),[c,u]=(0,t.useState)(""),[h,d]=(0,t.useState)(""),[f,p]=(0,t.useState)(!1),m="undefined"!==typeof window&&"capacitor:"===window.location.protocol;return(0,jE.jsx)("div",{className:"authentication-view",children:(0,jE.jsxs)("div",{className:"auth-container",children:[(0,jE.jsxs)("div",{className:"auth-header",children:[(0,jE.jsx)("div",{className:"paw-icon",children:"\ud83d\udc3e"}),(0,jE.jsx)("h1",{className:"auth-title",children:"Fetchr"}),(0,jE.jsx)("p",{className:"auth-subtitle",children:"Real-time safety for your best friend."})]}),(0,jE.jsxs)("div",{className:"auth-form-container",children:[(0,jE.jsxs)("form",{onSubmit:f?async e=>{if(e.preventDefault(),r(!0),o(null),!h.trim())return o("Please enter your full name."),void r(!1);try{await ME.signUpWithEmailAndPassword(a,c,h)}catch(I_){let t="Failed to create account. Please try again.";"auth/email-already-in-use"===I_.code?t="An account with this email already exists.":"auth/invalid-email"===I_.code?t="Invalid email address.":"auth/weak-password"===I_.code&&(t="Password should be at least 6 characters."),o(t)}finally{r(!1)}}:async e=>{e.preventDefault(),n(!0),o(null);try{await ME.signInWithEmailAndPassword(a,c)}catch(I_){let t="Failed to sign in. Please try again.";"auth/user-not-found"===I_.code?t="No account found with this email address.":"auth/wrong-password"===I_.code?t="Incorrect password.":"auth/invalid-email"===I_.code?t="Invalid email address.":"auth/too-many-requests"===I_.code&&(t="Too many failed attempts. Please try again later."),o(t)}finally{n(!1)}},className:"auth-form",children:[f&&(0,jE.jsx)("div",{className:"form-group",children:(0,jE.jsx)("input",{type:"text",placeholder:"Full Name",value:h,onChange:e=>d(e.target.value),required:!0,className:"auth-input"})}),(0,jE.jsx)("div",{className:"form-group",children:(0,jE.jsx)("input",{type:"email",placeholder:"Email address",value:a,onChange:e=>l(e.target.value),required:!0,className:"auth-input"})}),(0,jE.jsx)("div",{className:"form-group",children:(0,jE.jsx)("input",{type:"password",placeholder:"Password",value:c,onChange:e=>u(e.target.value),required:!0,className:"auth-input",minLength:6})}),(0,jE.jsx)("button",{type:"submit",className:"auth-submit-button ".concat(e||i?"signing-in":""),disabled:e||i,children:e||i?(0,jE.jsxs)(jE.Fragment,{children:[(0,jE.jsx)("div",{className:"spinner"}),(0,jE.jsx)("span",{children:f?"Creating account...":"Signing in..."})]}):(0,jE.jsx)("span",{children:f?"Create Account":"Sign In"})})]}),!m&&(0,jE.jsxs)(jE.Fragment,{children:[(0,jE.jsx)("div",{className:"auth-divider",children:(0,jE.jsx)("span",{children:"or"})}),(0,jE.jsx)("button",{className:"google-sign-in-button ".concat(e?"signing-in":""),onClick:async()=>{n(!0),o(null);try{await ME.signInWithGoogle()}catch(I_){let t="Failed to sign in with Google. Please try again.";I_.message&&I_.message.includes("not supported in native apps")&&(t="Google Sign-In is not available in the app. Please use email/password authentication."),o(t)}finally{n(!1)}},disabled:e,children:e?(0,jE.jsxs)(jE.Fragment,{children:[(0,jE.jsx)("div",{className:"spinner"}),(0,jE.jsx)("span",{children:"Signing in..."})]}):(0,jE.jsxs)(jE.Fragment,{children:[(0,jE.jsxs)("svg",{className:"google-icon",viewBox:"0 0 24 24",width:"20",height:"20",children:[(0,jE.jsx)("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),(0,jE.jsx)("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),(0,jE.jsx)("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),(0,jE.jsx)("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),(0,jE.jsx)("span",{children:"Continue with Google"})]})})]}),(0,jE.jsx)("div",{className:"auth-mode-toggle",children:(0,jE.jsxs)("p",{children:[f?"Already have an account?":"Don't have an account?",(0,jE.jsx)("button",{type:"button",className:"toggle-button",onClick:()=>{p(!f),o(null),l(""),u(""),d("")},children:f?"Sign In":"Sign Up"})]})})]}),s&&(0,jE.jsx)("p",{className:"error-message",children:s})]})})};let UE=function(e){return e.RESTING="Resting",e.WALKING="Walking",e.PLAYING="Playing",e.UNUSUAL="Unusual Activity",e}({});function zE(e,t){return Object.freeze(Ve(Ve({},e),t))}const BE=(0,t.createContext)(null),VE=BE.Provider;function qE(){const e=(0,t.useContext)(BE);if(null==e)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function HE(){return qE().map}function WE(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(-1!==t.indexOf(i))continue;n[i]=e[i]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var KE=n(228),GE=n.n(KE);const ZE=["bounds","boundsOptions","center","children","className","id","placeholder","style","whenReady","zoom"];function QE(){return QE=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},QE.apply(this,arguments)}function YE(e,n){let{bounds:i,boundsOptions:r,center:s,children:o,className:a,id:l,placeholder:c,style:u,whenReady:h,zoom:d}=e,f=WE(e,ZE);const[p]=(0,t.useState)({className:a,id:l,style:u}),[m,g]=(0,t.useState)(null);(0,t.useImperativeHandle)(n,()=>{var e;return null!==(e=null===m||void 0===m?void 0:m.map)&&void 0!==e?e:null},[m]);const _=(0,t.useCallback)(e=>{if(null!==e&&null===m){const t=new KE.Map(e,f);null!=s&&null!=d?t.setView(s,d):null!=i&&t.fitBounds(i,r),null!=h&&t.whenReady(h),g(function(e){return Object.freeze({__version:1,map:e})}(t))}},[]);(0,t.useEffect)(()=>()=>{null===m||void 0===m||m.map.remove()},[m]);const v=m?t.createElement(VE,{value:m},o):null!==c&&void 0!==c?c:null;return t.createElement("div",QE({},p,{ref:_}),v)}const JE=(0,t.forwardRef)(YE);function XE(e){function n(n,i){const{instance:r,context:s}=e(n).current;return(0,t.useImperativeHandle)(i,()=>r),null==n.children?null:t.createElement(VE,{value:s},n.children)}return(0,t.forwardRef)(n)}function $E(e,t,n){return Object.freeze({instance:e,context:t,container:n})}function eT(e,n){return null==n?function(n,i){const r=(0,t.useRef)();return r.current||(r.current=e(n,i)),r}:function(i,r){const s=(0,t.useRef)();s.current||(s.current=e(i,r));const o=(0,t.useRef)(i),{instance:a}=s.current;return(0,t.useEffect)(function(){o.current!==i&&(n(a,i,o.current),o.current=i)},[a,i,r]),s}}function tT(e,n){const i=(0,t.useRef)(n);(0,t.useEffect)(function(){n!==i.current&&null!=e.attributionControl&&(null!=i.current&&e.attributionControl.removeAttribution(i.current),null!=n&&e.attributionControl.addAttribution(n)),i.current=n},[e,n])}function nT(e,n){const i=(0,t.useRef)();(0,t.useEffect)(function(){return null!=n&&e.instance.on(n),i.current=n,function(){null!=i.current&&e.instance.off(i.current),i.current=null}},[e,n])}function iT(e,t){var n;const i=null!==(n=e.pane)&&void 0!==n?n:t.pane;return i?Ve(Ve({},e),{},{pane:i}):e}function rT(e,n){(0,t.useEffect)(function(){var t;return(null!==(t=n.layerContainer)&&void 0!==t?t:n.map).addLayer(e.instance),function(){var t;null===(t=n.layerContainer)||void 0===t||t.removeLayer(e.instance),n.map.removeLayer(e.instance)}},[n,e])}function sT(e){return function(t){const n=qE(),i=e(iT(t,n),n);return tT(n.map,t.attribution),nT(i.current,t.eventHandlers),rT(i.current,n),i}}function oT(e){return function(n){const i=qE(),r=e(iT(n,i),i);return nT(r.current,n.eventHandlers),rT(r.current,i),function(e,n){const i=(0,t.useRef)();(0,t.useEffect)(function(){if(n.pathOptions!==i.current){var t;const r=null!==(t=n.pathOptions)&&void 0!==t?t:{};e.instance.setStyle(r),i.current=r}},[e,n])}(r.current,n),r}}const aT=["url"],lT=function(e){function n(n,i){const{instance:r}=e(n).current;return(0,t.useImperativeHandle)(i,()=>r),null}return(0,t.forwardRef)(n)}(sT(eT(function(e,t){let{url:n}=e,i=WE(e,aT);return $E(new KE.TileLayer(n,iT(i,t)),t)},function(e,t,n){!function(e,t,n){const{opacity:i,zIndex:r}=t;null!=i&&i!==n.opacity&&e.setOpacity(i),null!=r&&r!==n.zIndex&&e.setZIndex(r)}(e,t,n);const{url:i}=t;null!=i&&i!==n.url&&e.setUrl(i)})));const cT=["center","children"],uT=function(e,t){return XE(oT(eT(e,t)))}(function(e,t){let{center:n,children:i}=e,r=WE(e,cT);const s=new KE.Circle(n,r);return $E(s,zE(t,{overlayContainer:s}))},function(e,t,n){t.center!==n.center&&e.setLatLng(t.center),null!=t.radius&&t.radius!==n.radius&&e.setRadius(t.radius)}),hT=["position"],dT=function(e,t){return XE(sT(eT(e,t)))}(function(e,t){let{position:n}=e,i=WE(e,hT);const r=new KE.Marker(n,i);return $E(r,zE(t,{overlayContainer:r}))},function(e,t,n){t.position!==n.position&&e.setLatLng(t.position),null!=t.icon&&t.icon!==n.icon&&e.setIcon(t.icon),null!=t.zIndexOffset&&t.zIndexOffset!==n.zIndexOffset&&e.setZIndexOffset(t.zIndexOffset),null!=t.opacity&&t.opacity!==n.opacity&&e.setOpacity(t.opacity),null!=e.dragging&&t.draggable!==n.draggable&&(!0===t.draggable?e.dragging.enable():e.dragging.disable())}),fT=function(e,n){const i=function(e,t){return function(n,i){const r=qE(),s=e(iT(n,r),r);return tT(r.map,n.attribution),nT(s.current,n.eventHandlers),t(s.current,r,n,i),s}}(eT(e),n);return function(e){function n(n,i){const[r,o]=(0,t.useState)(!1),{instance:a}=e(n,o).current;(0,t.useImperativeHandle)(i,()=>a),(0,t.useEffect)(function(){r&&a.update()},[a,r,n.children]);const l=a._contentNode;return l?(0,s.createPortal)(n.children,l):null}return(0,t.forwardRef)(n)}(i)}(function(e,t){return $E(new KE.Popup(e,t.overlayContainer),t)},function(e,n,i,r){let{position:s}=i;(0,t.useEffect)(function(){const{instance:t}=e;function i(e){e.popup===t&&(t.update(),r(!0))}function o(e){e.popup===t&&r(!1)}return n.map.on({popupopen:i,popupclose:o}),null==n.overlayContainer?(null!=s&&t.setLatLng(s),t.openOn(n.map)):n.overlayContainer.bindPopup(t),function(){var e;n.map.off({popupopen:i,popupclose:o}),null===(e=n.overlayContainer)||void 0===e||e.unbindPopup(),n.map.removeLayer(t)}},[e,n,r,s])});delete GE().Icon.Default.prototype._getIconUrl,GE().Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-shadow.png"});const pT=e=>{let{petCoordinate:n,safeZone:i}=e;const r=HE();return(0,t.useEffect)(()=>{n?r.setView([n.lat,n.lng],16):i&&r.setView([i.centerLatitude,i.centerLongitude],16)},[r,n,i]),null},mT=e=>{let{onMapClick:n,isEditing:i}=e;const r=HE();return(0,t.useEffect)(()=>{if(!i)return;const e=e=>{n(e.latlng.lat,e.latlng.lng)};return r.on("click",e),()=>{r.off("click",e)}},[r,n,i]),null},gT=e=>{let{petImageURL:n,petCoordinate:i,safeZone:r,onSafeZoneUpdate:s}=e;const o=40.741,a=-74.175,[l,c]=(0,t.useState)(!1),[u,h]=(0,t.useState)(null);(0,t.useEffect)(()=>{l&&r&&h(Ve({},r))},[l,r]);const d=l?u:r;return(0,jE.jsxs)("div",{className:"pet-map-view",children:[(0,jE.jsx)("div",{className:"safe-zone-controls",children:l?(0,jE.jsxs)("div",{className:"safe-zone-edit-controls",children:[(0,jE.jsxs)("div",{className:"radius-control",children:[(0,jE.jsxs)("label",{children:["Radius: ",(null===u||void 0===u?void 0:u.radius)||0,"m"]}),(0,jE.jsx)("input",{type:"range",min:"50",max:"500",value:(null===u||void 0===u?void 0:u.radius)||150,onChange:e=>{return t=parseInt(e.target.value),void(u&&h(Ve(Ve({},u),{},{radius:t})));var t},className:"radius-slider"})]}),(0,jE.jsxs)("div",{className:"edit-buttons",children:[(0,jE.jsx)("button",{className:"save-btn",onClick:()=>{u&&s&&s(u),c(!1),h(null)},children:"Save"}),(0,jE.jsx)("button",{className:"cancel-btn",onClick:()=>{c(!1),h(null)},children:"Cancel"})]})]}):(0,jE.jsxs)("button",{className:"edit-safe-zone-btn",onClick:()=>c(!0),title:"Edit Safe Zone",children:[(0,jE.jsx)("span",{className:"edit-icon",children:"\ud83d\udccd"}),(0,jE.jsx)("span",{children:"Edit Safe Zone"})]})}),(0,jE.jsxs)(JE,{center:i||{lat:(null===d||void 0===d?void 0:d.centerLatitude)||o,lng:(null===d||void 0===d?void 0:d.centerLongitude)||a},zoom:16,style:{height:"100%",width:"100%"},zoomControl:!0,children:[(0,jE.jsx)(lT,{attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),(0,jE.jsx)(pT,{petCoordinate:i,safeZone:d}),(0,jE.jsx)(mT,{onMapClick:(e,t)=>{l&&u&&h(Ve(Ve({},u),{},{centerLatitude:e,centerLongitude:t}))},isEditing:l}),d&&(0,jE.jsx)(uT,{center:[d.centerLatitude,d.centerLongitude],radius:d.radius,pathOptions:{color:l?"#CC9966":"var(--accent-color)",fillColor:l?"#CC9966":"var(--accent-color)",fillOpacity:.15,weight:2}}),i&&(0,jE.jsx)(dT,{position:[i.lat,i.lng],icon:GE().divIcon({html:'<div class="pet-marker">\ud83d\udc3e</div>',className:"custom-pet-marker",iconSize:[30,30],iconAnchor:[15,15]}),children:(0,jE.jsx)(fT,{children:(0,jE.jsxs)("div",{style:{textAlign:"center"},children:[(0,jE.jsxs)("strong",{children:["\ud83d\udc3e ",i?"Pet Location":"Nola's Current Location"]}),(0,jE.jsx)("br",{}),l&&(0,jE.jsx)("small",{children:"Tap on the map to set safe zone center"})]})})}),l&&u&&(0,jE.jsx)(dT,{position:[u.centerLatitude,u.centerLongitude],children:(0,jE.jsx)(fT,{children:(0,jE.jsxs)("div",{style:{textAlign:"center"},children:[(0,jE.jsx)("strong",{children:"\ud83d\udccd Safe Zone Center"}),(0,jE.jsx)("br",{}),(0,jE.jsxs)("small",{children:["Radius: ",u.radius,"m"]})]})})})]})]})},_T=e=>{let{icon:t,iconColor:n,title:i,value:r,status:s,statusColor:o}=e;return(0,jE.jsxs)("div",{className:"vital-sign-card",children:[(0,jE.jsx)("div",{className:"vital-icon",style:{color:n},children:(0,jE.jsx)("span",{children:t})}),(0,jE.jsxs)("div",{className:"vital-content",children:[(0,jE.jsx)("div",{className:"vital-title",children:i}),(0,jE.jsx)("div",{className:"vital-value",children:r}),(0,jE.jsx)("div",{className:"vital-status",style:{color:o},children:s})]})]})};class vT{constructor(){this.listeners={}}static getInstance(){return vT.instance||(vT.instance=new vT),vT.instance}subscribeToPetSensorData(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3;const i=mE(AE,"sensorData/".concat(e));let r;const s=()=>{wE(i,n=>{const i=n.val();if(i){const n={petId:e,timestamp:i.timestamp||Date.now(),heartRate:i.heartRate||0,bodyTemperature:i.bodyTemperature||0,activityStatus:i.activityStatus||UE.RESTING,ambientTemperature:i.ambientTemperature||0,bloodPressure:i.bloodPressure||{systolic:0,diastolic:0},respiratoryRate:i.respiratoryRate||0,oxygenSaturation:i.oxygenSaturation||0,dangerMode:i.dangerMode||!1,highActivity:i.highActivity||!1,crashDetected:i.crashDetected||!1,suddenMovement:i.suddenMovement||!1,latitude:i.latitude||0,longitude:i.longitude||0};t(n)}else t(null)},{onlyOnce:!0})};s(),r=setInterval(s,n);const o="sensorData_".concat(e,"_").concat(Date.now());return this.listeners[o]=()=>{clearInterval(r)},()=>{this.listeners[o]&&(this.listeners[o](),delete this.listeners[o])}}async getCurrentPetSensorData(e){return new Promise((t,n)=>{wE(mE(AE,"sensorData/".concat(e)),n=>{const i=n.val();if(i){const n={petId:e,timestamp:i.timestamp||Date.now(),heartRate:i.heartRate||0,bodyTemperature:i.bodyTemperature||0,activityStatus:i.activityStatus||UE.RESTING,ambientTemperature:i.ambientTemperature||0,bloodPressure:i.bloodPressure||{systolic:0,diastolic:0},respiratoryRate:i.respiratoryRate||0,oxygenSaturation:i.oxygenSaturation||0,dangerMode:i.dangerMode||!1,highActivity:i.highActivity||!1,crashDetected:i.crashDetected||!1,suddenMovement:i.suddenMovement||!1,latitude:i.latitude||0,longitude:i.longitude||0};t(n)}else t(null)},e=>{n(e)},{onlyOnce:!0})})}subscribeToDogHealth(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3;const n=mE(AE,"dogHealth");let i;const r=()=>{wE(n,t=>{const n=t.val();if(n){const t={heartRate:n.heartRate||0,dangerMode:n.dangerMode||!1,highActivity:n.highActivity||!1,timestamp:Date.now()};e(t)}},{onlyOnce:!0})};r(),i=setInterval(r,t);const s="dogHealth_".concat(Date.now());return this.listeners[s]=()=>{clearInterval(i)},()=>{this.listeners[s]&&(this.listeners[s](),delete this.listeners[s])}}async getHistoricalSensorData(e,t,n){return[]}cleanup(){Object.values(this.listeners).forEach(e=>{"function"===typeof e&&e()}),this.listeners={}}}vT.instance=void 0;const yT=vT.getInstance();class wT{static getInstance(){return wT.instance||(wT.instance=new wT),wT.instance}async addPet(e){try{const t=await ME.getCurrentUser();if(!t)throw new Error("User not authenticated");const n=Ve(Ve({},e),{},{userId:t.id,createdAt:(new Date).toISOString()}),i=await gp(tf(PE,"pets"),n);return Ve(Ve({},e),{},{id:i.id})}catch(I_){throw I_}}async getPets(){try{const e=await ME.getCurrentUser();if(!e)throw new Error("User not authenticated");const t=Wf(tf(PE,"pets"),Gf("userId","==",e.id)),n=await fp(t),i=[];return n.forEach(e=>{const t=e.data();let n;n=t.birthdate?t.birthdate.toDate&&"function"===typeof t.birthdate.toDate?t.birthdate.toDate():t.birthdate instanceof Date?t.birthdate:new Date(t.birthdate):new Date,i.push({id:e.id,name:t.name,breed:t.breed,birthdate:n,photoURL:t.photoURL,createdAt:t.createdAt})}),i.sort((e,t)=>{const n=new Date(e.createdAt||0);return new Date(t.createdAt||0).getTime()-n.getTime()}),i}catch(I_){throw I_}}async deletePet(e){try{if(!await ME.getCurrentUser())throw new Error("User not authenticated");await mp(nf(PE,"pets",e))}catch(I_){throw I_}}async updatePet(e,t){try{if(!await ME.getCurrentUser())throw new Error("User not authenticated");const n=nf(PE,"pets",e);await pp(n,Ve(Ve({},t),{},{updatedAt:(new Date).toISOString()}))}catch(I_){throw I_}}}wT.instance=void 0;const bT=wT.getInstance(),ET={API_KEY:"sk_5c6514d953ac9ae36b9e9d37fc4f0a60533b2e8d73f026b8",VOICE_ID:"pNInz6obpgDQGcFmaJgB",MODEL_ID:"eleven_monolingual_v1",VOICE_SETTINGS:{normal:{stability:.5,similarity_boost:.5},alert:{stability:.3,similarity_boost:.8,style:.8}}};class TT{constructor(){this.config=void 0,this.audioContext=null,this.isPlaying=!1,this.eventListeners=new Set,this.isIOS=!1,this.isCapacitor=!1,this.config={apiKey:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyDoWYF5rEHMliG2tAbiE4OM8qvjAssT8Pc",REACT_APP_FIREBASE_AUTH_DOMAIN:"hackru-cc78a.firebaseapp.com",REACT_APP_FIREBASE_DATABASE_URL:"https://hackru-cc78a-default-rtdb.firebaseio.com",REACT_APP_FIREBASE_PROJECT_ID:"hackru-cc78a",REACT_APP_FIREBASE_STORAGE_BUCKET:"hackru-cc78a.firebasestorage.app",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"53406972833",REACT_APP_FIREBASE_APP_ID:"1:53406972833:web:0a038d10f85d215b1829e0",REACT_APP_FIREBASE_MEASUREMENT_ID:"G-3D65B0W7J7",REACT_APP_API_BASE:"http://localhost:8080",REACT_APP_SERVER_IP:"10.74.159.48"}.REACT_APP_ELEVENLABS_API_KEY||ET.API_KEY||"YOUR_ELEVENLABS_API_KEY_HERE",voiceId:ET.VOICE_ID,modelId:ET.MODEL_ID},this.detectEnvironment()}detectEnvironment(){"undefined"!==typeof window&&(this.isIOS=/iPad|iPhone|iPod/.test(navigator.userAgent),this.isCapacitor="capacitor:"===window.location.protocol)}logError(e,t){console.error("[ElevenLabsService] ".concat(e),t||"")}logInfo(e,t){console.log("[ElevenLabsService] ".concat(e),t||"")}static getInstance(){return TT.instance||(TT.instance=new TT),TT.instance}setApiKey(e){this.config.apiKey=e}setVoiceId(e){this.config.voiceId=e}setModelId(e){this.config.modelId=e}getConfig(){return Ve({},this.config)}isConfigured(){const e=this.config.apiKey.length>0&&"YOUR_ELEVENLABS_API_KEY_HERE"!==this.config.apiKey;return this.logInfo("ElevenLabs configured: ".concat(e),{apiKeyLength:this.config.apiKey.length,hasValidKey:"YOUR_ELEVENLABS_API_KEY_HERE"!==this.config.apiKey}),e}async initializeAudioContext(){try{if(!this.audioContext){const e=window.AudioContext||window.webkitAudioContext;this.audioContext=new e({sampleRate:44100,latencyHint:"interactive"})}if("suspended"===this.audioContext.state&&await this.audioContext.resume(),this.isIOS||this.isCapacitor)try{this.audioContext.state}catch(e){this.logError("Mobile audio setup failed",e)}return!0}catch(I_){return this.logError("Failed to initialize audio context",I_),!1}}isAudioContextReady(){return null!==this.audioContext&&"running"===this.audioContext.state}isAudioContextSuspended(){return null!==this.audioContext&&"suspended"===this.audioContext.state}async textToSpeech(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!this.isConfigured())return this.logError("ElevenLabs not configured"),null;if(!e||0===e.trim().length)return this.logError("Empty text provided"),null;const i=e.trim();if(i.length>5e3)throw this.logError("Text too long for ElevenLabs API"),new Error("Text is too long for ElevenLabs API. Maximum 5000 characters allowed.");const r=i.length>4e3?i.substring(0,4e3)+"...":i;try{const e=t.voiceId||this.config.voiceId,i={text:r,model_id:t.modelId||this.config.modelId,voice_settings:Ve({stability:.5,similarity_boost:.5},t.voiceSettings)},a={method:"POST",headers:{Accept:"audio/mpeg","Content-Type":"application/json","xi-api-key":this.config.apiKey,"User-Agent":this.isIOS?"Fetchr-iOS/1.0":"Fetchr-Web/1.0","Cache-Control":"no-cache",Pragma:"no-cache"},body:JSON.stringify(i),signal:AbortSignal.timeout(3e4)};(this.isIOS||this.isCapacitor)&&(a.cache="no-cache",a.redirect="follow"),this.logInfo("Making ElevenLabs API request to: https://api.elevenlabs.io/v1/text-to-speech/".concat(e)),this.logInfo("Request body: ".concat(JSON.stringify(i)));const l=await fetch("https://api.elevenlabs.io/v1/text-to-speech/".concat(e),a);if(this.logInfo("ElevenLabs API response status: ".concat(l.status)),this.logInfo("Response headers: ".concat(JSON.stringify(Object.fromEntries(l.headers.entries())))),!l.ok){let e={};try{const t=await l.text();this.logError("Error response text: ".concat(t)),e=JSON.parse(t)}catch(s){this.logError("Failed to parse error response",s)}let t="ElevenLabs API error: ".concat(l.status);throw 401===l.status?t+=" - Unauthorized. Check your API key.":429===l.status?t+=" - Rate limit exceeded.":0===l.status||void 0===l.status?t+=" - Network error. Check internet connection and firewall settings.":l.status>=500?t+=" - Server error. ElevenLabs API may be experiencing issues.":t+=e&&"object"===typeof e&&"detail"in e?" - ".concat(e.detail):" - Unknown error",this.logError("ElevenLabs API error",{status:l.status,statusText:l.statusText,errorData:e,isIOS:this.isIOS,isCapacitor:this.isCapacitor}),new Error(t)}const c=l.headers.get("content-type");if(!c||!c.includes("audio"))throw this.logError("Unexpected content type",{contentType:c}),new Error("ElevenLabs API returned non-audio content. Check your request parameters.");const u=await l.arrayBuffer();if(0===u.byteLength){if(this.logError("Received empty audio data from ElevenLabs API"),n>0)throw new Error("ElevenLabs API returned empty audio data after retry. This could be due to API quota exceeded, invalid voice ID, or text length issues.");if(r.length>1e3){const e=r.substring(0,500)+"...";return await this.textToSpeech(e,t,n+1)}throw new Error("ElevenLabs API returned empty audio data. This could be due to API quota exceeded, invalid voice ID, or text length issues.")}if(!this.audioContext)throw this.logError("AudioContext not initialized. Call initializeAudioContext() after user interaction first."),new Error("AudioContext not initialized. Please initialize audio system first.");if(this.isIOS&&"suspended"===this.audioContext.state)try{await this.audioContext.resume()}catch(I_){throw this.logError("Failed to resume AudioContext",I_),new Error("Failed to resume audio context. Please try again.")}try{return await this.audioContext.decodeAudioData(u)}catch(o){throw this.logError("Failed to decode audio data",o),new Error("Failed to decode audio data. The audio format may be unsupported.")}}catch(I_){throw this.logError("textToSpeech failed",I_),I_}}async playText(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.isPlaying)return!1;this.emitEvent({type:"voice_start",text:e,timestamp:Date.now(),alertTitle:n.alertTitle});try{if(t=await this.textToSpeech(e,n),!t)return this.logError("Failed to get audio buffer from textToSpeech"),this.emitEvent({type:"voice_error",text:e,timestamp:Date.now(),alertTitle:n.alertTitle}),!1}catch(I_){return this.logError("textToSpeech failed",I_),this.emitEvent({type:"voice_error",text:e,timestamp:Date.now(),alertTitle:n.alertTitle}),!1}const i=await this.playAudioBuffer(t);return this.emitEvent({type:"voice_end",text:e,timestamp:Date.now(),alertTitle:n.alertTitle}),i}async playAudioBuffer(e){if(!this.audioContext)return this.logError("No AudioContext available"),!1;if(this.isPlaying)return!1;try{if(this.isPlaying=!0,(this.isIOS||this.isCapacitor)&&"suspended"===this.audioContext.state)try{await this.audioContext.resume()}catch(I_){return this.logError("Failed to resume AudioContext",I_),this.isPlaying=!1,!1}const t=this.audioContext.createBufferSource();t.buffer=e;const n=this.audioContext.createGain();return n.gain.value=1,t.connect(n),n.connect(this.audioContext.destination),new Promise(e=>{t.onended=()=>{this.isPlaying=!1,e(!0)};try{const e=this.audioContext.currentTime;t.start(e)}catch(I_){this.logError("Failed to start audio source",I_),this.isPlaying=!1,e(!1)}})}catch(I_){return this.logError("playAudioBuffer failed",I_),this.isPlaying=!1,!1}}stop(){this.isPlaying=!1}isCurrentlyPlaying(){return this.isPlaying}addEventListener(e){this.eventListeners.add(e)}removeEventListener(e){this.eventListeners.delete(e)}emitEvent(e){this.eventListeners.forEach(t=>{try{t(e)}catch(I_){console.error("Error in voice event listener:",I_)}})}async getVoices(){if(!this.isConfigured())return[];try{const e=await fetch("https://api.elevenlabs.io/v1/voices",{headers:{"xi-api-key":this.config.apiKey}});if(!e.ok)throw new Error("Failed to fetch voices: ".concat(e.status));return(await e.json()).voices||[]}catch(I_){return[]}}async checkQuota(){if(!this.isConfigured())return null;try{var e;const t=await fetch("https://api.elevenlabs.io/v1/user",{headers:{"xi-api-key":this.config.apiKey}});if(!t.ok)return this.logError("Failed to fetch user info",{status:t.status}),null;const n=await t.json();return{remaining:(n.character_limit||0)-(n.character_count||0),total:n.character_limit||0,resetDate:null===(e=n.subscription)||void 0===e?void 0:e.next_character_count_reset_unix}}catch(I_){return this.logError("Failed to check quota",I_),null}}}TT.instance=void 0;const CT=TT;var xT,ST=n(403);!function(e){e[e.Sunday=1]="Sunday",e[e.Monday=2]="Monday",e[e.Tuesday=3]="Tuesday",e[e.Wednesday=4]="Wednesday",e[e.Thursday=5]="Thursday",e[e.Friday=6]="Friday",e[e.Saturday=7]="Saturday"}(xT||(xT={}));const IT=(0,ST.F3)("LocalNotifications",{web:()=>n.e(640).then(n.bind(n,640)).then(e=>new e.LocalNotificationsWeb)});class kT{constructor(){this.config=void 0,this.audioInitialized=!1,this.initializationPromise=null,this.config={isMobile:ST.Ii.isNativePlatform(),isCapacitor:ST.Ii.isNativePlatform(),isIOS:"ios"===ST.Ii.getPlatform(),isAndroid:"android"===ST.Ii.getPlatform()}}static getInstance(){return kT.instance||(kT.instance=new kT),kT.instance}getConfig(){return Ve({},this.config)}isMobile(){return this.config.isMobile}isCapacitor(){return this.config.isCapacitor}isIOS(){return this.config.isIOS}isAndroid(){return this.config.isAndroid}async initializeAudio(){if(this.audioInitialized)return!0;if(this.initializationPromise)return this.initializationPromise;this.initializationPromise=this._doInitializeAudio();const e=await this.initializationPromise;return this.initializationPromise=null,e}async _doInitializeAudio(){try{if(!this.config.isMobile)return this.audioInitialized=!0,!0;if(this.config.isCapacitor)try{await IT.requestPermissions()}catch(I_){}return this.audioInitialized=!0,!0}catch(I_){return this.audioInitialized=!1,!1}}isAudioReady(){return this.audioInitialized}async showMobileAlert(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"info";if(this.config.isCapacitor)try{await IT.schedule({notifications:[{title:e,body:t,id:Date.now(),schedule:{at:new Date(Date.now()+1e3)},sound:"error"===n?"default":void 0,actionTypeId:"ALERT_ACTION",extra:{type:n}}]})}catch(I_){}}async onUserInteraction(){return!!this.audioInitialized||await this.initializeAudio()}reset(){this.audioInitialized=!1,this.initializationPromise=null}}kT.instance=void 0;const PT=kT;class NT{constructor(){this.elevenLabsService=void 0,this.mobileAudioService=void 0,this.lastAlertTime=new Map,this.alertCooldown=1e4,this.isPlaying=!1,this.alertCallback=null,this.elevenLabsService=CT.getInstance(),this.mobileAudioService=PT.getInstance()}static getInstance(){return NT.instance||(NT.instance=new NT),NT.instance}async checkAndAlert(e,t){if(!this.elevenLabsService.isConfigured())return;const n=this.analyzeDangerConditions(e,t);for(const i of n)await this.playAlert(i)}analyzeDangerConditions(e,t){const n=[];e.dangerMode&&n.push({type:"danger_mode",message:"Alert! ".concat(t.name," is in danger mode. Heart rate is critically high or low. Immediate attention required."),priority:"high"}),(e.highActivity||e.crashDetected)&&n.push({type:"high_activity",message:"Warning! ".concat(t.name," has detected sudden movement or possible crash. Please check on your pet immediately."),priority:"high"}),e.heartRate&&(e.heartRate>150?n.push({type:"heart_rate_danger",message:"Alert! ".concat(t.name,"'s heart rate is dangerously high at ").concat(e.heartRate," beats per minute."),priority:"high"}):e.heartRate<40&&n.push({type:"heart_rate_danger",message:"Alert! ".concat(t.name,"'s heart rate is dangerously low at ").concat(e.heartRate," beats per minute."),priority:"high"}));return n}async playAlert(e){const t=e.type,n=Date.now();if(!(n-(this.lastAlertTime.get(t)||0)<this.alertCooldown)&&!this.isPlaying)try{this.isPlaying=!0,this.lastAlertTime.set(t,n),this.alertCallback&&this.alertCallback({type:"high"===e.priority?"danger":"warning",title:this.getAlertTitle(e.type),message:e.message,priority:e.priority,actions:[{label:"OK",onClick:()=>{}}]});const r="high"===e.priority?ET.VOICE_SETTINGS.alert:ET.VOICE_SETTINGS.normal;try{if(this.mobileAudioService.isMobile()){if(!await this.mobileAudioService.onUserInteraction())return void console.log("Mobile audio not ready for danger alert, skipping voice playback")}if(!this.elevenLabsService.isAudioContextReady())return void console.log("AudioContext not ready for danger alert, skipping voice playback");await this.elevenLabsService.playText(e.message,{voiceSettings:r,showAlert:!1,alertTitle:this.getAlertTitle(e.type)})}catch(i){console.log("Voice alert failed, visual alert still active:",i)}}catch(I_){}finally{this.isPlaying=!1}}async playCustomAlert(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"medium";if(!this.elevenLabsService.isConfigured())return;const n={type:"danger_mode",message:e,priority:t};await this.playAlert(n)}isCurrentlyPlaying(){return this.isPlaying}setAlertCooldown(e){this.alertCooldown=1e3*e}clearAlertHistory(){this.lastAlertTime.clear()}setAlertCallback(e){this.alertCallback=e}getAlertTitle(e){switch(e){case"danger_mode":return"\ud83d\udea8 Danger Mode";case"high_activity":return"\u26a0\ufe0f High Activity";case"crash_detected":return"\ud83d\udca5 Crash Detected";case"temperature_danger":return"\ud83c\udf21\ufe0f Temperature Alert";case"heart_rate_danger":return"\ud83d\udc93 Heart Rate Alert";default:return"\u26a0\ufe0f Pet Alert"}}}NT.instance=void 0;const AT=NT,RT=e=>{let{alert:n,onClose:i,onAction:r}=e;const[s,o]=(0,t.useState)(!1),[a,l]=(0,t.useState)(!1),c=(0,t.useRef)(null),u=(0,t.useRef)(null);(0,t.useEffect)(()=>{const e=setTimeout(()=>{o(!0),l(!0),n.duration&&n.duration>0&&(c.current=setTimeout(()=>{h()},n.duration))},50);return()=>{clearTimeout(e),c.current&&clearTimeout(c.current),u.current&&clearTimeout(u.current)}},[n.duration]);const h=()=>{l(!1),u.current=setTimeout(()=>{o(!1),i(n.id)},300)};if(!s)return null;return(0,jE.jsx)("div",{className:(()=>{const e="in-app-alert--".concat(n.type),t="in-app-alert--".concat(n.priority),i=a?"in-app-alert--show":"in-app-alert--hide";return"".concat("in-app-alert"," ").concat(e," ").concat(t," ").concat(i)})(),children:(0,jE.jsxs)("div",{className:"in-app-alert__content",children:[(0,jE.jsxs)("div",{className:"in-app-alert__header",children:[(0,jE.jsx)("div",{className:"in-app-alert__icon",children:(()=>{switch(n.type){case"voice":return"\ud83d\udd0a";case"danger":return"\ud83d\udea8";case"warning":return"\u26a0\ufe0f";case"info":return"\u2139\ufe0f";default:return"\ud83d\udce2"}})()}),(0,jE.jsx)("div",{className:"in-app-alert__title",children:n.title}),(0,jE.jsx)("button",{className:"in-app-alert__close",onClick:h,"aria-label":"Close alert",children:"\xd7"})]}),(0,jE.jsx)("div",{className:"in-app-alert__message",children:n.message}),n.actions&&n.actions.length>0&&(0,jE.jsx)("div",{className:"in-app-alert__actions",children:n.actions.map((e,t)=>(0,jE.jsx)("button",{className:"in-app-alert__action",onClick:()=>{return t=e.label,r&&r(n.id,t),void h();var t},children:e.label},t))})]})})},LT=t.createContext(null),OT=e=>{let{children:n}=e;const[i,r]=(0,t.useState)([]),s=(0,t.useCallback)(()=>"alert_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),[]),o=(0,t.useCallback)(e=>{var t;const n=s(),i=Ve(Ve({},e),{},{id:n,duration:null!==(t=e.duration)&&void 0!==t?t:"high"===e.priority?8e3:5e3});return r(e=>[...e.filter(e=>!(e.type===i.type&&e.message===i.message)),i]),n},[s]),a=(0,t.useCallback)(e=>{r(t=>t.filter(t=>t.id!==e))},[]),l=(0,t.useCallback)(()=>{r([])},[]),c=(0,t.useCallback)((e,t)=>{},[]);(0,t.useEffect)(()=>{const e=setInterval(()=>{r(e=>{const t=Date.now();return e.filter(e=>{const n=parseInt(e.id.split("_")[1]);return t-n<3e4})})},5e3);return()=>clearInterval(e)},[]);const u={showAlert:o,hideAlert:a,clearAllAlerts:l};return(0,jE.jsxs)(LT.Provider,{value:u,children:[n,i.slice().reverse().map(e=>(0,jE.jsx)(RT,{alert:e,onClose:a,onAction:c},e.id))]})},DT=()=>{const e=(0,t.useContext)(LT);if(!e)throw new Error("useAlert must be used within an AlertManager");return{showAlert:e.showAlert,hideAlert:e.hideAlert,clearAllAlerts:e.clearAllAlerts,showVoiceAlert:function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Voice Alert";return e.showAlert({type:"voice",title:n,message:t,priority:"medium",duration:6e3,actions:[{label:"Dismiss",onClick:()=>{}}]})},showDangerAlert:function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Danger Alert",i=arguments.length>2?arguments[2]:void 0;return e.showAlert({type:"danger",title:n,message:t,priority:"high",duration:1e4,actions:i||[{label:"OK",onClick:()=>{}}]})},showWarningAlert:function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Warning",i=arguments.length>2?arguments[2]:void 0;return e.showAlert({type:"warning",title:n,message:t,priority:"medium",duration:7e3,actions:i||[{label:"Dismiss",onClick:()=>{}}]})},showInfoAlert:function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Info",i=arguments.length>2?arguments[2]:void 0;return e.showAlert({type:"info",title:n,message:t,priority:"low",duration:5e3,actions:i||[{label:"OK",onClick:()=>{}}]})}}},MT=()=>{const{showVoiceAlert:e,showDangerAlert:n,showWarningAlert:i,showInfoAlert:r}=DT(),s=(0,t.useRef)(CT.getInstance());return(0,t.useEffect)(()=>{const t=t=>{const{type:n,text:r,alertTitle:o}=t;switch(n){case"voice_start":e(r,o||"Voice Alert");break;case"voice_error":i("Voice playback failed: ".concat(r),"Voice Error",[{label:"Retry",onClick:async()=>{try{s.current.isAudioContextReady()||await s.current.initializeAudioContext(),await s.current.playText(r,{alertTitle:o})}catch(I_){console.warn("Failed to retry voice playback:",I_)}}},{label:"Dismiss",onClick:()=>{}}])}};return s.current.addEventListener(t),()=>{s.current.removeEventListener(t)}},[e,n,i,r]),{showVoiceAlert:e,showDangerAlert:n,showWarningAlert:i,showInfoAlert:r}},jT={id:"pet_1",name:"Nola",breed:"Labrador",birthdate:new Date(16e11),photoURL:void 0},FT=()=>{const[e,n]=(0,t.useState)([]),[i,r]=(0,t.useState)(null),[s,o]=(0,t.useState)(null),[a,l]=(0,t.useState)(null),[c,u]=(0,t.useState)(!1),[h,d]=(0,t.useState)(!0),[f,p]=(0,t.useState)(null),[m,g]=(0,t.useState)(!0),_=(0,t.useRef)(AT.getInstance()),v=(0,t.useRef)(CT.getInstance()),y=(0,t.useRef)(null);MT(),(()=>{const{showDangerAlert:e,showWarningAlert:n}=DT();(0,t.useEffect)(()=>(AT.getInstance().setAlertCallback(t=>{switch(t.type){case"danger":e(t.message,t.title,t.actions);break;case"warning":case"info":n(t.message,t.title,t.actions)}}),()=>{AT.getInstance().setAlertCallback(null)}),[e,n])})();const w=e.find(e=>e.id===i)||e[0];(0,t.useEffect)(()=>{b()},[]),(0,t.useEffect)(()=>{e.length>0&&!i&&r(e[0].id)},[e,i]),(0,t.useEffect)(()=>{l({centerLatitude:40.502209,centerLongitude:-74.45195,radius:50})},[]),(0,t.useEffect)(()=>{const e=yT.subscribeToDogHealth(e=>{u(!0);const t={petId:i||"default",timestamp:e.timestamp||Date.now(),heartRate:e.heartRate,bodyTemperature:70,activityStatus:e.highActivity?UE.UNUSUAL:UE.RESTING,ambientTemperature:0,bloodPressure:{systolic:0,diastolic:0},respiratoryRate:0,oxygenSaturation:0,dangerMode:e.dangerMode,highActivity:e.highActivity,crashDetected:e.highActivity,suddenMovement:e.highActivity,latitude:0,longitude:0};o(t),m&&w&&(async(e,t)=>{y.current&&y.current.dangerMode===e.dangerMode&&y.current.highActivity===e.highActivity&&y.current.heartRate===e.heartRate||(y.current=Ve({},e),await _.current.checkAndAlert(e,t))})(t,w)},3e3);return()=>{e()}},[i,m,w]);const b=async()=>{try{d(!0),p(null);const e=await bT.getPets();n(e)}catch(f){p("Failed to load pets"),n([jT])}finally{d(!1)}},E=()=>{if(!s)return"#999999";if(s.dangerMode||s.crashDetected)return"#F44336";if(s.highActivity)return"#FF9800";switch(s.activityStatus){case UE.RESTING:return"var(--success-color)";case UE.WALKING:return"var(--warning-color)";case UE.PLAYING:return"#6699CC";case UE.UNUSUAL:return"var(--danger-color)";default:return"#999999"}},T=s&&s.heartRate?s.heartRate>120?{text:"Elevated",color:"var(--warning-color)"}:s.heartRate<60?{text:"Low",color:"var(--warning-color)"}:{text:"Normal Range",color:"var(--success-color)"}:{text:"No Data",color:"#999999"};return h?(0,jE.jsxs)("div",{className:"dashboard-view",children:[(0,jE.jsx)("div",{className:"dashboard-header",children:(0,jE.jsx)("h1",{children:"Dashboard"})}),(0,jE.jsx)("div",{className:"loading-message",children:"Loading pets..."})]}):f&&0===e.length?(0,jE.jsxs)("div",{className:"dashboard-view",children:[(0,jE.jsx)("div",{className:"dashboard-header",children:(0,jE.jsx)("h1",{children:"Dashboard"})}),(0,jE.jsx)("div",{className:"error-message",children:f})]}):w?(0,jE.jsxs)("div",{className:"dashboard-view",children:[(0,jE.jsxs)("div",{className:"dashboard-header",children:[(0,jE.jsx)("h1",{children:"Dashboard"}),(0,jE.jsx)("div",{className:"dashboard-controls",children:(0,jE.jsx)("button",{className:"alert-toggle ".concat(m?"enabled":"disabled"),onClick:async()=>{const e=!m;if(e)try{await v.current.initializeAudioContext()}catch(f){}g(e)},title:m?"Disable voice alerts":"Enable voice alerts",children:m?"\ud83d\udd0a":"\ud83d\udd07"})})]}),(0,jE.jsxs)("div",{className:"dashboard-content",children:[e.length>1&&(0,jE.jsxs)("div",{className:"pet-selector",children:[(0,jE.jsx)("label",{className:"pet-selector-label",children:"Select Pet:"}),(0,jE.jsx)("div",{className:"pet-cards-container",children:e.map(e=>(0,jE.jsxs)("div",{className:"pet-card ".concat(i===e.id?"selected":""),onClick:()=>r(e.id),children:[(0,jE.jsx)("div",{className:"pet-card-avatar",children:e.photoURL?(0,jE.jsx)("img",{src:e.photoURL,alt:e.name}):(0,jE.jsx)("div",{className:"pet-card-icon",children:"\ud83d\udc3e"})}),(0,jE.jsxs)("div",{className:"pet-card-info",children:[(0,jE.jsx)("div",{className:"pet-card-name",children:e.name}),(0,jE.jsx)("div",{className:"pet-card-breed",children:e.breed})]})]},e.id))})]}),(0,jE.jsxs)("div",{className:"pet-header",children:[(0,jE.jsxs)("div",{className:"pet-info",children:[(0,jE.jsx)("div",{className:"pet-icon",children:"\ud83d\udc3e"}),(0,jE.jsxs)("div",{className:"pet-details",children:[(0,jE.jsx)("h2",{className:"pet-name",children:w.name}),(0,jE.jsx)("p",{className:"pet-breed",children:w.breed}),(0,jE.jsx)("p",{className:"pet-status",children:(()=>{if(!s)return"Awaiting Data";switch(s.activityStatus){case UE.RESTING:return"Resting";case UE.WALKING:return"Walking";case UE.PLAYING:return"Playing";case UE.UNUSUAL:return"Active";default:return"Awaiting Data"}})()})]})]}),(0,jE.jsx)("div",{className:"status-badge",style:{backgroundColor:E()+"20",color:E()},children:(()=>{if(!s)return"No Data Available";if(s.dangerMode)return"\u26a0\ufe0f Danger Mode";if(s.highActivity)return"\ud83d\udea8 High Activity";if(s.crashDetected)return"\ud83d\udca5 Crash Detected";switch(s.activityStatus){case UE.RESTING:return"Safe & Secure";case UE.WALKING:return"\ud83d\udeb6 On a Walk";case UE.PLAYING:return"\ud83c\udfbe Playing";case UE.UNUSUAL:return"\u26a1 Unusual Activity";default:return"\u2753 Unknown Status"}})()})]}),(0,jE.jsx)("div",{className:"map-container",children:(0,jE.jsx)(gT,{petImageURL:w.photoURL,petCoordinate:s&&s.latitude&&s.longitude?{lat:s.latitude,lng:s.longitude}:null,safeZone:a,onSafeZoneUpdate:e=>{l(e)}})}),(0,jE.jsxs)("div",{className:"vitals-section",children:[(0,jE.jsxs)("div",{className:"vitals-header",children:[(0,jE.jsx)("h3",{children:"Live Vitals"}),c&&(0,jE.jsxs)("div",{className:"live-indicator",children:[(0,jE.jsx)("div",{className:"pulse-dot"}),(0,jE.jsx)("span",{children:"Live"})]})]}),(0,jE.jsxs)("div",{className:"vitals-grid",children:[(0,jE.jsx)(_T,{icon:"\u2764\ufe0f",iconColor:null!==s&&void 0!==s&&s.dangerMode?"#F44336":"red",title:"Heart Rate",value:null!==s&&void 0!==s&&s.heartRate?"".concat(s.heartRate," bpm"):"No Data",status:c?"".concat(T.text," \u2022 Live"):"No Data",statusColor:c?T.color:"#999999"}),(0,jE.jsx)(_T,{icon:"\ud83c\udf21\ufe0f",iconColor:"orange",title:"Environment Temperature",value:"70\xb0F",status:(C=70,C<20?"Dangerous - Hypothermia Risk":C<32?"Too Cold - Frostbite Risk":C<45?"Cold - Some Dogs Uncomfortable":C>=45&&C<=75?"Perfect Weather":C<=85?"Warm - Monitor Activity":C<=95?"Hot - Heat Exhaustion Risk":"Dangerous - Heatstroke Risk"),statusColor:(e=>e<20?"#F44336":e<32?"#FF5722":e<45?"#FF9800":e>=45&&e<=75?"#4CAF50":e<=85?"#FFC107":e<=95?"#FF9800":"#F44336")(70)}),(0,jE.jsx)(_T,{icon:"\u26a0\ufe0f",iconColor:null!==s&&void 0!==s&&s.dangerMode?"#F44336":"#4CAF50",title:"Health Status",value:s?s.dangerMode?"\u26a0\ufe0f ALERT":"Safe":"No Data",status:s?s.dangerMode?"Critical Health Issue":"All Vitals Normal":"No Data",statusColor:s?s.dangerMode?"#F44336":"#4CAF50":"#999999"}),(0,jE.jsx)(_T,{icon:"\ud83d\udca5",iconColor:null!==s&&void 0!==s&&s.highActivity?"#F44336":"#4CAF50",title:"Activity Monitor",value:s?s.highActivity?"\ud83d\udea8 ALERT":"Normal":"No Data",status:s?s.highActivity?"Sudden Movement/Crash Detected":"Normal Activity Levels":"No Data",statusColor:s?s.highActivity?"#F44336":"#4CAF50":"#999999"})]})]})]})]}):(0,jE.jsxs)("div",{className:"dashboard-view",children:[(0,jE.jsx)("div",{className:"dashboard-header",children:(0,jE.jsx)("h1",{children:"Dashboard"})}),(0,jE.jsxs)("div",{className:"no-pets-message",children:[(0,jE.jsx)("div",{className:"no-pets-icon",children:"\ud83d\udc3e"}),(0,jE.jsx)("p",{children:"No pets found"}),(0,jE.jsx)("small",{children:"Add a pet in your profile to get started!"})]})]});var C},UT=e=>{let{isOpen:n,onClose:i,onPetAdded:r}=e;const[s,o]=(0,t.useState)({name:"",breed:"",birthdate:""}),[a,l]=(0,t.useState)(!1),[c,u]=(0,t.useState)(null),h=()=>{a||(o({name:"",breed:"",birthdate:""}),u(null),i())};return n?(0,jE.jsx)("div",{className:"modal-overlay",onClick:h,children:(0,jE.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,jE.jsxs)("div",{className:"modal-header",children:[(0,jE.jsx)("h2",{children:"Add New Pet"}),(0,jE.jsx)("button",{className:"close-button",onClick:h,disabled:a,children:"\u2715"})]}),(0,jE.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),l(!0),u(null);try{if(!s.name.trim()||!s.breed.trim()||!s.birthdate)return void u("Please fill in all fields.");const e={name:s.name.trim(),breed:s.breed.trim(),birthdate:new Date(s.birthdate)},t=await bT.addPet(e);r(t),o({name:"",breed:"",birthdate:""}),i()}catch(c){u(c.message||"Failed to add pet. Please try again.")}finally{l(!1)}},className:"pet-form",children:[(0,jE.jsxs)("div",{className:"form-group",children:[(0,jE.jsx)("label",{htmlFor:"name",children:"Pet Name *"}),(0,jE.jsx)("input",{type:"text",id:"name",value:s.name,onChange:e=>o(Ve(Ve({},s),{},{name:e.target.value})),placeholder:"Enter pet's name",required:!0,disabled:a})]}),(0,jE.jsxs)("div",{className:"form-group",children:[(0,jE.jsx)("label",{htmlFor:"breed",children:"Breed *"}),(0,jE.jsxs)("select",{id:"breed",value:s.breed,onChange:e=>o(Ve(Ve({},s),{},{breed:e.target.value})),required:!0,disabled:a,className:"breed-select",children:[(0,jE.jsx)("option",{value:"",children:"Select a breed"}),(0,jE.jsx)("option",{value:"Labrador Retriever",children:"Labrador Retriever"}),(0,jE.jsx)("option",{value:"Golden Retriever",children:"Golden Retriever"}),(0,jE.jsx)("option",{value:"German Shepherd",children:"German Shepherd"}),(0,jE.jsx)("option",{value:"French Bulldog",children:"French Bulldog"}),(0,jE.jsx)("option",{value:"Bulldog",children:"Bulldog"}),(0,jE.jsx)("option",{value:"Poodle",children:"Poodle"}),(0,jE.jsx)("option",{value:"Beagle",children:"Beagle"}),(0,jE.jsx)("option",{value:"Rottweiler",children:"Rottweiler"}),(0,jE.jsx)("option",{value:"German Shorthaired Pointer",children:"German Shorthaired Pointer"}),(0,jE.jsx)("option",{value:"Siberian Husky",children:"Siberian Husky"})]})]}),(0,jE.jsxs)("div",{className:"form-group",children:[(0,jE.jsx)("label",{htmlFor:"birthdate",children:"Birth Date *"}),(0,jE.jsx)("input",{type:"date",id:"birthdate",value:s.birthdate,onChange:e=>o(Ve(Ve({},s),{},{birthdate:e.target.value})),required:!0,disabled:a,max:(new Date).toISOString().split("T")[0]})]}),c&&(0,jE.jsx)("div",{className:"error-message",children:c}),(0,jE.jsxs)("div",{className:"modal-actions",children:[(0,jE.jsx)("button",{type:"button",className:"cancel-button",onClick:h,disabled:a,children:"Cancel"}),(0,jE.jsx)("button",{type:"submit",className:"submit-button",disabled:a,children:a?"Adding...":"Add Pet"})]})]})]})}):null},zT=e=>{let{user:n}=e;const[i,r]=(0,t.useState)([]),[s,o]=(0,t.useState)(!1),[a,l]=(0,t.useState)(!0),[c,u]=(0,t.useState)(null),[h,d]=(0,t.useState)([]),[f,p]=(0,t.useState)(!1),[m,g]=(0,t.useState)(""),[_,v]=(0,t.useState)(null);(0,t.useEffect)(()=>(y(),OE.updateUserOnlineStatus(n.id,!0),()=>{OE.updateUserOnlineStatus(n.id,!1)}),[n.id]);const y=async()=>{try{l(!0),u(null);const e=await OE.getOrCreateUserProfile(n);v(e),d(e.tags||[]),await w()}catch(c){u("Failed to load profile data"),v(n),d(n.tags||[])}finally{l(!1)}},w=async()=>{try{const e=await bT.getPets();r(e)}catch(c){}},b=async e=>{const t=e||m;if(t.trim()&&!h.includes(t.trim())){const e=[...h,t.trim()];d(e),g(""),p(!1);try{await OE.updateUserTags(n.id,e),_&&v(Ve(Ve({},_),{},{tags:e}))}catch(c){d(h)}}},E=e=>{if(!e||isNaN(e.getTime()))return"Unknown age";const t=new Date,n=t.getFullYear()-e.getFullYear(),i=t.getMonth()-e.getMonth();if(i<0||0===i&&t.getDate()<e.getDate())return"".concat(n-1," years old");if(0===n){const e=i||1;return"".concat(e," month").concat(e>1?"s":""," old")}return"".concat(n," year").concat(n>1?"s":""," old")};return a?(0,jE.jsxs)("div",{className:"profile-view",children:[(0,jE.jsx)("div",{className:"profile-header",children:(0,jE.jsx)("h1",{children:"Profile"})}),(0,jE.jsx)("div",{className:"profile-content",children:(0,jE.jsxs)("div",{className:"loading-message",children:[(0,jE.jsx)("div",{className:"loading-spinner",children:"\ud83d\udc3e"}),(0,jE.jsx)("p",{children:"Loading profile..."})]})})]}):(0,jE.jsxs)("div",{className:"profile-view",children:[(0,jE.jsx)("div",{className:"profile-header",children:(0,jE.jsx)("h1",{children:"Profile"})}),(0,jE.jsxs)("div",{className:"profile-content",children:[(0,jE.jsxs)("div",{className:"profile-section",children:[(0,jE.jsx)("h2",{children:"My Pets"}),c&&(0,jE.jsx)("div",{className:"error-message",children:c}),(0,jE.jsxs)("div",{className:"pets-list",children:[0===i.length&&(0,jE.jsxs)("div",{className:"no-pets-message",children:[(0,jE.jsx)("div",{className:"no-pets-icon",children:"\ud83d\udc3e"}),(0,jE.jsx)("p",{children:"No pets added yet"}),(0,jE.jsx)("small",{children:"Add your first pet to get started!"})]}),i.map(e=>(0,jE.jsxs)("div",{className:"pet-item",children:[(0,jE.jsx)("div",{className:"pet-icon",children:"\ud83d\udc3e"}),(0,jE.jsxs)("div",{className:"pet-info",children:[(0,jE.jsx)("div",{className:"pet-name",children:e.name}),(0,jE.jsx)("div",{className:"pet-breed",children:e.breed}),(0,jE.jsx)("div",{className:"pet-age",children:E(e.birthdate)})]}),(0,jE.jsx)("button",{className:"delete-pet-button",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this pet?"))try{await bT.deletePet(e),r(t=>t.filter(t=>t.id!==e))}catch(c){}})(e.id),title:"Delete pet",children:"\ud83d\uddd1\ufe0f"})]},e.id)),(0,jE.jsxs)("button",{className:"add-pet-button",onClick:()=>o(!0),children:[(0,jE.jsx)("span",{className:"add-icon",children:"\u2795"}),(0,jE.jsx)("span",{children:"Add New Pet"})]})]})]}),(0,jE.jsxs)("div",{className:"profile-section",children:[(0,jE.jsx)("h2",{children:"Profile Tags"}),(0,jE.jsx)("p",{className:"section-description",children:"Add tags to help other pet owners find you"}),(0,jE.jsx)("div",{className:"user-tags-container",children:h.map((e,t)=>(0,jE.jsxs)("div",{className:"user-tag",children:[(0,jE.jsx)("span",{children:e}),(0,jE.jsx)("button",{className:"remove-tag-btn",onClick:()=>(async e=>{const t=h.filter(t=>t!==e);d(t);try{await OE.updateUserTags(n.id,t),_&&v(Ve(Ve({},_),{},{tags:t}))}catch(c){d(h)}})(e),title:"Remove tag",children:"\xd7"})]},t))}),f?(0,jE.jsxs)("div",{className:"tag-input-container",children:[(0,jE.jsx)("input",{type:"text",value:m,onChange:e=>g(e.target.value),placeholder:"Enter a tag...",className:"tag-input",onKeyPress:e=>"Enter"===e.key&&b()}),(0,jE.jsx)("button",{className:"save-tag-btn",onClick:()=>b(),disabled:!m.trim(),children:"Add"}),(0,jE.jsx)("button",{className:"cancel-tag-btn",onClick:()=>{p(!1),g("")},children:"Cancel"})]}):(0,jE.jsxs)("button",{className:"add-tag-button",onClick:()=>p(!0),children:[(0,jE.jsx)("span",{className:"add-icon",children:"\u2795"}),(0,jE.jsx)("span",{children:"Add Tag"})]}),(0,jE.jsxs)("div",{className:"predefined-tags",children:[(0,jE.jsx)("p",{className:"predefined-tags-title",children:"Quick add:"}),(0,jE.jsx)("div",{className:"predefined-tags-list",children:["Looking for pet friends","Looking for pet sitters","Dog walking buddy","Pet playdates","Pet advice needed","Experienced pet owner","New pet owner","Pet training help"].filter(e=>!h.includes(e)).map((e,t)=>(0,jE.jsx)("button",{className:"predefined-tag",onClick:()=>b(e),children:e},t))})]})]}),(0,jE.jsxs)("div",{className:"profile-section",children:[(0,jE.jsx)("h2",{children:"Account"}),(0,jE.jsx)("div",{className:"account-info",children:_&&(0,jE.jsxs)(jE.Fragment,{children:[(0,jE.jsxs)("div",{className:"account-item",children:[(0,jE.jsx)("span",{className:"account-label",children:"Name"}),(0,jE.jsx)("span",{className:"account-value",children:_.displayName})]}),(0,jE.jsxs)("div",{className:"account-item",children:[(0,jE.jsx)("span",{className:"account-label",children:"Email"}),(0,jE.jsx)("span",{className:"account-value",children:_.email})]}),_.bio&&(0,jE.jsxs)("div",{className:"account-item",children:[(0,jE.jsx)("span",{className:"account-label",children:"Bio"}),(0,jE.jsx)("span",{className:"account-value",children:_.bio})]})]})}),(0,jE.jsxs)("button",{className:"sign-out-button",onClick:async()=>{try{await ME.signOut()}catch(c){}},children:[(0,jE.jsx)("span",{className:"sign-out-icon",children:"\ud83d\udeaa"}),(0,jE.jsx)("span",{children:"Log Out"})]})]})]}),s&&(0,jE.jsx)(UT,{isOpen:s,onClose:()=>o(!1),onPetAdded:e=>{r(t=>[e,...t])}})]})};class BT{static getInstance(){return BT.instance||(BT.instance=new BT),BT.instance}async uploadImage(e,t){try{const n=this.validateImageFile(e);if(!n.isValid)throw new Error(n.error||"Invalid file");const i=Date.now(),r="".concat(i,"_").concat(e.name),s="".concat(t).concat(r),o=function(e,t,n){return Pm(e=Se(e),t,n)}(zm(NE,s),e),a=new Promise((e,t)=>{setTimeout(()=>{t(new Error("Upload timeout - please check your internet connection"))},6e4)}),l=function(e){return Nm(e=Se(e))}((await Promise.race([o,a])).ref),c=new Promise((e,t)=>{setTimeout(()=>{t(new Error("Failed to get download URL - please try again"))},15e3)});return await Promise.race([l,c])}catch(I_){const t=I_ instanceof Error?I_.message:"Unknown error",n=(null===I_||void 0===I_?void 0:I_.code)||"unknown";if("storage/unauthorized"===n)throw new Error("You do not have permission to upload files");if("storage/canceled"===n)throw new Error("Upload was canceled");if("storage/invalid-format"===n)throw new Error("Invalid file format");if("storage/invalid-checksum"===n)throw new Error("File upload failed - please try again");throw new Error("Failed to upload image: ".concat(t))}}async uploadPostImage(e,t){const n="posts/".concat(t,"/");return this.uploadImage(e,n)}async uploadPetImage(e,t,n){const i="pets/".concat(t,"/").concat(n,"/");return this.uploadImage(e,i)}async deleteImage(e){try{const t=new URL(e),n=decodeURIComponent(t.pathname.split("/o/")[1].split("?")[0]),i=zm(NE,n);await function(e){return Am(e=Se(e))}(i)}catch(I_){}}validateImageFile(e){if(!e.type.startsWith("image/"))return{isValid:!1,error:"File must be an image"};if(e.size>10485760)return{isValid:!1,error:"Image must be smaller than 10MB"};return e.size<1024?{isValid:!1,error:"Image file is too small"}:{isValid:!0}}}BT.instance=void 0;const VT=BT.getInstance();const qT=e=>{var n;let{post:i,onLike:r,onDelete:s,currentUserId:o}=e;const[a,l]=(0,t.useState)(!1),c=(null===(n=i.likes)||void 0===n?void 0:n.length)||0,u=new Date(i.timestamp).toLocaleString(),h=o&&i.userID===o,d=i.tag?{"missing-pet":{label:"Missing Pet",color:"#e74c3c"},"advice-needed":{label:"Advice Needed",color:"#f39c12"},"babysitter-wanted":{label:"Pet Sitter Wanted",color:"#9b59b6"},"found-pet":{label:"Found Pet",color:"#27ae60"},adoption:{label:"Adoption",color:"#3498db"},general:{label:"General",color:"#95a5a6"}}[f=i.tag]||{label:f,color:"#95a5a6"}:null;var f;return(0,jE.jsxs)(jE.Fragment,{children:[a&&(0,jE.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:(0,jE.jsxs)("div",{style:{backgroundColor:"var(--card-bg)",padding:"24px",borderRadius:"var(--border-radius)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.3)",maxWidth:"400px",width:"90%",textAlign:"center"},children:[(0,jE.jsx)("h3",{style:{color:"var(--text-primary)",marginBottom:"16px",fontSize:"18px",fontWeight:"600"},children:"Delete Post"}),(0,jE.jsx)("p",{style:{color:"var(--text-secondary)",marginBottom:"24px",lineHeight:"1.5"},children:"Are you sure you want to delete this post? This action cannot be undone."}),(0,jE.jsxs)("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[(0,jE.jsx)("button",{onClick:()=>{l(!1)},style:{padding:"10px 20px",border:"1px solid var(--accent-color)",backgroundColor:"transparent",color:"var(--accent-color)",borderRadius:"25px",cursor:"pointer",fontWeight:"600",fontSize:"14px",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="var(--accent-color)",e.currentTarget.style.color="white"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent",e.currentTarget.style.color="var(--accent-color)"},children:"Cancel"}),(0,jE.jsx)("button",{onClick:()=>{s(i.id),l(!1)},style:{padding:"10px 20px",border:"none",backgroundColor:"#e74c3c",color:"white",borderRadius:"25px",cursor:"pointer",fontWeight:"600",fontSize:"14px",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#c0392b"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="#e74c3c"},children:"Delete"})]})]})}),(0,jE.jsxs)("div",{className:"post-card",style:{background:"var(--card-bg)",borderRadius:"var(--border-radius)",padding:"20px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.08)",border:"1px solid rgba(204, 153, 102, 0.2)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 8px 30px rgba(0, 0, 0, 0.12)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 20px rgba(0, 0, 0, 0.08)"},children:[(0,jE.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:16},children:[(0,jE.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,jE.jsx)("div",{style:{fontWeight:700,color:"var(--text-primary)",fontSize:"16px"},children:i.authorName}),d&&(0,jE.jsx)("span",{style:{padding:"4px 12px",borderRadius:"20px",fontSize:"10px",fontWeight:700,color:"white",background:"linear-gradient(135deg, ".concat(d.color,", ").concat(d.color,"dd)"),boxShadow:"0 2px 8px ".concat(d.color,"40"),textTransform:"uppercase",letterSpacing:"0.5px"},children:d.label})]}),(0,jE.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,jE.jsx)("div",{style:{color:"var(--text-secondary)",fontSize:"12px",fontWeight:"500"},children:u}),h&&(0,jE.jsx)("button",{onClick:()=>{l(!0)},style:{background:"none",border:"none",color:"#e74c3c",cursor:"pointer",padding:"4px",borderRadius:"4px",fontSize:"16px",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#e74c3c20"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},title:"Delete post",children:"\ud83d\uddd1\ufe0f"})]})]}),(0,jE.jsx)("div",{style:{color:"var(--text-primary)",marginBottom:16,lineHeight:"1.6",fontSize:"15px"},children:i.postText}),i.imageURL&&(0,jE.jsx)("div",{style:{marginBottom:8},children:(0,jE.jsx)("img",{src:i.imageURL,alt:"Post image",style:{maxWidth:"100%",maxHeight:"400px",borderRadius:8,objectFit:"cover",cursor:"pointer"},onClick:()=>window.open(i.imageURL,"_blank"),onError:e=>{e.currentTarget.style.display="none"}})}),(0,jE.jsxs)("button",{onClick:()=>r(i.id),style:{border:"none",background:"linear-gradient(135deg, var(--accent-color), var(--accent-dark))",color:"white",padding:"12px 20px",borderRadius:"25px",cursor:"pointer",fontWeight:"600",fontSize:"14px",textTransform:"uppercase",letterSpacing:"0.5px",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:"0 3px 10px rgba(204, 153, 102, 0.3)"},onMouseEnter:e=>{const t=e.currentTarget;t.style.transform="translateY(-2px)",t.style.boxShadow="0 5px 15px rgba(204, 153, 102, 0.4)"},onMouseLeave:e=>{const t=e.currentTarget;t.style.transform="translateY(0)",t.style.boxShadow="0 3px 10px rgba(204, 153, 102, 0.3)"},children:["\u2764\ufe0f Like (",c,")"]})]})]})},HT=e=>{let{onClose:n,onSubmit:i}=e;const[r,s]=(0,t.useState)(""),[o,a]=(0,t.useState)(null),[l,c]=(0,t.useState)(!1),[u,h]=(0,t.useState)(null),[d,f]=(0,t.useState)(null),[p,m]=(0,t.useState)("");return(0,jE.jsx)("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1200,backdropFilter:"blur(4px)"},children:(0,jE.jsxs)("div",{style:{background:"var(--card-bg)",borderRadius:"var(--border-radius)",padding:24,width:"90%",maxWidth:520,maxHeight:"90vh",overflow:"auto",boxShadow:"0 20px 40px rgba(0,0,0,0.15)",border:"1px solid rgba(204, 153, 102, 0.2)"},children:[(0,jE.jsx)("div",{style:{fontWeight:700,marginBottom:20,fontSize:"1.5rem",color:"var(--accent-color)",textAlign:"center"},children:"Create Post"}),(0,jE.jsx)("textarea",{value:r,onChange:e=>s(e.target.value),placeholder:"What's on your mind?",rows:4,style:{width:"100%",padding:"16px 20px",borderRadius:"25px",border:"2px solid rgba(204, 153, 102, 0.3)",marginBottom:16,resize:"vertical",minHeight:"100px",fontSize:"16px",fontFamily:"inherit",outline:"none",transition:"all 0.3s ease",background:"white"},onFocus:e=>{e.target.style.borderColor="var(--accent-color)",e.target.style.boxShadow="0 0 0 3px rgba(204, 153, 102, 0.1)"},onBlur:e=>{e.target.style.borderColor="rgba(204, 153, 102, 0.3)",e.target.style.boxShadow="none"}}),(0,jE.jsxs)("div",{style:{marginBottom:20,padding:"16px",background:"linear-gradient(135deg, rgba(204, 153, 102, 0.05), rgba(204, 153, 102, 0.1))",borderRadius:"var(--border-radius)",border:"1px solid rgba(204, 153, 102, 0.2)"},children:[(0,jE.jsx)("label",{style:{display:"block",marginBottom:12,fontWeight:600,fontSize:"14px",color:"var(--text-primary)",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Post Category (Optional)"}),(0,jE.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:[{value:"",label:"No tag"},{value:"missing-pet",label:"Missing Pet",color:"#e74c3c"},{value:"advice-needed",label:"Advice Needed",color:"#f39c12"},{value:"babysitter-wanted",label:"Pet Sitter Wanted",color:"#9b59b6"},{value:"found-pet",label:"Found Pet",color:"#27ae60"},{value:"adoption",label:"Adoption",color:"#3498db"},{value:"general",label:"General",color:"#95a5a6"}].map(e=>(0,jE.jsx)("button",{type:"button",onClick:()=>m(e.value),style:{padding:"8px 16px",borderRadius:"20px",border:p===e.value?"2px solid ".concat(e.color):"2px solid rgba(204, 153, 102, 0.3)",background:p===e.value?"linear-gradient(135deg, ".concat(e.color,", ").concat(e.color,"dd)"):"white",color:p===e.value?"white":"var(--text-primary)",fontSize:"12px",fontWeight:p===e.value?700:500,cursor:"pointer",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:p===e.value?"0 4px 12px ".concat(e.color,"40"):"0 2px 5px rgba(0,0,0,0.1)",textTransform:"uppercase",letterSpacing:"0.5px"},onMouseEnter:t=>{if(p!==e.value){const e=t.currentTarget;e.style.transform="translateY(-2px)",e.style.boxShadow="0 4px 12px rgba(0,0,0,0.15)"}},onMouseLeave:t=>{if(p!==e.value){const e=t.currentTarget;e.style.transform="translateY(0)",e.style.boxShadow="0 2px 5px rgba(0,0,0,0.1)"}},children:e.label},e.value))})]}),(0,jE.jsxs)("div",{style:{marginBottom:12},children:[(0,jE.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;const n=(null===(t=e.target.files)||void 0===t?void 0:t[0])||null;if(h(null),n){if(!n.type.startsWith("image/"))return h("Please select an image file"),a(null),void f(null);const e=10485760;if(n.size>e)return h("Image must be smaller than 10MB"),a(null),void f(null);a(n);const t=URL.createObjectURL(n);f(t)}else a(null),f(null)},style:{marginBottom:8},id:"image-upload"}),u&&(0,jE.jsx)("div",{style:{color:"#e74c3c",fontSize:"14px",marginBottom:8},children:u}),d&&(0,jE.jsxs)("div",{style:{position:"relative",marginTop:8},children:[(0,jE.jsx)("img",{src:d,alt:"Preview",style:{width:"100%",maxHeight:"200px",objectFit:"cover",borderRadius:8,border:"1px solid #ddd"}}),(0,jE.jsx)("button",{onClick:()=>{a(null),h(null),d&&(URL.revokeObjectURL(d),f(null))},style:{position:"absolute",top:8,right:8,background:"rgba(0,0,0,0.7)",color:"white",border:"none",borderRadius:"50%",width:"24px",height:"24px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px"},children:"\xd7"})]})]}),(0,jE.jsxs)("div",{style:{display:"flex",gap:12,justifyContent:"flex-end",marginTop:24},children:[(0,jE.jsx)("button",{onClick:n,style:{background:"linear-gradient(135deg, #6c757d, #5a6268)",border:"none",padding:"12px 24px",borderRadius:"25px",cursor:"pointer",color:"white",fontWeight:"600",fontSize:"14px",textTransform:"uppercase",letterSpacing:"0.5px",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:"0 3px 10px rgba(0,0,0,0.15)"},onMouseEnter:e=>{const t=e.currentTarget;t.style.transform="translateY(-2px)",t.style.boxShadow="0 5px 15px rgba(108, 117, 125, 0.4)"},onMouseLeave:e=>{const t=e.currentTarget;t.style.transform="translateY(0)",t.style.boxShadow="0 3px 10px rgba(0,0,0,0.15)"},children:"Cancel"}),(0,jE.jsx)("button",{onClick:async()=>{if(!r.trim())return;if(u)return;const e=new FormData;e.append("postText",r.trim()),o&&e.append("image",o),p&&e.append("tag",p),c(!0);try{await i(e),n()}finally{c(!1)}},disabled:l||!!u,style:{background:l||u?"linear-gradient(135deg, #6c757d, #5a6268)":"linear-gradient(135deg, var(--accent-color), var(--accent-dark))",color:"white",border:"none",padding:"12px 24px",borderRadius:"25px",cursor:l||u?"not-allowed":"pointer",fontWeight:"600",fontSize:"14px",textTransform:"uppercase",letterSpacing:"0.5px",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:l||u?"0 2px 5px rgba(0,0,0,0.1)":"0 3px 10px rgba(204, 153, 102, 0.3)"},onMouseEnter:e=>{if(!l&&!u){const t=e.currentTarget;t.style.transform="translateY(-2px)",t.style.boxShadow="0 5px 15px rgba(204, 153, 102, 0.4)"}},onMouseLeave:e=>{if(!l&&!u){const t=e.currentTarget;t.style.transform="translateY(0)",t.style.boxShadow="0 3px 10px rgba(204, 153, 102, 0.3)"}},children:l?"Posting...":"Post"})]})]})})},WT=()=>{const[e,n]=(0,t.useState)([]),[i,r]=(0,t.useState)(!0),[s,o]=(0,t.useState)(null),[a,l]=(0,t.useState)(!1),[c,u]=(0,t.useState)(null),h=async()=>{try{r(!0);const e=await async function(){try{const t=tf(PE,"communityPosts");let n;try{const e=Wf(t,Jf("timestamp","desc"));n=await fp(e)}catch(e){n=await fp(t)}const i=[];return n.forEach(e=>{var t,n,r;const s=e.data();i.push({id:e.id,userID:s.userID||"",authorName:s.authorName||"Unknown",postText:s.postText||"",imageURL:s.imageURL||void 0,timestamp:(null===(t=s.timestamp)||void 0===t||null===(n=t.toDate)||void 0===n||null===(r=n.call(t))||void 0===r?void 0:r.toISOString())||s.timestamp||(new Date).toISOString(),likes:s.likes||[],tag:s.tag||void 0})}),i.sort((e,t)=>{const n=new Date(e.timestamp);return new Date(t.timestamp).getTime()-n.getTime()}),i}catch(s){const t=s instanceof Error?s.message:"Unknown error";throw new Error("Failed to fetch posts: ".concat(t))}}();e.sort((e,t)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime()),n(e)}catch(aC){o("Failed to load posts")}finally{r(!1)}};(0,t.useEffect)(()=>{h();(async()=>{try{const e=await ME.getCurrentUser();u((null===e||void 0===e?void 0:e.id)||null)}catch(s){}})()},[]);const d=async e=>{try{const t=await async function(e){try{const t=await ME.getCurrentUser();if(!t)throw new Error("User must be authenticated to like posts");const n=nf(PE,"communityPosts",e),i=await hp(n);if(!i.exists())throw new Error("Post not found");const r=i.data().likes||[],s=r.includes(t.id);return s?await pp(n,{likes:Tp(t.id)}):await pp(n,{likes:Ep(t.id)}),{success:!0,likes:s?r.filter(e=>e!==t.id):[...r,t.id]}}catch(s){throw new Error("Failed to like post")}}(e);n(n=>n.map(n=>n.id===e?Ve(Ve({},n),{},{likes:t.likes}):n))}catch(aC){}},f=async e=>{try{await async function(e){try{const t=await ME.getCurrentUser();if(!t)throw new Error("User must be authenticated to delete posts");const n=nf(PE,"communityPosts",e),i=await hp(n);if(!i.exists())throw new Error("Post not found");if(i.data().userID!==t.id)throw new Error("You can only delete your own posts");await mp(n)}catch(s){const t=s instanceof Error?s.message:"Unknown error";throw new Error("Failed to delete post: ".concat(t))}}(e),n(t=>t.filter(t=>t.id!==e))}catch(s){}};return(0,jE.jsxs)("div",{className:"community-feed",style:{padding:16},children:[(0,jE.jsx)("div",{className:"dashboard-header",style:{marginBottom:12},children:(0,jE.jsx)("h1",{children:"Community"})}),(0,jE.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:20},children:(0,jE.jsx)("button",{onClick:()=>l(!0),style:{background:"linear-gradient(135deg, var(--accent-color), var(--accent-dark))",color:"white",border:"none",padding:"12px 24px",borderRadius:"25px",cursor:"pointer",fontWeight:"600",fontSize:"14px",textTransform:"uppercase",letterSpacing:"0.5px",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:"0 3px 10px rgba(204, 153, 102, 0.3)"},onMouseEnter:e=>{const t=e.currentTarget;t.style.transform="translateY(-2px)",t.style.boxShadow="0 5px 15px rgba(204, 153, 102, 0.4)"},onMouseLeave:e=>{const t=e.currentTarget;t.style.transform="translateY(0)",t.style.boxShadow="0 3px 10px rgba(204, 153, 102, 0.3)"},children:"Create Post"})}),i&&(0,jE.jsx)("div",{children:"Loading posts..."}),s&&(0,jE.jsx)("div",{style:{color:"var(--danger-color)"},children:s}),(0,jE.jsx)("div",{style:{display:"grid",gap:12},children:e.map(e=>(0,jE.jsx)(qT,{post:e,onLike:d,onDelete:f,currentUserId:c||void 0},e.id))}),a&&(0,jE.jsx)(HT,{onClose:()=>l(!1),onSubmit:async e=>{const t=await async function(e){try{const t=await ME.getCurrentUser();if(!t)throw new Error("User must be authenticated to create posts");const n=e.get("postText"),i=e.get("image"),r=e.get("tag");let s;if(i&&i.size>0){const e=VT.validateImageFile(i);if(!e.isValid)throw new Error(e.error||"Invalid image file");s=await VT.uploadPostImage(i,t.id)}const o={postText:n,authorName:t.displayName,userID:t.id,timestamp:new Cf("serverTimestamp"),likes:[],imageURL:s,tag:r||void 0};return{id:(await gp(tf(PE,"communityPosts"),o)).id,userID:t.id,authorName:t.displayName,postText:n,imageURL:s,timestamp:(new Date).toISOString(),likes:[],tag:r||void 0}}catch(s){const t=s instanceof Error?s.message:"Unknown error";throw new Error("Failed to create post: ".concat(t))}}(e);n(e=>[t,...e])}})]})},KT=[{id:"vet_1",name:"East Brunswick Animal Hospital",address:"44 Arthur St, East Brunswick, NJ 08816",phone:"+1 732-254-1212",email:"privacy@nva.com"},{id:"vet_2",name:"Faith Veterinary Clinic",address:"2202 Route 130 North, Church Lane Plaza, US-130, North Brunswick Township, NJ 08902",phone:"+1 732-658-6777",email:"info@faithurgentvet.com"},{id:"vet_3",name:"Easton Animal Clinic",address:"802 Easton Ave, Somerset, NJ 08873",phone:"+1 732-246-2680",email:"eastonanimalclinic@gmail.com"},{id:"vet_4",name:"South Brunswick Animal Hospital",address:"879 Georges Rd, Monmouth Junction, NJ 08852",phone:"+1 732-821-0040",email:"sbanimalhospital@gmail.com"},{id:"vet_5",name:"Cedar Lane Animal Clinic",address:"1760 Easton Ave #6, Somerset, NJ 08873",phone:"+1 732-469-5133",email:"cedarlanegang@aol.com"}],GT=()=>(0,jE.jsxs)("div",{className:"nearby-vets-view",children:[(0,jE.jsxs)("div",{className:"vets-header",children:[(0,jE.jsx)("h1",{children:"Nearby Vets"}),(0,jE.jsx)("p",{className:"vets-subtitle",children:"Veterinary offices and animal hospitals near New Brunswick, NJ"})]}),(0,jE.jsx)("div",{className:"vets-content",children:(0,jE.jsx)("div",{className:"vets-list",children:KT.map(e=>(0,jE.jsxs)("div",{className:"vet-card",children:[(0,jE.jsxs)("div",{className:"vet-header",children:[(0,jE.jsx)("div",{className:"vet-icon",children:"\ud83c\udfe5"}),(0,jE.jsxs)("div",{className:"vet-info",children:[(0,jE.jsx)("h3",{className:"vet-name",children:e.name}),(0,jE.jsx)("p",{className:"vet-address",children:e.address})]})]}),(0,jE.jsx)("div",{className:"vet-details",children:(0,jE.jsxs)("div",{className:"vet-contact",children:[(0,jE.jsxs)("div",{className:"contact-item",children:[(0,jE.jsx)("span",{className:"contact-icon",children:"\ud83d\udcde"}),(0,jE.jsx)("span",{className:"contact-label",children:"Phone:"}),(0,jE.jsx)("span",{className:"contact-value",children:e.phone})]}),(0,jE.jsxs)("div",{className:"contact-item",children:[(0,jE.jsx)("span",{className:"contact-icon",children:"\u2709\ufe0f"}),(0,jE.jsx)("span",{className:"contact-label",children:"Email:"}),(0,jE.jsx)("span",{className:"contact-value",children:e.email})]})]})}),(0,jE.jsxs)("div",{className:"vet-actions",children:[(0,jE.jsxs)("button",{className:"action-button call-button",onClick:()=>{return t=e.phone,void window.open("tel:".concat(t),"_self");var t},children:[(0,jE.jsx)("span",{className:"action-icon",children:"\ud83d\udcde"}),(0,jE.jsx)("span",{children:"Call"})]}),(0,jE.jsxs)("button",{className:"action-button email-button",onClick:()=>{return t=e.email,void window.open("mailto:".concat(t),"_self");var t},children:[(0,jE.jsx)("span",{className:"action-icon",children:"\u2709\ufe0f"}),(0,jE.jsx)("span",{children:"Email"})]}),(0,jE.jsxs)("button",{className:"action-button directions-button",onClick:()=>(e=>{const t=encodeURIComponent(e);window.open("https://maps.google.com/maps?q=".concat(t),"_blank")})(e.address),children:[(0,jE.jsx)("span",{className:"action-icon",children:"\ud83d\udccd"}),(0,jE.jsx)("span",{children:"Directions"})]})]})]},e.id))})})]});class ZT{static async sendFriendRequest(e,t){try{if(await this.getFriendship(e,t))throw new Error("Users are already friends");if(await this.getPendingFriendRequest(e,t))throw new Error("Friend request already sent");if(await this.getPendingFriendRequest(t,e))throw new Error("This user has already sent you a friend request");const n={fromUserId:e,toUserId:t,status:"pending",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};return(await gp(tf(PE,this.FRIEND_REQUESTS_COLLECTION),n)).id}catch(I_){throw I_}}static async getPendingFriendRequest(e,t){try{const n=Wf(tf(PE,this.FRIEND_REQUESTS_COLLECTION),Gf("fromUserId","==",e),Gf("toUserId","==",t),Gf("status","==","pending")),i=await fp(n);if(i.empty)return null;const r=i.docs[0];return Ve({id:r.id},r.data())}catch(I_){throw I_}}static async acceptFriendRequest(e){try{const t=nf(PE,this.FRIEND_REQUESTS_COLLECTION,e),n=await hp(t);if(!n.exists())throw new Error("Friend request not found");const i=n.data();if("pending"!==i.status)throw new Error("Friend request is not pending");await pp(t,{status:"accepted",updatedAt:(new Date).toISOString()}),await this.createFriendship(i.fromUserId,i.toUserId)}catch(I_){throw I_}}static async declineFriendRequest(e){try{const t=nf(PE,this.FRIEND_REQUESTS_COLLECTION,e),n=await hp(t);if(!n.exists())throw new Error("Friend request not found");if("pending"!==n.data().status)throw new Error("Friend request is not pending");await pp(t,{status:"declined",updatedAt:(new Date).toISOString()})}catch(I_){throw I_}}static async createFriendship(e,t){try{const[n,i]=[e,t].sort(),r={userId1:n,userId2:i,createdAt:(new Date).toISOString()};return(await gp(tf(PE,this.FRIENDSHIPS_COLLECTION),r)).id}catch(I_){throw I_}}static async getFriendship(e,t){try{const[n,i]=[e,t].sort(),r=Wf(tf(PE,this.FRIENDSHIPS_COLLECTION),Gf("userId1","==",n),Gf("userId2","==",i)),s=await fp(r);if(s.empty)return null;const o=s.docs[0];return Ve({id:o.id},o.data())}catch(I_){throw I_}}static async removeFriendship(e,t){try{const n=await this.getFriendship(e,t);if(!n)throw new Error("Friendship not found");await mp(nf(PE,this.FRIENDSHIPS_COLLECTION,n.id))}catch(I_){throw I_}}static async getUserFriendships(e){try{const n=Wf(tf(PE,this.FRIENDSHIPS_COLLECTION),Qf(Gf("userId1","==",e),Gf("userId2","==",e)),Jf("createdAt","desc")),i=await fp(n),r=[];for(const s of i.docs){const n=s.data(),i=n.userId1===e?n.userId2:n.userId1;try{const e=await OE.getUserProfile(i);e&&r.push({id:s.id,friend:{id:e.id,displayName:e.displayName,email:e.email,photoURL:e.photoURL,bio:e.bio,location:e.location,tags:e.tags,isOnline:e.isOnline,lastSeen:e.lastSeen},createdAt:n.createdAt})}catch(t){}}return r}catch(I_){if(console.error("Error getting user friendships:",I_),"failed-precondition"===I_.code)return[];if("permission-denied"===I_.code)return[];if("unavailable"===I_.code)return[];throw I_}}static async getPendingFriendRequests(e){try{const n=Wf(tf(PE,this.FRIEND_REQUESTS_COLLECTION),Gf("toUserId","==",e),Gf("status","==","pending"),Jf("createdAt","desc")),i=await fp(n),r=[];for(const e of i.docs){const n=e.data();try{const t=await OE.getUserProfile(n.fromUserId);t&&r.push(Ve(Ve({},n),{},{id:e.id,fromUser:t}))}catch(t){}}return r}catch(I_){if(console.error("Error getting pending friend requests:",I_),"failed-precondition"===I_.code)return[];if("permission-denied"===I_.code)return[];if("unavailable"===I_.code)return[];throw I_}}static async getSentFriendRequests(e){try{const n=Wf(tf(PE,this.FRIEND_REQUESTS_COLLECTION),Gf("fromUserId","==",e),Gf("status","==","pending"),Jf("createdAt","desc")),i=await fp(n),r=[];for(const e of i.docs){const n=e.data();try{const t=await OE.getUserProfile(n.toUserId);t&&r.push(Ve(Ve({},n),{},{id:e.id,toUser:t}))}catch(t){}}return r}catch(I_){if(console.error("Error getting sent friend requests:",I_),"failed-precondition"===I_.code)return[];if("permission-denied"===I_.code)return[];if("unavailable"===I_.code)return[];throw I_}}static async getRecommendedFriends(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;try{let i;console.log("Starting getRecommendedFriends for user:",e);try{const e=Wf(tf(PE,"users"),Jf("createdAt","desc"),$f(50));i=await fp(e),console.log("Successfully queried users with orderBy")}catch(n){console.warn("OrderBy query failed, using basic query:",n);const e=Wf(tf(PE,"users"),$f(50));i=await fp(e),console.log("Successfully queried users with basic query")}const r=[];i.forEach(t=>{const n=Ve({id:t.id},t.data());n.id!==e&&r.push(n)}),console.log("Found users in database:",r.length);const s=(await this.getUserFriendships(e)).map(e=>e.friend.id),[o,a]=await Promise.all([this.getPendingFriendRequests(e),this.getSentFriendRequests(e)]),l=[...o.map(e=>e.fromUser.id),...a.map(e=>e.toUser.id)],c=r.filter(e=>!s.includes(e.id)&&!l.includes(e.id));console.log("Recommended friends debug:",{totalUsers:r.length,friendIds:s.length,pendingUserIds:l.length,filteredUsers:c.length,finalRecommendations:c.slice(0,t).length});const u=c.slice(0,t);return 0===u.length&&(console.warn("No recommended friends found. Possible reasons:"),console.warn("- No users in database:",0===r.length),console.warn("- All users are already friends or have pending requests"),console.warn("- User is trying to recommend themselves")),u}catch(I_){if(console.error("Error getting recommended friends:",I_),"failed-precondition"===I_.code)return[];if("permission-denied"===I_.code)return[];if("unavailable"===I_.code)return[];throw I_}}static async areFriends(e,t){try{return null!==await this.getFriendship(e,t)}catch(I_){return!1}}static async hasPendingRequest(e,t){try{const[n,i]=await Promise.all([this.getPendingFriendRequest(e,t),this.getPendingFriendRequest(t,e)]);return null!==n||null!==i}catch(I_){return!1}}static subscribeToFriendRequests(e,t){return _p(Wf(tf(PE,this.FRIEND_REQUESTS_COLLECTION),Gf("toUserId","==",e),Gf("status","==","pending"),Jf("createdAt","desc")),async e=>{const n=[];for(const t of e.docs){const e=t.data();try{const i=await OE.getUserProfile(e.fromUserId);i&&n.push(Ve(Ve({},e),{},{id:t.id,fromUser:i}))}catch(i){}}t(n)},e=>{t([])})}static subscribeToSentFriendRequests(e,t){return _p(Wf(tf(PE,this.FRIEND_REQUESTS_COLLECTION),Gf("fromUserId","==",e),Gf("status","==","pending"),Jf("createdAt","desc")),async e=>{const n=[];for(const t of e.docs){const e=t.data();try{const i=await OE.getUserProfile(e.toUserId);i&&n.push(Ve(Ve({},e),{},{id:t.id,toUser:i}))}catch(i){}}t(n)},e=>{t([])})}static subscribeToFriendships(e,t){return _p(Wf(tf(PE,this.FRIENDSHIPS_COLLECTION),Qf(Gf("userId1","==",e),Gf("userId2","==",e)),Jf("createdAt","desc")),async n=>{const i=[];for(const t of n.docs){const n=t.data(),s=n.userId1===e?n.userId2:n.userId1;try{const e=await OE.getUserProfile(s);e&&i.push({id:t.id,friend:{id:e.id,displayName:e.displayName,email:e.email,photoURL:e.photoURL,bio:e.bio,location:e.location,tags:e.tags,isOnline:e.isOnline,lastSeen:e.lastSeen},createdAt:n.createdAt})}catch(r){}}t(i)},e=>{t([])})}static async cancelFriendRequest(e){try{const t=nf(PE,this.FRIEND_REQUESTS_COLLECTION,e),n=await hp(t);if(!n.exists())throw new Error("Friend request not found");if("pending"!==n.data().status)throw new Error("Friend request is not pending");await mp(t)}catch(I_){throw I_}}static async bulkAcceptFriendRequests(e){try{const n=(af(t=Zd(t=PE,of)),new wp(t,e=>vp(t,e)));for(const t of e){const e=nf(PE,this.FRIEND_REQUESTS_COLLECTION,t),i=await hp(e);if(i.exists()){const t=i.data();if("pending"===t.status){n.update(e,{status:"accepted",updatedAt:(new Date).toISOString()});const i=nf(tf(PE,this.FRIENDSHIPS_COLLECTION)),[r,s]=[t.fromUserId,t.toUserId].sort();n.set(i,{userId1:r,userId2:s,createdAt:(new Date).toISOString()})}}}await n.commit()}catch(I_){throw I_}var t}static async getFriendshipStats(e){try{const[t,n,i]=await Promise.all([this.getUserFriendships(e),this.getPendingFriendRequests(e),this.getSentFriendRequests(e)]);return{friendsCount:t.length,pendingRequestsCount:n.length,sentRequestsCount:i.length}}catch(I_){return{friendsCount:0,pendingRequestsCount:0,sentRequestsCount:0}}}}ZT.FRIEND_REQUESTS_COLLECTION="friendRequests",ZT.FRIENDSHIPS_COLLECTION="friendships";const QT=ZT,YT=e=>{let{user:n}=e;const[i,r]=(0,t.useState)([]),[s,o]=(0,t.useState)([]),[a,l]=(0,t.useState)([]),[c,u]=(0,t.useState)([]),[h,d]=(0,t.useState)({friendsCount:0,pendingRequestsCount:0,sentRequestsCount:0}),[f,p]=(0,t.useState)(!0),[m,g]=(0,t.useState)(null),[_,v]=(0,t.useState)(null),[y,w]=(0,t.useState)("friends"),[b,E]=(0,t.useState)(navigator.onLine),[T,C]=(0,t.useState)({}),x=(0,t.useRef)({}),S=(0,t.useCallback)(async()=>{try{const e=await QT.getRecommendedFriends(n.id,3);r(e)}catch(e){console.error("Failed to load recommended friends:",e),g("Failed to load recommended friends. Please try again.")}},[n.id]),I=(0,t.useCallback)(()=>{Object.values(x.current).forEach(e=>{e&&e()}),x.current.friendships=QT.subscribeToFriendships(n.id,e=>{o(e),d(t=>Ve(Ve({},t),{},{friendsCount:e.length}))}),x.current.pendingRequests=QT.subscribeToFriendRequests(n.id,e=>{l(e),d(t=>Ve(Ve({},t),{},{pendingRequestsCount:e.length}))}),x.current.sentRequests=QT.subscribeToSentFriendRequests(n.id,e=>{u(e),d(t=>Ve(Ve({},t),{},{sentRequestsCount:e.length}))})},[n.id]);(0,t.useEffect)(()=>{const e=()=>E(!0),t=()=>E(!1);return window.addEventListener("online",e),window.addEventListener("offline",t),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t)}},[]),(0,t.useEffect)(()=>(n&&n.id?(async()=>{try{p(!0),g(null),await S(),I(),p(!1)}catch(e){g("Failed to initialize friends data"),p(!1)}})():p(!1),()=>{Object.values(x.current).forEach(e=>{e&&e()})}),[S,I,n]);const k=async e=>{try{await QT.removeFriendship(n.id,e),o(t=>t.filter(t=>t.friend.id!==e)),d(e=>Ve(Ve({},e),{},{friendsCount:e.friendsCount-1})),await S()}catch(t){g("Failed to remove friend")}},P=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,jE.jsxs)("div",{className:"user-card",children:[(0,jE.jsx)("div",{className:"user-avatar",children:e.photoURL?(0,jE.jsx)("img",{src:e.photoURL,alt:e.displayName}):(0,jE.jsx)("div",{className:"default-avatar",children:"\ud83d\udc64"})}),(0,jE.jsxs)("div",{className:"user-info",children:[(0,jE.jsx)("h3",{className:"user-name",children:e.displayName}),e.bio&&(0,jE.jsx)("p",{className:"user-bio",children:e.bio}),e.location&&(0,jE.jsxs)("p",{className:"user-location",children:["\ud83d\udccd ",e.location]}),e.tags&&e.tags.length>0&&(0,jE.jsx)("div",{className:"user-tags",children:e.tags.map((e,t)=>(0,jE.jsx)("span",{className:"tag",children:e},t))})]}),(0,jE.jsx)("div",{className:"user-actions",children:t?(0,jE.jsx)("button",{className:"remove-friend-btn",onClick:()=>k(e.id),children:"Remove Friend"}):(0,jE.jsx)("button",{className:"add-friend-btn",disabled:T["send-".concat(e.id)],onClick:()=>(async e=>{const t="send-".concat(e);C(e=>Ve(Ve({},e),{},{[t]:!0}));try{if(g(null),v(null),!n.id)throw new Error("User ID is not available");if(!e)throw new Error("Friend ID is not available");if(n.id===e)throw new Error("Cannot send friend request to yourself");const t=await QT.sendFriendRequest(n.id,e);r(t=>t.filter(t=>t.id!==e));const s=i.find(t=>t.id===e);if(s){const i={id:t,fromUserId:n.id,toUserId:e,status:"pending",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),toUser:s};u(e=>[i,...e]),d(e=>Ve(Ve({},e),{},{sentRequestsCount:e.sentRequestsCount+1}))}await S(),w("requests"),s&&v("Friend request sent to ".concat(s.displayName,"!"))}catch(s){g(s instanceof Error?s.message:"Failed to send friend request")}finally{C(e=>Ve(Ve({},e),{},{[t]:!1}))}})(e.id),children:T["send-".concat(e.id)]?"Sending...":"Send Request"})})]},e.id)},N=e=>(0,jE.jsxs)("div",{className:"user-card",children:[(0,jE.jsx)("div",{className:"user-avatar",children:e.fromUser.photoURL?(0,jE.jsx)("img",{src:e.fromUser.photoURL,alt:e.fromUser.displayName}):(0,jE.jsx)("div",{className:"default-avatar",children:"\ud83d\udc64"})}),(0,jE.jsxs)("div",{className:"user-info",children:[(0,jE.jsx)("h3",{className:"user-name",children:e.fromUser.displayName}),e.fromUser.bio&&(0,jE.jsx)("p",{className:"user-bio",children:e.fromUser.bio}),e.fromUser.location&&(0,jE.jsxs)("p",{className:"user-location",children:["\ud83d\udccd ",e.fromUser.location]}),e.fromUser.tags&&e.fromUser.tags.length>0&&(0,jE.jsx)("div",{className:"user-tags",children:e.fromUser.tags.map((e,t)=>(0,jE.jsx)("span",{className:"tag",children:e},t))})]}),(0,jE.jsxs)("div",{className:"user-actions",children:[(0,jE.jsx)("button",{className:"accept-request-btn",onClick:()=>(async e=>{try{const t=a.find(t=>t.id===e);if(!t)throw new Error("Friend request not found");await QT.acceptFriendRequest(e),l(t=>t.filter(t=>t.id!==e)),d(e=>Ve(Ve({},e),{},{pendingRequestsCount:e.pendingRequestsCount-1}));const n={id:"friend-".concat(Date.now()),friend:t.fromUser,createdAt:(new Date).toISOString()};o(e=>[n,...e]),d(e=>Ve(Ve({},e),{},{friendsCount:e.friendsCount+1})),await S(),w("friends")}catch(t){g("Failed to accept friend request")}})(e.id),children:"Accept"}),(0,jE.jsx)("button",{className:"decline-request-btn",onClick:()=>(async e=>{try{await QT.declineFriendRequest(e),l(t=>t.filter(t=>t.id!==e)),d(e=>Ve(Ve({},e),{},{pendingRequestsCount:e.pendingRequestsCount-1}))}catch(t){g("Failed to decline friend request")}})(e.id),children:"Decline"})]})]},e.id),A=e=>(0,jE.jsxs)("div",{className:"user-card",children:[(0,jE.jsx)("div",{className:"user-avatar",children:e.toUser.photoURL?(0,jE.jsx)("img",{src:e.toUser.photoURL,alt:e.toUser.displayName}):(0,jE.jsx)("div",{className:"default-avatar",children:"\ud83d\udc64"})}),(0,jE.jsxs)("div",{className:"user-info",children:[(0,jE.jsx)("h3",{className:"user-name",children:e.toUser.displayName}),e.toUser.bio&&(0,jE.jsx)("p",{className:"user-bio",children:e.toUser.bio}),e.toUser.location&&(0,jE.jsxs)("p",{className:"user-location",children:["\ud83d\udccd ",e.toUser.location]}),e.toUser.tags&&e.toUser.tags.length>0&&(0,jE.jsx)("div",{className:"user-tags",children:e.toUser.tags.map((e,t)=>(0,jE.jsx)("span",{className:"tag",children:e},t))}),(0,jE.jsxs)("div",{className:"request-time",children:["Sent ",new Date(e.createdAt).toLocaleDateString()]})]}),(0,jE.jsx)("div",{className:"user-actions",children:(0,jE.jsx)("button",{className:"cancel-request-btn",onClick:()=>(async e=>{try{await QT.cancelFriendRequest(e),u(t=>t.filter(t=>t.id!==e)),d(e=>Ve(Ve({},e),{},{sentRequestsCount:e.sentRequestsCount-1})),await S()}catch(t){g("Failed to cancel friend request")}})(e.id),children:"Cancel Request"})})]},e.id);return f?(0,jE.jsx)("div",{className:"friends-view",children:(0,jE.jsx)("div",{className:"loading",children:"Loading friends..."})}):(0,jE.jsxs)("div",{className:"friends-view",children:[(0,jE.jsxs)("div",{className:"friends-header",children:[(0,jE.jsx)("h1",{children:"Friends"}),(0,jE.jsx)("p",{children:"Connect with other pet owners in your community"}),(0,jE.jsx)("div",{className:"connection-status ".concat(b?"online":"offline"),children:b?"\ud83d\udfe2 Online":"\ud83d\udd34 Offline"})]}),m&&(0,jE.jsxs)("div",{className:"error-message",children:[m,(0,jE.jsx)("button",{onClick:()=>g(null),className:"close-error",children:"\xd7"})]}),_&&(0,jE.jsxs)("div",{className:"success-message",children:[_,(0,jE.jsx)("button",{onClick:()=>v(null),className:"close-success",children:"\xd7"})]}),(0,jE.jsxs)("div",{className:"friends-tabs",children:[(0,jE.jsxs)("button",{className:"tab-button ".concat("friends"===y?"active":""),onClick:()=>w("friends"),children:["Friends (",h.friendsCount,")"]}),(0,jE.jsxs)("button",{className:"tab-button ".concat("requests"===y?"active":""),onClick:()=>w("requests"),children:["Requests (",h.pendingRequestsCount,")",h.pendingRequestsCount>0&&(0,jE.jsx)("span",{className:"notification-badge",children:h.pendingRequestsCount})]})]}),(0,jE.jsx)("div",{className:"friends-sections",children:"friends"===y?(0,jE.jsxs)(jE.Fragment,{children:[(0,jE.jsxs)("section",{className:"friends-section",children:[(0,jE.jsx)("h2",{children:"Recommended Friends"}),i.length>0?(0,jE.jsx)("div",{className:"friends-grid",children:i.map(e=>P(e,!1))}):(0,jE.jsxs)("div",{className:"no-friends",children:[(0,jE.jsx)("p",{children:"No recommended friends at the moment."}),(0,jE.jsx)("button",{className:"refresh-btn",onClick:S,disabled:f,children:f?"Loading...":"Refresh Recommendations"})]})]}),(0,jE.jsxs)("section",{className:"friends-section",children:[(0,jE.jsxs)("h2",{children:["My Friends (",s.length,")"]}),s.length>0?(0,jE.jsx)("div",{className:"friends-grid",children:s.map(e=>(e=>(0,jE.jsxs)("div",{className:"user-card",children:[(0,jE.jsx)("div",{className:"user-avatar",children:e.friend.photoURL?(0,jE.jsx)("img",{src:e.friend.photoURL,alt:e.friend.displayName}):(0,jE.jsx)("div",{className:"default-avatar",children:"\ud83d\udc64"})}),(0,jE.jsxs)("div",{className:"user-info",children:[(0,jE.jsx)("h3",{className:"user-name",children:e.friend.displayName}),e.friend.bio&&(0,jE.jsx)("p",{className:"user-bio",children:e.friend.bio}),e.friend.location&&(0,jE.jsxs)("p",{className:"user-location",children:["\ud83d\udccd ",e.friend.location]}),e.friend.tags&&e.friend.tags.length>0&&(0,jE.jsx)("div",{className:"user-tags",children:e.friend.tags.map((e,t)=>(0,jE.jsx)("span",{className:"tag",children:e},t))})]}),(0,jE.jsx)("div",{className:"user-actions",children:(0,jE.jsx)("button",{className:"remove-friend-btn",onClick:()=>k(e.friend.id),children:"Remove Friend"})})]},e.id))(e))}):(0,jE.jsx)("p",{className:"no-friends",children:"You haven't added any friends yet."})]})]}):(0,jE.jsxs)(jE.Fragment,{children:[(0,jE.jsxs)("section",{className:"friends-section",children:[(0,jE.jsxs)("div",{className:"section-header",children:[(0,jE.jsxs)("h2",{children:["Friend Requests (",a.length,")"]}),a.length>1&&(0,jE.jsx)("button",{className:"bulk-accept-btn",onClick:()=>(async e=>{try{await QT.bulkAcceptFriendRequests(e),l(t=>t.filter(t=>!e.includes(t.id)));const t=a.filter(t=>e.includes(t.id)).map(e=>({id:"request-".concat(Date.now(),"-").concat(e.id),friend:e.fromUser,createdAt:(new Date).toISOString()}));o(e=>[...t,...e]),d(t=>Ve(Ve({},t),{},{pendingRequestsCount:t.pendingRequestsCount-e.length,friendsCount:t.friendsCount+e.length})),await S(),w("friends")}catch(t){g("Failed to accept friend requests")}})(a.map(e=>e.id)),children:"Accept All"})]}),a.length>0?(0,jE.jsx)("div",{className:"friends-grid",children:a.map(e=>N(e))}):(0,jE.jsx)("p",{className:"no-friends",children:"No pending friend requests."})]}),(0,jE.jsxs)("section",{className:"friends-section",children:[(0,jE.jsxs)("h2",{children:["Sent Requests (",c.length,")"]}),c.length>0?(0,jE.jsx)("div",{className:"friends-grid",children:c.map(e=>A(e))}):(0,jE.jsx)("p",{className:"no-friends",children:"No sent friend requests."})]})]})})]})};class JT{constructor(){this.config=void 0,this.config={pythonScriptPath:"./scripts/pet_translator.py",modelPath:"./models/",tempImagePath:"./temp/"}}static getInstance(){return JT.instance||(JT.instance=new JT),JT.instance}async analyzePetImage(e){try{const t=await this.fileToBase64(e);return await this.simulatePetAnalysis(t,e.name)}catch(I_){throw console.error("Pet analysis error:",I_),new Error("Failed to analyze pet image. Please try again.")}}fileToBase64(e){return new Promise((t,n)=>{const i=new FileReader;i.readAsDataURL(e),i.onload=()=>{const e=i.result.split(",")[1];t(e)},i.onerror=e=>n(e)})}async simulatePetAnalysis(e,t){await new Promise(e=>setTimeout(e,2e3));const n=[{petType:"dog",mood:"happy",confidence:.95,recommendation:"Your dog is absolutely thrilled! Take them for a long walk or play fetch in the park \ud83c\udfbe"},{petType:"dog",mood:"happy",confidence:.88,recommendation:"Your dog is beaming with joy! They'd love some belly rubs and a game of tug-of-war \ud83d\udc15"},{petType:"dog",mood:"happy",confidence:.92,recommendation:"Your dog is wagging with happiness! Give them some treats and let them sniff around the yard \ud83d\udc36"},{petType:"dog",mood:"happy",confidence:.89,recommendation:"Your dog is in great spirits! They'd enjoy some mental stimulation and exercise \ud83d\udc15\u200d\ud83e\uddba"},{petType:"dog",mood:"happy",confidence:.94,recommendation:"Your dog is radiating happiness! Challenge them with some puzzle toys or agility exercises \ud83c\udfaf"},{petType:"dog",mood:"happy",confidence:.91,recommendation:"Your dog is absolutely delighted! They'd love some grooming time and a fun training session \u2728"},{petType:"dog",mood:"happy",confidence:.87,recommendation:"Your dog is content and cheerful! Give them some gentle playtime and lots of love \ud83d\udc3e"},{petType:"dog",mood:"happy",confidence:.93,recommendation:"Your dog is full of joy! They'd love a long run or some outdoor play if available \u2744\ufe0f"},{petType:"dog",mood:"happy",confidence:.9,recommendation:"Your dog is beaming with happiness! They'd enjoy some interactive games or frisbee \ud83e\udd4f"},{petType:"dog",mood:"happy",confidence:.86,recommendation:"Your dog is absolutely joyful! They'd love some cuddle time and gentle play \ud83d\udc15"}],i=n[Math.floor(Math.random()*n.length)],r="data:image/jpeg;base64,".concat(e);return Ve(Ve({},i),{},{annotatedImage:r})}async callPythonScript(e){const t=await fetch("/api/pet-translator/analyze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({image:e})});if(!t.ok)throw new Error("Analysis failed: ".concat(t.statusText));const n=await t.json();if(!n.success)throw new Error(n.error||"Analysis failed");return{petType:n.petType,mood:n.mood,confidence:n.confidence,recommendation:n.recommendation,annotatedImage:n.annotatedImage}}async callPythonScriptDirect(e){const t=await fetch("/api/execute-python-script",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({scriptPath:this.config.pythonScriptPath,imagePath:e})});if(!t.ok)throw new Error("Python script execution failed: ".concat(t.statusText));const n=await t.json();if(!n.success)throw new Error(n.error||"Python script execution failed");return{petType:n.petType,mood:n.mood,confidence:n.confidence,recommendation:n.recommendation,annotatedImage:n.annotatedImage}}getRecommendation(e,t){return{dog_happy:"Take your dog for a walk or play fetch \ud83c\udfbe",dog_tired:"Let your dog rest and provide fresh water \ud83d\udca7",dog_playful:"Engage with toys to burn energy \ud83d\udc15",dog_anxious:"Check if something is stressing your dog \ud83d\ude1f",cat_happy:"Give your cat some toys or treats \ud83d\udc31\u2728",cat_tired:"Let your cat nap in a quiet spot \ud83d\udca4",cat_playful:"Play with a laser pointer or string toy \ud83c\udfaf",cat_anxious:"Make sure the environment is calm \ud83d\udc31\ud83d\ude1f"}["".concat(e,"_").concat(t)]||"Keep monitoring your pet."}validateImageFile(e){return e.size>10485760?{isValid:!1,error:"Image file is too large. Maximum size is 10MB."}:["image/jpeg","image/jpg","image/png","image/webp"].includes(e.type)?{isValid:!0}:{isValid:!1,error:"Invalid file type. Please upload a JPG, PNG, or WebP image."}}}JT.instance=void 0;const XT=JT,$T=()=>{const[e,n]=(0,t.useState)(!1),[i,r]=(0,t.useState)(null),[s,o]=(0,t.useState)(null),[a,l]=(0,t.useState)(!1),c=(0,t.useRef)(null),u=CT.getInstance(),h=async e=>{n(!0),o(null),r(null);try{const t=XT.getInstance(),n=await t.analyzePetImage(e);r(n)}catch(t){o(t instanceof Error?t.message:"Failed to analyze pet image")}finally{n(!1)}},d=()=>{r(null),o(null),c.current&&(c.current.value="")};return(0,jE.jsxs)("div",{className:"pet-translator",children:[(0,jE.jsxs)("div",{className:"pet-translator-header",children:[(0,jE.jsx)("h1",{children:"\ud83d\udc3e Pet Translator"}),(0,jE.jsx)("p",{children:"Upload a photo of your pet to analyze their mood and get personalized recommendations"})]}),(0,jE.jsxs)("div",{className:"pet-translator-content",children:[!i&&!s&&(0,jE.jsxs)("div",{className:"upload-area",onDrop:e=>{e.preventDefault();const t=e.dataTransfer.files[0];t&&t.type.startsWith("image/")&&h(t)},onDragOver:e=>{e.preventDefault()},onClick:()=>{var e;return null===(e=c.current)||void 0===e?void 0:e.click()},children:[(0,jE.jsxs)("div",{className:"upload-content",children:[(0,jE.jsx)("div",{className:"upload-icon",children:"\ud83d\udcf8"}),(0,jE.jsx)("h3",{children:"Upload Pet Photo"}),(0,jE.jsx)("p",{children:"Drag and drop an image here or click to select"}),(0,jE.jsx)("p",{className:"upload-hint",children:"Supports JPG, PNG, and other image formats"})]}),(0,jE.jsx)("input",{ref:c,type:"file",accept:"image/*",onChange:e=>{var t;const n=null===(t=e.target.files)||void 0===t?void 0:t[0];n&&h(n)},style:{display:"none"}})]}),e&&(0,jE.jsxs)("div",{className:"loading-container",children:[(0,jE.jsx)("div",{className:"loading-spinner",children:(0,jE.jsx)("div",{className:"paw-icon",children:"\ud83d\udc3e"})}),(0,jE.jsx)("p",{children:"Analyzing your pet's mood..."}),(0,jE.jsx)("p",{className:"loading-hint",children:"This may take a few moments"})]}),s&&(0,jE.jsxs)("div",{className:"error-container",children:[(0,jE.jsx)("div",{className:"error-icon",children:"\u274c"}),(0,jE.jsx)("h3",{children:"Analysis Failed"}),(0,jE.jsx)("p",{children:s}),(0,jE.jsx)("button",{className:"retry-button",onClick:d,children:"Try Again"})]}),i&&(0,jE.jsxs)("div",{className:"result-container",children:[(0,jE.jsxs)("div",{className:"result-header",children:[(0,jE.jsx)("h2",{children:"Analysis Complete! \ud83c\udf89"}),(0,jE.jsx)("button",{className:"new-analysis-button",onClick:d,children:"Analyze Another Pet"})]}),(0,jE.jsxs)("div",{className:"result-content",children:[(0,jE.jsxs)("div",{className:"pet-info",children:[(0,jE.jsxs)("div",{className:"info-card",children:[(0,jE.jsx)("div",{className:"info-icon",children:"\ud83d\udc15"}),(0,jE.jsxs)("div",{className:"info-content",children:[(0,jE.jsx)("h3",{children:"Pet Type"}),(0,jE.jsx)("p",{className:"info-value",children:i.petType})]})]}),(0,jE.jsxs)("div",{className:"info-card",children:[(0,jE.jsx)("div",{className:"info-icon",children:"\ud83d\ude0a"}),(0,jE.jsxs)("div",{className:"info-content",children:[(0,jE.jsx)("h3",{children:"Mood"}),(0,jE.jsx)("p",{className:"info-value",children:i.mood}),(0,jE.jsxs)("p",{className:"confidence",children:["Confidence: ",Math.round(100*i.confidence),"%"]})]})]})]}),(0,jE.jsxs)("div",{className:"recommendation-card",children:[(0,jE.jsxs)("div",{className:"recommendation-header",children:[(0,jE.jsx)("h3",{children:"\ud83d\udca1 Recommendation"}),(0,jE.jsx)("button",{className:"voice-button",onClick:async()=>{if(i){l(!0);try{if(!u.isAudioContextReady()){if(!await u.initializeAudioContext())return void o("Failed to initialize audio system. Please try again.")}const e="I detected a ".concat(i.petType," that appears to be ").concat(i.mood," with ").concat(Math.round(100*i.confidence),"% confidence. ").concat(i.recommendation);await u.playText(e,{voiceSettings:{stability:.5,similarity_boost:.5}})||o("Voice playback failed. Please try again.")}catch(e){const t=e instanceof Error?e.message:"Unknown error";o("Voice playback failed: ".concat(t))}finally{l(!1)}}},disabled:a,children:a?"\ud83d\udd0a Playing...":"\ud83d\udd0a Play Voice"})]}),(0,jE.jsx)("p",{className:"recommendation-text",children:i.recommendation})]}),i.annotatedImage&&(0,jE.jsxs)("div",{className:"annotated-image",children:[(0,jE.jsx)("h3",{children:"Annotated Image"}),(0,jE.jsx)("img",{src:i.annotatedImage,alt:"Pet analysis with annotations",className:"result-image"})]})]})]})]})]})},eC=e=>{let{user:n}=e;const[i,r]=(0,t.useState)("dashboard"),[s,o]=(0,t.useState)(!1);(0,t.useEffect)(()=>{(()=>{if("undefined"!==typeof window){const e="capacitor:"===window.location.protocol,t=/iPad|iPhone|iPod/.test(navigator.userAgent);o(e&&t)}})()},[]);return(0,jE.jsxs)("div",{className:"main-view ".concat(s?"ios-layout":""),children:[!s&&(0,jE.jsxs)("nav",{className:"top-nav",children:[(0,jE.jsxs)("div",{className:"nav-brand",children:[(0,jE.jsx)("span",{className:"brand-icon",children:"\ud83d\udc3e"}),(0,jE.jsx)("span",{className:"brand-text",children:"Fetchr"})]}),(0,jE.jsxs)("div",{className:"nav-items",children:[(0,jE.jsxs)("button",{className:"nav-item ".concat("dashboard"===i?"active":""),onClick:()=>r("dashboard"),children:[(0,jE.jsx)("span",{className:"nav-icon",children:"\ud83d\udc3e"}),(0,jE.jsx)("span",{className:"nav-label",children:"Dashboard"})]}),(0,jE.jsxs)("button",{className:"nav-item ".concat("community"===i?"active":""),onClick:()=>r("community"),children:[(0,jE.jsx)("span",{className:"nav-icon",children:"\ud83d\udde3\ufe0f"}),(0,jE.jsx)("span",{className:"nav-label",children:"Community"})]}),(0,jE.jsxs)("button",{className:"nav-item ".concat("friends"===i?"active":""),onClick:()=>r("friends"),children:[(0,jE.jsx)("span",{className:"nav-icon",children:"\ud83d\udc65"}),(0,jE.jsx)("span",{className:"nav-label",children:"Friends"})]}),(0,jE.jsxs)("button",{className:"nav-item ".concat("pet-translator"===i?"active":""),onClick:()=>r("pet-translator"),children:[(0,jE.jsx)("span",{className:"nav-icon",children:"\ud83d\udd0d"}),(0,jE.jsx)("span",{className:"nav-label",children:"Pet Translator"})]}),(0,jE.jsxs)("button",{className:"nav-item ".concat("vets"===i?"active":""),onClick:()=>r("vets"),children:[(0,jE.jsx)("span",{className:"nav-icon",children:"\ud83c\udfe5"}),(0,jE.jsx)("span",{className:"nav-label",children:"Vets"})]}),(0,jE.jsxs)("button",{className:"nav-item ".concat("profile"===i?"active":""),onClick:()=>r("profile"),children:[(0,jE.jsx)("span",{className:"nav-icon",children:"\ud83d\udc64"}),(0,jE.jsx)("span",{className:"nav-label",children:"Profile"})]})]})]}),(0,jE.jsx)("div",{className:"main-content ".concat(s?"ios-content":""),children:(()=>{switch(i){case"dashboard":default:return(0,jE.jsx)(FT,{});case"profile":return(0,jE.jsx)(zT,{user:n});case"community":return(0,jE.jsx)(WT,{});case"vets":return(0,jE.jsx)(GT,{});case"friends":return(0,jE.jsx)(YT,{user:n});case"pet-translator":return(0,jE.jsx)($T,{})}})()}),s&&(0,jE.jsxs)("nav",{className:"bottom-nav",children:[(0,jE.jsxs)("button",{className:"nav-item ".concat("dashboard"===i?"active":""),onClick:()=>r("dashboard"),children:[(0,jE.jsx)("span",{className:"nav-icon",children:"\ud83d\udc3e"}),(0,jE.jsx)("span",{className:"nav-label",children:"Dashboard"})]}),(0,jE.jsxs)("button",{className:"nav-item ".concat("community"===i?"active":""),onClick:()=>r("community"),children:[(0,jE.jsx)("span",{className:"nav-icon",children:"\ud83d\udde3\ufe0f"}),(0,jE.jsx)("span",{className:"nav-label",children:"Community"})]}),(0,jE.jsxs)("button",{className:"nav-item ".concat("friends"===i?"active":""),onClick:()=>r("friends"),children:[(0,jE.jsx)("span",{className:"nav-icon",children:"\ud83d\udc65"}),(0,jE.jsx)("span",{className:"nav-label",children:"Friends"})]}),(0,jE.jsxs)("button",{className:"nav-item ".concat("pet-translator"===i?"active":""),onClick:()=>r("pet-translator"),children:[(0,jE.jsx)("span",{className:"nav-icon",children:"\ud83d\udd0d"}),(0,jE.jsx)("span",{className:"nav-label",children:"Pet Translator"})]}),(0,jE.jsxs)("button",{className:"nav-item ".concat("vets"===i?"active":""),onClick:()=>r("vets"),children:[(0,jE.jsx)("span",{className:"nav-icon",children:"\ud83c\udfe5"}),(0,jE.jsx)("span",{className:"nav-label",children:"Vets"})]}),(0,jE.jsxs)("button",{className:"nav-item ".concat("profile"===i?"active":""),onClick:()=>r("profile"),children:[(0,jE.jsx)("span",{className:"nav-icon",children:"\ud83d\udc64"}),(0,jE.jsx)("span",{className:"nav-label",children:"Profile"})]})]})]})};class tC{constructor(){this.config=void 0,this.config=this.detectEnvironment()}static getInstance(){return tC.instance||(tC.instance=new tC),tC.instance}detectEnvironment(){const e="undefined"!==typeof window&&"capacitor:"===window.location.protocol;let t;if(e){const e=this.getServerIP();t="http://".concat(e,":8080")}else t="http://localhost:8080";return{serverUrl:t,isNative:e,isDevelopment:!1}}getServerIP(){return"10.74.159.48"}getConfig(){return this.config}getApiUrl(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const t=this.config.serverUrl;return e?"".concat(t).concat(e):t}async testConnection(){try{const e=this.getApiUrl("/api/health");return(await fetch(e,{method:"GET",headers:{"Content-Type":"application/json"},signal:AbortSignal.timeout(5e3)})).ok}catch(I_){return!1}}getConnectionInstructions(){return this.config.isNative?"To connect your iOS app to the backend server:\n\n1. Make sure your computer and phone are on the same WiFi network\n2. Find your computer's IP address:\n   - Mac: Run 'ipconfig getifaddr en0' in Terminal\n   - Windows: Run 'ipconfig' in Command Prompt\n3. Update the server IP in NetworkConfig.ts or set REACT_APP_SERVER_IP environment variable\n4. Make sure your backend server is running on port 8080\n\nCurrent server URL: ".concat(this.config.serverUrl):"Web development mode - using localhost"}}tC.instance=void 0;const nC=tC.getInstance(),iC=nC.getApiUrl("/api/generate-content");class rC{static async sendMessage(e,t,n){if(!e||0===e.length)throw new Error("Message history cannot be empty.");const i=JSON.stringify({messages:e,petData:t||null,sensorData:n||null}),r=new AbortController,s=setTimeout(()=>r.abort(),3e4);try{const e=await fetch(iC,{method:"POST",headers:{"Content-Type":"application/json"},body:i,signal:r.signal});return clearTimeout(s),await this.handleResponse(e)}catch(I_){var o,a;if(clearTimeout(s),"AbortError"===I_.name)throw new Error("Request timed out - please check your internet connection");if(null!==(o=I_.message)&&void 0!==o&&o.includes("Failed to fetch")||null!==(a=I_.message)&&void 0!==a&&a.includes("Network request failed")){if(nC.getConfig().isNative){const e=await this.getConnectionInfo();throw new Error("Unable to connect to Pet Assistant API.\n\nConnection Info:\n- URL: ".concat(e.url,"\n- Platform: ").concat(e.isIOS?"iOS":"Android","\n- Connection Test: ").concat(e.testResult?"PASSED":"FAILED","\n").concat(e.error?"- Error: ".concat(e.error):"","\n\n").concat(nC.getConnectionInstructions()))}throw new Error("Unable to connect to Pet Assistant API - please check your internet connection")}throw I_}}static async testConnection(){return await nC.testConnection()}static getConnectionInstructions(){return nC.getConnectionInstructions()}static async getConnectionInfo(){const e=nC.getConfig(),t=nC.getApiUrl("/api/health");try{const n=await nC.testConnection();return{url:t,isNative:e.isNative,isIOS:e.isNative&&"undefined"!==typeof window&&/iPad|iPhone|iPod/.test(navigator.userAgent),testResult:n}}catch(I_){return{url:t,isNative:e.isNative,isIOS:e.isNative&&"undefined"!==typeof window&&/iPad|iPhone|iPod/.test(navigator.userAgent),testResult:!1,error:I_ instanceof Error?I_.message:"Unknown error"}}}static async handleResponse(e){if(!e.ok){let t="Check server console logs for details.";try{const n=await e.json();t=n.error||n.details||t}catch(aC){t="Proxy returned non-JSON error (Status ".concat(e.status,").")}throw new Error("Pet Assistant API failed (Status ".concat(e.status,"): ").concat(t))}const t=await e.json();return t&&"string"===typeof t.content&&""!==t.content.trim()?t.content:"No text content was returned by the Pet Assistant API."}}const sC=()=>{const[e,n]=(0,t.useState)(!1),[i,r]=(0,t.useState)([]),[s,o]=(0,t.useState)(""),[a,l]=(0,t.useState)(!1),[c,u]=(0,t.useState)([]),[h,d]=(0,t.useState)(null),[f,p]=(0,t.useState)(null),[m,g]=(0,t.useState)(!0),[_,v]=(0,t.useState)(!1),y=(0,t.useRef)(null),w=(0,t.useRef)(CT.getInstance()),b=(0,t.useRef)(PT.getInstance());MT();const E=(0,t.useMemo)(()=>s.trim().length>0&&!a,[s,a]),T=async e=>{if(m)if(w.current.isConfigured())try{if(console.log("[Chatbot] Starting TTS for text:",e.substring(0,50)+"..."),!_)return void console.warn("[Chatbot] Audio system not initialized - this should not happen");console.log("[Chatbot] Playing text with ElevenLabs...");const t=await w.current.playText(e);console.log("[Chatbot] TTS result:",t?"SUCCESS":"FAILED")}catch(I_){console.error("[Chatbot] TTS error:",I_)}else console.warn("[Chatbot] ElevenLabs not configured - check API key");else console.log("[Chatbot] TTS disabled")};(0,t.useEffect)(()=>{(async()=>{try{const e=await bT.getPets();u(e),e.length>0&&d(e[0])}catch(I_){}})()},[]),(0,t.useEffect)(()=>{if(!h)return;const e=yT.subscribeToDogHealth(e=>{const t={petId:h.id,timestamp:e.timestamp||Date.now(),heartRate:e.heartRate,bodyTemperature:0,activityStatus:e.highActivity?UE.UNUSUAL:UE.RESTING,ambientTemperature:70,bloodPressure:{systolic:0,diastolic:0},respiratoryRate:0,oxygenSaturation:0,dangerMode:e.dangerMode,highActivity:e.highActivity,crashDetected:e.highActivity,suddenMovement:e.highActivity,latitude:0,longitude:0};p(t)},5e3);return()=>e()},[h]);const C=async()=>{if(!E)return;const e={role:"user",content:s.trim()};r(t=>[...t,e]),o(""),l(!0);try{const t=await rC.sendMessage([...i,e],h,f),n={role:"assistant",content:t};r(e=>[...e,n]),await T(t)}catch(aC){const t="Sorry, I ran into an error: ".concat(aC.message||"Unknown error",". Please try again.");r(e=>[...e,{role:"assistant",content:t}]),await T(t)}finally{l(!1),setTimeout(()=>{var e;return null===(e=y.current)||void 0===e?void 0:e.scrollIntoView({behavior:"smooth"})},0)}};return(0,jE.jsxs)(jE.Fragment,{children:[(0,jE.jsx)("button",{className:"chatbot-fab",onClick:async()=>{await(async()=>{if(!_){console.log("[Chatbot] Initializing audio system...");try{b.current.isMobile()&&await b.current.onUserInteraction()&&console.log("[Chatbot] Mobile audio initialized successfully"),await w.current.initializeAudioContext()&&console.log("[Chatbot] ElevenLabs audio context initialized successfully"),v(!0),console.log("[Chatbot] Audio system fully initialized")}catch(I_){console.error("[Chatbot] Failed to initialize audio system:",I_)}}})(),n(!0)},"aria-label":"Open chatbot",children:"\ud83d\udcac"}),e&&(0,jE.jsxs)(jE.Fragment,{children:[(0,jE.jsx)("div",{className:"chatbot-modal-backdrop",onClick:()=>n(!1)}),(0,jE.jsxs)("div",{className:"chatbot-modal",role:"dialog","aria-modal":"true","aria-label":"AI Chatbot",children:[(0,jE.jsxs)("div",{className:"chatbot-header",children:[(0,jE.jsx)("div",{className:"chatbot-title",children:h?"\ud83d\udc3e ".concat(h.name,"'s Assistant"):"\ud83d\udc3e Pet Assistant"}),(0,jE.jsxs)("div",{className:"chatbot-controls",children:[(0,jE.jsx)("button",{className:"tts-toggle ".concat(m?"enabled":"disabled"),onClick:()=>g(!m),title:m?"Disable voice":"Enable voice",children:m?"\ud83d\udd0a":"\ud83d\udd07"}),(0,jE.jsx)("button",{className:"chatbot-close",onClick:()=>n(!1),"aria-label":"Close",children:"\xd7"})]})]}),c.length>1&&(0,jE.jsxs)("div",{className:"chatbot-pet-selector",children:[(0,jE.jsx)("label",{children:"Select Pet:"}),(0,jE.jsx)("select",{value:(null===h||void 0===h?void 0:h.id)||"",onChange:e=>{const t=c.find(t=>t.id===e.target.value);d(t||null),r([])},children:c.map(e=>(0,jE.jsxs)("option",{value:e.id,children:[e.name," (",e.breed,")"]},e.id))})]}),(0,jE.jsxs)("div",{className:"chatbot-messages",children:[0===i.length&&(0,jE.jsx)("div",{className:"chat-msg assistant",children:h?(0,jE.jsxs)(jE.Fragment,{children:["Hi! I'm Fetchr, ",h.name,"'s personal care assistant! \ud83d\udc3e",(0,jE.jsx)("br",{}),"I'm here to help you take the best care of your ",h.breed,".",f&&f.dangerMode&&(0,jE.jsxs)(jE.Fragment,{children:[(0,jE.jsx)("br",{}),(0,jE.jsx)("br",{}),"\u26a0\ufe0f I notice ",h.name," is in danger mode - let's address this right away!"]}),(0,jE.jsx)("br",{}),(0,jE.jsx)("br",{}),"How can I help you today?"]}):(0,jE.jsxs)(jE.Fragment,{children:["Hi! I'm Fetchr, your pet care assistant! \ud83d\udc3e",(0,jE.jsx)("br",{}),"I'm here to help you take the best care of your furry friend.",(0,jE.jsx)("br",{}),(0,jE.jsx)("br",{}),"How can I help you today?"]})}),i.map((e,t)=>(0,jE.jsx)("div",{className:"chat-msg ".concat(e.role),children:e.content},t)),(0,jE.jsx)("div",{ref:y})]}),(0,jE.jsxs)("div",{className:"chatbot-input",children:[(0,jE.jsx)("input",{type:"text",value:s,onChange:e=>o(e.target.value),placeholder:h?"Ask about ".concat(h.name,"..."):"Ask about your pet...",onKeyDown:e=>{"Enter"===e.key&&C()}}),(0,jE.jsx)("button",{onClick:C,disabled:!E,children:a?"Sending...":"Send"})]})]})]})]})},oC=()=>{const[e,n]=(0,t.useState)(null),[i,r]=(0,t.useState)(!0);return(0,t.useEffect)(()=>{const e=ME.onAuthStateChange(e=>{n(e),r(!1)}),t=setTimeout(()=>{r(!1)},1e4);return()=>{e(),clearTimeout(t)}},[]),i?(0,jE.jsx)("div",{className:"app-loading",children:(0,jE.jsxs)("div",{className:"loading-spinner",children:[(0,jE.jsx)("div",{className:"paw-icon",children:"\ud83d\udc3e"}),(0,jE.jsx)("p",{children:"Loading Fetchr..."})]})}):(0,jE.jsx)(S,{children:(0,jE.jsx)(OT,{children:(0,jE.jsx)("div",{className:"App",children:e?(0,jE.jsxs)(jE.Fragment,{children:[(0,jE.jsx)(eC,{user:e}),(0,jE.jsx)(sC,{})]}):(0,jE.jsx)(FE,{})})})})};r.createRoot(document.getElementById("root")).render((0,jE.jsx)(t.StrictMode,{children:(0,jE.jsx)(oC,{})}))})()})();
//# sourceMappingURL=main.9161317f.js.map